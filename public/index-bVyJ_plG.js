import{az as vi,cd as gi,cC as pi,W as xe,_ as Vt,ed as Xi,aj as Te,aQ as me,c as U,a5 as j,bf as he,aa as ve,a_ as ft,a7 as te,ah as D,ai as we,t as I,eC as it,c5 as Ae,a6 as O,aW as pe,g1 as je,eD as nt,dl as De,bZ as _i,bP as Ie,d6 as Ni,b as S,da as wi,a2 as Me,bU as Yi,a9 as He,i as B,k as oe,cl as Ci,ac as yi,bY as We,ae as Zi,ck as Qi,ab as fe,ad as Ki,E as Qe,a as ye,a8 as Xe,d9 as Ot,aA as Dt,n as qi,bo as Ji,ak as xi,eE as ei,bB as Si,aR as bi,cM as Ct,cU as en,aB as Gt,cO as Ut,bC as tn,dV as Ye,aL as nn,c8 as ti,T as dt,bp as rn,a4 as jt,bW as on,bE as an,cJ as sn,dR as ln,cI as dn,af as Lt,bX as cn,eh as un,w as fn,aV as hn,r as mn,bI as ii,an as ni}from"./index-BV2I1Jtp.js";import{l as $i,b as ht,f as Mi,u as X,h as Wt,S as rt,H as mt,j as _e,k as Ge,m as ze,n as Xt,o as ct,p as At,q as vn,r as gn,t as tt,v as st,x as pn,s as _n,y as gt,z as pt,A as ke,C as wn,D as Ti,E as ki,G as Li,I as ri,J as Cn,K as yn,L as xn,M as Sn,N as bn,O as $n,P as Mn,Q as Tn,R as kn,T as Pi}from"./appDialogsManager-CWwr6pYf.js";import{s as lt}from"./useSwipe-DaF0L6mY.js";import{I as ut}from"./iconTsx-WcVB6J0T.js";import{H as Ln}from"./heightTransition-BrzXd6zX.js";import{S as Fe}from"./chatBackground-CE6wSm2q.js";import"./page-CZapATw0.js";import"./putPreloader-D61QXpkQ.js";import"./avatar-CoF9jUXV.js";import"./classNames-CN4lTu6a.js";import"./htmlToSpan-DhAls8qz.js";import"./wrapDuration-Dbmbo_XD.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./toast-CKjmCNNt.js";import"./fastBlur-Co-79rP4.js";import"./emailSetup-DC47owN0.js";import"./transition-RjVzGhLO.js";import"./countryInputField-DRrD4ZDI.js";import"./scrollable2-DFH8h4l4.js";import"./tracking-D9iSy3gB.js";import"./useIsCleaned-lDkUR-1w.js";function Nt(e,t,i){e.viewport(0,0,e.canvas.width,e.canvas.height),e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT),e.bindBuffer(e.ARRAY_BUFFER,t.buffers.position),e.vertexAttribPointer(t.attribs.vertexPosition,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(t.attribs.vertexPosition),e.bindBuffer(e.ARRAY_BUFFER,t.buffers.texture),e.vertexAttribPointer(t.attribs.textureCoord,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(t.attribs.textureCoord),e.useProgram(t.program),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t.texture),e.uniform1i(t.uniforms.uSampler,0),e.uniform1f(t.uniforms.uAngle,-i.rotation),e.uniform2f(t.uniforms.uResolution,e.canvas.width,e.canvas.height),e.uniform1f(t.uniforms.uScale,i.scale),e.uniform2fv(t.uniforms.uTranslation,i.translation),e.uniform2fv(t.uniforms.uImageSize,i.imageSize),e.uniform2fv(t.uniforms.uFlip,i.flip),e.uniform1f(t.uniforms.uSaturation,i.saturation),e.uniform1f(t.uniforms.uBrightness,i.brightness),e.uniform1f(t.uniforms.uContrast,i.contrast),e.uniform1f(t.uniforms.uWarmth,i.warmth),e.uniform1f(t.uniforms.uFade,i.fade),e.uniform1f(t.uniforms.uShadows,i.shadows),e.uniform1f(t.uniforms.uHighlights,i.highlights),e.uniform1f(t.uniforms.uVignette,i.vignette),e.uniform1f(t.uniforms.uGrain,i.grain),e.uniform1f(t.uniforms.uSharpen,i.sharpen),e.uniform1f(t.uniforms.uEnhance,i.enhance),e.drawArrays(e.TRIANGLE_STRIP,0,4)}function Pn(e,t,i){const n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n);const a=[0,0,t,0,0,i,t,i];return e.bufferData(e.ARRAY_BUFFER,new Float32Array(a),e.STATIC_DRAW),n}function Bn(e){const t=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,t);const i=[0,0,1,0,0,1,1,1];return e.bufferData(e.ARRAY_BUFFER,new Float32Array(i),e.STATIC_DRAW),t}function In(e,t,i){const n=oi(e,e.VERTEX_SHADER,t),a=oi(e,e.FRAGMENT_SHADER,i),r=e.createProgram();return e.attachShader(r,n),e.attachShader(r,a),e.linkProgram(r),e.getProgramParameter(r,e.LINK_STATUS)?r:($i.error(`Unable to initialize the shader program: ${e.getProgramInfoLog(r)}`),null)}function oi(e,t,i){const n=e.createShader(t);return e.shaderSource(n,i),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?n:($i.error(`An error occurred compiling the shaders: ${e.getShaderInfoLog(n)}`),e.deleteShader(n),null)}const Bi=[];window.derefMediaEditorVideos=()=>{console.log("Dereffed weak refs ::>> ",Bi.map(e=>e.deref()))};async function Ii(e,t={}){const i=t.currentTime??0,n=t.waitToSeek??!0,a=t.muted??!0,r=vi({pip:!1,middleware:t.middleware});r.src=e,r.autoplay=!0,r.controls=!1,r.muted=!0,Bi.push(new WeakRef(r));let o;r.addEventListener("timeupdate",()=>{r.pause()},{once:!0});try{const h=gi(r);if(await pi(r,h),n){const u=xe();r.addEventListener("seeked",()=>void u.resolve(),{once:!0}),o=self.setTimeout(()=>u.resolve(),500),r.currentTime=r.duration*i,await u,self.clearTimeout(o)}}catch(h){console.error(h)}return a||(r.muted=!1),r}async function Rn({gl:e,mediaSrc:t,mediaType:i,videoTime:n,waitToSeek:a,middleware:r}){const o=e.createTexture();e.bindTexture(e.TEXTURE_2D,o);let h;if(i==="image"){const u=new Image;u.src=t;const c=xe();u.addEventListener("load",()=>void c.resolve()),await c,h={image:u,width:u.naturalWidth,height:u.naturalHeight}}else{const u=await Ii(t,{currentTime:n,waitToSeek:a,middleware:r});h={video:u,width:u.videoWidth,height:u.videoHeight}}return e.bindTexture(e.TEXTURE_2D,o),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,h.video||h.image),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),{media:h,texture:o}}async function Yt({gl:e,mediaSrc:t,mediaType:i,videoTime:n,waitToSeek:a,middleware:r}){const[{vertexShaderSource:o,fragmentShaderSource:h},{texture:u,media:c}]=await Promise.all([Vt(()=>import("./shaderSources-DfZIiSec.js"),[],import.meta.url),Rn({gl:e,mediaSrc:t,mediaType:i,videoTime:n,waitToSeek:a,middleware:r})]),s=In(e,o,h),l={position:Pn(e,c.width,c.height),texture:Bn(e)};return{program:s,buffers:l,media:c,texture:u,attribs:{vertexPosition:e.getAttribLocation(s,"aVertexPosition"),textureCoord:e.getAttribLocation(s,"aTextureCoord")},uniforms:{uSampler:e.getUniformLocation(s,"uSampler"),uFlip:e.getUniformLocation(s,"uFlip"),uAngle:e.getUniformLocation(s,"uAngle"),uResolution:e.getUniformLocation(s,"uResolution"),uTranslation:e.getUniformLocation(s,"uTranslation"),uScale:e.getUniformLocation(s,"uScale"),uImageSize:e.getUniformLocation(s,"uImageSize"),...Object.fromEntries(ht.map(({uniform:d})=>[d,e.getUniformLocation(s,d)]))}}}const bt=class bt{constructor({targetCanvas:t,imageCanvas:i,blurAmount:n=bt.defaultBlurAmount}){this.brushes={pen:(a,r)=>{r.strokeStyle=a.color,this.drawLinePath(a,r)},arrow:(a,r,o)=>{const{points:h}=a;r.strokeStyle=a.color,this.drawLinePath(a,r),o&&(h.length<2||this.drawArrowHead(r,a,this.getArrowHeadLength(a)))},brush:(a,r)=>{r.strokeStyle=`rgba(${Xi(a.color).join(",")},0.4)`,this.drawLinePath(a,r)},neon:(a,r)=>{r.strokeStyle="#ffffff",r.shadowBlur=a.size,r.shadowColor=a.color,this.drawLinePath(a,r)},blur:(a,r)=>{const o=r.canvas.width,h=r.canvas.height;this.blurredLineCtx.clearRect(0,0,o,h);const{points:u}=a,c=u.map(m=>m[0]),s=u.map(m=>m[1]),l=Math.max(Math.min(...c)-a.size,0),d=Math.max(...c)+a.size,f=Math.max(Math.min(...s)-a.size,0),p=Math.max(...s)+a.size;this.blurredLineCtx.strokeStyle="white",this.drawLinePath(a,this.blurredLineCtx),this.blurredLineCtx.globalCompositeOperation="source-in",this.blurredLineCtx.drawImage(this.blurredImageCanvas,0,0),r.drawImage(this.blurredLineCanvas,l,f,d,p,l,f,d,p),this.blurredLineCtx.globalCompositeOperation="source-over"},eraser:(a,r)=>{r.strokeStyle="white",r.globalCompositeOperation="destination-out",this.drawLinePath(a,r),r.stroke(),r.globalCompositeOperation="source-over"}},this.targetCtx=t.getContext("2d"),this.imageCanvas=i,this.blurAmount=n,this.cacheCanvas=document.createElement("canvas"),this.blurredImageCanvas=document.createElement("canvas"),this.blurredLineCanvas=document.createElement("canvas"),this.width=this.cacheCanvas.width=this.blurredImageCanvas.width=this.blurredLineCanvas.width=t.width,this.height=this.cacheCanvas.height=this.blurredImageCanvas.height=this.blurredLineCanvas.height=t.height,this.cacheCtx=this.cacheCanvas.getContext("2d"),this.blurredImageCtx=this.blurredImageCanvas.getContext("2d"),this.blurredLineCtx=this.blurredLineCanvas.getContext("2d")}previewLine(t,i=!1){this.targetCtx.clearRect(0,0,this.width,this.height),this.targetCtx.drawImage(this.cacheCanvas,0,0);const n=this.brushes[t.brush];this.targetCtx.save(),n(t,this.targetCtx,i),this.targetCtx.restore()}saveLastLine(){this.cacheCtx.clearRect(0,0,this.width,this.height),this.cacheCtx.drawImage(this.targetCtx.canvas,0,0),this.updateBlurredImage()}updateBlurredImage(){this.blurredImageCtx.clearRect(0,0,this.width,this.height),this.blurredImageCtx.filter=`blur(${this.blurAmount}px)`,this.blurredImageCtx.drawImage(this.imageCanvas,0,0,this.width,this.height),this.blurredImageCtx.drawImage(this.cacheCanvas,0,0)}drawLine(t){this.previewLine(t,!0),this.saveLastLine()}clear(){this.targetCtx.clearRect(0,0,this.width,this.height),this.cacheCtx.clearRect(0,0,this.width,this.height)}drawLinePath(t,i){const{points:n}=t;if(!n.length)return;if(n.length===1){i.fillStyle=i.strokeStyle,i.beginPath(),i.arc(n[0][0],n[0][1],t.size/2,0,2*Math.PI),i.fill();return}i.lineWidth=t.size,i.lineCap="round",i.lineJoin="round",i.beginPath(),i.moveTo(n[0][0],n[0][1]);for(let r=1;r<n.length-2;r++){const o=(n[r][0]+n[r+1][0])/2,h=(n[r][1]+n[r+1][1])/2;i.quadraticCurveTo(n[r][0],n[r][1],o,h)}const a=n.length-1;i.quadraticCurveTo(n[a-1][0],n[a-1][1],n[a][0],n[a][1]),i.stroke()}getArrowHeadLength(t){return Math.sqrt(t.size)+t.size*2.5}drawArrowHead(t,i,n){const{points:a}=i;if(a.length<2)return;const r=a.length-1;let o=r;for(;o>0&&!(Mi(a[r],a[o])>i.size*.5);o--);const h=Math.atan2(a[r][0]-a[o][0],a[r][1]-a[o][1])+Math.PI,u=h+Math.PI/4,c=h-Math.PI/4,s=[n*Math.sin(u),n*Math.cos(u)],l=[n*Math.sin(c),n*Math.cos(c)];t.strokeStyle=i.color,t.lineWidth=i.size,t.lineCap="round",t.lineJoin="round",t.beginPath(),t.moveTo(a[r][0],a[r][1]),t.lineTo(a[r][0]+s[0],a[r][1]+s[1]),t.moveTo(a[r][0],a[r][1]),t.lineTo(a[r][0]+l[0],a[r][1]+l[1]),t.stroke()}async animateArrowBrush(t){const{points:i}=t;if(i.length<2)return;const n=this.targetCtx,a=this.getArrowHeadLength(t),r=xe();Te(.1,a,120,o=>this.drawArrowHead(n,t,o),{onEnd:()=>r.resolve()}),await r}};bt.defaultBlurAmount=10;let Ne=bt;function $t(){const{editorState:e}=X(),t=me(()=>e.canvasSize.map(i=>i*e.pixelRatio));return i=>{const n=e.finalTransform,[a,r]=t();i=i.map(h=>h*e.pixelRatio),i=[(i[0]-n.translation[0]-a/2)/n.scale,(i[1]-n.translation[1]-r/2)/n.scale];const o=[Math.sin(n.rotation),Math.cos(n.rotation)];return i=[i[0]*o[1]+i[1]*o[0],i[1]*o[1]-i[0]*o[0]],i}}function Zt(e=!0){const{editorState:t}=X(),i=me(()=>t.canvasSize.map(n=>n*t.pixelRatio));return n=>{const[a,r]=i(),o=t.finalTransform,h=[Math.sin(-o.rotation),Math.cos(-o.rotation)];return n=[n[0]*h[1]+n[1]*h[0],n[1]*h[1]-n[0]*h[0]],n=[(n[0]*o.scale+a/2+o.translation[0])/(e?1:t.pixelRatio),(n[1]*o.scale+r/2+o.translation[1])/(e?1:t.pixelRatio)],n}}const En=I("<canvas class=media-editor__brush-canvas>"),ai=I("<canvas>");function An(e,t){const{mediaState:i}=X();t&&Nt(e,t,{flip:i.flip,rotation:0,scale:1,translation:[0,0],imageSize:[t.media.width,t.media.height],...Object.fromEntries(ht.map(({key:n,to100:a})=>{const r=i.adjustments[n];return[n,r/(a?100:50)]}))})}function zn(){const{editorState:e,mediaState:t,actions:i,mediaSrc:n,mediaType:a}=X(),[r,o]=U(),h=$t(),u=Zt();function c(_){const g=e.finalTransform;return{..._,size:_.size*g.scale,points:_.points.map(u)}}const s=me(()=>t.brushDrawnLines.map(c)),[l,d]=U(),f=(()=>{const _=En();return j(g=>{const T=e.currentTab==="brush",E=e.isAdjusting?0:1,H=e.canvasSize?.[0]*e.pixelRatio,z=e.canvasSize?.[1]*e.pixelRatio;return T!==g._v$&&_.classList.toggle("media-editor__brush-canvas--active",g._v$=T),E!==g._v$2&&((g._v$2=E)!=null?_.style.setProperty("opacity",E):_.style.removeProperty("opacity")),H!==g._v$3&&he(_,"width",g._v$3=H),z!==g._v$4&&he(_,"height",g._v$4=z),g},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),_})(),p=f.getContext("2d");e.brushCanvas=f;const m=()=>Math.min(e.canvasSize?.[0]/e.mediaSize?.[0],e.canvasSize?.[1]/e.mediaSize?.[1])*2*e.pixelRatio,C=(()=>{const _=ai();return j(g=>{const T=e.mediaSize?.[0],E=e.mediaSize?.[1];return T!==g._v$5&&he(_,"width",g._v$5=T),E!==g._v$6&&he(_,"height",g._v$6=E),g},{_v$5:void 0,_v$6:void 0}),_})(),y=C.getContext("webgl",{preserveDrawingBuffer:!0}),w=(()=>{const _=ai();return j(g=>{const T=e.mediaSize?.[0]*m(),E=e.mediaSize?.[1]*m();return T!==g._v$7&&he(_,"width",g._v$7=T),E!==g._v$8&&he(_,"height",g._v$8=E),g},{_v$7:void 0,_v$8:void 0}),_})();let v=new Ne({imageCanvas:e.imageCanvas,targetCanvas:f}),x;ve(async()=>{if(a!=="image")return;const _=ft().get();o(await Yt({gl:y,mediaSrc:n,mediaType:a,videoTime:0,middleware:_}))}),te(()=>{Wt(y)}),D(()=>{const _=r();An(y,_)}),D(we(r,()=>{r()&&setTimeout(()=>b(),100)})),D(we(()=>e.canvasSize,()=>{v=new Ne({imageCanvas:e.imageCanvas,targetCanvas:f}),k()}));function $(){d({color:e.currentBrush.color,brush:e.currentBrush.brush,size:e.currentBrush.size*e.pixelRatio/e.finalTransform.scale,points:[]})}D(()=>{$()}),D(()=>{if(e.isMoving){const _=e.finalTransform;p.clearRect(0,0,f.width,f.height),p.save(),p.translate(_.translation[0]+f.width/2,_.translation[1]+f.height/2),p.rotate(_.rotation),p.scale(_.scale,_.scale);const[g,T]=e.mediaSize;p.drawImage(w,-(g/2),-(T/2),g,T),p.restore()}else k(),b()});function k(){v.clear(),v.saveLastLine(),s().forEach(_=>v.drawLine(_))}function M(_){return{..._,size:_.size*m(),points:_.points.map(g=>[(g[0]+e.mediaSize?.[0]/2)*m(),(g[1]+e.mediaSize?.[1]/2)*m()])}}function b(){x&&(x.clear(),x.saveLastLine(),t.brushDrawnLines.forEach(_=>x.drawLine(M(_))))}return D(we(()=>e.mediaSize,()=>{e.mediaSize?.[0]&&(x=new Ne({imageCanvas:C,targetCanvas:w,blurAmount:Ne.defaultBlurAmount*m()}),k(),b())})),D(()=>{e.isAdjusting&&te(()=>{k(),b()})}),i.redrawBrushes=()=>{k(),b()},te(()=>{i.redrawBrushes=()=>{}}),ve(()=>{let _,g=[],T=0;function E(){t.brushDrawnLines.push(l()),i.pushToHistory({path:["brushDrawnLines",t.brushDrawnLines.length-1],newValue:l(),oldValue:mt.RemoveArrayItem}),x.updateBlurredImage(),x.drawLine(M(l())),$(),v.saveLastLine(),g=[],_=void 0}function H(K,Z){const L=f.getBoundingClientRect();_=[K-L.left,Z-L.top],g=[h(_)],d(R=>({...R,points:g})),v.updateBlurredImage(),v.previewLine(c(l())),e.selectedResizableLayer=void 0}function z(){g.length===1&&E()}f.addEventListener("mousedown",K=>{H(K.clientX,K.clientY)}),f.addEventListener("touchstart",K=>{H(K.touches[0].clientX,K.touches[0].clientY)}),f.addEventListener("mouseup",()=>{z()}),f.addEventListener("touchend",()=>{z()});const q=new rt({element:f,cursor:"",onSwipe:(K,Z,L)=>{const P=h([_[0]+K,_[1]+Z]);if(g.length>0){const R=g[g.length-1];T+=Mi(u(R),u(P))}T<Math.min(l().size,12)*e.pixelRatio&&g.length>1?g[g.length-1]=P:(g.push(P),T=0),d(R=>({...R,points:g})),v.previewLine(c(l()))},onReset(){(async()=>(T=0,l().brush==="arrow"&&await v.animateArrowBrush(c(l())),E()))()}});te(()=>{q.removeListeners()})}),f}function Ke(){const{editorState:e}=X();return()=>{const{canvasSize:t}=e;if(!t)return{left:0,top:0,width:0,height:0};const i=t[0],n=t[1];return{left:60,top:60,width:i-120,height:n-180}}}function Ri({scale:e,translation:t,rotation:i,extendCrop:n=[[0,0],[0,0]]}){const{editorState:a,mediaState:r}=X(),o=Ke(),[h,u]=a.mediaSize,[c,s]=_e(h/u,o().width,o().height),l=[-c/2,s/2],d=[[l[0],l[1]],[l[0]+c,l[1]],[l[0]+c,l[1]-s],[l[0],l[1]-s]].map(v=>{const x=[Math.sin(i),Math.cos(i)];v=[v[0]*x[1]-v[1]*x[0],v[1]*x[1]+v[0]*x[0]].map(k=>k*e),v=[v[0]+t[0],v[1]+t[1]];const $=[Math.sin(-i),Math.cos(-i)];return v=[v[0]*$[1]-v[1]*$[0],v[1]*$[1]+v[0]*$[0]],v}),[f,p]=_e(r.currentImageRatio,o().width,o().height),m=[-f/2,p/2],C=[[m[0]+n[0][0],m[1]+n[0][1]],[m[0]+f+n[1][0],m[1]+n[0][1]],[m[0]+f+n[1][0],m[1]-p+n[1][1]],[m[0]+n[0][0],m[1]-p+n[1][1]]].map(v=>{const x=[Math.sin(-i),Math.cos(-i)];return[v[0]*x[1]-v[1]*x[0],v[1]*x[1]+v[0]*x[0]]}),y=C.map(v=>v[0]),w=C.map(v=>v[1]);return{cropMinX:Math.min(...y),cropMaxX:Math.max(...y),cropMinY:Math.min(...w),cropMaxY:Math.max(...w),imageMinX:d[0][0],imageMaxX:d[2][0],imageMinY:d[2][1],imageMaxY:d[0][1]}}const _t=I("<div>"),Fn=I('<div><div class=media-editor__crop-handles-backdrop></div><div class=media-editor__crop-handles><div class=media-editor__crop-handles-line-h></div><div class=media-editor__crop-handles-line-h></div><div class=media-editor__crop-handles-line-v></div><div class=media-editor__crop-handles-line-v></div><div class="media-editor__crop-handles-side media-editor__crop-handles-side--w"></div><div class="media-editor__crop-handles-side media-editor__crop-handles-side--n"></div><div class="media-editor__crop-handles-side media-editor__crop-handles-side--e"></div><div class="media-editor__crop-handles-side media-editor__crop-handles-side--s"></div><div class="media-editor__crop-handles-circle media-editor__crop-handles-circle--nw"></div><div class="media-editor__crop-handles-circle media-editor__crop-handles-circle--ne"></div><div class="media-editor__crop-handles-circle media-editor__crop-handles-circle--sw"></div><div class="media-editor__crop-handles-circle media-editor__crop-handles-circle--se">'),wt=20;function Hn(){const{editorState:e,mediaState:t}=X(),i=()=>e.currentTab==="crop",n=Ke(),[a,r]=U([0,0]),[o,h]=U([0,0]),[u,c]=U([0,0]),[s,l]=U([0,0]),d=Ge(Ri),f=()=>{const[L,P]=_e(t.currentImageRatio,n().width,n().height);return{leftTop:[n().left+(n().width-L)/2,n().top+(n().height-P)/2],size:[L,P]}};D(we(n,()=>{const{leftTop:L,size:P}=f();r(L),c(P)}));let p;function m(){const L=s(),P=o(),R=a(),F=u(),G=[0,0],se=[0,0],{leftTop:A,size:le}=f();p?.(),p=Te(0,1,200,J=>{pe(()=>{l(je(L,G,J)),h(je(P,se,J)),r(je(R,A,J)),c(je(F,le,J))})})}D(we(()=>t.currentImageRatio,()=>{m()})),ve(()=>{const L=[{el:b,left:-1,top:-1},{el:_,left:1,top:-1},{el:g,left:-1,top:1},{el:T,left:1,top:1},{el:E,left:-1,top:0},{el:H,left:0,top:-1},{el:z,left:1,top:0},{el:q,left:0,top:1}];let P,R,F,G;const se=L.map(({el:le,left:J,top:de})=>new rt({element:le,setCursorTo:document.body,onStart(){R=t.scale,F=t.translation,e.isMoving=!0,le.classList.add("media-editor__crop-handles-circle--anti-flicker")},onSwipe(ie,ne,Ce){if(G||(G=Ce.target),G!==le)return;const ue=e.fixedImageRatioKey;let V=t.currentImageRatio;J<0&&(V=-V),de<0&&(V=-V);const[ae,Y]=u(),ce=Math.min(ae,n().width/wt*Math.min(wt,R)),ee=Math.min(Y,n().height/wt*Math.min(wt,R));if(ie=Math.max(ie*J,ce-ae)*J,ne=Math.max(ne*de,ee-Y)*de,ue)if(de===0)ne=ie/V;else if(J===0)ie=ne*V;else{const Wi=ie;ie=(ie+ne*V)/2,ne=(Wi/V+ne)/2}l(ue&&de===0?[J*ie,ne]:ue&&J===0?[ie,de*ne]:[ie*J,ne*de]),h([ue&&J===0?-ie/2:+(J<0)*ie,ue&&de===0?-ne/2:+(de<0)*ne]);const{cropMinX:Q,cropMaxX:N,cropMinY:ge,cropMaxY:be,imageMinX:$e,imageMaxX:re,imageMinY:Re,imageMaxY:Ve}=d({scale:R,rotation:t.rotation,translation:F,extendCrop:[[ue&&J===0?-ie/2:J===-1?ie:0,ue&&de===0?ne/2:de===1?ne:0],[ue&&J===0?ie/2:J===1?ie:0,ue&&de===0?-ne/2:de===-1?ne:0]]}),Oe=(re-$e)/2,Ee=(Ve-Re)/2,Le=[$e+Oe,Re+Ee];let Ue=1,kt=1;$e>Q&&(Ue*=1+((Le[0]-Q)/Oe-1)/2),re<N&&(Ue*=1+((N-Le[0])/Oe-1)/2),Re>ge&&(kt*=1+((Le[1]-ge)/Ee-1)/2),Ve<be&&(kt*=1+((be-Le[1])/Ee-1)/2);const Jt=Math.max(Ue,kt);Jt>1&&(t.scale=R*Jt);let Pe=[0,0];$e>Q&&(Pe[0]+=$e-Q),re<N&&(Pe[0]+=re-N),Re>ge&&(Pe[1]+=Re-ge),Ve<be&&(Pe[1]+=Ve-be);const vt=[Math.sin(t.rotation),Math.cos(t.rotation)];Pe=[Pe[0]*vt[1]-Pe[1]*vt[0],Pe[1]*vt[1]+Pe[0]*vt[0]],t.translation=[F[0]-Pe[0]/2,F[1]-Pe[1]/2]},onReset(){if(G!==le)return G=void 0;G=void 0;const ie=u()[0]+s()[0],ne=u()[1]+s()[1],Ce=ie/ne,ue=Math.min(n().width/ie,n().height/ne);t.currentImageRatio=Ce,m();const V=t.scale,ae=t.translation,Y=t.scale*ue,ce=[ue*(t.translation[0]+-s()[0]*J*.5),ue*(t.translation[1]+-s()[1]*de*.5)];Te(0,1,200,ee=>{it(t,nt(Q=>{Q.scale=De(V,Y,ee),Q.translation=je(ae,ce,ee)}))},{onEnd:()=>e.isMoving=!1}),le.classList.remove("media-editor__crop-handles-circle--anti-flicker")}})),A=new rt({element:M,onStart(){F=t.translation,e.isMoving=!0},onSwipe(le,J,de){if(G||(G=de.target),G!==M)return;const{cropMinX:ie,cropMaxX:ne,cropMinY:Ce,cropMaxY:ue,imageMinX:V,imageMaxX:ae,imageMinY:Y,imageMaxY:ce}=d({scale:t.scale,rotation:t.rotation,translation:[F[0]+le,F[1]+J]});P=[0,0],V>ie&&(P[0]=V-ie),ae<ne&&(P[0]=ae-ne),Y>Ce&&(P[1]=Y-Ce),ce<ue&&(P[1]=ce-ue);const ee=[Math.sin(t.rotation),Math.cos(t.rotation)];P=[P[0]*ee[1]-P[1]*ee[0],P[1]*ee[1]+P[0]*ee[0]];const Q=4;t.translation=[F[0]+le-(P[0]-P[0]/Q),F[1]+J-(P[1]-P[1]/Q)],P=[P[0]/Q,P[1]/Q]},onReset(){if(G!==M)return G=void 0;G=void 0;const le=t.translation;Te(le,[le[0]-P[0],le[1]-P[1]],120,J=>t.translation=J,{onEnd:()=>e.isMoving=!1})}});te(()=>{se.forEach(le=>le.removeListeners()),A.removeListeners()})});const C=()=>a()[0]+o()[0],y=()=>a()[1]+o()[1],w=()=>u()[0]+s()[0],v=()=>u()[1]+s()[1],x=()=>C()+w(),$=()=>y()+v(),k=()=>{const[L,P]=e.canvasSize;let[R,F]=[L,P];const G=t.currentImageRatio;return R/G>F?R=F*G:F=R/G,[(L-R)/2,(P-F)/2]};let M,b,_,g,T,E,H,z,q;const K=()=>({transition:"opacity 0.2s","transition-timing-function":i()?"ease-in":"ease-out","pointer-events":i()?"none":void 0,opacity:i()?0:1}),Z=()=>({transition:"transform 0.2s, opacity 0.2s","transition-timing-function":i()?"ease-out":"ease-in","pointer-events":i()?void 0:"none",opacity:i()?1:0,transform:i()?void 0:"scale(1.05)"});return[(()=>{const L=_t();return j(P=>Ae(L,{background:"black",position:"absolute",left:"0px",top:"0px",width:"100%",height:k()[1]+"px",...K()},P)),L})(),(()=>{const L=_t();return j(P=>Ae(L,{background:"black",position:"absolute",left:"0px",bottom:"0px",width:"100%",height:k()[1]+"px",...K()},P)),L})(),(()=>{const L=_t();return j(P=>Ae(L,{background:"black",position:"absolute",left:"0px",top:"0px",height:"100%",width:k()[0]+"px",...K()},P)),L})(),(()=>{const L=_t();return j(P=>Ae(L,{background:"black",position:"absolute",right:"0px",top:"0px",height:"100%",width:k()[0]+"px",...K()},P)),L})(),(()=>{const L=Fn(),P=L.firstChild,R=P.nextSibling,F=R.firstChild,G=F.nextSibling,se=G.nextSibling,A=se.nextSibling,le=A.nextSibling,J=le.nextSibling,de=J.nextSibling,ie=de.nextSibling,ne=ie.nextSibling,Ce=ne.nextSibling,ue=Ce.nextSibling,V=ue.nextSibling,ae=M;typeof ae=="function"?O(ae,R):M=R,F.style.setProperty("top","33%"),G.style.setProperty("top","66%"),se.style.setProperty("left","33%"),A.style.setProperty("left","66%");const Y=E;typeof Y=="function"?O(Y,le):E=le;const ce=H;typeof ce=="function"?O(ce,J):H=J;const ee=z;typeof ee=="function"?O(ee,de):z=de;const Q=q;typeof Q=="function"?O(Q,ie):q=ie;const N=b;typeof N=="function"?O(N,ne):b=ne;const ge=_;typeof ge=="function"?O(ge,Ce):_=Ce;const be=g;typeof be=="function"?O(be,ue):g=ue;const $e=T;return typeof $e=="function"?O($e,V):T=V,j(re=>{const Re={position:"absolute",right:"0px",top:"0px",height:"100%",width:"100%",overflow:"hidden",...Z()},Ve={"clip-path":`polygon(
              0 0, 0 100%,
              ${C()}px 100%, ${C()}px ${y()}px, ${x()}px ${y()}px,
              ${x()}px ${$()}px, ${C()}px ${$()}px, ${C()}px 100%,
              100% 100%, 100% 0%
            )`},Oe=C()+"px",Ee=y()+"px",Le=w()+"px",Ue=v()+"px";return re._v$=Ae(L,Re,re._v$),re._v$2=Ae(P,Ve,re._v$2),Oe!==re._v$3&&((re._v$3=Oe)!=null?R.style.setProperty("left",Oe):R.style.removeProperty("left")),Ee!==re._v$4&&((re._v$4=Ee)!=null?R.style.setProperty("top",Ee):R.style.removeProperty("top")),Le!==re._v$5&&((re._v$5=Le)!=null?R.style.setProperty("width",Le):R.style.removeProperty("width")),Ue!==re._v$6&&((re._v$6=Ue)!=null?R.style.setProperty("height",Ue):R.style.removeProperty("height")),re},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0}),L})()]}function Vn({gl:e,drawAdjustedImage:t}){const{editorState:i,mediaState:n,actions:a}=X(),{renderingPayload:r}=i,o=r.media.video;if(!o)return;let h=!1;a.setVideoTime=(c,s=ze.Redraw|ze.UpdateVideo|ze.UpdateCursor)=>{s&ze.UpdateCursor&&(n.currentVideoTime=c),s&ze.UpdateVideo&&(o.currentTime=c*o.duration),s&ze.Redraw&&(h=!0)};const u=()=>{h&&(h=!1,e.bindTexture(e.TEXTURE_2D,r.texture),e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,o),t())};o.addEventListener("seeked",u),te(()=>{o.removeEventListener("seeked",u)}),D(()=>{if(i.currentTab!=="adjustments")return;const c=s=>{const l=s.target;s.code==="Space"&&!l.isContentEditable&&(s.preventDefault(),i.isPlaying=!i.isPlaying)};document.addEventListener("keydown",c),te(()=>{i.isPlaying=!1,document.removeEventListener("keydown",c)})}),D(()=>{o.muted=n.videoMuted}),D(()=>{if(!i.isPlaying)return;let c,s=!0,l=0;function d(){e.bindTexture(e.TEXTURE_2D,r.texture),e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,o),t(),c=o.requestVideoFrameCallback(()=>d())}const f=self.setTimeout(()=>{n.currentVideoTime>=n.videoCropStart+n.videoCropLength&&a.setVideoTime(n.videoCropStart),c=o.requestVideoFrameCallback(d),o.play(),_i(()=>(l=(l+1)%3,l?!0:s?(n.currentVideoTime=o.currentTime/o.duration||0,(o.ended||o.paused||n.currentVideoTime>=n.videoCropStart+n.videoCropLength)&&(s=!1,i.isPlaying=!1,n.currentVideoTime=Ie(n.currentVideoTime,n.videoCropStart,n.videoCropStart+n.videoCropLength)),s):!1))},200);te(()=>{s=!1,self.clearTimeout(f),o.cancelVideoFrameCallback(c),o.pause()})})}const On=I("<canvas>");function si(e){const{editorState:t,mediaState:i}=X(),n=t.renderingPayload;n&&Nt(e,n,{...t.finalTransform,imageSize:[n.media.width,n.media.height],...Object.fromEntries(ht.map(({key:a,to100:r})=>{const o=i.adjustments[a];return[a,o/(r?100:50)]}))})}function Dn(){const{editorState:e,mediaState:t,mediaSrc:i,mediaType:n,actions:a}=X(),r=(()=>{const l=On();return j(d=>{const f=e.canvasSize[0]*e.pixelRatio,p=e.canvasSize[1]*e.pixelRatio;return f!==d._v$&&he(l,"width",d._v$=f),p!==d._v$2&&he(l,"height",d._v$2=p),d},{_v$:void 0,_v$2:void 0}),l})(),o=r.getContext("webgl",{preserveDrawingBuffer:!0});e.imageCanvas=r;const h=Ge(()=>si(o)),u=Ge(()=>Vn({gl:o,drawAdjustedImage:h})),c=ft().get();async function s(){const l=await Yt({gl:o,mediaSrc:i,mediaType:n,videoTime:t.currentVideoTime,middleware:c});pe(()=>{if(e.renderingPayload=l,e.mediaSize=[l.media.width,l.media.height],e.mediaRatio=l.media.width/l.media.height,!t.videoQuality){const d=Xt(l.media.height);a.updateMediaStateClone(f=>{f.videoQuality=d}),t.videoQuality=d}if(!t.currentImageRatio){const d=l.media.width/l.media.height;a.updateMediaStateClone(f=>{f.currentImageRatio=d}),t.currentImageRatio=d}}),u()}return ve(()=>{e.isReady?s():Ni(()=>{s()})(()=>e.isReady)}),D(()=>{si(o)}),te(()=>{Wt(o)}),r}const Gn=I("<div class=media-editor__preview-brush-size>"),Un=()=>{const{editorState:e}=X();return S(Me,{get when(){return e.previewBrushSize},get children(){const t=Gn();return j(i=>{const n=["blur","eraser"].includes(e.currentBrush.brush)?void 0:wi(e.currentBrush.color).join(","),a=e.previewBrushSize+"px",r=e.previewBrushSize+"px";return n!==i._v$&&((i._v$=n)!=null?t.style.setProperty("--color",n):t.style.removeProperty("--color")),a!==i._v$2&&((i._v$2=a)!=null?t.style.setProperty("width",a):t.style.removeProperty("width")),r!==i._v$3&&((i._v$3=r)!=null?t.style.setProperty("height",r):t.style.removeProperty("height")),i},{_v$:void 0,_v$2:void 0,_v$3:void 0}),t}})};function jn(e){const[t,i]=U(!1),n=()=>{i(window.matchMedia(e).matches)},a=window.matchMedia(e);return i(a.matches),a.addEventListener("change",n),te(()=>{a.removeEventListener("change",n)}),t}function Qt(){return jn("(max-width: 800px")}const Wn=I("<div class=media-editor__sticker-layer-content>");function Xn(e){const{editorState:t,canImageResultInGIF:i}=X();let n;ve(()=>{const r=ft();Yi({div:n,doc:e.layer.sticker,group:"none",width:500,height:500,play:i,loop:i,withThumb:!1,middleware:r.get()}),t.stickersLayersInfo[e.layer.id]={container:n},te(()=>{r.destroy()})});const a=(()=>{const r=Wn(),o=n;return typeof o=="function"?O(o,r):n=r,r})();return S(Ei,{get layer(){return e.layer},children:a})}const li=I("<div>"),Nn=I("<div class=media-editor__text-layer><div class=media-editor__text-layer-layout contenteditable>");function Yn(e){const{editorState:t,mediaState:i,actions:n}=X();if(!e.layer.textInfo)return;const a=()=>{pe(()=>{t.selectedResizableLayer=e.layer.id,t.currentTextLayerInfo={...e.layer.textInfo}})},r=()=>ct[e.layer.textInfo.font];function o(){const m=i.resizableLayers,C=m.findIndex(w=>w.id===e.layer.id);if(C<0)return;const y=m.splice(C,1)[0];y.textRenderingInfo=void 0,n.pushToHistory({path:["resizableLayers",C],newValue:mt.RemoveArrayItem,oldValue:y,findBy:{id:y.id}})}function h(){if(l.childNodes.forEach(w=>{if(w instanceof HTMLDivElement&&!w.hasAttributes())w.querySelectorAll("*").forEach(v=>{const x=document.createTextNode(v.textContent);v.replaceWith(x)});else{const v=document.createElement("div");v.textContent=w.textContent,w.replaceWith(v)}}),!l.textContent){l.innerHTML="<div></div>";const w=l.children[0],v=document.createRange(),x=window.getSelection();v.setStart(w,0),v.collapse(!0),x.removeAllRanges(),x.addRange(v)}const m=window.getSelection();if(m.rangeCount>0){const w=m.getRangeAt(0);if(w.startContainer===l&&w.startOffset===0){const v=l.children[0],x=document.createRange();x.selectNodeContents(v),x.collapse(!1),m.removeAllRanges(),m.addRange(x)}}s.querySelector(".media-editor__text-layer-background")?.remove();const C=Zn(l,e.layer.textInfo.alignment),y=Qn(C);e.layer.textInfo.style==="background"&&Kn(s,y.join(" "),e.layer.textInfo),e.layer.textInfo.style==="outline"&&qn(s,l,e.layer.textInfo),e.layer.textRenderingInfo={width:s.clientWidth,height:s.clientHeight,path:y,lines:C}}function u(){const m=document.createRange();m.selectNodeContents(l.children[0]);const C=window.getSelection();C.removeAllRanges(),C.addRange(m)}D(()=>{h()});const c=me(()=>e.layer.id===t.selectedResizableLayer);ve(()=>{c()&&u()}),D(()=>{c()&&te(()=>{l.innerText.trim()||o()})}),D(we(()=>({...t.currentTextLayerInfo}),()=>{t.selectedResizableLayer===e.layer.id&&(e.layer.textInfo={...t.currentTextLayerInfo})})),ve(()=>{s.addEventListener("dragstart",m=>{m.preventDefault()})});let s,l;const d=()=>e.layer.textInfo.style==="normal"?e.layer.textInfo.color:At(e.layer.textInfo.color),f=(()=>{const m=e.layer.textRenderingInfo;return m?m.lines.map(C=>(()=>{const y=li();return B(y,()=>C.content),y})()):(()=>{const C=li();return B(C,()=>oe("MediaEditor.TypeSomething")),C})()})(),p=(()=>{const m=Nn(),C=m.firstChild,y=s;typeof y=="function"?O(y,m):s=m,C.addEventListener("focus",a),C.$$input=()=>h();const w=l;return typeof w=="function"?O(w,C):l=C,B(C,f),j(v=>{const x=e.layer.textInfo.style==="background",$=d(),k=e.layer.textInfo.size+"px",M=r().fontFamily,b=r().fontWeight,_=Jn[e.layer.textInfo.alignment];return x!==v._v$&&m.classList.toggle("media-editor__text-layer--with-bg",v._v$=x),$!==v._v$2&&((v._v$2=$)!=null?m.style.setProperty("color",$):m.style.removeProperty("color")),k!==v._v$3&&((v._v$3=k)!=null?m.style.setProperty("font-size",k):m.style.removeProperty("font-size")),M!==v._v$4&&((v._v$4=M)!=null?m.style.setProperty("font-family",M):m.style.removeProperty("font-family")),b!==v._v$5&&((v._v$5=b)!=null?m.style.setProperty("font-weight",b):m.style.removeProperty("font-weight")),_!==v._v$6&&((v._v$6=_)!=null?m.style.setProperty("--align-items",_):m.style.removeProperty("--align-items")),v},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0}),m})();return S(Ei,{get layer(){return e.layer},children:p})}function Zn(e,t){return Array.from(e.children).map(i=>{const n=i;let a=0;return t==="left"?a=0:t==="center"?a=(e.clientWidth-n.clientWidth)/2:a=e.clientWidth-n.clientWidth,{left:a,right:a+n.clientWidth,content:n.innerText,height:n.clientHeight}})}function Qn(e){const t=e[0],i=t.height*.3,n=(u,c=1)=>[u,u,0,0,c],a=[];a.push("M",t.left,i),a.push("A",...n(i),t.left+i,0),a.push("L",t.right-i,0),a.push("A",...n(i),t.right,i);let r=t,o=t.height;for(let u=1;u<e.length;u++){const c=e[u],s=c.right>r.right?1:-1,l=Math.min(Math.abs((c.right-r.right)/2),i)*s,d=Math.abs(l);a.push("L",r.right,o-d),a.push("A",...n(d,s===1?0:1),r.right+l,o),a.push("L",c.right-l,o),a.push("A",...n(d,s===1?1:0),c.right,o+d),o+=c.height,r=c}a.push("L",r.right,o-i),a.push("A",...n(i),r.right-i,o),a.push("L",r.left+i,o),a.push("A",...n(i),r.left,o-i);const h=e[e.length-1];o-=h.height;for(let u=e.length-2;u>=0;u--){const c=e[u],s=c.left>r.left?1:-1,l=Math.min(Math.abs((c.left-r.left)/2),i)*s,d=Math.abs(l);a.push("L",r.left,o+d),a.push("A",...n(d,s!==1?0:1),r.left+l,o),a.push("L",c.left-l,o),a.push("A",...n(d,s!==1?1:0),c.left,o-d),o-=c.height,r=c}return a}function Kn(e,t,i){const n=Ci(`
    <svg width="${e.clientWidth}" height="${e.clientHeight}" viewBox="0 0 ${e.clientWidth} ${e.clientHeight}">
      <path d="${t}" fill="${i.color}" />
    </svg>
  `);return n.classList.add("media-editor__text-layer-background"),e.prepend(n),t}function qn(e,t,i){const n=ct[i.font];function a(o){o.querySelector(".media-editor__text-layer-svg-outline")?.remove();const h=i.size*.5,u=o.clientWidth+h,c=o.clientHeight+h,s=Ci(`
      <div class="media-editor__text-layer-svg-outline" style="width: ${u}px; height: ${c}px;">
        <svg style="width: ${u}px; height: ${c}px;" viewBox="${-h/2} 0 ${o.clientWidth+h/2} ${o.clientHeight+h}">
          <text
            x="${i.size*.2}"
            y="${i.size*1.33*n.baseline}"
            style="font-size:${i.size}px;stroke:${i.color};stroke-width:${o.clientHeight*.15}px;font-family:${n.fontFamily};font-weight:${n.fontWeight};">
            ${o.innerText}
          </text>
        </svg>
      </div>
    `);o.prepend(s)}const r=document.createElement("div");r.classList.add("media-editor__text-layer-background","media-editor__text-layer-background--as-layout"),r.innerHTML=t.innerHTML,e.prepend(r),Array.from(r.children).forEach(o=>{o instanceof HTMLDivElement&&a(o)})}const Jn={left:"start",center:"center",right:"end"};He(["input"]);const er=I("<div class=media-editor__resizable-layers><div class=media-editor__resizable-layers-inner>"),tr=I("<div class=media-editor__resizable-container>"),ir=I('<div class=media-editor__resizable-container-handles><div class="media-editor__resizable-container-border media-editor__resizable-container-border--vertical"></div><div class="media-editor__resizable-container-border media-editor__resizable-container-border--vertical"></div><div class="media-editor__resizable-container-border media-editor__resizable-container-border--horizontal"></div><div class="media-editor__resizable-container-border media-editor__resizable-container-border--horizontal"></div><div class=media-editor__resizable-container-circle></div><div class=media-editor__resizable-container-circle></div><div class=media-editor__resizable-container-circle></div><div class=media-editor__resizable-container-circle>');function nr(){const e=X(),{editorState:t,mediaState:i,actions:n}=e,a=()=>t.currentTab==="text",r=()=>["stickers","text","adjustments"].includes(t.currentTab);function o(){const s=i.resizableLayers,l=s.findIndex(f=>f.id===t.selectedResizableLayer);if(l<0)return;const d=s.splice(l,1)[0];d&&s.push(d)}D(we(()=>t.selectedResizableLayer,()=>{o()})),D(()=>{t.currentTab,te(()=>{t.selectedResizableLayer=void 0})});let h;const u=$t();function c(s){if(s.target!==h)return;if(t.selectedResizableLayer){t.selectedResizableLayer=void 0;return}if(!a())return;const l=h.getBoundingClientRect(),d=t.finalTransform,f={id:e.resizableLayersSeed++,position:u([s.clientX-l.left,s.clientY-l.top]),rotation:-d.rotation,scale:1/d.scale,type:"text",textInfo:{...t.currentTextLayerInfo}};pe(()=>{i.resizableLayers.push(f),t.selectedResizableLayer=f.id,n.pushToHistory({path:["resizableLayers",i.resizableLayers.length-1],newValue:f,oldValue:mt.RemoveArrayItem,findBy:{id:f.id}})})}return(()=>{const s=er(),l=s.firstChild;yi(l,"click",Ge(c),!0);const d=h;return typeof d=="function"?O(d,l):h=l,B(l,S(We,{get each(){return i.resizableLayers},children:f=>[S(Me,{get when(){return f.type==="text"},get children(){return S(Yn,{layer:f})}}),S(Me,{get when(){return f.type==="sticker"},get children(){return S(Xn,{layer:f})}})]})),j(f=>{const p=!!r(),m=!t.selectedResizableLayer&&a()?"text":void 0,C=t.isAdjusting?0:1;return p!==f._v$&&s.classList.toggle("media-editor__resizable-layers--active",f._v$=p),m!==f._v$2&&((f._v$2=m)!=null?s.style.setProperty("cursor",m):s.style.removeProperty("cursor")),C!==f._v$3&&((f._v$3=C)!=null?l.style.setProperty("opacity",C):l.style.removeProperty("opacity")),f},{_v$:void 0,_v$2:void 0,_v$3:void 0}),s})()}function Ei(e){const{editorState:t,mediaState:i}=X(),n=Qt(),a=Zt(!1),r=()=>{},o=Zi({diff:[0,0],containerWidth:0,containerHeight:0,leftTopEl:r(),rightTopEl:r(),leftBottomEl:r(),rightBottomEl:r()}),h=()=>n()?"-6px":"-4px",u=()=>t.resizeHandlesContainer&&e.layer.id===t.selectedResizableLayer,c=me(()=>({position:a(e.layer.position),rotation:e.layer.rotation+i.rotation,scale:t.finalTransform.scale*e.layer.scale}));let s;return ve(()=>{rr({container:s,leftBottomEl:()=>o.leftBottomEl,leftTopEl:()=>o.leftTopEl,rightBottomEl:()=>o.rightBottomEl,rightTopEl:()=>o.rightTopEl,layer:e.layer,diff:o.diff,processedLayer:c}),or({container:s,layer:e.layer});const l=Qi(s,()=>{o.containerWidth=s.clientWidth,o.containerHeight=s.clientHeight});te(()=>{l()})}),(()=>{const l=tr(),d=s;return typeof d=="function"?O(d,l):s=l,l.$$click=()=>{t.selectedResizableLayer=e.layer.id},B(l,()=>e.children,null),B(l,(()=>{const f=fe(()=>!!u());return()=>f()&&S(Ki,{get mount(){return t.resizeHandlesContainer},get children(){const p=ir(),m=p.firstChild,C=m.nextSibling,y=C.nextSibling,w=y.nextSibling,v=w.nextSibling,x=v.nextSibling,$=x.nextSibling,k=$.nextSibling;return m.style.setProperty("left","0"),C.style.setProperty("right","0"),y.style.setProperty("top","0"),w.style.setProperty("bottom","0"),O(M=>o.leftTopEl=M,v),O(M=>o.rightTopEl=M,x),O(M=>o.leftBottomEl=M,$),O(M=>o.rightBottomEl=M,k),j(M=>{const b=c().position[0]+o.diff[0]+"px",_=c().position[1]+o.diff[1]+"px",g=o.containerWidth*c().scale+"px",T=o.containerHeight*c().scale+"px",E=c().rotation/Math.PI*180+"deg",H=h(),z=h(),q=h(),K=h(),Z=h(),L=h(),P=h(),R=h();return b!==M._v$8&&((M._v$8=b)!=null?p.style.setProperty("left",b):p.style.removeProperty("left")),_!==M._v$9&&((M._v$9=_)!=null?p.style.setProperty("top",_):p.style.removeProperty("top")),g!==M._v$10&&((M._v$10=g)!=null?p.style.setProperty("width",g):p.style.removeProperty("width")),T!==M._v$11&&((M._v$11=T)!=null?p.style.setProperty("height",T):p.style.removeProperty("height")),E!==M._v$12&&((M._v$12=E)!=null?p.style.setProperty("--rotation",E):p.style.removeProperty("--rotation")),H!==M._v$13&&((M._v$13=H)!=null?v.style.setProperty("left",H):v.style.removeProperty("left")),z!==M._v$14&&((M._v$14=z)!=null?v.style.setProperty("top",z):v.style.removeProperty("top")),q!==M._v$15&&((M._v$15=q)!=null?x.style.setProperty("right",q):x.style.removeProperty("right")),K!==M._v$16&&((M._v$16=K)!=null?x.style.setProperty("top",K):x.style.removeProperty("top")),Z!==M._v$17&&((M._v$17=Z)!=null?$.style.setProperty("left",Z):$.style.removeProperty("left")),L!==M._v$18&&((M._v$18=L)!=null?$.style.setProperty("bottom",L):$.style.removeProperty("bottom")),P!==M._v$19&&((M._v$19=P)!=null?k.style.setProperty("right",P):k.style.removeProperty("right")),R!==M._v$20&&((M._v$20=R)!=null?k.style.setProperty("bottom",R):k.style.removeProperty("bottom")),M},{_v$8:void 0,_v$9:void 0,_v$10:void 0,_v$11:void 0,_v$12:void 0,_v$13:void 0,_v$14:void 0,_v$15:void 0,_v$16:void 0,_v$17:void 0,_v$18:void 0,_v$19:void 0,_v$20:void 0}),p}})})(),null),j(f=>{const p=c().position[0]+o.diff[0]+"px",m=c().position[1]+o.diff[1]+"px",C=c().rotation/Math.PI*180+"deg",y=c().scale;return p!==f._v$4&&((f._v$4=p)!=null?l.style.setProperty("left",p):l.style.removeProperty("left")),m!==f._v$5&&((f._v$5=m)!=null?l.style.setProperty("top",m):l.style.removeProperty("top")),C!==f._v$6&&((f._v$6=C)!=null?l.style.setProperty("--rotation",C):l.style.removeProperty("--rotation")),y!==f._v$7&&((f._v$7=y)!=null?l.style.setProperty("--scale",y):l.style.removeProperty("--scale")),f},{_v$4:void 0,_v$5:void 0,_v$6:void 0,_v$7:void 0}),l})()}function rr({container:e,leftTopEl:t,rightTopEl:i,leftBottomEl:n,rightBottomEl:a,diff:r,layer:o,processedLayer:h}){const{editorState:u,mediaState:c}=X(),s=$t();let l,d=!1;const f=[{el:t,x:-1,y:-1},{el:i,x:1,y:-1},{el:n,x:-1,y:1},{el:a,x:1,y:1}];f.forEach(({el:m,x:C,y})=>{D(()=>{const w=m();if(!w)return;const v=new rt({element:w,onStart(){w.classList.add("media-editor__resizable-container-circle--anti-flicker")},onSwipe(x,$,k){const M=vn(k);if(l||(l=M.target),l!==w)return;const b=[e.clientWidth/2*C*u.finalTransform.scale,e.clientHeight/2*y*u.finalTransform.scale],_=e.getBoundingClientRect(),g=[_.left+_.width/2-M.clientX,_.top+_.height/2-M.clientY],T=Math.atan2(g[1],g[0])-Math.atan2(b[1],b[0])+Math.PI,E=Math.hypot(g[0],g[1])/Math.hypot(b[0],b[1]);it(o,nt(H=>{H.rotation=T-c.rotation,H.scale=E}))},onReset(){w.classList.remove("media-editor__resizable-container-circle--anti-flicker"),l=void 0}});te(()=>{v.removeListeners()})})});const p=new rt({element:e,onSwipe(m,C,y){l||(l=y.target),!f.find(({el:w})=>w()===l)&&(d||(d=!0,u.selectedResizableLayer=o.id),r.splice(0,2,m,C))},onReset(){o.position=s([h().position[0]+r[0],h().position[1]+r[1]]),r.splice(0,2,0,0),d=!1,l=void 0}});te(()=>{p.removeListeners()})}function or({container:e,layer:t}){const{editorState:i,mediaState:n,actions:a}=X();function r(){const h=n.resizableLayers,u=h.findIndex(c=>c.id===t.id);u<0||pe(()=>{i.selectedResizableLayer=void 0;const c=h.splice(u,1)[0];a.pushToHistory({path:["resizableLayers",u],newValue:mt.RemoveArrayItem,oldValue:c,findBy:{id:c.id}})})}const o=gn({buttons:[{icon:"delete",className:"danger",text:"Delete",onClick:r}],listenTo:e,onElementReady:h=>{h.classList.add("night")}});te(()=>{o.destroy()})}He(["click"]);function Ai(e){const{editorState:t,mediaState:i}=X();if(!t.mediaSize)return;const n=Ke(),[a,r]=t.mediaSize,o=Math.round(e/Math.PI*2),h=Math.abs(o)&1,u=o*Math.PI/2;let c;if(t.fixedImageRatioKey?.includes("x")){const $=t.fixedImageRatioKey.split("x");c=parseInt($[0])/parseInt($[1])}else c=h?r/a:a/r;const s=a/r,[l,d]=_e(s,n().width,n().height),[f,p]=_e(c,n().width,n().height),m=i.scale,C=i.translation,y=i.rotation,w=h?Math.max(f/d,p/l):Math.max(f/l,p/d),v=[0,0],x=u;i.currentImageRatio=c,t.isMoving=!0,Te(0,1,200,$=>{it(i,nt(k=>{k.scale=De(m,w,$),k.translation=je(C,v,$),k.rotation=De(y,x,$)}))},{onEnd:()=>{t.isMoving=!1,i.rotation=i.rotation%(Math.PI*2)}})}const ar=I("<div class=media-editor__rotation-wheel><div class=media-editor__rotation-wheel-swiper-wrapper><div class=media-editor__rotation-wheel-swiper><div class=media-editor__rotation-wheel-labels></div><div class=media-editor__rotation-wheel-dots></div></div></div><div class=media-editor__rotation-wheel-value><div class=media-editor__rotation-wheel-value-number>"),sr=I("<div class=media-editor__rotation-wheel-label><div class=media-editor__rotation-wheel-label-number>"),lr=I("<div class=media-editor__rotation-wheel-dot>"),dr=I('<svg class=media-editor__rotation-wheel-arrow width=6 height=4 viewBox="0 0 6 4"fill=none xmlns=http://www.w3.org/2000/svg><path d="M2.29289 0.707106L0.28033 2.71967C-0.192143 3.19214 0.142482 4 0.81066 4H5.18934C5.85752 4 6.19214 3.19214 5.71967 2.71967L3.70711 0.707107C3.31658 0.316583 2.68342 0.316582 2.29289 0.707106Z"fill=white>'),yt=42,xt=15,cr=90,Pt=cr/xt*yt,ur=40;function di(e){return e/yt*xt*Math.PI/180}function fr(){const{editorState:e,mediaState:t,actions:i}=X(),n=()=>e.currentTab==="crop",[a,r]=U(0),[o,h]=U(0);let u;ve(()=>{const y=Math.round(t.rotation/Math.PI*2)*Math.PI/2;r((y-t.rotation)*180/Math.PI/xt*yt),c=di(a());let w,v,x=_(),$=!1,k=!1,M,b;function _(){return Math.abs(a()+w||0)<ur}function g(H){h(H),l()}function T(){b=window.setTimeout(()=>{k=!1,$=!0;const H=o();M?.(),M=Te(0,1,200,z=>{g(De(H,w,z))},{onEnd:()=>{$=!1}})},750)}const E=new rt({element:u,onStart(){s=t.scale,w=o(),v=w,$=!1,k=!1,x=_(),e.isMoving=!0},onSwipe(H){v=w=Ie(a()+H,-Pt,Pt)-a();const z=_();z&&(v=-a()),x!==z&&(window.clearTimeout(b),b=window.setTimeout(()=>{if(_()!==z)return;$=!0;const K=o();M?.(),M=Te(0,1,200,Z=>{g(De(K,v,Z))},{onEnd:()=>{$=!1,k=_(),k&&T()}})},200)),x=z,!($||k)&&g(w)},onReset(){let H=a()+o();Math.abs(H)===Pt&&(H=0,c=0,x=!1,$=!1),M?.(),window.clearTimeout(b),pe(()=>{r(H),h(0),e.isMoving=!1,t.rotation=t.rotation%(Math.PI*2)})}});te(()=>{E.removeListeners()})});let c=0,s=0;const l=Ge(()=>{const y=di(a()+o()),w=y-c,v=t.rotation-w,x=[Math.cos(w),Math.sin(w)],$=[t.translation[0]*x[0]+t.translation[1]*x[1],t.translation[1]*x[0]-t.translation[0]*x[1]];if(c=y,!s)return;const{cropMinX:k,cropMaxX:M,cropMinY:b,cropMaxY:_,imageMinX:g,imageMaxX:T,imageMinY:E,imageMaxY:H}=Ri({scale:s,rotation:v,translation:$}),z=(T-g)/2,q=(H-E)/2,K=[g+z,E+q];let Z=1;g>k&&(Z=Math.max((K[0]-k)/z,Z)),T<M&&(Z=Math.max((M-K[0])/z,Z)),E>b&&(Z=Math.max((K[1]-b)/q,Z)),H<_&&(Z=Math.max((_-K[1])/q,Z)),it(t,nt(L=>{L.rotation=v,L.translation=$,Z>1&&(L.scale=s*Z)}))});function d(){c=0,Te([a(),o()],[0,0],200,y=>{pe(()=>{r(y[0]),h(y[1])})})}i.resetRotationWheel=()=>d(),te(()=>{i.resetRotationWheel=()=>{}});let f=!0;D(we(()=>e.fixedImageRatioKey,()=>{if(f){f=!1;return}d()}));function p(){const y=Math.round(t.rotation/Math.PI*2)*Math.PI/2-Math.PI/2;Ai(y),d()}function m(){e.isMoving=!0;const y=Math.abs(Math.round(t.rotation/Math.PI*2))&1,w=x=>x<0?-1:1,v=[w(t.flip[0])*(y?1:-1),w(t.flip[1])*(y?-1:1)];Te(t.flip,v,200,x=>void(t.flip=x),{onEnd:()=>void(e.isMoving=!1)})}const C=()=>(-(a()+o())/yt*xt).toFixed(1).replace(/\.0$/,"").replace(/^-0$/,"0");return(()=>{const y=ar(),w=y.firstChild,v=w.firstChild,x=v.firstChild,$=x.nextSibling,k=w.nextSibling,M=k.firstChild;B(y,S(tt,{get onClick(){return Ge(p)},class:"media-editor__rotation-wheel-button",icon:"rotate"}),w);const b=u;return typeof b=="function"?O(b,v):u=v,B(x,()=>new Array(13).fill(null).map((_,g)=>(()=>{const T=sr(),E=T.firstChild;return B(E,g*15-90),T})())),B($,()=>new Array(97).fill(null).map(()=>lr())),B(M,C),B(y,S(hr,{}),null),B(y,S(tt,{onClick:m,class:"media-editor__rotation-wheel-button",icon:"flip_image_horizontal"}),null),j(_=>{const g=n()?void 0:"none",T={"--moved":a()+o()+"px"};return g!==_._v$&&((_._v$=g)!=null?y.style.setProperty("display",g):y.style.removeProperty("display")),_._v$2=Ae(v,T,_._v$2),_},{_v$:void 0,_v$2:void 0}),y})()}function hr(){return dr()}function mr(){const{editorState:e,mediaState:t}=X(),i=Ke(),n=me(()=>e.currentTab==="crop"),[a,r]=U(0);let o=!0;D(we(n,()=>{if(o){o=!1;return}e.isMoving=!0;const v=Te(a(),n()?1:0,200,r,{onEnd:()=>e.isMoving=!1});te(v)}));const[h,u]=U(),[c,s]=U(),[l,d]=U(),f=me(()=>{const v=e.renderingPayload;if(!v||!e.canvasSize)return;const[x,$]=e.canvasSize,k=v.media.width/v.media.height,M=st(k,i().width,i().height,x,$),b=1/st(t.currentImageRatio,i().width,i().height,x,$),_=Math.min(x/v.media.width,$/v.media.height);return{toCropScale:M,fromCroppedScale:b,snappedImageScale:_}}),p=me(()=>{if(!e.canvasSize||!f())return;const{fromCroppedScale:v}=f();return t.translation.map(x=>x*v-x)}),m=me(()=>{if(!e.canvasSize||!f())return;const[,v]=e.canvasSize,{fromCroppedScale:x}=f();return je(t.translation.map($=>$*x-$),[0,i().left+i().height/2-v/2],a())});let C,y;function w(){if(!f()||!p())return;const{toCropScale:v,fromCroppedScale:x,snappedImageScale:$}=f();C=v*$*x,y=p()}D(we(a,()=>{[0,1].includes(a())&&w()})),D(we(()=>t.currentImageRatio,()=>{w()})),D(we(()=>e.canvasSize,()=>{if(!e.canvasSize||!f())return;const v=e.canvasSize,{toCropScale:x,fromCroppedScale:$,snappedImageScale:k}=f();C=x*k*$,y=p(),te(()=>{pe(()=>{u(v),d(C),s(y)})})})),D(we(h,()=>{if(!h||!l())return;const v=e.canvasSize,{toCropScale:x,fromCroppedScale:$,snappedImageScale:k}=f(),M=x*k*$,b=st(t.currentImageRatio,v[0],v[1],h()[0],h()[1]),_=l()/M,g=b*_;it(t,nt(T=>{T.scale=T.scale*g,T.translation=T.translation.map(E=>E*g)}))})),D(()=>{if(!e.renderingPayload)return;let{fromCroppedScale:x,toCropScale:$,snappedImageScale:k}=f();$*=De(x,1,a()),it(e.finalTransform,nt(M=>{M.flip=t.flip,M.rotation=t.rotation,M.scale=t.scale*e.pixelRatio*k*$,M.translation=[m()[0]+t.translation[0],m()[1]+t.translation[1]].map(b=>b*e.pixelRatio)}))})}const vr="_Container_tlmj1_36",gr="_hidden_tlmj1_58",pr="_changed_tlmj1_62",_r="_InnerContainer_tlmj1_66",wr="_IconButton_tlmj1_74",Cr="_MuteButton_tlmj1_81",yr="_muted_tlmj1_90",xr="_Frames_tlmj1_97",Sr="_FrameFade_tlmj1_103",br="_Cropper_tlmj1_108",$r="_CropperBg_tlmj1_118",Mr="_CropperBgLeft_tlmj1_124",Tr="_CropperBgRight_tlmj1_128",kr="_CropperHorizontalBorder_tlmj1_131",Lr="_dragging_tlmj1_141",Pr="_CropperHandle_tlmj1_144",Br="_CropperHandleLeft_tlmj1_163",Ir="_CropperHandleRight_tlmj1_168",Rr="_TimeStick_tlmj1_174",Er="_PlayButton_tlmj1_184",Ar="_PlayButtonInner_tlmj1_191",zr="_CroppedTime_tlmj1_195",Fr="_visible_tlmj1_206",Hr="_ThumbnailMark_tlmj1_210",Vr="_ghost_tlmj1_219",Or="_withTransition_tlmj1_225",Dr="_ThumbnailTrack_tlmj1_229",Gr="_disabled_tlmj1_238",Ur="_PausePlaySvg_tlmj1_242",jr="_PausePlaySvgPlay_tlmj1_252",Wr="_PausePlaySvgPauseLeft_tlmj1_256",Xr="_PausePlaySvgPauseRight_tlmj1_256",Nr="_paused_tlmj1_259",W={Container:vr,"container-fade-in":"_container-fade-in_tlmj1_1",hidden:gr,changed:pr,InnerContainer:_r,IconButton:wr,MuteButton:Cr,muted:yr,Frames:xr,FrameFade:Sr,Cropper:br,CropperBg:$r,CropperBgLeft:Mr,CropperBgRight:Tr,CropperHorizontalBorder:kr,dragging:Lr,CropperHandle:Pr,CropperHandleLeft:Br,CropperHandleRight:Ir,TimeStick:Rr,PlayButton:Er,PlayButtonInner:Ar,CroppedTime:zr,visible:Fr,ThumbnailMark:Hr,ghost:Vr,withTransition:Or,ThumbnailTrack:Dr,disabled:Gr,PausePlaySvg:Ur,PausePlaySvgPlay:jr,PausePlaySvgPauseLeft:Wr,PausePlaySvgPauseRight:Xr,paused:Nr};function Yr({getCanvas:e,size:t}){const{editorState:i,mediaSrc:n}=X();D(()=>{const a=i.renderingPayload?.media,r=e();if(!a||!r||!t.width||!t.height)return;const o=a.width/a.height,h=r.getContext("2d");let u=xe(),c=!1;te(()=>{c=!0,u?.resolve(),h.clearRect(0,0,r.width,r.height)});const s=ft().get();(async()=>{const l=await Ii(n,{currentTime:0,middleware:s});if(c)return;l.addEventListener("seeked",()=>{u?.resolve()});const[d,f]=_e(o,t.width,t.height);for(let p=0;p<t.width;p+=d){if(u=xe(),l.currentTime=p/t.width*l.duration,await u,c)return;h.drawImage(l,p,0,d,f);const m=document.createElement("div");m.classList.add(W.FrameFade),m.style.top="0px",m.style.left=p+"px",m.style.width=d+.5+"px",m.style.height=f+"px",r.after(m),m.animate({opacity:[1,0]},{duration:500,easing:"ease-in-out"}).finished.then(()=>m.remove())}})()})}const Zr=I("<div><div><button tabindex=-1></button><div><div><canvas></canvas><div></div><div></div><div></div><div></div><div></div></div><div></div></div><button tabindex=-1><span> "),Qr=I("<div>"),Kr=I('<svg width=20 height=25 viewBox="0 0 20 25"fill=none xmlns=http://www.w3.org/2000/svg><path d="M0 10V10.9952C0 14.8798 2.58024 18.2044 5.87746 20.2583C7.46104 21.2448 8.92659 22.4551 9.61717 23.8212C9.70992 24.0047 10.2901 24.0047 10.3828 23.8212C11.0734 22.4551 12.539 21.2448 14.1225 20.2583C17.4198 18.2044 20 14.8798 20 10.9952V10C20 4.47715 15.5228 0 10 0C4.47715 0 0 4.47715 0 10Z"fill=white></path><path fill-rule=evenodd clip-rule=evenodd d="M8.45844 4.4165H8.48341H11.5167H11.5417C12.1739 4.4165 12.6838 4.41649 13.0968 4.45023C13.522 4.48497 13.8954 4.55836 14.2409 4.7344C14.7897 5.01403 15.2359 5.46023 15.5155 6.00903C15.6915 6.35454 15.7649 6.72798 15.7997 7.15314C15.8334 7.56605 15.8334 8.07595 15.8334 8.70813V8.73317V11.7665V11.7915C15.8334 12.4237 15.8334 12.9336 15.7997 13.3465C15.7649 13.7717 15.6915 14.1452 15.5155 14.4907C15.2359 15.0395 14.7897 15.4857 14.2409 15.7653C13.8954 15.9413 13.522 16.0147 13.0968 16.0495C12.6839 16.0832 12.174 16.0832 11.5418 16.0832H11.5167H8.48341H8.45843C7.82626 16.0832 7.3163 16.0832 6.90339 16.0495C6.47822 16.0147 6.10478 15.9413 5.75928 15.7653C5.21047 15.4857 4.76427 15.0395 4.48465 14.4907C4.3086 14.1452 4.23521 13.7717 4.20048 13.3465C4.16674 12.9336 4.16674 12.4237 4.16675 11.7915V11.7665V8.73317V8.7082C4.16674 8.07599 4.16674 7.56607 4.20048 7.15314C4.23521 6.72798 4.3086 6.35454 4.48465 6.00903C4.76427 5.46023 5.21047 5.01403 5.75928 4.7344C6.10478 4.55836 6.47822 4.48497 6.90339 4.45023C7.31631 4.41649 7.82624 4.4165 8.45844 4.4165ZM6.99839 5.61303C6.64537 5.64187 6.44255 5.69563 6.28893 5.77391C5.95965 5.94169 5.69193 6.2094 5.52415 6.53869C5.44588 6.69231 5.39211 6.89513 5.36327 7.24814C5.33387 7.60797 5.33341 8.07015 5.33341 8.73317V11.7665C5.33341 12.4295 5.33387 12.8917 5.36327 13.2516C5.36613 13.2866 5.36925 13.3203 5.37261 13.3525L6.26742 11.8925L6.28131 11.8699C6.46683 11.5672 6.62664 11.3064 6.77319 11.11C6.92275 10.9096 7.11058 10.7022 7.37928 10.5859C7.74882 10.4259 8.16801 10.4259 8.53755 10.5859C8.80625 10.7022 8.99406 10.9096 9.14363 11.11C9.26806 11.2767 9.40199 11.4898 9.55313 11.7356L10.3508 10.4342L10.3647 10.4115C10.5502 10.1088 10.7099 9.84804 10.8565 9.65169C11.0061 9.45131 11.1939 9.24382 11.4626 9.12756C11.8322 8.96764 12.2513 8.96764 12.6209 9.12756C12.8896 9.24382 13.0774 9.45131 13.227 9.65169C13.3736 9.84804 13.5333 10.1088 13.7188 10.4115L13.7327 10.4342L14.6667 11.958L14.6667 11.7665V8.73317C14.6667 8.07015 14.6663 7.60797 14.6369 7.24814C14.6081 6.89513 14.5543 6.69231 14.476 6.53869C14.3082 6.2094 14.0405 5.94169 13.7112 5.77391C13.5576 5.69563 13.3548 5.64187 13.0018 5.61303C12.6419 5.58363 12.1798 5.58317 11.5167 5.58317H8.48341C7.82039 5.58317 7.35821 5.58363 6.99839 5.61303ZM10.2374 12.8518L11.5028 14.9165H11.5167C12.1798 14.9165 12.6419 14.916 13.0018 14.8866C13.3548 14.8578 13.5576 14.804 13.7112 14.7258C14.0405 14.558 14.3082 14.2903 14.476 13.961C14.4835 13.9462 14.4908 13.931 14.4979 13.9152L12.738 11.0439C12.5347 10.7121 12.4027 10.4978 12.292 10.3495C12.2036 10.231 12.1614 10.2013 12.1553 10.1973C12.0827 10.1666 12.0008 10.1666 11.9282 10.1973C11.922 10.2013 11.8799 10.231 11.7915 10.3495C11.6808 10.4978 11.5488 10.7121 11.3455 11.0439L10.2374 12.8518ZM10.1344 14.9165L8.6547 12.5022C8.45134 12.1704 8.31936 11.9561 8.20867 11.8079C8.12021 11.6893 8.07814 11.6596 8.07199 11.6556C7.99939 11.6249 7.91744 11.6249 7.84484 11.6556C7.83869 11.6596 7.79662 11.6893 7.70816 11.8079C7.59747 11.9561 7.46548 12.1704 7.26212 12.5022L6.00854 14.5475C6.09569 14.6153 6.1895 14.6751 6.28893 14.7258C6.44255 14.804 6.64537 14.8578 6.99839 14.8866C7.35821 14.916 7.82039 14.9165 8.48341 14.9165H10.1344Z"fill=#212121>'),qr=I('<svg width=6 height=60 viewBox="0 0 6 60"fill=none xmlns=http://www.w3.org/2000/svg><path d="M4 0.75C4.69036 0.75 5.25 1.30964 5.25 2V3.29297C5.24998 3.812 5.04377 4.30975 4.67676 4.67676C4.40352 4.95 4.25002 5.32061 4.25 5.70703V54.293C4.25002 54.6794 4.40352 55.05 4.67676 55.3232C5.04377 55.6903 5.24998 56.188 5.25 56.707V58C5.25 58.6904 4.69036 59.25 4 59.25H2C1.30964 59.25 0.75 58.6904 0.75 58V56.707C0.75002 56.188 0.956231 55.6903 1.32324 55.3232C1.59648 55.05 1.74998 54.6794 1.75 54.293V5.70703C1.74998 5.32061 1.59648 4.95 1.32324 4.67676C0.956231 4.30975 0.75002 3.812 0.75 3.29297V2C0.75 1.30964 1.30964 0.75 2 0.75H4Z"fill=white stroke=#212121 stroke-width=0.5>'),Jr=I('<svg width=24 height=24 viewBox="0 0 24 24"fill=none xmlns=http://www.w3.org/2000/svg><clipPath id=playSymbolClipPath><path d="M5 19.9138V4.0862C5 2.83455 6.44254 2.13342 7.42673 2.90672L17.4988 10.8205C18.2632 11.4211 18.2632 12.5789 17.4988 13.1795L7.42673 21.0933C6.44254 21.8666 5 21.1655 5 19.9138Z"fill=black></path></clipPath><g id=pauseSymbol clip-path=url(#playSymbolClipPath)><path d="M8.5 3H5C4.44772 3 4 3.44772 4 4V20C4 20.5523 4.44772 21 5 21H8.5C9.05228 21 9.5 20.5523 9.5 20V4C9.5 3.44772 9.05228 3 8.5 3Z"fill=white></path><path d="M19 3H15.5C14.9477 3 14.5 3.44772 14.5 4V20C14.5 20.5523 14.9477 21 15.5 21H19C19.5523 21 20 20.5523 20 20V4C20 3.44772 19.5523 3 19 3Z"fill=white>'),zt=9,eo=2,to=()=>{const{editorState:e,mediaState:t,actions:i}=X(),[n,a]=U(),[r,o]=U(!1),h=pn(n),u=()=>h.width-2*zt,c=()=>r()&&(m==="left"||m==="right"),s=me(()=>{if(!c())return"";const _=e.renderingPayload?.media?.video;if(!_)return"";const g=t.videoCropLength*_.duration;let T=g;const E=(Math.floor(T/3600)+"").padStart(2,"0");T-=+E*3600;const H=(Math.floor(T/60)+"").padStart(2,"0");T-=+H*60;const z=(Math.floor(T)+"").padStart(2,"0");T-=+z;const q=(Math.floor(T*4)*25+"").replace(/0$/,"");return(+E?`${E}:`:"")+`${H}:${z}`+(q&&g<10?`.${q}`:"")}),l=me(()=>{const _=e.renderingPayload?.media?.video?.duration;return _?Math.min(1,.5/_):0});let d,f,p,m;Yr({getCanvas:()=>d,size:h});const C={globalCursor:()=>"ew-resize",onStart:()=>{m="left",f=t.videoCropStart,p=t.videoCropLength,pe(()=>{o(!0),e.isPlaying=!1})},onMove:_=>void pe(()=>{if(m!=="left")return;const g=Ie(f+_/u(),0,Math.max(0,f+p-l()))-f;pe(()=>{t.videoCropStart=f+g,t.videoCropLength=p-g,i.setVideoTime(t.videoCropStart)})}),onEnd:()=>void o(!1)},y={globalCursor:()=>"ew-resize",onStart:()=>{m="right",p=t.videoCropLength,pe(()=>{o(!0),e.isPlaying=!1})},onMove:_=>void pe(()=>{if(m!=="right")return;const g=1-t.videoCropStart;t.videoCropLength=Ie(p+_/u(),Math.min(l(),g),g),i.setVideoTime(t.videoCropStart+t.videoCropLength)}),onEnd:()=>void o(!1)};let w=!1;const v={globalCursor:()=>p===1?"col-resize":"grabbing",onStart:_=>{m="middle",f=t.videoCropStart,p=t.videoCropLength,w=!1,p===1&&(o(!0),w=!0,$(_))},onMove:(_,g,T)=>void pe(()=>{if(m!=="middle")return;if(p===1)return void $(T);if(Math.abs(_)>eo&&(w=!0),!w)return;const E=Ie(f+_/u(),0,Math.max(0,1-Math.max(p,l())))-f;pe(()=>{o(!0),e.isPlaying=!1,t.videoCropStart=f+E,i.setVideoTime(t.videoCropStart)})}),onEnd:()=>{self.setTimeout(()=>{o(!1)},0)}},x={globalCursor:()=>"col-resize",onStart:()=>{m="cursor",o(!0)},onMove:(_,g,T)=>{m==="cursor"&&(e.isPlaying=!1,$(T))},onEnd:()=>void o(!1)},$=_=>{e.isPlaying=!1,i.setVideoTime(Ie(Je(_,n()),t.videoCropStart,t.videoCropStart+t.videoCropLength))},k=_=>{!n()||r()||i.setVideoTime(Ie(Je(_,n()),t.videoCropStart,t.videoCropStart+t.videoCropLength))},M=_=>_n({element:_,mountOn:_.parentElement.parentElement.parentElement,vertical:"top",textElement:oe("MediaEditor.VideoMutedTooltip"),lighter:!0,auto:!0});let b;return(()=>{const _=Zr(),g=_.firstChild,T=g.firstChild,E=T.nextSibling,H=E.firstChild,z=H.firstChild,q=z.nextSibling,K=q.nextSibling,Z=K.nextSibling,L=Z.nextSibling,P=L.nextSibling,R=H.nextSibling,F=E.nextSibling,G=F.firstChild;G.firstChild,T.$$click=A=>{t.videoMuted=!t.videoMuted,b?.(),t.videoMuted&&(b=M(A.currentTarget).close)},O(Qe,T,()=>!0),B(T,S(ut,{get icon(){return t.videoMuted?"volume_off":"volume_up"}})),O(a,H);const se=d;return typeof se=="function"?O(se,z):d=z,Z.$$click=k,O(lt,Z,()=>v),O(lt,L,()=>C),O(lt,P,()=>y),B(E,S(no,{swipe:x}),R),B(E,S(io,{get cropper(){return n()},get isDraggingSomething(){return r()},get hidden(){return c()}}),R),B(R,s),F.$$click=()=>{e.isPlaying=!e.isPlaying},O(Qe,F,()=>!0),B(G,S(ro,{get paused(){return!e.isPlaying}}),null),j(A=>{const le=W.Container,J={[W.hidden]:e.currentTab!=="adjustments",[W.changed]:t.videoCropLength!==1},de=t.videoCropStart,ie=t.videoCropLength,ne=t.currentVideoTime,Ce=W.InnerContainer,ue=`btn-icon ${W.IconButton} ${W.MuteButton}`,V={[W.muted]:t.videoMuted},ae=W.Frames,Y=W.Cropper,ce=W.Images,ee=h.width,Q=h.height,N=`${W.CropperBg} ${W.CropperBgLeft}`,ge=`${W.CropperBg} ${W.CropperBgRight}`,be=W.CropperHorizontalBorder,$e={[W.dragging]:r()},re=`${W.CropperHandle} ${W.CropperHandleLeft}`,Re=`${W.CropperHandle} ${W.CropperHandleRight}`,Ve=W.CroppedTime,Oe={[W.visible]:c()},Ee=`btn-icon ${W.IconButton} ${W.PlayButton}`,Le=W.PlayButtonInner;return le!==A._v$&&ye(_,A._v$=le),A._v$2=Xe(_,J,A._v$2),de!==A._v$3&&((A._v$3=de)!=null?_.style.setProperty("--start",de):_.style.removeProperty("--start")),ie!==A._v$4&&((A._v$4=ie)!=null?_.style.setProperty("--length",ie):_.style.removeProperty("--length")),ne!==A._v$5&&((A._v$5=ne)!=null?_.style.setProperty("--current-time",ne):_.style.removeProperty("--current-time")),Ce!==A._v$6&&ye(g,A._v$6=Ce),ue!==A._v$7&&ye(T,A._v$7=ue),A._v$8=Xe(T,V,A._v$8),ae!==A._v$9&&ye(E,A._v$9=ae),Y!==A._v$10&&ye(H,A._v$10=Y),ce!==A._v$11&&ye(z,A._v$11=ce),ee!==A._v$12&&he(z,"width",A._v$12=ee),Q!==A._v$13&&he(z,"height",A._v$13=Q),N!==A._v$14&&ye(q,A._v$14=N),ge!==A._v$15&&ye(K,A._v$15=ge),be!==A._v$16&&ye(Z,A._v$16=be),A._v$17=Xe(Z,$e,A._v$17),re!==A._v$18&&ye(L,A._v$18=re),Re!==A._v$19&&ye(P,A._v$19=Re),Ve!==A._v$20&&ye(R,A._v$20=Ve),A._v$21=Xe(R,Oe,A._v$21),Ee!==A._v$22&&ye(F,A._v$22=Ee),Le!==A._v$23&&ye(G,A._v$23=Le),A},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0,_v$9:void 0,_v$10:void 0,_v$11:void 0,_v$12:void 0,_v$13:void 0,_v$14:void 0,_v$15:void 0,_v$16:void 0,_v$17:void 0,_v$18:void 0,_v$19:void 0,_v$20:void 0,_v$21:void 0,_v$22:void 0,_v$23:void 0}),_})()},io=e=>{const{actions:t,editorState:i,mediaState:n}=X(),[a,r]=U(),[o,h]=U(!1),u=me(()=>!e.isDraggingSomething&&!o()&&!isNaN(a())),c=m=>{e.cropper&&(n.videoThumbnailPosition=Je(m,e.cropper))};let s=!1,l;const d=m=>{if(!e.cropper||i.isPlaying||e.isDraggingSomething)return;l||(l=self.setTimeout(()=>{s=!0},200));const C=Je(m,e.cropper);r(C),s&&t.setVideoTime(C,ze.UpdateVideo|ze.Redraw)},f=()=>{s&&t.setVideoTime(n.currentVideoTime,ze.UpdateVideo|ze.Redraw),r(),s=!1,self.clearTimeout(l),l=void 0},p={globalCursor:()=>"grabbing",onStart:m=>{h(!0),e.cropper&&(n.videoThumbnailPosition=Je(m,e.cropper))},onMove:(m,C,y)=>{e.cropper&&(n.videoThumbnailPosition=Je(y,e.cropper))},onEnd:()=>void h(!1)};return[S(ci,{get position(){return n.videoThumbnailPosition},get visible(){return!e.hidden},withTransition:!0}),S(ci,{get position(){return a()||0},ghost:!0,get visible(){return fe(()=>!e.hidden)()&&u()}}),(()=>{const m=Qr();return m.$$click=c,m.$$touchend=f,m.$$pointerout=f,m.$$touchmove=d,m.$$pointermove=d,O(lt,m,()=>p),j(C=>{const y=W.ThumbnailTrack,w={[W.disabled]:e.isDraggingSomething};return y!==C._v$24&&ye(m,C._v$24=y),C._v$25=Xe(m,w,C._v$25),C},{_v$24:void 0,_v$25:void 0}),m})()]},ci=e=>(()=>{const t=Kr();return j(i=>{const n=W.ThumbnailMark,a={[W.ghost]:e.ghost,[W.visible]:e.visible,[W.withTransition]:e.withTransition},r=e.position;return n!==i._v$26&&he(t,"class",i._v$26=n),i._v$27=Xe(t,a,i._v$27),r!==i._v$28&&((i._v$28=r)!=null?t.style.setProperty("--position",r):t.style.removeProperty("--position")),i},{_v$26:void 0,_v$27:void 0,_v$28:void 0}),t})(),no=e=>(()=>{const t=qr();return O(lt,t,()=>e.swipe),j(()=>he(t,"class",W.TimeStick)),t})(),ro=e=>(()=>{const t=Jr(),i=t.firstChild,n=i.firstChild,a=i.nextSibling,r=a.firstChild,o=r.nextSibling;return j(h=>{const u=W.PausePlaySvg,c={[W.paused]:e.paused},s=W.PausePlaySvgPlay,l=W.PausePlaySvgPause,d=W.PausePlaySvgPauseLeft,f=W.PausePlaySvgPauseRight;return u!==h._v$29&&he(t,"class",h._v$29=u),h._v$30=Xe(t,c,h._v$30),s!==h._v$31&&he(n,"class",h._v$31=s),l!==h._v$32&&he(a,"class",h._v$32=l),d!==h._v$33&&he(r,"class",h._v$33=d),f!==h._v$34&&he(o,"class",h._v$34=f),h},{_v$29:void 0,_v$30:void 0,_v$31:void 0,_v$32:void 0,_v$33:void 0,_v$34:void 0}),t})();function Je(e,t){const i=e instanceof TouchEvent?e.changedTouches[0].clientX:e.clientX,n=t.getBoundingClientRect(),r=(i-n.left-zt)/(n.width-2*zt);return Ie(r,0,1)}He(["click","pointermove","touchmove","pointerout","touchend"]);const oo=I("<div class=media-editor__resize-handles-overlay>"),ao=I("<div class=media-editor__main-canvas>");function so(){let e;const{editorState:t,mediaType:i}=X();return mr(),ve(()=>{const n=()=>{const a=e.getBoundingClientRect();t.canvasSize=[a.width,a.height]};n(),window.addEventListener("resize",n),te(()=>{window.removeEventListener("resize",n)})}),(()=>{const n=ao(),a=e;return typeof a=="function"?O(a,n):e=n,B(n,S(Me,{get when(){return t.canvasSize},get children(){return[S(Dn,{}),S(Me,{get when(){return t.isReady},get children(){return[S(zn,{}),S(nr,{}),S(Un,{}),(()=>{const r=oo();return O(o=>void(t.resizeHandlesContainer=o),r),r})(),S(Hn,{}),S(fr,{}),S(Me,{get when(){return i==="video"&&!!t.renderingPayload},get children(){return S(to,{})}})]}})]}})),n})()}const Bt=2560,It=240;function Ft({imageWidth:e,cropOffset:t,imageRatio:i,newRatio:n,scale:a,videoType:r,quality:o}){const[h]=_e(i,t.width,t.height),[u]=_e(n,t.width,t.height);let c=u/(h*a)*e,s=c/n;const l=!!r;return Math.max(c,s)<It&&([c,s]=_e(n,It,It)),r==="gif"&&(c>gt.width||s>gt.height)&&([c,s]=_e(n,gt.width,gt.height)),r==="video"&&(c>pt.width||s>pt.height)&&([c,s]=_e(n,pt.width,pt.height)),!l&&Math.max(c,s)>Bt&&([c,s]=_e(n,Bt,Bt)),o&&(s=o,c=o*n),c=Math.floor(c),s=Math.floor(s),c=c%2==0?c:c-1,s=s%2==0?s:s-1,[c,s]}function lo({context:e,scaledWidth:t,scaledHeight:i,imageWidth:n,imageHeight:a,cropOffset:r}){const{editorState:{canvasSize:o},mediaState:{scale:h,translation:u,rotation:c,flip:s,currentImageRatio:l}}=e,d=o[0],f=o[1],p=n/a,m=d/f;let C=t,y=i;t/m<i?C=i*m:y=t/m;let w=st(p,r().width,r().height,C,y);const v=1/st(l,r().width,r().height,C,y);w*=v;const x=Math.min(C/n,y/a),$=u.map(k=>k*v-k);return{flip:s,rotation:c,scale:h*x*w,translation:[$[0]+u[0],$[1]+u[1]]}}function co(e,t,i,n){const{mediaState:{resizableLayers:a,brushDrawnLines:r},editorState:{pixelRatio:o}}=e;function h(s){const l=[Math.sin(-t.rotation),Math.cos(-t.rotation)];return s=[s[0]*l[1]+s[1]*l[0],s[1]*l[1]-s[0]*l[0]],s=[s[0]*t.scale+i/2+t.translation[0],s[1]*t.scale+n/2+t.translation[1]],s}const u=r.map(({size:s,points:l,...d})=>({...d,size:s*t.scale,points:l.map(h)})),c=a.map(s=>{const l={...Ot(s)};return l.position=h(l.position),l.rotation+=t.rotation,l.scale*=t.scale,l.textInfo&&(l.textInfo={...l.textInfo},l.textInfo.size*=l.scale*o),l});return{scaledLines:u,scaledLayers:c}}const Ze=60,Kt=200;function Mt(e,t,i,n,a,r=!0){const{editorState:{stickersLayersInfo:o,pixelRatio:h}}=e,{container:u}=o[i.id];if(!u?.lastElementChild)return;const s=Kt*i.scale*(r?h:1);t.save(),t.translate(i.position[0],i.position[1]),t.rotate(i.rotation);const[l,d]=_e(a,s,s);t.drawImage(n,-s/2+(s-l)/2,-s/2+(s-d)/2,l,d),t.restore()}function Tt(e,t,i,n=!0){if(i.type!=="text")return;const{editorState:{pixelRatio:a}}=e,r={...i.textRenderingInfo},o=i.scale*(n?a:1);if(r.height*=o,r.width*=o,r.lines=r.lines.map(s=>({...s,height:s.height*o,left:s.left*o,right:s.right*o})),r.path){let s=function(d){l[d]=l[d]*o};const l=[...r.path];l.forEach((d,f)=>{d==="M"||d==="L"?(s(f+1),s(f+2)):d==="A"&&(s(f+1),s(f+2),s(f+6),s(f+7))}),r.path=l}t.save(),t.translate(i.position[0],i.position[1]),t.rotate(i.rotation);let h=-r.height/2;const u=-r.width/2,c=ct[i.textInfo.font];if(i.textInfo.style==="background"){t.translate(u,h),t.fillStyle=i.textInfo.color;const s=new Path2D(r.path.join(" "));t.fill(s),t.translate(-u,-h)}r.lines.forEach(s=>{const l=s.height*c.baseline;let d=.2*i.textInfo.size;i.textInfo.style==="background"&&(d=.3*i.textInfo.size),t.font=`${c.fontWeight} ${i.textInfo.size}px ${c.fontFamily}`;const f=u+d+s.left,p=h+l;i.textInfo.style==="outline"?(t.lineWidth=i.textInfo.size*.15,t.strokeStyle=i.textInfo.color,t.strokeText(s.content,f,p),t.fillStyle=At(i.textInfo.color),t.fillText(s.content,f,p)):i.textInfo.style==="background"?(t.fillStyle=At(i.textInfo.color),t.fillText(s.content,f,p)):(t.fillStyle=i.textInfo.color,t.fillText(s.content,f,p)),h+=s.height}),t.restore()}async function zi({scaledWidth:e,scaledHeight:t}){const i=X(),{editorState:{canvasSize:[n,a],imageCanvas:r,brushCanvas:o,currentTab:h,stickersLayersInfo:u,finalTransform:{scale:c}},mediaState:{resizableLayers:s,rotation:l}}=i,d=Zt(!1),f=Ke(),p=h==="crop",m=e/t,[C,y]=_e(m,p?f().width:n,p?f().height:a),w=document.createElement("canvas");[w.width,w.height]=[n,a];const v=document.createElement("canvas");[v.width,v.height]=[C,y];const x=v.getContext("2d"),$=w.getContext("2d");return $.drawImage(r,0,0,n,a),$.drawImage(o,0,0,n,a),Ot(s).map(b=>({...b,position:d(b.position),rotation:b.rotation+l,scale:b.scale*c,textInfo:b.textInfo?{...b.textInfo,size:b.textInfo.size*b.scale*c}:void 0})).forEach(b=>{if(b.type==="text"&&Tt(i,$,b,!1),b.type==="sticker"){const{container:_}=u[b.id],g=_?.lastElementChild;let T;if(g instanceof HTMLImageElement)T=g.naturalWidth/g.naturalHeight;else if(g instanceof HTMLCanvasElement)T=1;else if(g instanceof HTMLVideoElement)T=g.videoWidth/g.videoHeight;else return;Mt(i,$,b,g,T,!1)}}),p?x.drawImage(w,f().left+(f().width-C)/2,f().top+(f().height-y)/2,C,y,0,0,C,y):x.drawImage(w,(n-C)/2,(a-y)/2,C,y,0,0,C,y),await new Promise(b=>v.toBlob(b))}class Fi{async init(t){const i=await Dt.downloadMedia({media:t}),n=this.image=new Image;n.src=URL.createObjectURL(i);const a=xe();n.addEventListener("load",()=>{a.resolve()}),await a}getTotalFrames(){return 1}getRatio(){return this.image.naturalWidth/this.image.naturalHeight}async renderFrame(){}getRenderedFrame(){return this.image}destroy(){this.image=null}}class Hi{constructor(){this.frameCount=0}async init(t,i){const n=await Dt.downloadMedia({media:t}),a=this.container=document.createElement("div");a.style.width=i+"px",a.style.height=i+"px",a.style.position="absolute",a.style.opacity="0",a.style.pointerEvents="none",document.body.append(a);const r=this.animation=await qi.loadAnimationWorker({container:a,autoplay:!1,animationData:n,width:i,height:i,name:"doc"+t.id}),o=xe();r.addEventListener("ready",()=>{this.frameCount=r.maxFrame+1,o.resolve()}),r.addEventListener("enterFrame",()=>{this.currentDeferredFrame?.resolve()}),await o}getTotalFrames(){return this.frameCount}getRatio(){return 1/1}async renderFrame(t){this.currentDeferredFrame=xe(),this.animation.requestFrame(t),await this.currentDeferredFrame}getRenderedFrame(){return this.animation.canvas[0]}destroy(){this.container.remove(),this.animation.remove()}}class Vi{constructor(){this.duration=0,this.middleware=Ji()}async init(t){const i=await Dt.downloadMedia({media:t}),n=this.video=vi({middleware:this.middleware.get()});n.src=await xi.invoke("createObjectURL",i),n.controls=!1,n.muted=!0,n.preload="auto";const a=gi(n);await pi(n,a),await ke(100),this.duration=n.duration,n.addEventListener("seeked",()=>{this.currentDeferredFrame?.resolve()})}getTotalFrames(){return ei?1:Math.floor(this.duration*Ze)}async renderFrame(t){ei||(this.currentDeferredFrame=xe(),this.video.currentTime=1/Ze*t,await this.currentDeferredFrame)}getRatio(){return this.video.videoWidth/this.video.videoHeight}getRenderedFrame(){return this.video}destroy(){this.middleware.destroy(),this.video=null}}const qe=30,ui=1e-4,fi=720,ot=Si("MediaEditor.createFinalResult.renderToActualVideo");async function uo({renderingPayload:e,hasAnimatedStickers:t,scaledWidth:i,scaledHeight:n,scaledLayers:a,ctx:r,imageCanvasGL:o,imageCanvas:h,drawToImageCanvas:u,brushCanvas:c,resultCanvas:s}){const l=X(),{editorState:{pixelRatio:d},mediaState:{videoCropStart:f,videoCropLength:p,videoMuted:m,videoThumbnailPosition:C},getMediaBlob:y}=l,{media:{video:w}}=e,v=Ut();w.muted=!0;const x=w.duration*f,$=w.duration*(f+p),k=bi(V=>({signal:U(0),dispose:V})),[M,b]=k.signal,_=new Map,g=document.createElement("canvas");[g.width,g.height]=_e(i/n,Math.min(i,fi),Math.min(n,fi));const T=g.getContext("2d"),E=C*w.duration;let H,z,q=0,K,Z=!1,L=!1,P=0;const R=new tn;R.add(window)("focus",()=>{ot("window focus changed","focused"),z?.resolve?.(),z=void 0}),R.add(window)("blur",()=>{ot("window focus changed","blurred"),z=xe(),H?.reject(0)});async function F(){const{Muxer:V,ArrayBufferTarget:ae}=await Vt(()=>import("./mp4-muxer-BBZkcVvS.js"),[],import.meta.url);let Y,ce;if(!m&&await wn()&&(ce=await y()))try{Y=await fo(ce,x,$)}catch{}const ee=new V({target:new ae,video:{codec:"avc",width:i,height:n},audio:Y?{codec:"opus",sampleRate:Y.sampleRate,numberOfChannels:Y.numberOfChannels}:void 0,fastStart:"in-memory"}),Q=new VideoEncoder({output:(N,ge)=>ee.addVideoChunk(N,ge),error:N=>console.error(N)});return Q.configure({width:i,height:n,...Ti(i,n,ki)}),{muxer:ee,encoder:Q,audioBuffer:Y}}function G(){o.bindTexture(o.TEXTURE_2D,e.texture),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,w)}async function se(){await Promise.all(a.map(async V=>{if(!V.sticker)return;const ae=V.sticker?.sticker;let Y;ae===Ye.Static&&(Y=new Fi),ae===Ye.Lottie&&(Y=new Hi),ae===Ye.WebM&&(Y=new Vi),Y&&(_.set(V.id,Y),await Y.init(V.sticker,Kt*V.scale*d))}))}let A;(V=>{V[V.EncodingPaused=0]="EncodingPaused",V[V.TimeLoopback=1]="TimeLoopback"})(A||(A={}));async function le(V,ae){H=xe();const Y=Q=>{G(),w.pause(),H.resolve(Q)};ae===0?Y(0):(K=w.requestVideoFrameCallback((Q,{mediaTime:N})=>void Y(N)),w.paused&&await w.play());let ce;try{ce=await H}catch(Q){if(w.pause(),Q===0&&z){await z,ot("paused case was playing",q+x);const N=xe();R.add(w)("seeked",()=>{N.resolve()},{once:!0}),w.currentTime=q+x,await N}throw Q}const ee=ae===0?0:ce-x;if(ee<q)throw 1;if(t){const Q=Math.round(ee*qe);for(let N=Math.round(q*qe)+1;N<Q;N++)await J({frameNo:N/qe*Ze|0,timestamp:N/qe*1e6|0,appendToMuxer:!0,encoder:V})}q=ee,await J({frameNo:ee*Ze|0,timestamp:ee*1e6|0,appendToMuxer:!0,encoder:V}),!Z&&E-.5/qe<=ee&&ee<=E+.5/qe&&(Z=!0,T.drawImage(s,0,0,g.width,g.height))}async function J({frameNo:V,timestamp:ae,appendToMuxer:Y,encoder:ce}){const ee=Array.from(_.values()).map(N=>N.renderFrame(V%N.getTotalFrames()));if(await Promise.all(ee),u(),r.clearRect(0,0,i,n),r.drawImage(h,0,0),r.drawImage(c,0,0),a.forEach(N=>{if(N.type==="text"&&Tt(l,r,N),N.type==="sticker"&&_.has(N.id)){const ge=_.get(N.id);Mt(l,r,N,ge.getRenderedFrame(),ge.getRatio())}}),!Y)return;const Q=new VideoFrame(s,{timestamp:ae});ce.encode(Q),Q.close()}function de(V){const Y=M(),ce=V-Y;if(ce<.0025){b(V);return}b(Y+ce*.05),P=requestAnimationFrame(()=>de(V))}function ie(V){V.close(),Array.from(_.values()).forEach(ae=>ae.destroy()),R.removeAll(),cancelAnimationFrame(P),w.src="",w.load()}b(0);const ne=await Ct(v,()=>zi({scaledWidth:i,scaledHeight:n})),Ce=new Promise(async(V,ae)=>{const Y=xe();w.currentTime=w.duration*f,w.addEventListener("seeked",()=>void Y.resolve(),{once:!0});const[{muxer:ce,encoder:ee,audioBuffer:Q}]=await Promise.all([F(),ke(200),Y,se()]);let N=0,ge=!1;for(_i(()=>z?!0:(w.currentTime>=$-ui&&(ge=!0,H.resolve($)),!ge));w.currentTime<$-ui;){if(L){ae(),ge=!0,w.pause(),ie(ee);return}try{ot("prepareAndRenderFrame",N),z&&(ot("paused case was paused",q+x),await z),await le(ee,N)}catch(re){if(typeof re!="number")break;if(re===0)await z;else if(re===1)break}de(Ie((w.currentTime-x)/($-x),0,1)),N++}if(ge=!0,w.cancelVideoFrameCallback(K),w.pause(),!Z){const re=xe();w.addEventListener("seeked",()=>{re.resolve()},{once:!0}),w.currentTime=E,await Promise.race([re,ke(2e3)]),G(),await J({frameNo:0,timestamp:0,appendToMuxer:!1,encoder:ee}),T.drawImage(s,0,0,g.width,g.height)}Q&&await ho(Q,re=>ce.addAudioChunk(re)),await ee.flush(),ce.finalize(),ie(ee);const{buffer:be}=ce.target;b(1);const $e=await new Promise(re=>g.toBlob(re));V({blob:new Blob([be],{type:"video/mp4"}),hasSound:!!Q,thumb:{blob:$e,size:new en(g.width,g.height)}})});let ue;return Ce.then(V=>ue=V).catch(Gt),{preview:ne,isVideo:!0,getResult:()=>ue??Ce,cancel:()=>{L=!0},creationProgress:k}}async function fo(e,t,i){const n=new(window.AudioContext||window.webkitAudioContext),a=await e.arrayBuffer(),r=await n.decodeAudioData(a),o=r.sampleRate,h=Math.floor(t*o),u=Math.floor(i*o),c=u-h,s=r.numberOfChannels,l=n.createBuffer(s,c,o);for(let d=0;d<s;d++){const f=r.getChannelData(d);l.copyToChannel(f.subarray(h,u),d)}return l}async function ho(e,t){const i=e.sampleRate,n=e.numberOfChannels,a=e.length,r=new Float32Array(a*n);for(let u=0;u<n;u++){const c=e.getChannelData(u);for(let s=0;s<a;s++)r[s*n+u]=c[s]}const o=new AudioEncoder({output:t,error:u=>console.error("AudioEncoder error:",u)});o.configure({codec:"opus",sampleRate:i,numberOfChannels:e.numberOfChannels,bitrate:128e3});const h=new AudioData({format:"f32",sampleRate:i,numberOfFrames:e.duration*e.sampleRate,numberOfChannels:e.numberOfChannels,timestamp:0,data:r});o.encode(h),h.close(),await o.flush(),o.close()}async function mo({context:e,scaledLayers:t,ctx:i,imageCanvas:n,brushCanvas:a,resultCanvas:r}){const{editorState:{stickersLayersInfo:o},canImageResultInGIF:h}=e;i.drawImage(n,0,0),i.drawImage(a,0,0),t.forEach(c=>{if(c.type==="text"&&Tt(e,i,c),c.type==="sticker"&&(!h||c.sticker?.sticker===Ye.Static)){const{container:s}=o[c.id],l=s?.lastElementChild;let d;if(l instanceof HTMLImageElement)d=l.naturalWidth/l.naturalHeight;else if(l instanceof HTMLVideoElement)d=l.videoWidth/l.videoHeight;else if(l instanceof HTMLCanvasElement)d=l.width/l.height;else return;Mt(e,i,c,l,d)}});const u=await new Promise(c=>r.toBlob(s=>c({blob:s,hasSound:!1})));return{preview:u.blob,isVideo:!1,getResult:()=>u}}async function vo({scaledWidth:e,scaledHeight:t,scaledLayers:i,ctx:n,imageCanvas:a,brushCanvas:r,resultCanvas:o}){const h=Ut(),u=X(),{editorState:{pixelRatio:c}}=u,s=bi(w=>({signal:U(0),dispose:w})),[,l]=s.signal,d=new Map;let f=!1;async function p(w,v){const x=Array.from(d.values()).map(k=>k.renderFrame(v%(k.getTotalFrames()+1)));await Promise.all(x),n.clearRect(0,0,e,t),n.drawImage(a,0,0),n.drawImage(r,0,0),i.forEach(k=>{if(k.type==="text"&&Tt(u,n,k),k.type==="sticker"&&d.has(k.id)){const M=d.get(k.id);Mt(u,n,k,M.getRenderedFrame(),M.getRatio())}});const $=new VideoFrame(o,{timestamp:v*1e6/Ze,duration:1e6/Ze});w.encode($),$.close()}function m(w){w.close(),Array.from(d.values()).forEach(v=>v.destroy())}const C=new Promise(async(w,v)=>{let x=0;const[{ArrayBufferTarget:$,Muxer:k}]=await Promise.all([Vt(()=>import("./mp4-muxer-BBZkcVvS.js"),[],import.meta.url),...i.map(async g=>{if(!g.sticker)return;const T=g.sticker?.sticker;let E;T===Ye.Static&&(E=new Fi),T===Ye.Lottie&&(E=new Hi),T===Ye.WebM&&(E=new Vi),E&&(d.set(g.id,E),await E.init(g.sticker,Kt*g.scale*c),x=Math.max(x,E.getTotalFrames()))}),ke(200)]),M=new k({target:new $,video:{codec:"avc",width:e,height:t,frameRate:Ze},fastStart:"in-memory"}),b=new VideoEncoder({output:(g,T)=>M.addVideoChunk(g,T),error:g=>console.error(g)});b.configure({width:e,height:t,...Ti(e,t,ki)});for(let g=0;g<=x;g++)f&&(v(),m(b)),await p(b,g),l(g/x);await b.flush(),M.finalize(),m(b);const{buffer:_}=M.target;w({blob:new Blob([_],{type:"video/mp4"}),hasSound:!1})});let y;return C.then(w=>y=w).catch(Gt),{preview:await Ct(h,()=>zi({scaledWidth:e,scaledHeight:t})),isVideo:!0,getResult:()=>y??C,cancel:()=>{f=!0},creationProgress:s}}async function go({context:e,cropOffset:t,scaledWidth:i,scaledHeight:n,previewBlob:a}){const{editorState:{currentTab:r,imageCanvas:o}}=e,h=r==="crop",u=o.getBoundingClientRect(),c=new Image;c.src=await xi.invoke("createObjectURL",a),c.style.position="fixed";const s=u.left+(h?t().left+t().width/2:u.width/2),l=u.top+(h?t().top+t().height/2:u.height/2),[d,f]=_e(i/n,h?t().width:u.width,h?t().height:u.height);c.style.left=s+"px",c.style.top=l+"px",c.style.width=d+"px",c.style.height=f+"px",c.style.transform="translate(-50%, -50%)",c.style.objectFit="cover",c.style.zIndex="1000",document.body.append(c);const p=xe();return c.addEventListener("load",()=>p.resolve()),await Promise.race([ke(500),p]),c}const po=Si("MediaEditor.createFinalResult");async function _o(){const e=X(),{editorState:t,mediaState:i,mediaSrc:n,mediaType:a,canImageResultInGIF:r}=e,{resizableLayers:o,adjustments:h}=i,u=Ut(),c=Ke(),s=Li(o)&&r,l=s||a==="video",d=a==="video"?"video":s?"gif":void 0,[,f]=Ft({imageWidth:t.renderingPayload?.media.width,newRatio:i.currentImageRatio,scale:i.scale,videoType:d,imageRatio:t.mediaRatio,cropOffset:c()}),p=Xt(f),[m,C]=Ft({imageWidth:t.renderingPayload?.media.width,newRatio:i.currentImageRatio,scale:i.scale,videoType:d,imageRatio:t.mediaRatio,cropOffset:c(),quality:l?Math.min(p,i.videoQuality):void 0}),y=document.createElement("canvas");y.width=m,y.height=C;const w=y.getContext("webgl",{preserveDrawingBuffer:!0}),v=await Yt({gl:w,mediaSrc:n,mediaType:a,videoTime:i.videoCropStart,waitToSeek:!1}),x=lo({context:e,scaledWidth:m,scaledHeight:C,imageWidth:v.media.width,imageHeight:v.media.height,cropOffset:c}),$=()=>{Nt(w,v,{...x,imageSize:[v.media.width,v.media.height],...Object.fromEntries(ht.map(({key:q,to100:K})=>{const Z=h[q];return[q,Z/(K?100:50)]}))})};a==="image"&&$();const{scaledLayers:k,scaledLines:M}=co(e,x,m,C),b=document.createElement("canvas");b.width=m,b.height=C;const _=new Ne({targetCanvas:b,imageCanvas:y});_.saveLastLine(),M.forEach(q=>_.drawLine(q));const g=document.createElement("canvas");g.width=m,g.height=C;const T=g.getContext("2d",{willReadFrequently:!0}),H=await(a==="video"?Ct(u,()=>uo({renderingPayload:v,hasAnimatedStickers:s,scaledWidth:m,scaledHeight:C,scaledLayers:k,imageCanvasGL:w,imageCanvas:y,drawToImageCanvas:$,resultCanvas:g,brushCanvas:b,ctx:T})):s?Ct(u,()=>vo({scaledWidth:m,scaledHeight:C,scaledLayers:k,imageCanvas:y,resultCanvas:g,brushCanvas:b,ctx:T})):mo({context:e,scaledLayers:k,imageCanvas:y,resultCanvas:g,brushCanvas:b,ctx:T})),z=await go({context:e,cropOffset:c,scaledWidth:m,scaledHeight:C,previewBlob:H.preview});return Promise.resolve(H.getResult())?.catch(Gt)?.finally(()=>{Wt(w),po("cleaning up webgl")}),{...H,animatedPreview:z,width:m,height:C,originalSrc:e.mediaSrc,originalSize:[v.media.width,v.media.height],editingMediaState:structuredClone(Ot(i))}}const wo=I('<div class=media-editor__finish-button><svg width=18 height=16 viewBox="0 0 18 16"fill=none xmlns=http://www.w3.org/2000/svg><path d="M2 9L6.5 14L16 2"stroke=white stroke-width=2.66 stroke-linecap=round stroke-linejoin=round>');function Co(e){let t;const{hasModifications:i}=X();return ve(()=>{Qe(t)}),(()=>{const n=wo();yi(n,"click",e.onClick,!0);const a=t;return typeof a=="function"?O(a,n):t=n,j(()=>n.classList.toggle("media-editor__finish-button--hidden",!i())),n})()}He(["click"]);const yo=I('<div class=media-editor__range-input><div class=media-editor__range-input-row><div class=media-editor__range-input-label></div><div class=media-editor__range-input-value></div></div><div class=media-editor__range-input-wrapper><input type=range step=1><div class="media-editor__range-input-thumb media-editor__range-input-thumb--shadow"></div><div class="media-editor__range-input-progress media-editor__range-input-progress--shadow"></div><div class=media-editor__range-input-progress-background></div><div class=media-editor__range-input-thumb></div><div class=media-editor__range-input-progress>');function St(e){const t=()=>ri(e.value,e.min,e.max,0,1),i=me(()=>ri(0,e.min,e.max,0,100)),n=()=>e.color&&nn(e.color).l<32;let a=null;return(()=>{const r=yo(),o=r.firstChild,h=o.firstChild,u=h.nextSibling,c=o.nextSibling,s=c.firstChild,l=e.ref;return typeof l=="function"?O(l,r):e.ref=r,B(h,()=>e.label),B(u,()=>e.value),s.addEventListener("change",()=>{e.onChangeFinish?.(a,e.value),a=null}),s.$$input=d=>{a===null&&(a=e.value);const f=Ie(d.currentTarget.valueAsNumber,e.min,e.max);e.onChange(f)},j(d=>{const f=!!e.passiveLabel,p=!!(!e.passiveLabel&&e.value),m=!!n(),C={"--color":e.color,"--normalized":t(),"--w":Math.abs(e.value-Math.max(0,e.min))/(e.max-e.min)*100+"%","--bar-left":e.value>=0?Math.max(0,i())+"%":void 0,"--bar-right":e.value<0?i()+"%":void 0,...e.style},y=e.min,w=e.max;return f!==d._v$&&r.classList.toggle("media-editor__range-input--passive",d._v$=f),p!==d._v$2&&r.classList.toggle("media-editor__range-input--has-value",d._v$2=p),m!==d._v$3&&r.classList.toggle("media-editor__range-input--bright-shadow",d._v$3=m),d._v$4=Ae(r,C,d._v$4),y!==d._v$5&&he(s,"min",d._v$5=y),w!==d._v$6&&he(s,"max",d._v$6=w),d},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0}),j(()=>s.value=e.value),r})()}He(["input"]);const xo=I("<div class=media-editor__step-input><div class=media-editor__range-input-row><div class=media-editor__range-input-label></div><div class=media-editor__range-input-value></div></div><div class=media-editor__step-input-wrapper><input type=range min=0 step=1>"),So=I("<div class=media-editor__step-input-dot>"),bo=I("<div class=media-editor__step-input-separator>");function $o(e){const t=me(()=>e.steps.findIndex(r=>r.value===e.value)),i=me(()=>e.steps[t()]),n=ti(t,(r,o)=>r<=o),a=ti(t,(r,o)=>r===o);return(()=>{const r=xo(),o=r.firstChild,h=o.firstChild,u=h.nextSibling,c=o.nextSibling,s=c.firstChild;return B(h,()=>e.label),B(u,()=>i().label),s.$$input=l=>{const d=Math.round(Ie(l.currentTarget.valueAsNumber,0,e.steps.length-1));e.onChange(e.steps[d].value)},B(c,S(We,{get each(){return e.steps},children:(l,d)=>[fe((()=>{const f=fe(()=>!!d());return()=>f()&&(()=>{const p=bo();return j(()=>p.classList.toggle("media-editor__step-input-separator--active",!!n(d()))),p})()})()),(()=>{const f=So();return j(p=>{const m=!!n(d()),C=!!a(d());return m!==p._v$&&f.classList.toggle("media-editor__step-input-dot--active",p._v$=m),C!==p._v$2&&f.classList.toggle("media-editor__step-input-dot--selected",p._v$2=C),p},{_v$:void 0,_v$2:void 0}),f})()]}),null),j(()=>he(s,"max",e.steps.length-1)),j(()=>s.value=t()),r})()}He(["input"]);const Mo=I("<div>"),To=I('<div class="night media-editor__inherit-color">'),hi=800;function ko(){const{editorState:e,mediaState:t,actions:i,mediaType:n}=X(),a=Qt(),r=Ke();let o=0;function h(){window.clearTimeout(o),o=window.setTimeout(()=>{e.isAdjusting=!1},hi)}const u=me(()=>e.mediaSize?Ft({imageWidth:e.mediaSize[0],scale:t.scale,newRatio:t.currentImageRatio||e.mediaRatio,videoType:n==="video"?"video":"gif",imageRatio:e.mediaRatio,cropOffset:r().width?r():{width:1,height:1}}):[0,0]);D(()=>{u(),window.debugResultingSize&&console.log("resultingSize",u())});const c=me(()=>Xt(u()[1])),s=me(()=>Cn.filter(d=>d<=c()).map(d=>({value:d,label:d+"p"}))),l=me(()=>(n==="video"||Li(t.resizableLayers))&&s().length>1);return[S(Fe,{amount:"16px"}),S(Ln,{get children(){return S(Me,{get when(){return l()},get children(){const d=Mo();return B(d,S($o,{get label(){return oe("Quality")},get steps(){return s()},get value(){return Math.min(c(),t.videoQuality)},onChange:f=>void(t.videoQuality=f)}),null),B(d,S(Fe,{amount:"32px"}),null),d}})}}),fe(()=>ht.map(d=>{const[f,p]=U(),[m,C]=U(!1),y=()=>t.adjustments[d.key],w=$=>void(t.adjustments[d.key]=$);D(we(m,()=>{if(!f()||!a()||!m())return;const $=f().getBoundingClientRect(),k=(()=>{const M=To();return M.style.setProperty("position","fixed"),M.style.setProperty("z-index","100"),B(M,S(St,{get value(){return y()},onChange:()=>{},get label(){return d.label()},get min(){return d.to100?0:-50},get max(){return d.to100?100:50}})),j(b=>{const _=$.left+"px",g=$.top+"px",T=$.width+"px",E=$.height+"px";return _!==b._v$&&((b._v$=_)!=null?M.style.setProperty("left",_):M.style.removeProperty("left")),g!==b._v$2&&((b._v$2=g)!=null?M.style.setProperty("top",g):M.style.removeProperty("top")),T!==b._v$3&&((b._v$3=T)!=null?M.style.setProperty("width",T):M.style.removeProperty("width")),E!==b._v$4&&((b._v$4=E)!=null?M.style.setProperty("height",E):M.style.removeProperty("height")),b},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),M})();document.body.append(k),te(()=>{setTimeout(()=>{k.remove()},200)})}));let v=0;const x=()=>{window.clearTimeout(v),v=window.setTimeout(()=>{C(!1)},hi)};return[S(St,{ref:p,get value(){return y()},onChange:$=>{w($),C(!0),e.isAdjusting=!0,x(),h()},get label(){return d.label()},onChangeFinish:($,k)=>{C(!1),e.isAdjusting=!1,i.pushToHistory({path:["adjustments",d.key],newValue:k,oldValue:$})},get min(){return d.to100?0:-50},get max(){return d.to100?100:50}}),S(Fe,{amount:"32px"})]}))]}const Lo=I('<svg width=120 height=48 viewBox="0 0 120 48"fill=none xmlns=http://www.w3.org/2000/svg><g clip-path=url(#clip0_6102_2542)><g filter=url(#filter0_iiii_6102_2542)><path d="M0 15H80L110.2 22.4465C112.048 22.9021 112.971 23.1299 113.185 23.4931C113.369 23.806 113.369 24.194 113.185 24.5069C112.971 24.8701 112.048 25.0979 110.2 25.5535L80 33H0V15Z"fill=#3E3F3F></path></g><path d="M112.564 24.9709L103.474 27.2132C103.21 27.2782 102.944 27.121 102.883 26.8566C102.736 26.2146 102.5 25.0296 102.5 24C102.5 22.9705 102.736 21.7855 102.883 21.1434C102.944 20.8791 103.21 20.7219 103.474 20.7868L112.564 23.0291C113.578 23.2792 113.578 24.7208 112.564 24.9709Z"fill=currentColor></path><rect x=76 y=15 width=4 height=18 rx=0.5 fill=currentColor></rect></g><defs><filter id=filter0_iiii_6102_2542 x=0 y=10 width=116.323 height=28 filterUnits=userSpaceOnUse color-interpolation-filters=sRGB><feFlood flood-opacity=0 result=BackgroundImageFix></feFlood><feBlend mode=normal in=SourceGraphic in2=BackgroundImageFix result=shape></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=1 dy=5></feOffset><feGaussianBlur stdDeviation=3></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.137255 0 0 0 0 0.145098 0 0 0 0 0.14902 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=shape result=effect1_innerShadow_6102_2542></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=3 dy=-5></feOffset><feGaussianBlur stdDeviation=3></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.137255 0 0 0 0 0.145098 0 0 0 0 0.14902 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=effect1_innerShadow_6102_2542 result=effect2_innerShadow_6102_2542></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=1 dy=-1></feOffset><feGaussianBlur stdDeviation=0.5></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.242217 0 0 0 0 0.247242 0 0 0 0 0.247101 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=effect2_innerShadow_6102_2542 result=effect3_innerShadow_6102_2542></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=1 dy=1></feOffset><feGaussianBlur stdDeviation=0.5></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.242217 0 0 0 0 0.247242 0 0 0 0 0.247101 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=effect3_innerShadow_6102_2542 result=effect4_innerShadow_6102_2542></feBlend></filter><clipPath id=clip0_6102_2542><rect width=20 height=120 fill=white transform="matrix(0 1 -1 0 120 14)">'),Po=I('<svg width=120 height=48 viewBox="0 0 120 48"fill=none xmlns=http://www.w3.org/2000/svg><g clip-path=url(#clip0_6102_2543)><path d="M94 24H110M110 24L104 18M110 24L104 30"stroke=url(#paint0_linear_6102_2543) stroke-width=3 stroke-linecap=round stroke-linejoin=round></path><g filter=url(#filter0_iiii_6102_2543)><path d="M0 15H92C94.2091 15 96 16.7909 96 19V29C96 31.2091 94.2091 33 92 33H0V15Z"fill=#3E3F3F></path></g><path d="M92 15V15C94.2091 15 96 16.7909 96 19V29C96 31.2091 94.2091 33 92 33V33V15Z"fill=currentColor></path></g><defs><filter id=filter0_iiii_6102_2543 x=0 y=10 width=99 height=28 filterUnits=userSpaceOnUse color-interpolation-filters=sRGB><feFlood flood-opacity=0 result=BackgroundImageFix></feFlood><feBlend mode=normal in=SourceGraphic in2=BackgroundImageFix result=shape></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=1 dy=5></feOffset><feGaussianBlur stdDeviation=3></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.137255 0 0 0 0 0.145098 0 0 0 0 0.14902 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=shape result=effect1_innerShadow_6102_2543></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=3 dy=-5></feOffset><feGaussianBlur stdDeviation=3></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.137255 0 0 0 0 0.145098 0 0 0 0 0.14902 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=effect1_innerShadow_6102_2543 result=effect2_innerShadow_6102_2543></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=1 dy=-1></feOffset><feGaussianBlur stdDeviation=0.5></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.242217 0 0 0 0 0.247242 0 0 0 0 0.247101 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=effect2_innerShadow_6102_2543 result=effect3_innerShadow_6102_2543></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=1 dy=1></feOffset><feGaussianBlur stdDeviation=0.5></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.242217 0 0 0 0 0.247242 0 0 0 0 0.247101 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=effect3_innerShadow_6102_2543 result=effect4_innerShadow_6102_2543></feBlend></filter><linearGradient id=paint0_linear_6102_2543 x1=110 y1=24 x2=94 y2=24 gradientUnits=userSpaceOnUse><stop offset=0.755 stop-color=currentColor></stop><stop offset=1 stop-color=currentColor stop-opacity=0></stop></linearGradient><clipPath id=clip0_6102_2543><rect width=20 height=120 fill=white transform="matrix(0 1 -1 0 120 14)">'),Bo=I('<svg width=120 height=48 viewBox="0 0 120 48"fill=none xmlns=http://www.w3.org/2000/svg><g clip-path=url(#clip0_6102_2546)><g filter=url(#filter0_iiii_6102_2546)><path d="M0 15H82.3579C83.4414 15 84.5135 15.2201 85.5093 15.6468L91 18H101C101.552 18 102 18.4477 102 19V29C102 29.5523 101.552 30 101 30H91L85.5093 32.3532C84.5135 32.7799 83.4414 33 82.3579 33H0V15Z"fill=#3E3F3F></path></g><rect x=76 y=15 width=4 height=18 rx=0.5 fill=currentColor></rect><path d="M102 19H106.434C106.785 19 107.111 19.1843 107.291 19.4855L112.091 27.4855C112.491 28.152 112.011 29 111.234 29H102V19Z"fill=currentColor></path></g><defs><filter id=filter0_iiii_6102_2546 x=0 y=10 width=105 height=28 filterUnits=userSpaceOnUse color-interpolation-filters=sRGB><feFlood flood-opacity=0 result=BackgroundImageFix></feFlood><feBlend mode=normal in=SourceGraphic in2=BackgroundImageFix result=shape></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=1 dy=5></feOffset><feGaussianBlur stdDeviation=3></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.137255 0 0 0 0 0.145098 0 0 0 0 0.14902 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=shape result=effect1_innerShadow_6102_2546></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=3 dy=-5></feOffset><feGaussianBlur stdDeviation=3></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.137255 0 0 0 0 0.145098 0 0 0 0 0.14902 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=effect1_innerShadow_6102_2546 result=effect2_innerShadow_6102_2546></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=1 dy=-1></feOffset><feGaussianBlur stdDeviation=0.5></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.242217 0 0 0 0 0.247242 0 0 0 0 0.247101 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=effect2_innerShadow_6102_2546 result=effect3_innerShadow_6102_2546></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=1 dy=1></feOffset><feGaussianBlur stdDeviation=0.5></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.242217 0 0 0 0 0.247242 0 0 0 0 0.247101 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=effect3_innerShadow_6102_2546 result=effect4_innerShadow_6102_2546></feBlend></filter><clipPath id=clip0_6102_2546><rect width=20 height=120 fill=white transform="matrix(0 1 -1 0 120 14)">'),Io=I('<svg width=120 height=48 viewBox="0 0 120 48"fill=none xmlns=http://www.w3.org/2000/svg><g clip-path=url(#clip0_6102_2547)><g filter=url(#filter0_f_6102_2547)><path d="M102 19H107.146C108.282 19 109.323 19.6487 109.601 20.7506C109.813 21.593 110 22.703 110 24C110 25.297 109.813 26.407 109.601 27.2494C109.323 28.3513 108.282 29 107.146 29H102V19Z"fill=currentColor></path></g><g filter=url(#filter1_f_6102_2547)><path d="M102 19H107.146C108.282 19 109.323 19.6487 109.601 20.7506C109.813 21.593 110 22.703 110 24C110 25.297 109.813 26.407 109.601 27.2494C109.323 28.3513 108.282 29 107.146 29H102V19Z"fill=currentColor></path></g><g filter=url(#filter2_f_6102_2547)><path d="M102 19H107.146C108.282 19 109.323 19.6487 109.601 20.7506C109.813 21.593 110 22.703 110 24C110 25.297 109.813 26.407 109.601 27.2494C109.323 28.3513 108.282 29 107.146 29H102V19Z"fill=currentColor></path></g><g filter=url(#filter3_iiii_6102_2547)><path d="M0 15H82.3579C83.4414 15 84.5135 15.2201 85.5093 15.6468L91 18H101C101.552 18 102 18.4477 102 19V29C102 29.5523 101.552 30 101 30H91L85.5093 32.3532C84.5135 32.7799 83.4414 33 82.3579 33H0V15Z"fill=#3E3F3F></path></g><rect x=76 y=15 width=4 height=18 rx=0.5 fill=currentCOlor></rect><path d="M102 19H107.146C108.282 19 109.323 19.6487 109.601 20.7506C109.813 21.593 110 22.703 110 24C110 25.297 109.813 26.407 109.601 27.2494C109.323 28.3513 108.282 29 107.146 29H102V19Z"fill=currentCOlor></path></g><defs><filter id=filter0_f_6102_2547 x=96 y=13 width=20 height=22 filterUnits=userSpaceOnUse color-interpolation-filters=sRGB><feFlood flood-opacity=0 result=BackgroundImageFix></feFlood><feBlend mode=normal in=SourceGraphic in2=BackgroundImageFix result=shape></feBlend><feGaussianBlur stdDeviation=3 result=effect1_foregroundBlur_6102_2547></feGaussianBlur></filter><filter id=filter1_f_6102_2547 x=96 y=13 width=20 height=22 filterUnits=userSpaceOnUse color-interpolation-filters=sRGB><feFlood flood-opacity=0 result=BackgroundImageFix></feFlood><feBlend mode=normal in=SourceGraphic in2=BackgroundImageFix result=shape></feBlend><feGaussianBlur stdDeviation=3 result=effect1_foregroundBlur_6102_2547></feGaussianBlur></filter><filter id=filter2_f_6102_2547 x=96 y=13 width=20 height=22 filterUnits=userSpaceOnUse color-interpolation-filters=sRGB><feFlood flood-opacity=0 result=BackgroundImageFix></feFlood><feBlend mode=normal in=SourceGraphic in2=BackgroundImageFix result=shape></feBlend><feGaussianBlur stdDeviation=3 result=effect1_foregroundBlur_6102_2547></feGaussianBlur></filter><filter id=filter3_iiii_6102_2547 x=0 y=10 width=105 height=28 filterUnits=userSpaceOnUse color-interpolation-filters=sRGB><feFlood flood-opacity=0 result=BackgroundImageFix></feFlood><feBlend mode=normal in=SourceGraphic in2=BackgroundImageFix result=shape></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=1 dy=5></feOffset><feGaussianBlur stdDeviation=3></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.137255 0 0 0 0 0.145098 0 0 0 0 0.14902 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=shape result=effect1_innerShadow_6102_2547></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=3 dy=-5></feOffset><feGaussianBlur stdDeviation=3></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.137255 0 0 0 0 0.145098 0 0 0 0 0.14902 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=effect1_innerShadow_6102_2547 result=effect2_innerShadow_6102_2547></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=1 dy=-1></feOffset><feGaussianBlur stdDeviation=0.5></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.242217 0 0 0 0 0.247242 0 0 0 0 0.247101 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=effect2_innerShadow_6102_2547 result=effect3_innerShadow_6102_2547></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=1 dy=1></feOffset><feGaussianBlur stdDeviation=0.5></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.242217 0 0 0 0 0.247242 0 0 0 0 0.247101 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=effect3_innerShadow_6102_2547 result=effect4_innerShadow_6102_2547></feBlend></filter><clipPath id=clip0_6102_2547><rect width=20 height=120 fill=white transform="matrix(0 1 -1 0 120 14)">'),Ro=I('<svg width=120 height=48 viewBox="0 0 120 48"fill=none xmlns=http://www.w3.org/2000/svg><g clip-path=url(#clip0_6102_2544)><g filter=url(#filter0_i_6102_2544)><path d="M95 15H108C110.209 15 112 16.7909 112 19V29C112 31.2091 110.209 33 108 33H95V15Z"fill=#D9D9D9></path><path d="M95 15H108C110.209 15 112 16.7909 112 19V29C112 31.2091 110.209 33 108 33H95V15Z"fill=#F09B99></path></g><g filter=url(#filter1_iiii_6102_2544)><path d="M0 15H77.6464C77.8728 15 78.0899 14.9101 78.25 14.75V14.75C78.4101 14.5899 78.6272 14.5 78.8536 14.5H96C97.1046 14.5 98 15.3954 98 16.5V31.5C98 32.6046 97.1046 33.5 96 33.5H78.8536C78.6272 33.5 78.4101 33.4101 78.25 33.25V33.25C78.0899 33.0899 77.8728 33 77.6464 33H0V15Z"fill=#3E3F3F></path></g><path d="M79 33.5V14.5H78V33.5H79Z"fill=black fill-opacity=0.33></path></g><defs><filter id=filter0_i_6102_2544 x=95 y=13 width=19 height=20 filterUnits=userSpaceOnUse color-interpolation-filters=sRGB><feFlood flood-opacity=0 result=BackgroundImageFix></feFlood><feBlend mode=normal in=SourceGraphic in2=BackgroundImageFix result=shape></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=2 dy=-2></feOffset><feGaussianBlur stdDeviation=2></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.33 0"></feColorMatrix><feBlend mode=normal in2=shape result=effect1_innerShadow_6102_2544></feBlend></filter><filter id=filter1_iiii_6102_2544 x=0 y=9.5 width=101 height=29 filterUnits=userSpaceOnUse color-interpolation-filters=sRGB><feFlood flood-opacity=0 result=BackgroundImageFix></feFlood><feBlend mode=normal in=SourceGraphic in2=BackgroundImageFix result=shape></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=1 dy=5></feOffset><feGaussianBlur stdDeviation=3></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.137255 0 0 0 0 0.145098 0 0 0 0 0.14902 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=shape result=effect1_innerShadow_6102_2544></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=3 dy=-5></feOffset><feGaussianBlur stdDeviation=3></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.137255 0 0 0 0 0.145098 0 0 0 0 0.14902 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=effect1_innerShadow_6102_2544 result=effect2_innerShadow_6102_2544></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=1 dy=-1></feOffset><feGaussianBlur stdDeviation=0.5></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.242217 0 0 0 0 0.247242 0 0 0 0 0.247101 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=effect2_innerShadow_6102_2544 result=effect3_innerShadow_6102_2544></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=1 dy=1></feOffset><feGaussianBlur stdDeviation=0.5></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.242217 0 0 0 0 0.247242 0 0 0 0 0.247101 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=effect3_innerShadow_6102_2544 result=effect4_innerShadow_6102_2544></feBlend></filter><clipPath id=clip0_6102_2544><rect width=20 height=120 fill=white transform="matrix(0 1 -1 0 120 14)">'),Eo=I('<svg width=120 height=48 viewBox="0 0 120 48"fill=none xmlns=http://www.w3.org/2000/svg><g clip-path=url(#clip0_6102_2545)><image href=assets/img/media-editor-blurred-color-wheel.png x=91 y=12 width=26 height=24></image><image href=assets/img/media-editor-blurred-color-wheel.png x=91 y=12 width=26 height=24></image><g filter=url(#filter3_iiii_6102_2545)><path d="M-2 15H75.441C75.7836 15 76.0968 15.1936 76.25 15.5V15.5C76.4032 15.8064 76.7164 16 77.059 16H92.941C93.2836 16 93.5968 15.8064 93.75 15.5V15.5C93.9032 15.1936 94.2164 15 94.559 15H98C99.1046 15 100 15.8954 100 17V31C100 32.1046 99.1046 33 98 33H94.559C94.2164 33 93.9032 32.8064 93.75 32.5V32.5C93.5968 32.1936 93.2836 32 92.941 32H77.059C76.7164 32 76.4032 32.1936 76.25 32.5V32.5C76.0968 32.8064 75.7836 33 75.441 33H-2V15Z"fill=#3E3F3F></path></g><mask id=mask0_6102_2545 style=mask-type:alpha maskUnits=userSpaceOnUse x=0 y=15 width=100 height=18><path d="M0 15H75.441C75.7836 15 76.0968 15.1936 76.25 15.5V15.5C76.4032 15.8064 76.7164 16 77.059 16H92.941C93.2836 16 93.5968 15.8064 93.75 15.5V15.5C93.9032 15.1936 94.2164 15 94.559 15H98C99.1046 15 100 15.8954 100 17V31C100 32.1046 99.1046 33 98 33H94.559C94.2164 33 93.9032 32.8064 93.75 32.5V32.5C93.5968 32.1936 93.2836 32 92.941 32H77.059C76.7164 32 76.4032 32.1936 76.25 32.5V32.5C76.0968 32.8064 75.7836 33 75.441 33H0V15Z"fill=#3E3F3F></path></mask><image opacity=1 href=assets/img/media-editor-blurred-color-wheel.png x=91 y=12 width=26 height=24></image></g><defs><filter id=filter3_iiii_6102_2545 x=-2 y=10 width=105 height=28 filterUnits=userSpaceOnUse color-interpolation-filters=sRGB><feFlood flood-opacity=0 result=BackgroundImageFix></feFlood><feBlend mode=normal in=SourceGraphic in2=BackgroundImageFix result=shape></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=1 dy=5></feOffset><feGaussianBlur stdDeviation=3></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.137255 0 0 0 0 0.145098 0 0 0 0 0.14902 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=shape result=effect1_innerShadow_6102_2545></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=3 dy=-5></feOffset><feGaussianBlur stdDeviation=3></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.137255 0 0 0 0 0.145098 0 0 0 0 0.14902 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=effect1_innerShadow_6102_2545 result=effect2_innerShadow_6102_2545></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=1 dy=-1></feOffset><feGaussianBlur stdDeviation=0.5></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.242217 0 0 0 0 0.247242 0 0 0 0 0.247101 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=effect2_innerShadow_6102_2545 result=effect3_innerShadow_6102_2545></feBlend><feColorMatrix in=SourceAlpha type=matrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"result=hardAlpha></feColorMatrix><feOffset dx=1 dy=1></feOffset><feGaussianBlur stdDeviation=0.5></feGaussianBlur><feComposite in2=hardAlpha operator=arithmetic k2=-1 k3=1></feComposite><feColorMatrix type=matrix values="0 0 0 0 0.242217 0 0 0 0 0.247242 0 0 0 0 0.247101 0 0 0 1 0"></feColorMatrix><feBlend mode=normal in2=effect3_innerShadow_6102_2545 result=effect4_innerShadow_6102_2545></feBlend></filter><clipPath id=clip0_6102_2545><rect width=120 height=48 fill=white>');function Ao(){return Lo()}function zo(){return Po()}function Fo(){return Bo()}function Ho(){return Io()}function Vo(){return Ro()}function Oo(){return Eo()}const Do=I("<div class=media-editor__color-picker-swatch><div class=media-editor__color-picker-swatch-color>"),Go=I('<div class=media-editor__color-picker><div class=media-editor__color-picker-swatches><div class="media-editor__color-picker-swatch media-editor__color-picker-swatch--gradient"><div class=media-editor__color-picker-swatch-color></div></div><div class=media-editor__color-picker-slider></div></div><div class=media-editor__color-picker-layout-wrapper><div class=media-editor__color-picker-layout><div class=media-editor__color-picker-box></div><div class=media-editor__color-picker-inputs>'),Uo=I("<div>"),et=["#ffffff","#fe4438","#ff8901","#ffd60a","#33c759","#62e5e0","#0a84ff","#bd5cf3"],jo=200,Wo=120,Xo=304,Rt=384;function Oi(e){const{actions:t}=X(),[i,n]=U(et.includes(e.value)),[a,r]=U(!1),[o,h]=U(Rt);let u;const c=(d,f)=>(()=>{const p=Do();return p.$$click=()=>e.onChange(d),f!=null?p.style.setProperty("--i",f):p.style.removeProperty("--i"),j(m=>{const C=!!(e.value===d&&i()),y=wi(d).join(" ");return C!==m._v$&&p.classList.toggle("media-editor__color-picker-swatch--active",m._v$=C),y!==m._v$2&&((m._v$2=y)!=null?p.style.setProperty("--color-rgb",y):p.style.removeProperty("--color-rgb")),m},{_v$:void 0,_v$2:void 0}),p})(),s=async()=>{n(d=>!d),i()&&(r(!0),e.onChange(e.previousColor||et[0]),await ke(200),r(!1))},l=me(we(o,()=>{const d=new yn({buildLayout:f=>(()=>{const p=Go(),m=p.firstChild,C=m.firstChild,y=C.nextSibling,w=m.nextSibling,v=w.firstChild,x=v.firstChild,$=x.nextSibling;return p.style.setProperty("--picker-height","120px"),B(m,()=>et.map(c),C),C.$$click=s,B(y,()=>f.slider),B(x,()=>f.pickerBox),B($,()=>f.hexInput,null),B($,()=>f.rgbInput,null),j(k=>{const M=!!i(),b=!i();return M!==k._v$3&&p.classList.toggle("media-editor__color-picker--collapsed",k._v$3=M),b!==k._v$4&&C.classList.toggle("media-editor__color-picker-swatch--active",k._v$4=b),k},{_v$3:void 0,_v$4:void 0}),p})(),pickerBoxWidth:jo+o()-Rt,pickerBoxHeight:Wo,sliderWidth:Xo+o()-Rt,thickSlider:!0});return d.onChange=f=>{f.hex!==e.value&&e.onChange(f.hex),t.abortDrawerSlide()},d.container.querySelectorAll(".media-editor__color-picker-swatch").forEach(f=>{Qe(f)}),d}));return ve(()=>{h(u.clientWidth);const d=new ResizeObserver(()=>{h(u.clientWidth)});d.observe(u),te(()=>{d.disconnect()})}),D(we(()=>e.colorKey,async()=>{await ke(0);const d=et.includes(e.value);d!==i()&&(n(d),d&&(r(!0),ke(200).then(()=>r(!1))))})),D(we(()=>[a(),l(),e.value],async()=>{await dt(),!a()&&e.value!==l().getCurrentColor().hex&&l().setColor(e.value)})),(()=>{const d=Uo(),f=u;return typeof f=="function"?O(f,d):u=d,B(d,()=>l().container),d})()}He(["click"]);function at(e,t){const[i,n]=U((()=>{const r=()=>{const o=[et.includes(t)?1:2,t,t];return localStorage.setItem(e,JSON.stringify(o)),o};try{const o=JSON.parse(localStorage.getItem(e));return!(o instanceof Array)||typeof o[0]!="number"||typeof o[1]!="string"||typeof o[2]!="string"?r():o}catch{}return r()})());function a(r){let o;et.includes(r)?o=[1,r,r]:o=[2,i()[1],r],n(o),localStorage.setItem(e,JSON.stringify(o))}return[()=>({value:i()[i()[0]],previous:i()[1]}),a]}const No=I("<div>");function qt(e){let t;return ve(()=>{Qe(t)}),(()=>{const i=No(),n=t;return typeof n=="function"?O(n,i):t=i,rn(i,jt(e,{class:"media-editor__large-button",get classList(){return{"media-editor__large-button--active":e.active,[e.class]:!!e.class}}}),!1,!1),i})()}const Yo=I("<div class=media-editor__brush-button-svg-wrapper>"),Zo=I("<div>"),Qo=I("<div class=media-editor__label>");function Ko(){const{editorState:e,mediaType:t}=X(),i={pen:at("media-editor-pen-color","#fe4438"),arrow:at("media-editor-arrow-color","#ffd60a"),brush:at("media-editor-brush-color","#ff8901"),neon:at("media-editor-neon-color","#62e5e0")};function n(s){return i[s]}function a(){const[s]=n(e.currentBrush.brush)||[];!s||e.currentBrush.color===s().value||(e.currentBrush.color=s().value)}a(),D(()=>{a()});function r(s){const l=e.currentBrush.brush,[,d]=n(l)||[];d?.(s)}const o=(s,l,d)=>S(qt,{get active(){return e.currentBrush.brush===d},onClick:()=>void(e.currentBrush.brush=d),class:"media-editor__brush-button",get children(){return[(()=>{const f=Yo();return B(f,l),j(()=>n(d)?.[0]().value!=null?f.style.setProperty("color",n(d)?.[0]().value):f.style.removeProperty("color")),f})(),s]}}),h=()=>e.currentBrush.brush in i;let u=0;function c(){window.clearTimeout(u),u=window.setTimeout(()=>{e.previewBrushSize=void 0},1e3)}return[(()=>{const s=Zo();return B(s,S(Oi,{get value(){return e.currentBrush.color},onChange:r,get colorKey(){return e.currentBrush.brush},get previousColor(){return n(e.currentBrush.brush)?.[0]().previous}})),j(l=>Ae(s,{transition:"opacity .2s",...h()?void 0:{opacity:.25,"pointer-events":"none"}},l)),s})(),S(Fe,{amount:"16px"}),S(St,{get label(){return oe("MediaEditor.Size")},min:2,max:32,get value(){return e.currentBrush.size},onChange:s=>{e.currentBrush.size=s,e.previewBrushSize=s,c()},onChangeFinish:()=>{e.previewBrushSize=void 0},passiveLabel:!0,get color(){return h()?e.currentBrush.color:void 0}}),S(Fe,{amount:"16px"}),(()=>{const s=Qo();return B(s,()=>oe("MediaEditor.Tool")),s})(),fe(()=>o(oe("MediaEditor.Brushes.Pen"),S(Ao,{}),"pen")),fe(()=>o(oe("MediaEditor.Brushes.Arrow"),S(zo,{}),"arrow")),fe(()=>o(oe("MediaEditor.Brushes.Brush"),S(Fo,{}),"brush")),fe(()=>o(oe("MediaEditor.Brushes.Neon"),S(Ho,{}),"neon")),fe(()=>t==="image"&&o(oe("MediaEditor.Brushes.Blur"),S(Oo,{}),"blur")),fe(()=>o(oe("MediaEditor.Brushes.Eraser"),S(Vo,{}),"eraser"))]}const qo=I("<svg><rect x=4 y=4 width=16 height=16 rx=2 stroke=white stroke-width=1.66></svg>",!1,!0),Jo=I("<svg><rect x=3 y=6 width=18 height=12 rx=2 stroke=white stroke-width=1.66></svg>",!1,!0),ea=I("<svg><rect x=3 y=5 width=18 height=14 rx=2 stroke=white stroke-width=1.66></svg>",!1,!0),ta=I("<svg><rect x=3 y=4.5 width=18 height=15 rx=2 stroke=white stroke-width=1.66></svg>",!1,!0),ia=I("<svg><rect x=3 y=4 width=18 height=16 rx=2 stroke=white stroke-width=1.66></svg>",!1,!0),na=I("<svg><rect x=2.5 y=6.5 width=19 height=11 rx=2 stroke=white stroke-width=1.66></svg>",!1,!0),ra=I('<svg width=24 height=24 viewBox="0 0 24 24"fill=none xmlns=http://www.w3.org/2000/svg>'),oa=I("<div class=media-editor__label>"),aa=I("<div class=media-editor__crop-grid>"),sa={"1x1":()=>qo(),"3x2":()=>Jo(),"4x3":()=>ea(),"5x4":()=>ta(),"7x5":()=>ia(),"16x9":()=>na()},Be=(e,t)=>(()=>{const i=ra();return i.classList.toggle("media-editor__crop-item-icon--rotated",!!t),B(i,()=>sa[e]()),i})();function Se(e){const[t,i]=on(e,["icon","text"]);return S(qt,jt(i,{class:"media-editor__crop-item",get children(){return[fe(()=>t.icon),fe(()=>t.text)]}}))}function la(){const{editorState:e,mediaState:t,actions:i}=X(),n=r=>e.fixedImageRatioKey===r,a=Ge(r=>{e.fixedImageRatioKey=r,Ai(t.rotation),i.resetRotationWheel()});return[(()=>{const r=oa();return B(r,()=>oe("MediaEditor.AspectRatio")),r})(),S(Se,{get icon(){return S(ut,{icon:"free_transform"})},get text(){return oe("MediaEditor.Free")},get active(){return n()},onClick:()=>a()}),S(Se,{get icon(){return S(ut,{icon:"image_original"})},get text(){return oe("MediaEditor.Original")},get active(){return n("original")},onClick:()=>a("original")}),S(Se,{get icon(){return Be("1x1")},get text(){return oe("MediaEditor.Square")},get active(){return n("1x1")},onClick:()=>a("1x1")}),(()=>{const r=aa();return B(r,S(Se,{get icon(){return Be("3x2")},text:"3:2",get active(){return n("3x2")},onClick:()=>a("3x2")}),null),B(r,S(Se,{get icon(){return Be("3x2",!0)},text:"2:3",get active(){return n("2x3")},onClick:()=>a("2x3")}),null),B(r,S(Se,{get icon(){return Be("4x3")},text:"4:3",get active(){return n("4x3")},onClick:()=>a("4x3")}),null),B(r,S(Se,{get icon(){return Be("4x3",!0)},text:"3:4",get active(){return n("3x4")},onClick:()=>a("3x4")}),null),B(r,S(Se,{get icon(){return Be("5x4")},text:"5:4",get active(){return n("5x4")},onClick:()=>a("5x4")}),null),B(r,S(Se,{get icon(){return Be("5x4",!0)},text:"4:5",get active(){return n("4x5")},onClick:()=>a("4x5")}),null),B(r,S(Se,{get icon(){return Be("7x5")},text:"7:5",get active(){return n("7x5")},onClick:()=>a("7x5")}),null),B(r,S(Se,{get icon(){return Be("7x5",!0)},text:"5:7",get active(){return n("5x7")},onClick:()=>a("5x7")}),null),B(r,S(Se,{get icon(){return Be("16x9")},text:"16:9",get active(){return n("16x9")},onClick:()=>a("16x9")}),null),B(r,S(Se,{get icon(){return Be("16x9",!0)},text:"9:16",get active(){return n("9x16")},onClick:()=>a("9x16")}),null),r})()]}const da=I("<div class=media-editor__tabs-item>"),ca=I("<div class=media-editor__tabs><div class=media-editor__tabs-underline>"),Di=[{icon:"equalizer",key:"adjustments"},{icon:"crop",key:"crop"},{icon:"text",key:"text"},{icon:"brush",key:"brush"},{icon:"smile",key:"stickers"}],mi=Di.map(e=>e.key);function ua(){const{editorState:e}=X();let t,i;const n=Di.map(r=>({...r,element:(()=>{const o=da();return B(o,S(tt,{get icon(){return r.icon},onClick:()=>a(r.key)})),j(()=>o.classList.toggle("media-editor__tabs-item--active",e.currentTab===r.key)),o})()}));function a(r){const o=n.find(c=>c.key===r).element,h=t.getBoundingClientRect(),u=o.getBoundingClientRect();i.style.setProperty("--left",u.left+u.width/2-h.left+"px"),e.currentTab=r}return(()=>{const r=ca(),o=r.firstChild,h=t;typeof h=="function"?O(h,r):t=r,B(r,()=>n.map(c=>c.element),o);const u=i;return typeof u=="function"?O(u,o):i=o,r})()}const fa=I("<div><div class=media-editor__tab-content-scrollable-content>"),ha=I("<div class=media-editor__tab-content><div><div class=media-editor__tab-content-scrollable-content>"),Ht=sn();function ma(e){const{editorState:t}=X(),[i,n]=U(),[a,r]=U(0);let o,h=t.currentTab,u;D(async()=>{if(h===t.currentTab)return;const l=mi.indexOf(t.currentTab)>mi.indexOf(h);h=t.currentTab,u.destroy();const d=(()=>{const p=fa(),m=p.firstChild;return B(m,S(Ht.Provider,{value:{container:i,scrollAmount:a},get children(){return e.tabs[t.currentTab]()}})),p})();s(d);const f=(p,m,C)=>p.classList[m]("media-editor__tab-content--"+C);f(o,"add","exit"),l?(f(d,"add","go-right"),i().append(d),await dt(),f(o,"add","go-left"),f(d,"remove","go-right")):(f(d,"add","go-left"),i().append(d),await dt(),f(o,"add","go-right"),f(d,"remove","go-left")),await ke(200),o.remove(),o=d});const c=e.tabs[t.currentTab]();function s(l){u=new an(l),u.setListeners(),u.container.addEventListener("scroll",()=>{e.onScroll(),r(u.container.scrollTop)})}return ve(()=>{s(o)}),te(()=>{u.destroy()}),(()=>{const l=ha(),d=l.firstChild,f=d.firstChild;O(m=>{n(m),e.onContainer(m)},l);const p=o;return typeof p=="function"?O(p,d):o=d,B(f,S(Ht.Provider,{value:{container:i,scrollAmount:a},children:c})),l})()}const va=I("<div class=media-editor__stickers-set-thumb>"),ga=I("<div class=media-editor__stickers-grid-item>"),pa=I("<div class=media-editor__label>"),Et=I("<div class=media-editor__stickers-grid>"),_a=I("<div class=media-editor__stickers-recent-button>"),wa=I("<div class=media-editor__stickers-thumb-list-scrollable><div class=media-editor__stickers-thumb-list>"),Ca=I("<div class=media-editor__sticker-search>"),ya=I("<div class=media-editor__label data-set-id=recent>");function xa(){const{wrapStickerSetThumb:e,EmoticonsSearch:t}=ln(),i=X(),{container:n,scrollAmount:a}=dn(Ht),{managers:r,editorState:o,mediaState:h,actions:u}=i,c=$t(),[s]=Lt(()=>r.appStickersManager.getRecentStickersStickers()),[l]=Lt(()=>r.appStickersManager.getAllStickers()),[d,f]=U(),[p,m]=U(""),[C,y]=U(),[w,v]=U("recent"),[x,$]=U(!1),[k,M]=U(),[b,_]=U(),g=new cn,T=new xn({regularLazyLoadQueue:g,group:"none",managers:r,intersectionObserverInit:{root:n()},withLock:!1});te(()=>{T.destroy(),g.clear()});async function E(L){v(String(L)),$(!0),n()?.querySelector(`[data-set-id="${L}"]`)?.scrollIntoView({behavior:"smooth",block:"start"}),await ke(1e3),$(!1)}function H(L){let P;ve(()=>{const F=ft();e({container:P,group:"none",autoplay:!0,width:30,height:30,lazyLoadQueue:g,middleware:F.get(),set:L.set,managers:r,textColor:"white"})});const R=()=>String(L.set.id)===w();return(()=>{const F=va();F.$$click=()=>E(String(L.set.id));const G=P;return typeof G=="function"?O(G,F):P=F,j(()=>F.classList.toggle("media-editor__stickers-set-thumb--active",!!R())),F})()}function z(L){let P;ve(()=>{T.renderSticker(L.doc,P),T.observeAnimated(P)});function R(){const F=i.resizableLayersSeed++,G=o.finalTransform,se={id:F,position:c([o.canvasSize[0]/2,o.canvasSize[1]/2]),rotation:-G.rotation,scale:1/G.scale,type:"sticker",sticker:L.doc};pe(()=>{h.resizableLayers.push(se),o.selectedResizableLayer=F,u.pushToHistory({path:["resizableLayers",h.resizableLayers.length-1],newValue:se,oldValue:mt.RemoveArrayItem,findBy:{id:se.id}})})}return(()=>{const F=ga();F.$$click=R;const G=P;return typeof G=="function"?O(G,F):P=F,F})()}function q(L){let P;return D(()=>{k()&&(k().observe(P),te(()=>{k()?.unobserve(P)}))}),(()=>{const R=pa(),F=P;return typeof F=="function"?O(F,R):P=R,B(R,()=>fn(L.set.title)),j(()=>he(R,"data-set-id",L.set.id)),R})()}function K(L){const[P]=Lt(()=>r.appStickersManager.getStickerSet(Sn(L.set)));return S(Me,{get when(){return P()},get children(){return[S(Fe,{amount:"16px"}),S(q,{get set(){return L.set}}),(()=>{const R=Et();return B(R,S(We,{get each(){return P().documents},children:F=>S(z,{doc:F})})),R})()]}})}function Z(){let L;ve(()=>{document.querySelector(".media-editor__tabs")?.append(L),new un(L)}),te(()=>{L.remove()});const P=()=>l()&&!d();return(()=>{const R=wa(),F=R.firstChild,G=L;return typeof G=="function"?O(G,R):L=R,B(F,S(Me,{get when(){return s()?.length},get children(){const se=_a();return se.$$click=()=>E("recent"),B(se,S(ut,{icon:"recent"})),j(()=>se.classList.toggle("media-editor__stickers-recent-button--active",w()==="recent")),se}}),null),B(F,S(We,{get each(){return l()?.sets},children:se=>S(H,{set:se})}),null),j(se=>{const A=!P(),le=a()>8;return A!==se._v$&&R.classList.toggle("media-editor__stickers-thumb-list-scrollable--hidden",se._v$=A),le!==se._v$2&&R.classList.toggle("media-editor__stickers-thumb-list-scrollable--has-scroll",se._v$2=le),se},{_v$:void 0,_v$2:void 0}),R})(),[]}return D(()=>{M(new IntersectionObserver(L=>{L.forEach(P=>{if(!x()&&P.isIntersecting){const R=P.target.dataset.setId;R&&v(R)}})},{root:n(),rootMargin:`0px 0px -${n().clientHeight-100}px 0px`})),te(()=>{k()?.disconnect()})}),D(()=>{k()&&b()&&(k().observe(b()),te(()=>{k()?.unobserve(b())}))}),D(async()=>{if(p()){f(await r.appStickersManager.searchStickers(p()));return}if(C()){const L=C();if(L._==="emojiGroupPremium"){f(await r.appStickersManager.getPremiumStickers());return}f(await r.appStickersManager.getStickersByEmoticon({emoticon:L.emoticons,includeServerStickers:!0}));return}!C()&&!p()&&f()}),[S(Z,{}),S(Fe,{get amount(){return d()?"0px":"48px"}}),S(Fe,{amount:"8px"}),(()=>{const L=Ca();return B(L,S(t,{type:"stickers",onValue:P=>{m(P)},onGroup:P=>{y(P)},categoryColor:"white",animatedItemGroup:"none"})),L})(),S(Fe,{amount:"16px"}),S(Me,{get when(){return fe(()=>s()?.length>0)()&&!d()},get children(){return[(()=>{const L=ya();return O(_,L),B(L,()=>oe("MediaEditor.RecentlyUsed")),L})(),(()=>{const L=Et();return B(L,S(We,{get each(){return s()},children:P=>S(z,{doc:P})})),L})()]}}),S(Me,{get when(){return d()},get children(){const L=Et();return B(L,S(We,{get each(){return d()},children:P=>S(z,{doc:P})})),L}}),S(Me,{get when(){return fe(()=>!!l())()&&!d()},get children(){return S(We,{get each(){return l().sets},children:L=>S(K,{set:L})})}})]}He(["click"]);const Sa=I("<div class=media-editor__toggle-button>"),ba=I("<div class=media-editor__toggle-group-row><div class=media-editor__toggle-group></div><div class=media-editor__toggle-group>"),$a=I("<div class=media-editor__label>");function Ma(){const{editorState:e}=X(),[t,i]=at("media-editor-text-color","#ffffff");e.currentTextLayerInfo.color=t().value,D(()=>{hn(()=>e.currentTextLayerInfo).color=t().value});function n(u){e.currentTextLayerInfo.size=u}function a(u){e.currentTextLayerInfo.alignment=u}function r(u){e.currentTextLayerInfo.style=u}const o=(u,c,s,l)=>(()=>{const d=Sa();return d.$$click=()=>l(c),B(d,S(ut,{icon:u})),j(()=>d.classList.toggle("media-editor__toggle-button--active",c===s())),d})();ve(()=>{document.querySelectorAll(".media-editor__toggle-button").forEach(u=>{Qe(u)})});const h=(u,c)=>S(qt,{get active(){return e.currentTextLayerInfo.font===c},onClick:()=>void(e.currentTextLayerInfo.font=c),get style(){return{"font-family":ct[c].fontFamily,"font-weight":ct[c].fontWeight}},children:u});return[S(Oi,{get value(){return e.currentTextLayerInfo.color},onChange:i,get previousColor(){return t().previous},get colorKey(){return(e.selectedResizableLayer??"")+""}}),(()=>{const u=ba(),c=u.firstChild,s=c.nextSibling;return B(c,()=>o("align_left","left",()=>e.currentTextLayerInfo.alignment,a),null),B(c,()=>o("align_center","center",()=>e.currentTextLayerInfo.alignment,a),null),B(c,()=>o("align_right","right",()=>e.currentTextLayerInfo.alignment,a),null),B(s,()=>o("fontframe","normal",()=>e.currentTextLayerInfo.style,r),null),B(s,()=>o("fontframe_outline","outline",()=>e.currentTextLayerInfo.style,r),null),B(s,()=>o("fontframe_bg","background",()=>e.currentTextLayerInfo.style,r),null),u})(),S(St,{get label(){return oe("MediaEditor.Size")},min:16,max:64,get value(){return e.currentTextLayerInfo.size},onChange:n,passiveLabel:!0,get color(){return e.currentTextLayerInfo.color}}),S(Fe,{amount:"16px"}),(()=>{const u=$a();return B(u,()=>oe("MediaEditor.Font")),u})(),fe(()=>h(oe("MediaEditor.Fonts.Roboto"),"roboto")),fe(()=>h(oe("MediaEditor.Fonts.SuezOne"),"suez")),fe(()=>h(oe("MediaEditor.Fonts.FugazOne"),"fugaz")),fe(()=>h(oe("MediaEditor.Fonts.CourierPrime"),"courier")),fe(()=>h(oe("MediaEditor.Fonts.Chewy"),"chewy")),fe(()=>h(oe("MediaEditor.Fonts.Sedan"),"sedan")),fe(()=>h(oe("MediaEditor.Fonts.RubikBubbles"),"bubbles")),fe(()=>h(oe("MediaEditor.Fonts.Playwrite"),"playwrite"))]}He(["click"]);const Ta=I("<div class=media-editor__topbar><div class=media-editor__topbar-title></div><div class=media-editor__topbar-history-controls></div><div class=media-editor__topbar-done>");function ka(e){const{hasModifications:t,mediaState:i,editorState:n}=X();let a;function r(u,c){pe(()=>{const s=u.pop();s&&(c.push({...s,path:s.path,newValue:s.oldValue,oldValue:s.newValue}),$n(s,i),n.selectedResizableLayer=void 0)})}function o(){r(i.history,i.redoHistory)}function h(){r(i.redoHistory,i.history)}return ve(()=>{Qe(a);const u=bn(["Ctrl+KeyZ","Ctrl+Shift+KeyZ","Ctrl+KeyY"],c=>{c==="Ctrl+KeyZ"?o():h()});te(()=>u())}),(()=>{const u=Ta(),c=u.firstChild,s=c.nextSibling,l=s.nextSibling;B(u,S(tt,{icon:"cross",get onClick(){return e.onClose}}),c),B(c,()=>oe("Edit")),B(s,S(tt,{get disabled(){return!i.history.length},onClick:o,icon:"undo"}),null),B(s,S(tt,{get disabled(){return!i.redoHistory.length},onClick:h,icon:"redo"}),null),l.$$click=()=>{t()&&e.onFinish()};const d=a;return typeof d=="function"?O(d,l):a=l,B(l,()=>oe("Done")),j(()=>l.classList.toggle("media-editor__topbar-done--disabled",!t())),u})()}He(["click"]);const La=I("<div class=media-editor__toolbar><div class=media-editor__toolbar-draggable>");function Pa(e){let t;const{editorState:i,actions:n}=X(),[a,r]=U(0),[o,h]=U(!1),[u,c]=U(),[s,l]=U(0),[d,f]=U(0),p=Qt(),[m,C]=U(p());let y=0,w=!0,v=!1,x=!1;function $(){v||(v=!0,y=0,w=!0,Te(a(),0,200,r),setTimeout(()=>{v=!1},200))}n.abortDrawerSlide=()=>$(),ve(()=>{function b(T){p()&&(y=T,w=!1,x=!1,setTimeout(()=>{x=!0},100))}function _(T){if(!p()||w||!x)return;const E=T-y;o()?r(Math.min(Math.max(-s(),E),0)):r(Math.max(Math.min(s(),E),0))}function g(){p()&&(w||(w=!0,Math.abs(a())>100?h(T=>!T):$()))}u().addEventListener("input",()=>{$()}),t.addEventListener("touchstart",T=>{b(T.touches[0].clientY)}),t.addEventListener("touchmove",T=>{_(T.touches[0].clientY)}),t.addEventListener("touchend",T=>{g()}),t.addEventListener("mousedown",T=>{b(T.clientY)}),t.addEventListener("mousemove",T=>{_(T.clientY)}),t.addEventListener("mouseup",T=>{g()}),t.addEventListener("mouseout",T=>{g()})}),D(()=>{const b=new ResizeObserver(()=>{l(u()?.clientHeight||0)});b.observe(u()),te(()=>b.disconnect())}),D(we(o,()=>{const b=a(),_=d(),g=o()?s():0;Te(0,1,200,T=>{pe(()=>{r(De(b,0,T)),f(De(_,g,T))})})})),D(()=>{i.currentTab!=="crop"&&h(!1)}),D(()=>{i.renderingPayload&&m()&&(async()=>(t.style.transition=".2s",await dt(),C(!1),await ke(200),t.style.removeProperty("transition")))()});const k=()=>d()+a(),M=me(()=>{if(p())return{opacity:i.isAdjusting?0:1,transform:m()?"translate(-50%, 100%)":`translate(-50%, ${k()}px)`}});return(()=>{const b=La();b.firstChild;const _=t;return typeof _=="function"?O(_,b):t=b,B(b,S(ka,{onClose:()=>e.onClose(),get onFinish(){return e.onFinish}}),null),B(b,S(ua,{}),null),B(b,S(ma,{onContainer:c,onScroll:()=>{$()},tabs:{adjustments:()=>S(ko,{}),crop:()=>S(la,{}),text:()=>S(Ma,{}),brush:()=>S(Ko,{}),stickers:()=>S(xa,{})}}),null),j(g=>Ae(b,M(),g)),b})()}const Ba=I('<div class="media-editor__overlay night"><div class=media-editor__container>');function Ia(e){const t=Mn(e),{editorState:i,hasModifications:n}=t;let a,r=!1;function o(){r||(ni.isDarkOverlayActive=!1,r=!0)}ve(()=>{(async()=>(a.classList.add("media-editor__overlay--hidden"),await dt(),a.focus(),a.classList.remove("media-editor__overlay--hidden")))();const s={type:"popup",onPop:()=>u()};ii.pushItem(s),ni.isDarkOverlayActive=!0,te(()=>{o(),ii.removeItem(s)})}),D(()=>{i.imageCanvas&&(async()=>(await e.onCanvasReady(i.imageCanvas),i.isReady=!0))()}),D(()=>{i.renderingPayload&&e.onImageRendered()});async function h(s=!1){a.classList.add("media-editor__overlay--hidden"),await ke(200),e.onClose(s)}function u(s=!1,l=!1){if(s||!n()){h(l);return}return kn({title:oe("MediaEditor.DiscardChanges"),description:oe("MediaEditor.DiscardWarning"),button:{text:oe("Discard")}}).then(()=>h(),()=>{}),!1}let c=!1;return S(Tn.Provider,{value:t,get children(){const s=Ba(),l=s.firstChild,d=a;return typeof d=="function"?O(d,s):a=s,B(l,()=>{const f=Ge(async()=>{if(c)return;c=!0;const p=await _o().finally(()=>{c=!1});o(),e.onEditFinish(p),u(!0,p.isVideo)});return[S(so,{}),S(Pa,{onClose:u,onFinish:f}),S(Co,{onClick:f})]}),s}})}function Gi(e,t){const i=document.createElement("div");document.body.append(i);const n=mn(()=>S(t,{get children(){return S(Ia,jt(e,{onClose:a}))}}),i);function a(r){e.onClose(r),n(),i.remove()}}function ns({source:e,rect:t,animatedCanvasSize:i,...n}){const a=Ra({animatedCanvasSize:i,rect:t,source:e});Gi({...n,onCanvasReady:async r=>{const o=r.getBoundingClientRect();await a.animateToNewCenter(o)},onImageRendered:async()=>{await ji(a.imageCanvas)}},Pi)}function rs({source:e,animatedCanvasSize:t,...i}){let n;Gi({...i,onCanvasReady:async a=>{const r=a.getBoundingClientRect();n=Ui({rect:Aa(t,r),source:e,animatedCanvasSize:t}),await Ea(n.imageCanvas)},onImageRendered:async()=>{n&&await ji(n.imageCanvas)}},Pi)}function Ra({rect:e,source:t,animatedCanvasSize:i}){const{imageCanvas:n,centerLeft:a,centerTop:r}=Ui({rect:e,source:t,animatedCanvasSize:i}),[o,h]=i;async function u(c){const s=c.left+c.width/2,l=c.top+c.height/2,d=s-a,f=l-r,[p,m]=_e(o/h,c.width,c.height);await n.animate({transform:`translate(calc(-50% + ${d}px), calc(-50% + ${f}px))`,width:`${p}px`,height:`${m}px`},{duration:200,fill:"forwards",easing:"ease-in-out"}).finished}return{imageCanvas:n,animateToNewCenter:u}}function Ui({source:e,rect:t,animatedCanvasSize:i}){const n=document.createElement("canvas");[n.width,n.height]=i,n.getContext("2d").drawImage(e,0,0,n.width,n.height),n.style.position="fixed";const r=t.left+t.width/2,o=t.top+t.height/2,h=t.width,u=t.height;return n.style.left=r+"px",n.style.top=o+"px",n.style.width=h+"px",n.style.height=u+"px",n.style.transform="translate(-50%, -50%)",n.style.objectFit="cover",n.style.zIndex="1000",document.body.append(n),{centerLeft:r,centerTop:o,imageCanvas:n}}async function Ea(e){await e.animate({opacity:[0,1]},{duration:200,fill:"forwards",easing:"ease-in-out"}).finished}async function ji(e){await e.animate({opacity:[1,0]},{duration:400,fill:"forwards",easing:"ease-in"}).finished,e.remove()}function Aa(e,t){const[i,n]=e,[a,r]=_e(i/n,t.width,t.height),o=t.left+t.width/2-a/2,h=t.top+t.height/2-r/2;return{left:o,top:h,width:a,height:r}}export{ns as openMediaEditorFromMedia,rs as openMediaEditorFromMediaNoAnimation};
//# sourceMappingURL=index-bVyJ_plG.js.map
