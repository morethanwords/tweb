import{ey as oe,t as M,i as k,a1 as D,C as J,a0 as B,a as v,a4 as V,b as s,bv as de,a9 as W,a6 as A,c as H,ad as me,a5 as ge,cG as he,a8 as pe,ag as Se,df as fe,bw as Z,a3 as ee,dh as te,ac as N,ek as K,a2 as X,h as g,bu as _e}from"./index-D0ltjU_3.js";import{u as se}from"./actions-xL_n1ltU.js";import{v as ve,x as ae,R as F,y as Y,r as be}from"./appDialogsManager-hCo96X2k.js";import{S as Pe}from"./staticSwitch-DdiNhFTd.js";import{S as U}from"./space-BwTSUo7z.js";import{I as ne}from"./iconTsx-CrfVj0-p.js";import{L as ce,c as ye}from"./lottieAnimation-DESF7pFr.js";import{T as ke}from"./chatBackground-BVOXamyC.js";import"./page-l29LwOU7.js";import"./avatar-FYMWPUck.js";import"./putPreloader-BC_lZu-w.js";import"./classNames-D5xjt_0R.js";import"./htmlToSpan-DhAls8qz.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./textToSvgURL-Cnw_Q8Rw.js";import"./fastBlur-Co-79rP4.js";import"./countryInputField-CZmznp_V.js";import"./codeInputField-Bj4-k1J7.js";const Ce="_Container_1qplo_1",Le="_KeysContainer_1qplo_7",we="_KeyButton_1qplo_13",Ee="_selected_1qplo_35",Te="_KeyButtonFirst_1qplo_53",$e="_KeyButtonLast_1qplo_57",Be="_PlusIcon_1qplo_62",Me="_TargetKey_1qplo_67",T={Container:Ce,KeysContainer:Le,KeyButton:we,selected:Ee,KeyButtonFirst:Te,KeyButtonLast:$e,PlusIcon:Be,TargetKey:Me};var Re=M("<span>"),Ke=M("<div><div></div><div>"),xe=M("<button>");const Q=["Ctrl","Alt","Shift","Meta"],Oe=n=>{const d=oe(()=>n.value,(a,l)=>l.includes(a)),b=a=>a==="Meta"?s(ne,{icon:de?"mac_command_key":"win_key"}):(()=>{var l=Re();return k(l,a),l})(),C=a=>{if(n.value.includes(a)){const l=n.value.filter(h=>h!==a);if(!l.length){const h=[0,1,2,3].filter(e=>e!==Q.indexOf(a));l.push(Q[h[Math.floor(Math.random()*h.length)]])}n.onChange(l)}else n.onChange([...n.value,a])};return(()=>{var a=Ke(),l=a.firstChild,h=l.nextSibling;return k(l,()=>Q.map((e,i,P)=>(()=>{var f=xe();return f.$$click=C,f.$$clickData=e,D(J,f,()=>!0),k(f,()=>b(e)),B(t=>{var m=T.KeyButton,u={[T.selected]:d(e),[T.KeyButtonFirst]:i===0,[T.KeyButtonLast]:i===P.length-1};return m!==t.e&&v(f,t.e=m),t.t=V(f,u,t.t),t},{e:void 0,t:void 0}),f})())),k(a,s(ne,{get class(){return T.PlusIcon},icon:"plus"}),h),k(h,()=>n.key),B(e=>{var i=T.Container,P={[n.class]:!!n.class},f=T.KeysContainer,t=T.TargetKey;return i!==e.e&&v(a,e.e=i),e.t=V(a,P,e.t),f!==e.a&&v(l,e.a=f),t!==e.o&&v(h,e.o=t),e},{e:void 0,t:void 0,a:void 0,o:void 0}),a})()};W(["click"]);const De="_Overlay_deagn_36",Ae="_Value_deagn_45",He="_Select_deagn_52",Ie="_SelectClip_deagn_63",qe="_Option_deagn_75",Fe="_selected_deagn_87",R={Overlay:De,Value:Ae,Select:He,SelectClip:Ie,Option:qe,selected:Fe};var Ne=M("<div>"),Ve=M("<div><div><div>"),Ue=M("<div><span>");const ze=n=>{let d;const b=A(()=>n.options.find(t=>t.value===n.value)?.label),[C,a]=H();me(()=>{a(b()())});const l=oe(()=>n.value),[h,e]=H();ge(()=>{const t=new Z;t.add(window)("resize",()=>{n.isOpen&&n.onClose?.()}),ee(()=>{t.removeAll()})});const i=(t,m)=>{const u=t.firstElementChild,r=u.querySelector(`.${R.selected}`);if(!r||!u)return;const c=d.getBoundingClientRect(),p=u.getBoundingClientRect(),S=r.getBoundingClientRect(),y=S.top-p.top,L=y+S.height,I=y+S.height/2,z=c.left+c.width/2;let w=c.top+c.height/2-I;const O=w+p.height>window.innerHeight||w<0;if(O&&(w+=Math.max(0,-w)+Math.min(0,window.innerHeight-(w+p.height))),u.style.setProperty("--x",""+z),u.style.setProperty("--y",""+w),u.animate({opacity:[0,1]},{duration:120}).finished.then(()=>{O&&m()}),O)return;const q=Math.max(y,p.height-L),G=E=>`polygon(0% ${y-E}px, 100% ${y-E}px, 100% ${L+E}px, 0px ${L+E}px)`;Se(0,q,400,E=>{u.style.setProperty("clip-path",G(E))},{easing:fe,onEnd:()=>{u.style.removeProperty("clip-path"),m()}})},P=async(t,m)=>{await t.firstElementChild.animate({opacity:[1,0]},{duration:120}).finished,m()},f=t=>{const m=[n.parent,h()];if(!m.every(Boolean))return;m.every(r=>{const c=r.getBoundingClientRect();return Math.max(c.left-t.clientX,t.clientX-c.right,c.top-t.clientY,t.clientY-c.bottom)>100})&&n.onClose?.()};return[(()=>{var t=Ne(),m=d;return typeof m=="function"?D(m,t):d=t,k(t,C),B(()=>v(t,R.Value)),t})(),s(pe,{get children(){return s(ke,{appear:!0,onEnter:i,onExit:P,get children(){return A(()=>!!n.isOpen)()&&(()=>{var t=Ve(),m=t.firstChild,u=m.firstChild;return t.$$mousemove=f,t.$$click=r=>{r.stopPropagation(),n.onClose?.()},D(e,u),k(u,s(he,{get each(){return n.options},children:r=>(()=>{var c=Ue(),p=c.firstChild;return c.$$click=n.onChange,c.$$clickData=r.value,D(J,c,()=>!0),k(p,()=>r.label()),B(S=>{var y=R.Option,L={[R.selected]:l(r.value)};return y!==S.e&&v(c,S.e=y),S.t=V(c,L,S.t),S},{e:void 0,t:void 0}),c})()})),B(r=>{var c=R.Overlay,p=R.SelectClip,S=R.Select;return c!==r.e&&v(t,r.e=c),p!==r.t&&v(m,r.t=p),S!==r.a&&v(u,r.a=S),r},{e:void 0,t:void 0,a:void 0}),t})()}})}})]};W(["click","mousemove"]);const Ge="_MainDescription_1pm2o_36",Qe="_FirstSection_1pm2o_44",Xe="_Row_1pm2o_49",Ye="_ShortcutBuilderRow_1pm2o_54",je="_ShortcutBuilderRowChild_1pm2o_60",Je="_collapsed_1pm2o_63",We="_Hint_1pm2o_68",$={MainDescription:Ge,FirstSection:Qe,Row:Xe,ShortcutBuilderRow:Ye,ShortcutBuilderRowChild:je,collapsed:Je,Hint:We};var ie=M("<div>"),Ze=M('<div><button class="btn-primary btn-color-primary btn-large">');const j=(n,d)=>({appendTo:n.scrollable.container,duration:2500,from:"bottom",textElement:g(d),icon:"premium_lock",class:$.Hint,canCloseOnPeerChange:!1}),bt=()=>{const{rootScope:n}=te(),d=ve(),[b,{mutate:C}]=N(()=>{const e=n.managers.appStateManager.getState().then(i=>i.settings?.passcode?.enabled||!1);return d.collect(e),e}),[a,l]=H(!1),h=new Z;return h.add(n)("settings_updated",({key:e,value:i})=>{e===K("settings","passcode","enabled")&&C(i)}),ee(()=>{h.removeAll()}),s(X,{get when(){return b.state==="ready"},get children(){return A(()=>!!(b()||a()))()?s(tt,{onDisable:()=>l(!0)}):s(et,{})}})},et=()=>{const[n,{AppPasscodeEnterPasswordTab:d,AppPasscodeLockTab:b}]=ae(),{enablePasscode:C}=se(),{setQuizHint:a}=te(),l=()=>{n.slider.createTab(d).open({onSubmit:e=>{h(e),e=""},buttonText:"PasscodeLock.Next",inputLabel:"PasscodeLock.EnterAPasscode"})},h=e=>{n.slider.createTab(d).open({onSubmit:async(i,P)=>{if(i!==e)throw{};await C(i),i="",P.slider.sliceTabsUntilTab(b,P),P.close(),a(j(n,"PasscodeLock.PasscodeHasBeenSet"))},buttonText:"PasscodeLock.SetPasscode",inputLabel:"PasscodeLock.ReEnterPasscode"})};return s(Y,{caption:"PasscodeLock.Notice",get children(){return[s(ce,{name:"UtyanPasscode"}),(()=>{var e=ie();return k(e,()=>g("PasscodeLock.Description")),B(()=>v(e,$.MainDescription)),e})(),s(U,{amount:"0.5rem"}),(()=>{var e=Ze(),i=e.firstChild;return i.$$click=l,D(J,i,()=>!0),k(i,()=>g("PasscodeLock.TurnOn")),B(()=>v(e,ye.AdditionalPadding)),e})(),s(U,{amount:"1rem"})]}})},tt=n=>{const[d,{AppPasscodeEnterPasswordTab:b,AppPasscodeLockTab:C,AppPrivacyAndSecurityTab:a}]=ae(),{disablePasscode:l,changePasscode:h}=se(),{rootScope:e,setQuizHint:i}=te(),P=[{value:0,label:()=>g("PasscodeLock.Disabled")},{value:1,label:()=>g("MinutesShort",[1])},{value:5,label:()=>g("MinutesShort",[5])},{value:10,label:()=>g("MinutesShort",[10])},{value:15,label:()=>g("MinutesShort",[15])},{value:30,label:()=>g("MinutesShort",[30])}],[f,t]=H(),[m,u]=H(!1),[r,{mutate:c}]=N(()=>e.managers.appStateManager.getState().then(o=>o?.settings?.passcode?.autoLockTimeoutMins||0)),[p,{mutate:S}]=N(()=>e.managers.appStateManager.getState().then(o=>o?.settings?.passcode?.lockShortcutEnabled||!1)),[y,{mutate:L}]=N(()=>e.managers.appStateManager.getState().then(o=>o?.settings?.passcode?.lockShortcut||[])),I=new Z;I.add(e)("settings_updated",({key:o,value:_})=>{o===K("settings","passcode","lockShortcut")?L(_):o===K("settings","passcode","lockShortcutEnabled")?S(_):o===K("settings","passcode","autoLockTimeoutMins")&&c(_)});function z(o){L(o),e.managers.appStateManager.setByKey(K("settings","passcode","lockShortcut"),o)}function w(o){S(o),e.managers.appStateManager.setByKey(K("settings","passcode","lockShortcutEnabled"),o)}function O(o){c(o),e.managers.appStateManager.setByKey(K("settings","passcode","autoLockTimeoutMins"),o)}ee(()=>{I.removeAll()});const q=()=>!_e&&y.state==="ready"&&p.state==="ready",G=()=>{d.slider.createTab(b).open({onSubmit:o=>{E(o),o=""},buttonText:"PasscodeLock.Next",inputLabel:"PasscodeLock.EnterAPasscode"},"PasscodeLock.EnterANewPasscode")},E=o=>{d.slider.createTab(b).open({onSubmit:async(_,x)=>{if(_!==o)throw{};await h(_),_="",x.slider.sliceTabsUntilTab(C,x),x.close(),i(j(d,"PasscodeLock.PasscodeHasBeenChanged"))},buttonText:"PasscodeLock.SetPasscode",inputLabel:"PasscodeLock.ReEnterPasscode"},"PasscodeLock.ReEnterPasscode")},re=()=>{be({title:g("PasscodeLock.TurnOff.Title"),description:g("PasscodeLock.TurnOff.Description"),button:{text:g("PasscodeLock.TurnOff"),isDanger:!0}}).then(async()=>{n.onDisable(),await l(),d.close(),i(j(d.slider.getTab(a),"PasscodeLock.PasscodeHasBeenDisabled"))}).catch(()=>{})},le=[A(()=>g("PasscodeLock.Description")),s(U,{amount:"1rem"}),A(()=>g("PasscodeLock.Notice"))];return[s(Y,{get class(){return $.FirstSection},caption:le,get children(){return[s(ce,{name:"UtyanPasscode"}),s(U,{amount:"1.125rem"}),s(F,{get title(){return g("PasscodeLock.TurnOff.Title")},icon:"lockoff",clickable:re}),s(F,{get title(){return g("PasscodeLock.ChangePasscode")},icon:"key",clickable:G})]}}),s(Y,{get caption(){return q()?"PasscodeLock.LockShortcutDescription":void 0},get children(){return[s(X,{get when(){return r.state==="ready"},get children(){return s(F,{ref:t,get classList(){return{[$.Row]:!0}},get title(){return g("PasscodeLock.AutoLock")},get rightContent(){return s(ze,{get value(){return r()},onClose:()=>u(!1),options:P,onChange:O,get isOpen(){return m()},get parent(){return f()}})},clickable:()=>{u(!0)}})}}),s(X,{get when(){return q()},get children(){return[s(F,{get title(){return g("PasscodeLock.EnableLockShortcut")},get classList(){return{[$.Row]:!0}},get rightContent(){return s(Pe,{get checked(){return p()}})},clickable:o=>{w(!p())}}),(()=>{var o=ie();return k(o,s(Oe,{get class(){return $.ShortcutBuilderRowChild},get value(){return y()||[]},onChange:z,key:"L"})),B(_=>{var x=$.ShortcutBuilderRow,ue={[$.collapsed]:!p()};return x!==_.e&&v(o,_.e=x),_.t=V(o,ue,_.t),_},{e:void 0,t:void 0}),o})()]}})]}})]};W(["click"]);export{bt as default};
//# sourceMappingURL=mainTab-r1K3Q7ri.js.map
