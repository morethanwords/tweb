const __vite__fileDeps=["./pageEmailRecover-DCbQ2YLA.js","./index-CKohjhry.js","./index-D9mZOx4v.css","./page-rjQSrWOg.js","./emailSetup-W0kjvZWV.js","./classNames-CN4lTu6a.js","./iconTsx-DOiJm1ci.js","./transition-DN2xTdXy.js","./emailSetup-Cdnpduwy.css","./loginPage-Dksl0PzQ.js","./putPreloader-BgEVPg6_.js","./htmlToSpan-DhAls8qz.js","./toast-D_LJQErt.js","./pageSignIn-B9WvFxQ2.js","./pageSignQR-C9Mglp0F.js","./textToSvgURL-Cnw_Q8Rw.js","./countryInputField-B_vmakRK.js","./pageIm-D9_S5lhC.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{d as i,B as R,q as b,P as k,k as v,_ as f,h as S,m as E,u as I,j as K,w as T,v as F,x as N}from"./index-CKohjhry.js";import{p as M}from"./putPreloader-BgEVPg6_.js";import{P as x}from"./page-rjQSrWOg.js";import{L as D,S as u}from"./loginPage-Dksl0PzQ.js";import{h as C}from"./htmlToSpan-DhAls8qz.js";import{a as O,w as W,f as V,t as _}from"./toast-D_LJQErt.js";import z from"./pageSignIn-B9WvFxQ2.js";import"./pageSignQR-C9Mglp0F.js";import"./textToSvgURL-Cnw_Q8Rw.js";import"./countryInputField-B_vmakRK.js";let n,r;const j=()=>{const w=new D({className:"page-password",withInputWrapper:!0,titleLangKey:"Login.Password.Title",subtitleLangKey:"Login.Password.Subtitle"}),o=R("btn-primary btn-color-primary"),s=new b.IntlElement({key:"Login.Next"});o.append(s.element);const t=new k({label:"LoginPassword",name:"password"});n=t.input;let g=!1;const y=v("ForgotPassword",[O(()=>{g||(g=!0,i.managers.passwordManager.requestRecovery().then(e=>f(()=>import("./pageEmailRecover-DCbQ2YLA.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),import.meta.url).then(a=>{a.default.mount({email_pattern:e.email_pattern})})).catch(async e=>{if(e.type==="PASSWORD_RECOVERY_NA"){await u.show({titleLangKey:"Login.ResetPassword.Title",descriptionLangKey:"Login.ResetPassword.NoEmailText",button:{langKey:"Login.ResetPassword.ResetAccount",isDanger:!0}}),await u.show({titleLangKey:"Login.ResetAccount.Title",descriptionLangKey:"Login.ResetAccount.Text",button:{langKey:"Login.ResetPassword.ResetAccount",isDanger:!0}}),await i.managers.apiManager.invokeApi("account.deleteAccount",{reason:"Forgot password"}).then(()=>{z.mount()}).catch(a=>{if(a.type==="2FA_RECENT_CONFIRM")u.show({titleLangKey:"Login.ResetAccountFail.Title",descriptionLangKey:"Login.ResetAccountFail.TextCancelled",button:{langKey:"OK"}});else if(a.type.startsWith("2FA_CONFIRM_WAIT_")){const p=+a.type.replace("2FA_CONFIRM_WAIT_","");u.show({titleLangKey:"Login.ResetAccountFail.Title",descriptionLangKey:"Login.ResetAccountFail.TextWait",descriptionArgs:[W(V(p))],button:{langKey:"OK"}})}else console.error(a),_({langPackKey:"Error.AnError"})});return}_({langPackKey:"Error.AnError"})}).finally(()=>{g=!1}))})]);y.classList.add("forgot-link"),w.inputWrapper.append(t.container,y,o);let d;const m=()=>(d||(d=window.setInterval(m,1e4)),i.managers.passwordManager.getState().then(e=>{l=e,l.hint?K(t.label,C(T(l.hint))):t.setLabel()}));let l;const L=e=>{if(e&&F(e),!n.value.length){n.classList.add("error");return}const a=N([n,o],!0),p=n.value;s.update({key:"PleaseWait"});const h=M(o);t.setValueSilently(""+Math.random()),t.setValueSilently(p),i.managers.passwordManager.check(p,l).then(c=>{switch(c._){case"auth.authorization":clearInterval(d),f(()=>import("./pageIm-D9_S5lhC.js"),__vite__mapDeps([17,1,2,3]),import.meta.url).then(P=>{P.default.mount()}),r&&r.remove();break;default:o.removeAttribute("disabled"),s.update({key:c._}),h.remove();break}}).catch(c=>{switch(a(),t.input.classList.add("error"),c.type){default:s.update({key:"PASSWORD_HASH_INVALID"}),n.select();break}h.remove(),m()})};S(o,L),n.addEventListener("keypress",function(e){if(this.classList.remove("error"),s.update({key:"Login.Next"}),e.key==="Enter")return L()});const A=E.isMobile?100:166;return r=new I(t,A),w.imageDiv.append(r.container),Promise.all([r.load(),m()])},Z=new x("page-password",!0,j,()=>{r?.load()},()=>{n.focus(),i.managers.appStateManager.pushToState("authState",{_:"authStatePassword"})});export{Z as default};
//# sourceMappingURL=pagePassword-D2-Wkvij.js.map
