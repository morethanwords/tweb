{"version":3,"file":"useFlagFilters-Cndz2Rln.js","sources":["../src/helpers/solid/createSetSignal.ts","../src/components/sidebarRight/tabs/adminRecentActions/constants.ts","../src/components/sidebarRight/tabs/adminRecentActions/heightTransition.tsx","../src/components/sidebarRight/tabs/adminRecentActions/filters/expandableFilterGroup.tsx","../src/components/sidebarRight/tabs/adminRecentActions/filters/flagFilters.tsx","../src/components/sidebarRight/tabs/adminRecentActions/filters/config.ts","../src/components/sidebarRight/tabs/adminRecentActions/filters/useFlagFilters.ts"],"sourcesContent":["import {createSignal} from 'solid-js';\n\nexport const createSetSignal = <T, >(initialValue = new Set<T>()) => createSignal(initialValue, {\n  equals: (prev, next) => prev.size === next.size && [...prev].every(id => next.has(id))\n});\n","export const limitPeerTitleSymbols = 32;\n","import {createEffect, createSignal, ParentProps} from 'solid-js';\nimport {Transition} from 'solid-transition-group';\nimport {animate} from '@helpers/animation';\nimport liteMode from '@helpers/liteMode';\n\n\ntype HeightTransitionProps = {\n  onRunningAnimations?: (value: number) => void;\n  scale?: boolean;\n};\n\nconst transitionTime = 240;\n\nexport const HeightTransition = (props: ParentProps<HeightTransitionProps>) => {\n  const [runningAnimations, setRunningAnimations] = createSignal(0);\n\n  const increase = () => setRunningAnimations(prev => prev + 1);\n  const decrease = () => setRunningAnimations(prev => prev - 1);\n\n  createEffect(() => {\n    if(!props.onRunningAnimations) return;\n    props.onRunningAnimations(runningAnimations());\n  });\n\n  return (\n    <Transition\n      onBeforeEnter={increase}\n      onAfterEnter={decrease}\n      onBeforeExit={increase}\n      onAfterExit={decrease}\n\n      onEnter={async(_el, done) => {\n        const el = _el as HTMLElement;\n        el.style.height = '0px';\n        el.style.opacity = '0';\n\n        animate(() => {\n          const targetHeight = el.scrollHeight;\n          el.animate([\n            {height: '0px', opacity: 0, ...(props.scale && {transform: 'scale(0.95)', transformOrigin: '75% center'})},\n            {height: `${targetHeight}px`, opacity: 1, ...(props.scale && {transform: 'scale(1)'})}\n          ], {\n            duration: liteMode.isAvailable('animations') ? transitionTime : 0,\n            easing: 'ease-in-out'\n          }).finished\n          .then(() => {\n            el.style.removeProperty('height');\n            el.style.removeProperty('opacity');\n\n            done();\n          });\n        });\n      }}\n\n      onExit={async(el, done) => {\n        animate(() => {\n          el.animate([\n            {height: `${el.scrollHeight}px`, opacity: 1},\n            {height: '0px', opacity: 0}\n          ], {\n            duration: liteMode.isAvailable('animations') ? transitionTime : 0,\n            fill: 'forwards',\n            easing: 'ease-in-out'\n          }).finished.then(done);\n        });\n      }}\n    >\n      {props.children}\n    </Transition>\n  );\n};\n","import {Accessor, createMemo, createSignal, For, JSX, Show} from 'solid-js';\nimport {keepMe} from '@helpers/keepMe';\nimport CheckboxFieldTsx from '@components/checkboxFieldTsx';\nimport {IconTsx} from '@components/iconTsx';\nimport ripple from '@components/ripple';\nimport {HeightTransition} from '@components/sidebarRight/tabs/adminRecentActions/heightTransition';\nimport styles from '@components/sidebarRight/tabs/adminRecentActions/filters/expandableFilterGroup.module.scss';\n\nkeepMe(ripple);\n\n\ntype Item = {\n  checked: Accessor<boolean>;\n  label: JSX.Element;\n  onClick: () => void;\n};\n\ntype ExpandableFilterGroupProps = {\n  mainLabel: JSX.Element;\n  onMainCheckboxClick: () => void;\n  checkedCount: number;\n  items: Item[];\n};\n\nexport const ExpandableFilterGroup = (props: ExpandableFilterGroupProps) => {\n  const [isExpanded, setIsExpanded] = createSignal(false);\n\n  const isMainChecked = createMemo(() => props.items.every(item => item.checked()));\n\n  const onMainCheckboxClick = (e: MouseEvent) => {\n    e.stopPropagation();\n    props.onMainCheckboxClick();\n  };\n\n  return (\n    <>\n      <div class={`${styles.Row} hover-effect rp`} use:ripple onClick={() => setIsExpanded(!isExpanded())}>\n        <div class={styles.RowCheckboxWrapper} onClick={onMainCheckboxClick}>\n          <CheckboxFieldTsx class={styles.RowCheckbox} checked={isMainChecked()} />\n          <div class={styles.RowCheckboxClickArea} />\n        </div>\n        <div class={styles.RowSeparator} />\n        <div class={styles.RowLabel}>\n          {props.mainLabel}\n          <div class={styles.Count}>\n            {props.checkedCount}/{props.items.length}\n            <IconTsx class={styles.CountArrow} classList={{[styles.toggled]: isExpanded()}} icon='arrowhead' />\n          </div>\n        </div>\n      </div>\n\n      <HeightTransition>\n        <Show when={isExpanded()}>\n          <div class={styles.ExpandedItems}>\n            <For each={props.items}>\n              {item => (\n                <div class={`${styles.Row} hover-effect rp`} use:ripple onClick={item.onClick}>\n                  <div class={styles.RowOffset} />\n                  <div class={styles.RowCheckboxWrapper}>\n                    <CheckboxFieldTsx class={styles.RowCheckbox} checked={item.checked()} />\n                  </div>\n                  <div class={styles.RowLabel}>\n                    {item.label}\n                  </div>\n                </div>\n              )}\n            </For>\n          </div>\n        </Show>\n      </HeightTransition>\n    </>\n  )\n};\n","import {For, Show} from 'solid-js';\nimport {I18nTsx} from '@helpers/solid/i18n';\nimport {useHotReloadGuard} from '@lib/solidjs/hotReloadGuard';\nimport Button from '@components/buttonTsx';\nimport Scrollable from '@components/scrollable2';\nimport SimpleFormField from '@components/simpleFormField';\nimport Space from '@components/space';\nimport {limitPeerTitleSymbols} from '@components/sidebarRight/tabs/adminRecentActions/constants';\nimport {ExpandableFilterGroup} from '@components/sidebarRight/tabs/adminRecentActions/filters/expandableFilterGroup';\nimport styles from '@components/sidebarRight/tabs/adminRecentActions/filters/flagFilters.module.scss';\nimport {CommittedFilters} from '@components/sidebarRight/tabs/adminRecentActions/filters/types';\nimport {useFlagFilters} from '@components/sidebarRight/tabs/adminRecentActions/filters/useFlagFilters';\n\n\nexport const FlagFilters = (props: {\n  hasSearch?: boolean;\n\n  inputRef?: (input: HTMLInputElement) => void;\n\n  onCommit: (committedFilters: CommittedFilters) => void;\n  onReset: () => void;\n\n  filtersControls: ReturnType<typeof useFlagFilters>;\n}) => {\n  const {PeerTitleTsx} = useHotReloadGuard();\n\n  const filtersControls = () => props.filtersControls;\n\n  const onCommit = () => {\n    props.onCommit(filtersControls().getCommittedReady());\n  };\n\n  const onSubmit = (e: Event) => {\n    e.preventDefault();\n    onCommit();\n  };\n\n  return <>\n    <Show when={props.hasSearch}>\n      <Space amount='2px' />\n\n      <form class={styles.Search} onSubmit={onSubmit}>\n        <SimpleFormField value={filtersControls().search()} onChange={filtersControls().onSearchChange}>\n          <SimpleFormField.Label><I18nTsx key='Search' /></SimpleFormField.Label>\n          <SimpleFormField.Input ref={/* @once */props.inputRef} />\n        </SimpleFormField>\n      </form>\n\n      <Space amount='1rem' />\n    </Show>\n\n    <Scrollable class={styles.Scrollable} withBorders='both' relative>\n      <div class={styles.SectionTitle}>\n        <I18nTsx key='AdminRecentActionsFilters.ByType' />\n      </div>\n      <For each={filtersControls().filterGroupsConfig()}>\n        {group => (\n          <ExpandableFilterGroup\n            mainLabel={<I18nTsx key={group.i18nKey} />}\n            checkedCount={filtersControls().flagGroupCheckCount(group)}\n            onMainCheckboxClick={() => filtersControls().onFlagGroupClick(group)}\n            items={group.items.map(item => ({\n              checked: () => filtersControls().isFlagSelected(item.pFlag),\n              label: <I18nTsx key={item.i18nKey} />,\n              onClick: () => filtersControls().onFlagClick(item.pFlag)\n            }))}\n          />\n        )}\n      </For>\n      <Space amount='1rem' />\n      <div class={styles.SectionTitle}>\n        <I18nTsx key='AdminRecentActionsFilters.ByAdmin' />\n      </div>\n      <Show when={filtersControls().adminIds().length}>\n        <ExpandableFilterGroup\n          mainLabel={<I18nTsx key='AdminRecentActionsFilters.ShowAllAdminActions' />}\n          checkedCount={filtersControls().selectedAdminIds().size}\n          onMainCheckboxClick={filtersControls().onAllAdminsClick}\n          items={filtersControls().adminIds().map(userId => ({\n            checked: () => filtersControls().isAdminIdSelected(userId.toPeerId()),\n            label: <PeerTitleTsx peerId={userId.toPeerId()} limitSymbols={limitPeerTitleSymbols} />,\n            onClick: () => filtersControls().onAdminClick(userId.toPeerId())\n          }))}\n        />\n      </Show>\n      <Show when={filtersControls().notShowingAdmins()}>\n        <div class={styles.SectionTitle}>\n          <I18nTsx key='AdminRecentActionsFilters.NotShowingAdmins' args={[filtersControls().notShowingAdmins() + '']} />\n        </div>\n      </Show>\n\n    </Scrollable>\n\n    <Space amount='1rem' />\n\n    <div class={styles.Footer}>\n      <Button class={styles.Button} primary onClick={props.onReset}>\n        <I18nTsx key='AdminRecentActionsFilters.ResetFilters' />\n      </Button>\n      <Button class={styles.Button} primaryFilled onClick={onCommit}>\n        <I18nTsx key='AdminRecentActionsFilters.ApplyFilters' />\n      </Button>\n    </div>\n  </>\n};\n","import {ChannelAdminLogEventsFilter} from '@layer';\nimport {LangPackKey} from '@lib/langPack';\n\n\nexport type FilterGroupConfigItem = {\n  i18nKey: LangPackKey;\n  items: {\n    pFlag: keyof ChannelAdminLogEventsFilter['pFlags'];\n    i18nKey: LangPackKey;\n  }[];\n};\n\nexport type GetFilterGroupsConfigArgs = {\n  isBroadcast?: boolean;\n};\n\nexport function getFilterGroupsConfig({isBroadcast}: GetFilterGroupsConfigArgs): FilterGroupConfigItem[] {\n  return [\n    {\n      i18nKey: 'AdminRecentActionsFilters.MembersAndAdmins',\n      items: [\n        {\n          pFlag: 'join',\n          i18nKey: 'AdminRecentActionsFilters.NewMembers'\n        },\n        {\n          pFlag: 'leave',\n          i18nKey: isBroadcast ? 'AdminRecentActionsFilters.MembersLeftChannel' : 'AdminRecentActionsFilters.MembersLeftGroup'\n        },\n        {\n          pFlag: 'invite',\n          i18nKey: 'AdminRecentActionsFilters.InvitedMembers'\n        },\n        {\n          pFlag: 'ban',\n          i18nKey: 'AdminRecentActionsFilters.BannedMembers'\n        },\n        {\n          pFlag: 'unban',\n          i18nKey: 'AdminRecentActionsFilters.UnbannedMembers'\n        },\n        {\n          pFlag: 'kick',\n          i18nKey: 'AdminRecentActionsFilters.RemovedMembers'\n        },\n        {\n          pFlag: 'unkick',\n          i18nKey: 'AdminRecentActionsFilters.UnkickedMembers'\n        },\n        {\n          pFlag: 'promote',\n          i18nKey: 'AdminRecentActionsFilters.NewAdminRights'\n        },\n        {\n          pFlag: 'demote',\n          i18nKey: 'AdminRecentActionsFilters.RemovedAdminRights'\n        }\n      ]\n    },\n\n    {\n      i18nKey: isBroadcast ? 'AdminRecentActionsFilters.ChannelSettings' : 'AdminRecentActionsFilters.GroupSettings',\n      items: [\n        {\n          pFlag: 'info',\n          i18nKey: isBroadcast ? 'AdminRecentActionsFilters.ChannelInfo' : 'AdminRecentActionsFilters.GroupInfo'\n        },\n        {\n          pFlag: 'settings',\n          i18nKey: isBroadcast ? 'AdminRecentActionsFilters.ChannelSettings' : 'AdminRecentActionsFilters.GroupSettings'\n        },\n        {\n          pFlag: 'invites',\n          i18nKey: 'AdminRecentActionsFilters.InviteLinks'\n        },\n        {\n          pFlag: 'group_call',\n          i18nKey: 'AdminRecentActionsFilters.GroupCall'\n        },\n        {\n          pFlag: 'forums',\n          i18nKey: 'AdminRecentActionsFilters.Forums'\n        },\n        {\n          pFlag: 'sub_extend',\n          i18nKey: 'AdminRecentActionsFilters.SubscriptionExtensions'\n        }\n      ]\n    },\n\n    {\n      i18nKey: 'AdminRecentActionsFilters.Messages',\n      items: [\n        {\n          pFlag: 'send',\n          i18nKey: 'AdminRecentActionsFilters.SentMessages'\n        },\n        {\n          pFlag: 'delete',\n          i18nKey: 'AdminRecentActionsFilters.DeletedMessages'\n        },\n        {\n          pFlag: 'edit',\n          i18nKey: 'AdminRecentActionsFilters.EditedMessages'\n        },\n        {\n          pFlag: 'pinned',\n          i18nKey: 'AdminRecentActionsFilters.PinnedMessages'\n        }\n      ]\n    }\n  ];\n}\n","import {Accessor, createMemo, createResource, createSelector, createSignal} from 'solid-js';\nimport {createStore, reconcile} from 'solid-js/store';\nimport {createSetSignal} from '@helpers/solid/createSetSignal';\nimport {useHotReloadGuard} from '@lib/solidjs/hotReloadGuard';\nimport {FilterGroupConfigItem, getFilterGroupsConfig} from '@components/sidebarRight/tabs/adminRecentActions/filters/config';\nimport {CommittedFilters} from '@components/sidebarRight/tabs/adminRecentActions/filters/types';\n\n\ntype UseFlagFiltersArgs = {\n  channelId: Accessor<ChatId>;\n  isBroadcast: Accessor<boolean>;\n};\n\nconst adminsFetchLimit = 40; // Have more admins? I'm really sorry :)\n\nexport function useFlagFilters({channelId, isBroadcast}: UseFlagFiltersArgs) {\n  const {rootScope} = useHotReloadGuard();\n\n  const filterGroupsConfig = createMemo(() => getFilterGroupsConfig({isBroadcast: isBroadcast()}));\n\n  const getAllFlagKeys = () => filterGroupsConfig().flatMap(group => group.items.map(item => item.pFlag));\n\n  const getInitialFlagsStore = () => {\n    const keys = getAllFlagKeys();\n    return Object.fromEntries(keys.map(key => [key, true]));\n  };\n\n  const [adminsResource] = createResource(channelId, (id) =>\n    rootScope.managers.appProfileManager.getChannelParticipants({\n      id,\n      filter: {_: 'channelParticipantsAdmins'},\n      offset: 0,\n      limit: adminsFetchLimit\n    })\n  );\n\n  const [search, setSearch] = createSignal('');\n  const [selectedFlagsStore, setSelectedFlagsStore] = createStore(getInitialFlagsStore());\n  const [selectedAdminIds, setSelectedAdminIds] = createSetSignal<PeerId>();\n\n  const adminIds = createMemo(() =>\n    // [...Array.from({length: 20}).flatMap(() => [...adminsResource()?.participants || []])]\n    adminsResource()?.participants\n    ?.filter(item => 'user_id' in item)\n    .map(item => item.user_id) || []\n  );\n\n  const notShowingAdmins = createMemo(() => {\n    if(!adminsResource()) return null;\n\n    const length = adminIds().length;\n    const count = adminsResource().count || length;\n    return count - length > 0 ? count - length : null;\n  });\n\n  const allAdminPeerIds = createMemo(() =>\n    adminIds().map(id => id.toPeerId())\n  );\n\n  const isAdminIdSelected = createSelector(\n    selectedAdminIds,\n    (id: PeerId, ids) => ids.has(id.toPeerId())\n  );\n\n  const isFlagSelected = (flag: string) => selectedFlagsStore[flag];\n\n  const flagGroupCheckCount = (group: FilterGroupConfigItem) => {\n    return group.items.filter(item => selectedFlagsStore[item.pFlag]).length;\n  };\n\n  const onFlagClick = (flag: string) => {\n    setSelectedFlagsStore(flag, (prev) => !prev);\n  };\n\n  const onFlagGroupClick = (group: FilterGroupConfigItem) => {\n    const areAllChecked = group.items.every(item => selectedFlagsStore[item.pFlag]);\n\n    setSelectedFlagsStore(group.items.map(item => item.pFlag), !areAllChecked);\n  };\n\n  const onAllAdminsClick = () => {\n    const areAllSelected = selectedAdminIds().size === allAdminPeerIds().length;\n    setSelectedAdminIds(areAllSelected ? new Set<number> : new Set(allAdminPeerIds()));\n  };\n\n  const onAdminClick = (id: PeerId) => {\n    const newIds = new Set(selectedAdminIds());\n    if(newIds.has(id.toPeerId())) {\n      newIds.delete(id.toPeerId());\n    } else {\n      newIds.add(id.toPeerId());\n    }\n    setSelectedAdminIds(newIds);\n  };\n\n  const getCommittedReady = () => {\n    const activeFlagEntries = Object.entries(selectedFlagsStore).filter(([, value]) => value);\n\n    const flags = activeFlagEntries.length && activeFlagEntries.length < getAllFlagKeys().length ?\n      Object.fromEntries(activeFlagEntries) :\n      undefined;\n\n    const admins = selectedAdminIds().size < allAdminPeerIds().length ?\n      Array.from(selectedAdminIds()) :\n      undefined;\n\n    if(!search() && !flags && !admins) return null;\n\n    return {\n      search: search() || undefined,\n      flags,\n      admins\n    };\n  };\n\n  const setFromCommittedFilters = (committedFilters?: CommittedFilters | null) => {\n    setSearch(committedFilters?.search || '');\n    setSelectedFlagsStore(reconcile(committedFilters?.flags || getInitialFlagsStore()));\n    setSelectedAdminIds(new Set(committedFilters?.admins || allAdminPeerIds()));\n  };\n\n  return {\n    filterGroupsConfig,\n\n    adminIds,\n    notShowingAdmins,\n\n    setFromCommittedFilters,\n    getCommittedReady,\n\n    search,\n    selectedAdminIds,\n\n    onSearchChange: setSearch,\n    onFlagClick,\n    onFlagGroupClick,\n    onAllAdminsClick,\n    onAdminClick,\n\n    isFlagSelected,\n    isAdminIdSelected,\n    flagGroupCheckCount\n  };\n}\n"],"names":["createSetSignal","initialValue","createSignal","prev","next","id","limitPeerTitleSymbols","transitionTime","HeightTransition","props","runningAnimations","setRunningAnimations","increase","decrease","createEffect","onRunningAnimations","_$createComponent","Transition","onBeforeEnter","onAfterEnter","onBeforeExit","onAfterExit","onEnter","_el","done","el","style","height","opacity","animate","targetHeight","scrollHeight","scale","transform","transformOrigin","duration","liteMode","isAvailable","easing","finished","then","removeProperty","onExit","fill","children","ExpandableFilterGroup","isExpanded","setIsExpanded","isMainChecked","createMemo","items","every","item","checked","onMainCheckboxClick","e","stopPropagation","_el$","_tmpl$","_el$2","firstChild","_el$3","_el$4","nextSibling","_el$5","_el$6","_el$7","$$click","_$use","ripple","_$insert","CheckboxFieldTsx","styles","RowCheckbox","mainLabel","checkedCount","length","IconTsx","CountArrow","classList","toggled","icon","_$effect","_p$","_v$","Row","_v$2","RowCheckboxWrapper","_v$3","RowCheckboxClickArea","_v$4","RowSeparator","_v$5","RowLabel","_v$6","Count","_$className","undefined","Show","when","_el$8","_tmpl$2","For","each","_el$9","_tmpl$3","_el$10","_el$11","_el$12","_$addEventListener","onClick","label","_v$7","_v$8","RowOffset","_v$9","_v$10","ExpandedItems","_$delegateEvents","FlagFilters","PeerTitleTsx","useHotReloadGuard","filtersControls","onCommit","getCommittedReady","onSubmit","preventDefault","hasSearch","Space","amount","addEventListener","SimpleFormField","value","search","onChange","onSearchChange","Label","I18nTsx","key","Input","ref","r$","_ref$","inputRef","Search","Scrollable","withBorders","relative","SectionTitle","filterGroupsConfig","group","i18nKey","flagGroupCheckCount","onFlagGroupClick","map","isFlagSelected","pFlag","onFlagClick","adminIds","selectedAdminIds","size","onAllAdminsClick","userId","isAdminIdSelected","toPeerId","peerId","limitSymbols","onAdminClick","notShowingAdmins","args","Button","primary","onReset","primaryFilled","Footer","getFilterGroupsConfig","isBroadcast","adminsFetchLimit","useFlagFilters","channelId","rootScope","getAllFlagKeys","getInitialFlagsStore","keys","adminsResource","createResource","setSearch","selectedFlagsStore","setSelectedFlagsStore","createStore","setSelectedAdminIds","count","allAdminPeerIds","createSelector","ids","committedFilters","reconcile","activeFlagEntries","flags","admins","flag","areAllChecked","areAllSelected","newIds"],"mappings":"mgBAEO,MAAMA,GAAkB,CAAMC,MAAmB,MAAaC,EAAaD,EAAc,CAC9F,OAAQ,CAACE,EAAMC,IAASD,EAAK,OAASC,EAAK,MAAQ,CAAC,GAAGD,CAAI,EAAE,SAAYC,EAAK,IAAIC,CAAE,CAAC,CACvF,CAAC,ECJYC,GAAwB,GCW/BC,EAAiB,IAEVC,GAAoBC,GAA8C,CAC7E,KAAM,CAACC,EAAmBC,CAAoB,EAAIT,EAAa,CAAC,EAE1DU,EAAWA,IAAMD,EAAqBR,GAAQA,EAAO,CAAC,EACtDU,EAAWA,IAAMF,EAAqBR,GAAQA,EAAO,CAAC,EAE5DW,OAAAA,EAAa,IAAM,CACbL,EAAMM,qBACVN,EAAMM,oBAAoBL,EAAiB,CAAE,CAC/C,CAAC,EAEDM,EACGC,GAAU,CACTC,cAAeN,EACfO,aAAcN,EACdO,aAAcR,EACdS,YAAaR,EAEbS,QAAS,MAAMC,EAAKC,IAAS,CAC3B,MAAMC,EAAKF,EACXE,EAAGC,MAAMC,OAAS,MAClBF,EAAGC,MAAME,QAAU,IAEnBC,EAAQ,IAAM,CACZ,MAAMC,EAAeL,EAAGM,aACxBN,EAAGI,QAAQ,CACT,CAACF,OAAQ,MAAOC,QAAS,EAAG,GAAInB,EAAMuB,OAAS,CAACC,UAAW,cAAeC,gBAAiB,YAAa,CAAC,EACzG,CAACP,OAAS,GAAEG,CAAa,KAAKF,QAAS,EAAG,GAAInB,EAAMuB,OAAS,CAACC,UAAW,UAAW,CAAC,CAAC,EACrF,CACDE,SAAUC,EAASC,YAAY,YAAY,EAAI9B,EAAiB,EAChE+B,OAAQ,aACV,CAAC,EAAEC,SACFC,KAAK,IAAM,CACVf,EAAGC,MAAMe,eAAe,QAAQ,EAChChB,EAAGC,MAAMe,eAAe,SAAS,EAEjCjB,GACF,CAAC,CACH,CAAC,CACF,EAEDkB,OAAQ,MAAMjB,EAAID,IAAS,CACzBK,EAAQ,IAAM,CACZJ,EAAGI,QAAQ,CACT,CAACF,OAAS,GAAEF,EAAGM,YAAa,KAAKH,QAAS,CAAC,EAC3C,CAACD,OAAQ,MAAOC,QAAS,CAAC,CAAC,EAC1B,CACDO,SAAUC,EAASC,YAAY,YAAY,EAAI9B,EAAiB,EAChEoC,KAAM,WACNL,OAAQ,aACT,CAAA,EAAEC,SAASC,KAAKhB,CAAI,CACvB,CAAC,CACF,EAAA,IAAAoB,UAAA,CAAA,OAEAnC,EAAMmC,QAAQ,CAAA,CAAA,CAGrB,ujBC9CaC,EAAyBpC,GAAsC,CAC1E,KAAM,CAACqC,EAAYC,CAAa,EAAI7C,EAAa,EAAK,EAEhD8C,EAAgBC,EAAW,IAAMxC,EAAMyC,MAAMC,MAAMC,GAAQA,EAAKC,QAAS,CAAA,CAAC,EAE1EC,EAAuBC,GAAkB,CAC7CA,EAAEC,gBAAe,EACjB/C,EAAM6C,oBAAmB,GAG3B,MAAA,EAAA,IAAA,CAAA,MAAAG,EAAAC,GAAA,EAAAC,EAAAF,EAAAG,WAAAC,EAAAF,EAAAC,WAAAE,EAAAH,EAAAI,YAAAC,EAAAF,EAAAC,YAAAE,EAAAD,EAAAJ,WAAAM,EAAAD,EAAAL,WAAAH,OAAAA,EAAAU,QAEqE,IAAMpB,EAAc,CAACD,EAAY,CAAA,EAACsB,EAAlDC,EAAMZ,EAAA,IAAA,EAAA,EAAAE,EAAAQ,QACLb,EAAmBgB,EAAAX,EAAA3C,EAChEuD,EAAgB,CAAA,IAAA,OAAA,CAAA,OAAQC,EAAOC,WAAW,EAAA,IAAEpB,SAAO,CAAA,OAAEL,EAAa,CAAE,CAAA,CAAA,EAAAa,CAAA,EAAAS,EAAAN,EAAA,IAKpEvD,EAAMiE,UAAST,CAAA,EAAAK,EAAAL,EAAA,IAEbxD,EAAMkE,aAAYT,CAAA,EAAAI,EAAAL,EAAA,IAAGxD,EAAMyC,MAAM0B,OAAM,IAAA,EAAAN,EAAAL,EAAAjD,EACvC6D,GAAO,CAAA,IAAA,OAAA,CAAA,OAAQL,EAAOM,UAAU,EAAA,IAAEC,WAAS,CAAA,MAAE,CAAC,CAACP,EAAOQ,OAAO,EAAGlC,EAAW,EAAE,EAAEmC,KAAI,WAAA,CAAA,EAAA,IAAA,EAAAC,EAAAC,GAAA,CAAA,MAAAC,EAV7E,GAAEZ,EAAOa,GAAI,mBAAiBC,EAC7Bd,EAAOe,mBAAkBC,EAEvBhB,EAAOiB,qBAAoBC,EAE7BlB,EAAOmB,aAAYC,EACnBpB,EAAOqB,SAAQC,EAEbtB,EAAOuB,MAAKX,OAAAA,IAAAD,EAAAC,KAAAY,EAAAvC,EAAA0B,EAAAC,IAAAA,CAAA,EAAAE,IAAAH,EAAAG,MAAAU,EAAArC,EAAAwB,EAAAG,KAAAA,CAAA,EAAAE,IAAAL,EAAAK,MAAAQ,EAAAnC,EAAAsB,EAAAK,KAAAA,CAAA,EAAAE,IAAAP,EAAAO,MAAAM,EAAAlC,EAAAqB,EAAAO,KAAAA,CAAA,EAAAE,IAAAT,EAAAS,MAAAI,EAAAhC,EAAAmB,EAAAS,KAAAA,CAAA,EAAAE,IAAAX,EAAAW,MAAAE,EAAA/B,EAAAkB,EAAAW,KAAAA,CAAA,EAAAX,CAAA,EAAA,CAAAC,IAAAa,OAAAX,KAAAW,OAAAT,KAAAS,OAAAP,KAAAO,OAAAL,KAAAK,OAAAH,KAAAG,MAAA,CAAA,EAAAxC,IAAAzC,EAAAA,EAO3BR,GAAgB,CAAA,IAAAoC,UAAA,CAAA,OAAA5B,EACdkF,EAAI,CAAA,IAACC,MAAI,CAAA,OAAErD,EAAU,CAAE,EAAA,IAAAF,UAAA,CAAA,MAAAwD,EAAAC,KAAA/B,OAAAA,EAAA8B,EAAApF,EAEnBsF,EAAG,CAAA,IAACC,MAAI,CAAA,OAAE9F,EAAMyC,KAAK,EAAAN,SACnBQ,IAAI,IAAA,CAAA,MAAAoD,EAAAC,GAAA,EAAAC,EAAAF,EAAA5C,WAAA+C,EAAAD,EAAA3C,YAAA6C,EAAAD,EAAA5C,YAAA8C,OAAAA,EAAAL,EAC8DpD,QAAAA,EAAK0D,QAAO,EAAA,EAAA1C,EAA5BC,EAAMmC,EAAA,IAAA,EAAA,EAAAlC,EAAAqC,EAAA3F,EAGlDuD,EAAgB,CAAA,IAAA,OAAA,CAAA,OAAQC,EAAOC,WAAW,EAAA,IAAEpB,SAAO,CAAA,OAAED,EAAKC,SAAS,CAAA,CAAA,CAAA,EAAAiB,EAAAsC,EAGnExD,IAAAA,EAAK2D,KAAK,EAAA7B,EAAAC,GAAA,CAAA,MAAA6B,EANF,GAAExC,EAAOa,GAAI,mBAAiB4B,EAC7BzC,EAAO0C,UAASC,EAChB3C,EAAOe,mBAAkB6B,EAGzB5C,EAAOqB,SAAQmB,OAAAA,IAAA7B,EAAA6B,MAAAhB,EAAAQ,EAAArB,EAAA6B,KAAAA,CAAA,EAAAC,IAAA9B,EAAA8B,MAAAjB,EAAAU,EAAAvB,EAAA8B,KAAAA,CAAA,EAAAE,IAAAhC,EAAAgC,MAAAnB,EAAAW,EAAAxB,EAAAgC,KAAAA,CAAA,EAAAC,IAAAjC,EAAAiC,OAAApB,EAAAY,EAAAzB,EAAAiC,MAAAA,CAAA,EAAAjC,CAAA,EAAA,CAAA6B,KAAAf,OAAAgB,KAAAhB,OAAAkB,KAAAlB,OAAAmB,MAAAnB,MAAA,CAAA,EAAAO,CAAA,GAAA,CAI9B,CAAA,CAAA,EAAAtB,MAAAc,EAAAI,EAZO5B,EAAO6C,aAAa,CAAA,EAAAjB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAmB1C,EAAEkB,EAAA,CAAA,OAAA,CAAA,0NC1DWC,GAAe9G,GAStB,CACJ,KAAM,CAAC+G,aAAAA,CAAa,EAAGC,EAAiB,EAElCC,EAAkBA,IAAMjH,EAAMiH,gBAE9BC,EAAWA,IAAM,CACrBlH,EAAMkH,SAASD,IAAkBE,kBAAmB,CAAA,GAGhDC,EAAYtE,GAAa,CAC7BA,EAAEuE,eAAc,EAChBH,KAGF,MAAA3G,CAAAA,EACGkF,EAAI,CAAA,IAACC,MAAI,CAAA,OAAE1F,EAAMsH,SAAS,EAAA,IAAAnF,UAAA,CAAA,MAAA5B,CAAAA,EACxBgH,EAAK,CAACC,OAAM,KAAA,CAAA,GAAA,IAAA,CAAA,MAAAxE,EAAAC,KAAAD,OAAAA,EAAAyE,iBAAA,SAEyBL,CAAQ,EAAAvD,EAAAb,EAAAzC,EAC3CmH,EAAe,CAAA,IAACC,OAAK,CAAA,OAAEV,EAAe,EAAGW,QAAQ,EAAA,IAAEC,UAAQ,CAAA,OAAEZ,EAAiB,EAACa,cAAc,EAAA,IAAA3F,UAAA,CAAA,MAAA,CAAA5B,EAC3FmH,EAAgBK,MAAK,CAAA,IAAA5F,UAAA,CAAA,OAAA5B,EAAEyH,EAAO,CAACC,IAAG,QAAA,CAAA,CAAA,CAAA,CAAA,EAAA1H,EAClCmH,EAAgBQ,MAAK,CAAAC,IAAAC,EAAA,CAAA,MAAAC,EAAiBrI,EAAMsI,SAAQ,OAAAD,GAAAA,WAAAA,EAAAD,CAAA,EAAdpI,EAAMsI,SAAQF,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAA3D,MAAAc,EAAAvC,EAH5Ce,EAAOwE,MAAM,CAAA,EAAAvF,IAAAzC,EAAAA,EAOzBgH,EAAK,CAACC,OAAM,MAAA,CAAA,CAAA,CAAA,EAAAjH,EAAAA,EAGdiI,GAAU,CAAA,IAAA,OAAA,CAAA,OAAQzE,EAAOyE,UAAU,EAAEC,YAAW,OAAQC,SAAQ,GAAA,IAAAvG,UAAA,CAAA,MAAA,EAAA,IAAA,CAAA,MAAAe,EAAA0C,IAAA/B,OAAAA,EAAAX,EAAA3C,EAE5DyH,EAAO,CAACC,IAAG,kCAAA,CAAA,CAAA,EAAAxD,MAAAc,EAAArC,EADFa,EAAO4E,YAAY,CAAA,EAAAzF,IAAA3C,EAAAA,EAG9BsF,EAAG,CAAA,IAACC,MAAI,CAAA,OAAEmB,EAAe,EAAG2B,oBAAoB,EAAAzG,SAC9C0G,GAAKtI,EACH6B,EAAqB,CAAA,IACpB6B,WAAS,CAAA,OAAA1D,EAAGyH,EAAO,CAAA,IAACC,KAAG,CAAA,OAAEY,EAAMC,OAAO,CAAA,CAAA,CAAA,EAAA,IACtC5E,cAAY,CAAA,OAAE+C,EAAiB,EAAC8B,oBAAoBF,CAAK,CAAC,EAC1DhG,oBAAqBA,IAAMoE,IAAkB+B,iBAAiBH,CAAK,EAAC,IACpEpG,OAAK,CAAA,OAAEoG,EAAMpG,MAAMwG,IAAItG,IAAS,CAC9BC,QAASA,IAAMqE,EAAe,EAAGiC,eAAevG,EAAKwG,KAAK,EAC1D7C,MAAK/F,EAAGyH,EAAO,CAAA,IAACC,KAAG,CAAA,OAAEtF,EAAKmG,OAAO,EAAI,EACrCzC,QAASA,IAAMY,EAAe,EAAGmC,YAAYzG,EAAKwG,KAAK,CACxD,EAAC,CAAC,CAAA,CAAA,EAEN5I,EAAAA,EAEFgH,EAAK,CAACC,OAAM,MAAA,CAAA,GAAA,IAAA,CAAA,MAAApE,EAAAwC,IAAA/B,OAAAA,EAAAT,EAAA7C,EAEVyH,EAAO,CAACC,IAAG,mCAAA,CAAA,CAAA,EAAAxD,MAAAc,EAAAnC,EADFW,EAAO4E,YAAY,CAAA,EAAAvF,IAAA7C,EAAAA,EAG9BkF,EAAI,CAAA,IAACC,MAAI,CAAA,OAAEuB,EAAiB,EAACoC,SAAU,EAAClF,MAAM,EAAA,IAAAhC,UAAA,CAAA,OAAA5B,EAC5C6B,EAAqB,CAAA,IACpB6B,WAAS,CAAA,OAAA1D,EAAGyH,EAAO,CAACC,IAAG,+CAAA,CAAA,CAAA,EAAA,IACvB/D,cAAY,CAAA,OAAE+C,EAAiB,EAACqC,iBAAkB,EAACC,IAAI,EAAA,IACvD1G,qBAAmB,CAAA,OAAEoE,EAAiB,EAACuC,gBAAgB,EAAA,IACvD/G,OAAK,CAAA,OAAEwE,EAAe,EAAGoC,WAAWJ,IAAIQ,IAAW,CACjD7G,QAASA,IAAMqE,EAAiB,EAACyC,kBAAkBD,EAAOE,SAAQ,CAAE,EACpErD,MAAK/F,EAAGwG,EAAY,CAAA,IAAC6C,QAAM,CAAA,OAAEH,EAAOE,UAAU,EAAEE,aAAchK,GAAyB,EACvFwG,QAASA,IAAMY,EAAiB,EAAC6C,aAAaL,EAAOE,SAAQ,CAAE,CAChE,EAAC,CAAC,CAAA,CAAA,CAAA,EAAApJ,EAAAA,EAGNkF,EAAI,CAAA,IAACC,MAAI,CAAA,OAAEuB,EAAe,EAAG8C,kBAAkB,EAAA,IAAA5H,UAAA,CAAA,MAAAkB,EAAAuC,IAAA/B,OAAAA,EAAAR,EAAA9C,EAE3CyH,EAAO,CAACC,IAAG,6CAAA,IAA8C+B,MAAI,CAAA,MAAE,CAAC/C,EAAiB,EAAC8C,iBAAkB,EAAG,EAAE,CAAC,CAAA,CAAA,CAAA,EAAAtF,MAAAc,EAAAlC,EADjGU,EAAO4E,YAAY,CAAA,EAAAtF,CAAA,CAAA,CAAA,CAAA,CAAA,EAAA9C,EAAAA,EAOlCgH,EAAK,CAACC,OAAM,MAAA,CAAA,GAAA,IAAA,CAAA,MAAAjE,EAAAqC,IAAA/B,OAAAA,EAAAN,EAAAhD,EAGV0J,EAAM,CAAA,IAAA,OAAA,CAAA,OAAQlG,EAAOkG,MAAM,EAAEC,QAAO,GAAA,IAAC7D,SAAO,CAAA,OAAErG,EAAMmK,OAAO,EAAA,IAAAhI,UAAA,CAAA,OAAA5B,EACzDyH,EAAO,CAACC,IAAG,wCAAA,CAAA,CAAA,CAAA,CAAA,EAAA,IAAA,EAAApE,EAAAN,EAAAhD,EAEb0J,EAAM,CAAA,IAAA,OAAA,CAAA,OAAQlG,EAAOkG,MAAM,EAAEG,cAAa,GAAC/D,QAASa,EAAQ,IAAA/E,UAAA,CAAA,OAAA5B,EAC1DyH,EAAO,CAACC,IAAG,wCAAA,CAAA,CAAA,CAAA,CAAA,EAAA,IAAA,EAAAxD,MAAAc,EAAAhC,EALJQ,EAAOsG,MAAM,CAAA,EAAA9G,CAAA,GAAA,CAAA,CAS7B,ECxFgB,SAAA+G,GAAsB,CAAC,YAAAC,GAAkE,CAChG,MAAA,CACL,CACE,QAAS,6CACT,MAAO,CACL,CACE,MAAO,OACP,QAAS,sCACX,EACA,CACE,MAAO,QACP,QAASA,EAAc,+CAAiD,4CAC1E,EACA,CACE,MAAO,SACP,QAAS,0CACX,EACA,CACE,MAAO,MACP,QAAS,yCACX,EACA,CACE,MAAO,QACP,QAAS,2CACX,EACA,CACE,MAAO,OACP,QAAS,0CACX,EACA,CACE,MAAO,SACP,QAAS,2CACX,EACA,CACE,MAAO,UACP,QAAS,0CACX,EACA,CACE,MAAO,SACP,QAAS,8CACX,CACF,CACF,EAEA,CACE,QAASA,EAAc,4CAA8C,0CACrE,MAAO,CACL,CACE,MAAO,OACP,QAASA,EAAc,wCAA0C,qCACnE,EACA,CACE,MAAO,WACP,QAASA,EAAc,4CAA8C,yCACvE,EACA,CACE,MAAO,UACP,QAAS,uCACX,EACA,CACE,MAAO,aACP,QAAS,qCACX,EACA,CACE,MAAO,SACP,QAAS,kCACX,EACA,CACE,MAAO,aACP,QAAS,kDACX,CACF,CACF,EAEA,CACE,QAAS,qCACT,MAAO,CACL,CACE,MAAO,OACP,QAAS,wCACX,EACA,CACE,MAAO,SACP,QAAS,2CACX,EACA,CACE,MAAO,OACP,QAAS,0CACX,EACA,CACE,MAAO,SACP,QAAS,0CACX,CACF,CACF,CAAA,CAEJ,CCnGA,MAAMC,GAAmB,GAElB,SAASC,GAAe,CAAC,UAAAC,EAAW,YAAAH,GAAkC,CACrE,KAAA,CAAC,UAAAI,GAAa3D,IAEd4B,EAAqBpG,EAAW,IAAM8H,GAAsB,CAAC,YAAaC,EAAA,CAAc,CAAA,CAAC,EAEzFK,EAAiB,IAAMhC,EAAmB,EAAE,QAAQC,GAASA,EAAM,MAAM,IAAIlG,GAAQA,EAAK,KAAK,CAAC,EAEhGkI,EAAuB,IAAM,CACjC,MAAMC,EAAOF,IACN,OAAA,OAAO,YAAYE,EAAK,OAAW,CAAC7C,EAAK,EAAI,CAAC,CAAC,CAAA,EAGlD,CAAC8C,CAAc,EAAIC,EAAeN,EAAY9K,GAClD+K,EAAU,SAAS,kBAAkB,uBAAuB,CAC1D,GAAA/K,EACA,OAAQ,CAAC,EAAG,2BAA2B,EACvC,OAAQ,EACR,MAAO4K,EAAA,CACR,CAAA,EAGG,CAAC5C,EAAQqD,CAAS,EAAIxL,EAAa,EAAE,EACrC,CAACyL,EAAoBC,CAAqB,EAAIC,EAAYP,EAAsB,CAAA,EAChF,CAACvB,EAAkB+B,CAAmB,EAAI9L,GAAwB,EAElE8J,EAAW7G,EAAW,IAE1BuI,EAAe,GAAG,cAChB,OAAepI,GAAA,YAAaA,CAAI,EACjC,IAAIA,GAAQA,EAAK,OAAO,GAAK,CAAC,CAAA,EAG3BoH,EAAmBvH,EAAW,IAAM,CACxC,GAAG,CAACuI,EAAe,EAAU,OAAA,KAEvB,MAAA5G,EAASkF,EAAW,EAAA,OACpBiC,EAAQP,IAAiB,OAAS5G,EACxC,OAAOmH,EAAQnH,EAAS,EAAImH,EAAQnH,EAAS,IAAA,CAC9C,EAEKoH,EAAkB/I,EAAW,IACjC6G,EAAS,EAAE,IAAUzJ,GAAAA,EAAG,UAAU,CAAA,EAG9B8J,EAAoB8B,EACxBlC,EACA,CAAC1J,EAAY6L,IAAQA,EAAI,IAAI7L,EAAG,UAAU,CAAA,EA4DrC,MAAA,CACL,mBAAAgJ,EAEA,SAAAS,EACA,iBAAAU,EAEA,wBAZ+B2B,GAA+C,CACpET,EAAAS,GAAkB,QAAU,EAAE,EACxCP,EAAsBQ,EAAUD,GAAkB,OAASb,EAAA,CAAsB,CAAC,EAClFQ,EAAoB,IAAI,IAAIK,GAAkB,QAAUH,EAAiB,CAAA,CAAC,CAAA,EAU1E,kBAjCwB,IAAM,CACxB,MAAAK,EAAoB,OAAO,QAAQV,CAAkB,EAAE,OAAO,CAAC,CAAG,CAAAvD,CAAK,IAAMA,CAAK,EAElFkE,EAAQD,EAAkB,QAAUA,EAAkB,OAAShB,IAAiB,OACpF,OAAO,YAAYgB,CAAiB,EACpC,OAEIE,EAASxC,IAAmB,KAAOiC,EAAkB,EAAA,OACzD,MAAM,KAAKjC,GAAkB,EAC7B,OAEF,MAAG,CAAC1B,EAAA,GAAY,CAACiE,GAAS,CAACC,EAAe,KAEnC,CACL,OAAQlE,EAAY,GAAA,OACpB,MAAAiE,EACA,OAAAC,CAAA,CACF,EAkBA,OAAAlE,EACA,iBAAA0B,EAEA,eAAgB2B,EAChB,YAhEmBc,GAAiB,CACpCZ,EAAsBY,EAAOrM,GAAS,CAACA,CAAI,CAAA,EAgE3C,iBA7DwBmJ,GAAiC,CACnD,MAAAmD,EAAgBnD,EAAM,MAAM,SAAcqC,EAAmBvI,EAAK,KAAK,CAAC,EAExDwI,EAAAtC,EAAM,MAAM,IAAIlG,GAAQA,EAAK,KAAK,EAAG,CAACqJ,CAAa,CAAA,EA2DzE,iBAxDuB,IAAM,CAC7B,MAAMC,EAAiB3C,EAAmB,EAAA,OAASiC,IAAkB,OACrEF,EAAoBY,EAAqB,IAAA,IAAc,IAAI,IAAIV,EAAiB,CAAA,CAAC,CAAA,EAuDjF,aApDoB3L,GAAe,CACnC,MAAMsM,EAAS,IAAI,IAAI5C,EAAkB,CAAA,EACtC4C,EAAO,IAAItM,EAAG,SAAU,CAAA,EAClBsM,EAAA,OAAOtM,EAAG,SAAU,CAAA,EAEpBsM,EAAA,IAAItM,EAAG,SAAU,CAAA,EAE1ByL,EAAoBa,CAAM,CAAA,EA+C1B,eA3EsBH,GAAiBb,EAAmBa,CAAI,EA4E9D,kBAAArC,EACA,oBA3E2Bb,GACpBA,EAAM,MAAM,OAAOlG,GAAQuI,EAAmBvI,EAAK,KAAK,CAAC,EAAE,MA0ElE,CAEJ"}