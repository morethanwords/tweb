const __vite__fileDeps=["./pageIm-Cq-SheJD.js","./index-e7urbcmo.js","./index-DWEkd1do.css","./page-t2k2t_q4.js","./pageAuthCode-CoQP0vr9.js","./codeInputField-DTPZGpFN.js","./inputField-CZk6V5kQ.js","./putPreloader-BNsGPfVi.js","./pageSignQR-BYVyXESR.js","./textToSvgURL-Cnw_Q8Rw.js","./countryInputField-EEXUnNdb.js","./scrollable-GTY0T0TS.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{b as s,l as P,a as g,i as m,A as E,_ as C,c as A,d as k,e as T,f as x,g as N,h as w,j as M,k as F}from"./index-e7urbcmo.js";import{p as O}from"./putPreloader-BNsGPfVi.js";import{P as V,B as S,r as B}from"./page-t2k2t_q4.js";import{p as U,g as D}from"./pageSignQR-BYVyXESR.js";import{p as W,t as j}from"./inputField-CZk6V5kQ.js";import{C as z,T as H}from"./countryInputField-EEXUnNdb.js";import"./textToSvgURL-Cnw_Q8Rw.js";import"./scrollable-GTY0T0TS.js";let a=null,c;const Q=()=>{const p=document.createElement("div");p.classList.add("input-wrapper");let h,b;const l=new z({onCountryChange:(t,e)=>{h=t,b=e,e&&(o.value=o.lastValue="+"+e.country_code,setTimeout(()=>{u.focus(),W(u,!0)},0))}}),o=new H({onInput:t=>{P.loadLottieWorkers();const{country:e,code:i}=t||{},n=e?e.name||e.default_name:"";n!==l.value&&(!h||!e||!i||h!==e&&b.country_code!==i.country_code)&&l.override(e,i,n),e||o.value.length-1>1?a.style.visibility="":a.style.visibility="hidden"}}),u=o.input;u.addEventListener("keypress",t=>{if(!a.style.visibility&&t.key==="Enter")return L()}),a=S("btn-primary btn-color-primary",{text:"Login.Next"}),a.style.visibility="hidden";const L=t=>{t&&x(t);const e=j([a,c],!0);g(a,m("PleaseWait")),O(a);const i=o.value;s.managers.apiManager.invokeApi("auth.sendCode",{phone_number:i,api_id:E.id,api_hash:E.hash,settings:{_:"codeSettings",pFlags:{}}}).then(async n=>{if(n._==="auth.sentCodeSuccess"){const{authorization:r}=n;r._==="auth.authorization"&&(await s.managers.apiManager.setUser(r.user),C(()=>import("./pageIm-Cq-SheJD.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(f=>{f.default.mount()}))}C(()=>import("./pageAuthCode-CoQP0vr9.js"),__vite__mapDeps([4,1,2,3,5,6,7,8,9,10,11]),import.meta.url).then(r=>r.default.mount(Object.assign(n,{phone_number:i})))}).catch(n=>{switch(e(),n.type){case"PHONE_NUMBER_INVALID":o.setError(),g(o.label,m("Login.PhoneLabelInvalid")),u.classList.add("error"),g(a,m("Login.Next"));break;default:console.error("auth.sendCode error:",n),a.innerText=n.type;break}})};A(a,L),c=S("btn-primary btn-secondary btn-primary-transparent primary",{text:"Login.QR.Login"}),c.addEventListener("click",()=>{U.mount()}),p.append(l.container,o.container,a,c);const y=document.createElement("h4");y.classList.add("text-center"),k(y,"Login.Title");const _=document.createElement("div");_.classList.add("subtitle","text-center"),k(_,"Login.StartText"),$.pageEl.querySelector(".container").append(y,_,p);const I=()=>{s.managers.apiManager.invokeApi("help.getNearestDc").then(t=>{const e=N.getFromCache("langPack");e&&!e.countries?.hash&&w.getLangPack(e.lang_code).then(()=>{o.simulateInputEvent()});const i=new Set([1,2,3,4,5]),n=[t.this_dc];let r;return t.nearest_dc!==t.this_dc&&(r=s.managers.apiManager.getNetworkerVoid(t.nearest_dc).then(()=>{n.push(t.nearest_dc)})),(r||Promise.resolve()).then(()=>{n.forEach(d=>{i.delete(d)});const f=[...i],v=async()=>{const d=f.shift();if(!d)return;if((await M.get(F()))?.[`dc${d}_auth_key`])return v();setTimeout(()=>{s.managers.apiManager.getNetworkerVoid(d).finally(v)},3e3)};v()}),t}).then(t=>{!l.value.length&&!o.value.length&&l.selectCountryByIso2(t.country)})};T||setTimeout(()=>{u.focus()},0),D(p),I()},$=new V("page-sign",!0,Q,()=>{a&&(g(a,m("Login.Next")),B(a,void 0,void 0,!0),a.removeAttribute("disabled")),c&&c.removeAttribute("disabled"),s.managers.appStateManager.pushToState("authState",{_:"authStateSignIn"})});export{$ as default};
//# sourceMappingURL=pageSignIn-Bhp2DguR.js.map
