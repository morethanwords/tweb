const __vite__fileDeps=["./pageIm-74ciJYuA.js","./index-BV2I1Jtp.js","./index-DC1A9Z1P.css","./page-CZapATw0.js","./pageAuthCode-Is0r0roD.js","./tracking-D9iSy3gB.js","./emailSetup-DC47owN0.js","./classNames-CN4lTu6a.js","./iconTsx-WcVB6J0T.js","./transition-RjVzGhLO.js","./emailSetup-Cdnpduwy.css","./wrapDuration-Dbmbo_XD.js","./loginPage-gOyPbqXb.js","./toast-CKjmCNNt.js","./putPreloader-D61QXpkQ.js","./pageSignQR-B3kYd27Y.js","./countryInputField-DRrD4ZDI.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{d as c,y as T,n as x,B as k,x as N,j as m,k as h,A as C,_ as S,h as w,z as P,C as B,D as I,E as F,v as M,F as O,q as V,G as D}from"./index-BV2I1Jtp.js";import{p as U}from"./putPreloader-D61QXpkQ.js";import{P as z}from"./page-CZapATw0.js";import{P as W,p as j,g as q}from"./pageSignQR-B3kYd27Y.js";import{C as H,T as Q}from"./countryInputField-DRrD4ZDI.js";import"./toast-CKjmCNNt.js";let n=null,g,l;const $=()=>{const s=document.createElement("div");s.classList.add("input-wrapper");let y,E;const u=new H({onCountryChange:(t,e)=>{y=t,E=e,e&&(o.value=o.lastValue="+"+e.country_code,setTimeout(()=>{d.focus(),T(d,!0)},0))}}),o=new Q({onInput:t=>{x.loadLottieWorkers();const{country:e,code:i}=t||{},a=e?e.name||e.default_name:"";a!==u.value&&(!y||!e||!i||y!==e&&E.country_code!==i.country_code)&&u.override(e,i,a),e||o.value.length-1>1?n.style.visibility="":n.style.visibility="hidden"}}),d=o.input;d.addEventListener("keypress",t=>{if(!n.style.visibility&&t.key==="Enter")return L()}),n=k("btn-primary btn-color-primary",{text:"Login.Next"}),n.style.visibility="hidden";const L=t=>{t&&M(t);const e=N([n,g,l?.button].filter(Boolean),!0);m(n,h("PleaseWait")),U(n);const i=o.value;c.managers.apiManager.invokeApi("auth.sendCode",{phone_number:i,api_id:C.id,api_hash:C.hash,settings:{_:"codeSettings",pFlags:{}}}).then(async a=>{if(a._==="auth.sentCodeSuccess"){const{authorization:r}=a;r._==="auth.authorization"&&(await c.managers.apiManager.setUser(r.user),S(()=>import("./pageIm-74ciJYuA.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(v=>{v.default.mount()}))}S(()=>import("./pageAuthCode-Is0r0roD.js"),__vite__mapDeps([4,1,2,3,5,6,7,8,9,10,11,12,13,14,15,16]),import.meta.url).then(r=>r.default.mount(Object.assign(a,{phone_number:i})))}).catch(a=>{switch(e(),a.type){case"PHONE_NUMBER_INVALID":o.setError(),m(o.label,h("Login.PhoneLabelInvalid")),d.classList.add("error"),m(n,h("Login.Next"));break;default:console.error("auth.sendCode error:",a),n.innerText=a.type;break}})};w(n,L),g=k("btn-primary btn-secondary btn-primary-transparent primary",{text:"Login.QR.Login"}),l=W(),g.addEventListener("click",()=>{j.mount()}),s.append(...[u.container,o.container,n,g,l?.button].filter(Boolean));const _=document.createElement("h4");_.classList.add("text-center"),P(_,"Login.Title");const f=document.createElement("div");f.classList.add("subtitle","text-center"),P(f,"Login.StartText"),G.pageEl.querySelector(".container").append(_,f,s);const A=()=>{c.managers.apiManager.invokeApi("help.getNearestDc").then(t=>{const e=O.getFromCache("langPack");e&&!e.countries?.hash&&V.getLangPackAndApply(e.lang_code).then(()=>{o.simulateInputEvent()});const i=new Set([1,2,3,4,5]),a=[t.this_dc];let r;return t.nearest_dc!==t.this_dc&&(r=c.managers.apiManager.getNetworkerVoid(t.nearest_dc).then(()=>{a.push(t.nearest_dc)})),(r||Promise.resolve()).then(()=>{a.forEach(p=>{i.delete(p)});const v=[...i],b=async()=>{const p=v.shift();if(!p)return;if((await D.get(I()))[`dc${p}_auth_key`])return b();setTimeout(()=>{c.managers.apiManager.getNetworkerVoid(p).finally(b)},3e3)};b()}),t}).then(t=>{!u.value.length&&!o.value.length&&u.selectCountryByIso2(t.country)})};B||setTimeout(()=>{d.focus()},0),I()===1&&q(s),A(),l&&l.fetch()},G=new z("page-sign",!0,$,()=>{n&&(m(n,h("Login.Next")),F(n)),[n,g,l?.button].filter(Boolean).forEach(s=>{s.removeAttribute("disabled")}),c.managers.appStateManager.pushToState("authState",{_:"authStateSignIn"})});export{G as default};
//# sourceMappingURL=pageSignIn-CZ9ZMUyY.js.map
