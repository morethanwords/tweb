{"version":3,"file":"saveButton-Cb1fsvqF.js","sources":["../src/hooks/useIsConfirmationNeededOnClose.ts","../src/components/sidebarLeft/tabs/privacy/messages/appearZoomTransition.tsx","../src/helpers/solid/createScheduled.ts","../src/components/saveButton.tsx"],"sourcesContent":["import type {Accessor} from 'solid-js';\nimport type {ConfirmationPopupRejectReason} from '@components/confirmationPopup';\nimport type {PopupPeerOptions} from '@components/popups/peer';\nimport type {LangPackKey} from '@lib/langPack';\nimport {useHotReloadGuard} from '@lib/solidjs/hotReloadGuard';\n\n\ntype UseIsConfirmationNeededOnCloseArgs = {\n  descriptionLangKey: LangPackKey;\n  hasChanges: Accessor<boolean>;\n  saveAllSettings: () => Promise<void>;\n};\n\nconst useIsConfirmationNeededOnClose = ({descriptionLangKey, hasChanges, saveAllSettings}: UseIsConfirmationNeededOnCloseArgs) => {\n  const {confirmationPopup} = useHotReloadGuard();\n\n  return async() => {\n    if(!hasChanges()) return;\n\n    const saveButton: PopupPeerOptions['buttons'][number] = {\n      langKey: 'Save'\n    };\n\n    try {\n      await confirmationPopup({\n        titleLangKey: 'UnsavedChanges',\n        descriptionLangKey,\n        button: saveButton,\n        buttons: [\n          saveButton,\n          {isCancel: true, langKey: 'Discard'}\n        ],\n        rejectWithReason: true\n      });\n      saveAllSettings();\n\n      return true;\n    } catch(_reason: any) {\n      const reason: ConfirmationPopupRejectReason = _reason;\n\n      if(reason === 'closed') throw new Error();\n    }\n  };\n};\n\nexport default useIsConfirmationNeededOnClose;\n","import {ParentComponent} from 'solid-js';\nimport {Transition} from 'solid-transition-group';\n\n\nconst animateEl = (backwards = false) => async(el: Element, done: () => void) => {\n  const keyframes = ['scale(0)', 'scale(1)'];\n  if(backwards) keyframes.reverse();\n\n  await el.animate(\n    {transform: keyframes},\n    {duration: 80}\n  ).finished;\n\n  done();\n};\n\nconst AppearZoomTransition: ParentComponent = (props) => {\n  return (\n    <Transition\n      onEnter={animateEl()}\n      onExit={animateEl(true)}\n    >\n      {props.children}\n    </Transition>\n  );\n};\n\nexport default AppearZoomTransition;\n","import throttle from '@helpers/schedulers/throttle';\nimport {NoneToVoidFunction} from '@types';\nimport {Accessor, createEffect, createSignal} from 'solid-js';\nimport track from './track';\n\nexport function createScheduled<T>(value: Accessor<T>, scheduleWith: (callback: NoneToVoidFunction) => NoneToVoidFunction) {\n  const [scheduledValue, setScheduledValue] = createSignal(value());\n\n  const scheduledSet = scheduleWith(() => setScheduledValue(() => value()));\n\n  createEffect(() => {\n    track(value);\n    scheduledSet();\n  });\n\n  return scheduledValue;\n}\n\nexport function createThrottled<T>(value: Accessor<T>, delayMs: number, shouldRunFirst?: boolean) {\n  return createScheduled(value, (callback) => throttle(callback, delayMs, shouldRunFirst));\n}\n","import {IconTsx} from '@components/iconTsx';\nimport ripple from '@components/ripple';\nimport AppearZoomTransition from '@components/sidebarLeft/tabs/privacy/messages/appearZoomTransition';\nimport {keepMe} from '@helpers/keepMe';\nimport {createThrottled} from '@helpers/solid/createScheduled';\nimport {Component, Show} from 'solid-js';\n\nkeepMe(ripple);\n\n\nconst SaveButton: Component<{\n  hasChanges: boolean;\n  onClick: () => void;\n}> = (props) => {\n  // Note: the header is jerking if updating the hasChanges too quickly\n  const hasChanges = createThrottled(() => props.hasChanges, 200, true);\n\n  return (\n    <AppearZoomTransition>\n      <Show when={hasChanges()}>\n        <button\n          use:ripple\n          class=\"btn-icon blue\"\n          onClick={props.onClick}\n        >\n          <IconTsx icon=\"check\" />\n        </button>\n      </Show>\n    </AppearZoomTransition>\n  )\n};\n\nexport default SaveButton;\n"],"names":["useIsConfirmationNeededOnClose","descriptionLangKey","hasChanges","saveAllSettings","confirmationPopup","useHotReloadGuard","saveButton","_reason","animateEl","backwards","el","done","keyframes","reverse","animate","transform","duration","finished","AppearZoomTransition","props","_$createComponent","Transition","onEnter","onExit","children","createScheduled","value","scheduleWith","scheduledValue","setScheduledValue","createSignal","scheduledSet","createEffect","track","createThrottled","delayMs","shouldRunFirst","callback","throttle","SaveButton","Show","when","_el$","_tmpl$","_$addEventListener","onClick","_$use","ripple","_$insert","IconTsx","icon","_$delegateEvents"],"mappings":"wQAaA,MAAMA,EAAiC,CAAC,CAAC,mBAAAC,EAAoB,WAAAC,EAAY,gBAAAC,KAAyD,CAC1H,KAAA,CAAC,kBAAAC,GAAqBC,IAE5B,MAAO,UAAW,CAChB,GAAG,CAACH,EAAW,EAAG,OAElB,MAAMI,EAAkD,CACtD,QAAS,MAAA,EAGP,GAAA,CACF,aAAMF,EAAkB,CACtB,aAAc,iBACd,mBAAAH,EACA,OAAQK,EACR,QAAS,CACPA,EACA,CAAC,SAAU,GAAM,QAAS,SAAS,CACrC,EACA,iBAAkB,EAAA,CACnB,EACeH,IAET,SACDI,EAAc,CAGpB,GAF8CA,IAEhC,SAAU,MAAM,IAAI,KACpC,CAAA,CAEJ,ECvCMC,EAAYA,CAACC,EAAY,KAAU,MAAMC,EAAaC,IAAqB,CAC/E,MAAMC,EAAY,CAAC,WAAY,UAAU,EACtCH,GAAWG,EAAUC,UAExB,MAAMH,EAAGI,QACP,CAACC,UAAWH,CAAS,EACrB,CAACI,SAAU,EACb,CAAA,EAAEC,SAEFN,GACF,EAEMO,EAAyCC,GAC7CC,EACGC,EAAU,CAAA,IACTC,SAAO,CAAA,OAAEd,EAAS,CAAE,EAAA,IACpBe,QAAM,CAAA,OAAEf,EAAU,EAAI,CAAC,EAAA,IAAAgB,UAAA,CAAA,OAEtBL,EAAMK,QAAQ,CAAA,CAAA,ECjBL,SAAAC,EAAmBC,EAAoBC,EAAoE,CACzH,KAAM,CAACC,EAAgBC,CAAiB,EAAIC,EAAaJ,EAAO,CAAA,EAE1DK,EAAeJ,EAAa,IAAME,EAAkB,IAAMH,EAAO,CAAA,CAAC,EAExE,OAAAM,EAAa,IAAM,CACjBC,EAAMP,CAAK,EACEK,GAAA,CACd,EAEMH,CACT,CAEgB,SAAAM,EAAmBR,EAAoBS,EAAiBC,EAA0B,CACzF,OAAAX,EAAgBC,EAAQW,GAAaC,EAASD,EAAUF,EAASC,CAAc,CAAC,CACzF,6CCVMG,EAGApB,GAAU,CAEd,MAAMjB,EAAagC,EAAgB,IAAMf,EAAMjB,WAAY,IAAK,EAAI,EAEpE,OAAAkB,EACGF,EAAoB,CAAA,IAAAM,UAAA,CAAA,OAAAJ,EAClBoB,EAAI,CAAA,IAACC,MAAI,CAAA,OAAEvC,EAAU,CAAE,EAAA,IAAAsB,UAAA,CAAA,MAAAkB,EAAAC,IAAAC,OAAAA,EAAAF,EAIXvB,QAAAA,EAAM0B,QAAO,EAAA,EAAAC,EAFlBC,EAAML,EAAA,IAAA,EAAA,EAAAM,EAAAN,EAAAtB,EAIT6B,EAAO,CAACC,KAAI,OAAA,CAAA,CAAA,EAAAR,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAKvB,EAE0BS,EAAA,CAAA,OAAA,CAAA"}