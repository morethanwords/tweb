"use strict";(this.webpackChunktweb=this.webpackChunktweb||[]).push([[458],{503:(t,e,n)=>{n.d(e,{I:()=>g,Z:()=>m});var i=n(6669),s=n(1544),a=n(8763),l=n(3735),o=n(1293),r=n(130),h=n(2325),u=n(6241),d=n(6535),c=n(3066),p=n(9099);let f=()=>{document.addEventListener("paste",(t=>{if(!(0,a.Z)(t.target,'contenteditable="true"'))return;let e,n;t.preventDefault();let i=(t.originalEvent||t).clipboardData.getData("text/plain"),o=!0,r=(t.originalEvent||t).clipboardData.getData("text/html");if(r.trim()){r=r.replace(/<style([\s\S]*)<\/style>/,""),r=r.replace(/<!--([\s\S]*)-->/,"");const t=r.match(/<body>([\s\S]*)<\/body>/);t&&(r=t[1].trim());let s=document.createElement("span");s.innerHTML=r;let a=s.firstChild;for(;a;){let t=a.nextSibling;3===a.nodeType&&(a.nodeValue.trim()||a.remove()),a=t}const h=(0,l.Z)(s,!0);if(h.value.replace(/\s/g,"").length===i.replace(/\s/g,"").length){e=h.value,n=h.entities,o=!1;let t=(0,d.Z)(e);t=t.filter((t=>"messageEntityEmoji"===t._||"messageEntityLinebreak"===t._)),(0,u.Z)(n,t)}}o&&(e=i,n=(0,d.Z)(e),n=n.filter((t=>"messageEntityEmoji"===t._||"messageEntityLinebreak"===t._)));const h=(0,c.Z)(e,{entities:n});e=(0,s.Z)(h),window.document.execCommand("insertHTML",!1,e)})),f=null};var g;!function(t){t[t.Neutral=0]="Neutral",t[t.Valid=1]="Valid",t[t.Error=2]="Error"}(g||(g={}));const m=class{constructor(t={}){this.options=t,this.container=document.createElement("div"),this.container.classList.add("input-field"),this.required=t.required,this.validate=t.validate,void 0!==t.maxLength&&void 0===t.showLengthOn&&(t.showLengthOn=Math.min(40,Math.round(t.maxLength/3)));const{placeholder:e,maxLength:n,showLengthOn:i,name:s,plainText:a,canBeEdited:r=!0}=t;let u,d,c=t.label||t.labelText;if(a)this.container.innerHTML=`\n      <input type="text" ${s?`name="${s}"`:""} autocomplete="off" ${c?'required=""':""} class="input-field-input">\n      `,u=this.container.firstElementChild;else{f&&f(),this.container.innerHTML=`\n      <div contenteditable="${String(!!r)}" class="input-field-input"></div>\n      `,u=this.container.firstElementChild;const e=new MutationObserver((()=>{d&&d()}));u.addEventListener("input",(()=>{(0,o.Z)(u)&&(u.innerHTML=""),this.inputFake&&(this.inputFake.innerHTML=u.innerHTML,this.onFakeInput())})),e.observe(u,{characterData:!0,childList:!0,subtree:!0}),t.animate&&(u.classList.add("scrollable","scrollable-y"),this.inputFake=document.createElement("div"),this.inputFake.setAttribute("contenteditable","true"),this.inputFake.className=u.className+" input-field-input-fake")}if(u.setAttribute("dir","auto"),e&&((0,h.$d)(u,e,void 0,"placeholder"),this.inputFake&&(0,h.$d)(this.inputFake,e,void 0,"placeholder")),c||e){const t=document.createElement("div");t.classList.add("input-field-border"),this.container.append(t)}if(c&&(this.label=document.createElement("label"),this.setLabel(),this.container.append(this.label)),n){const t=this.container.lastElementChild;let e=!1;d=()=>{const s=u.classList.contains("error"),o=a?u.value.length:[...(0,l.Z)(u,!1).value].length,r=n-o,h=r<0;u.classList.toggle("error",h),h||r<=i?(this.setLabel(),t.append(` (${n-o})`),e||(e=!0)):(s&&!h||e)&&(this.setLabel(),e=!1)},u.addEventListener("input",d)}this.input=u}select(){this.value&&(this.options.plainText?this.input.select():function(t){const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e)}(this.input))}setLabel(){this.label.textContent="",this.options.labelText?(0,r.Z)(this.label,this.options.labelText):this.label.append((0,h.ag)(this.options.label,this.options.labelOptions))}onFakeInput(t=!0){const{scrollHeight:e}=this.inputFake,n=+this.input.style.height.replace("px","");if(n===e)return;const i=Math.round(50*Math.log(Math.abs(e-n)));this.input.style.transitionDuration=`${i}ms`,t&&(this.input.style.height=e?e+"px":"");const s="is-changing-height";(0,p.Z)(this.input,s,!0,i,(()=>{this.input.classList.remove(s)}))}get value(){return this.options.plainText?this.input.value:(0,l.Z)(this.input,!1).value}set value(t){this.setValueSilently(t,!1),(0,i.Z)(this.input,"input")}setValueSilently(t,e=!0){this.options.plainText?this.input.value=t:(this.input.innerHTML=t,this.inputFake&&(this.inputFake.innerHTML=t,e&&this.onFakeInput()))}isChanged(){return this.value!==this.originalValue}isValid(){return!this.input.classList.contains("error")&&(!this.validate||this.validate())&&(!this.required||!(0,o.Z)(this.input))}isValidToChange(){return this.isValid()&&this.isChanged()}setDraftValue(t="",e=!1){this.options.plainText||(t=(0,s.Z)((0,c.Z)(t))),e?this.setValueSilently(t,!1):this.value=t}setOriginalValue(t="",e=!1){this.originalValue=t,this.setDraftValue(t,e)}setState(t,e){e&&(this.label.textContent="",this.label.append((0,h.ag)(e,this.options.labelOptions))),this.input.classList.toggle("error",!!(t&g.Error)),this.input.classList.toggle("valid",!!(t&g.Valid))}setError(t){this.setState(g.Error,t)}}},9099:(t,e,n)=>{n.d(e,{Z:()=>a});var i=n(3512);const s=(t,e,n,a,l,o)=>{const{timeout:r,raf:h}=t.dataset;if(void 0!==r&&clearTimeout(+r),void 0!==h&&(window.cancelAnimationFrame(+h),o||delete t.dataset.raf),o&&i.Z.settings.animationsEnabled&&a)return void(t.dataset.raf=""+window.requestAnimationFrame((()=>{delete t.dataset.raf,s(t,e,n,a,l,o-1)})));n&&e&&t.classList.add(e);const u=()=>{delete t.dataset.timeout,!n&&e&&t.classList.remove("backwards",e),t.classList.remove("animating"),l&&l()};if(!i.Z.settings.animationsEnabled||!a)return t.classList.remove("animating","backwards"),void u();t.classList.add("animating"),t.classList.toggle("backwards",!n),t.dataset.timeout=""+setTimeout(u,a)},a=s},1544:(t,e,n)=>{n.d(e,{Z:()=>s});var i=n(4056);function s(t){return Array.from(t.childNodes).map((t=>3===t.nodeType?(0,i.Z)(t.textContent):t.outerHTML)).join("")}},8763:(t,e,n)=>{function i(t,e){return t.closest(`[${e}]`)}n.d(e,{Z:()=>i})},9041:(t,e,n)=>{n.d(e,{Z:()=>a,o:()=>i});const i={bold:{match:'[style*="bold"], [style*="font-weight: 700"], [style*="font-weight: 600"], [style*="font-weight:700"], [style*="font-weight:600"], b, strong',entityName:"messageEntityBold"},underline:{match:'[style*="underline"], u, ins',entityName:"messageEntityUnderline"},italic:{match:'[style*="italic"], i, em',entityName:"messageEntityItalic"},monospace:{match:'[style*="monospace"], [face*="monospace"], pre',entityName:"messageEntityCode"},strikethrough:{match:'[style*="line-through"], strike, del, s',entityName:"messageEntityStrike"},link:{match:"A:not(.follow)",entityName:"messageEntityTextUrl"},mentionName:{match:"A.follow",entityName:"messageEntityMentionName"},spoiler:{match:'[style*="spoiler"]',entityName:"messageEntitySpoiler"}},s=new Set(["DIV","P","BR","LI","SECTION","H6","H5","H4","H3","H2","H1","TR"]);function a(t,e,n,l,o,r,h={offset:0}){if(3===t.nodeType){let e=t.nodeValue;if(l===t?n.push(e.substr(0,o)+""+e.substr(o)):n.push(e),r&&e.length&&t.parentNode){const n=t.parentElement;for(const t in i){const s=i[t],a=n.closest(s.match+", [contenteditable]");null===(null==a?void 0:a.getAttribute("contenteditable"))&&("messageEntityTextUrl"===s.entityName?r.push({_:s.entityName,url:a.href,offset:h.offset,length:e.length}):"messageEntityMentionName"===s.entityName?r.push({_:s.entityName,offset:h.offset,length:e.length,user_id:a.dataset.follow.toUserId()}):r.push({_:s.entityName,offset:h.offset,length:e.length}))}}return void(h.offset+=e.length)}if(1!==t.nodeType)return;const u=l===t,d=s.has(t.tagName);if(d&&n.length)e.push(n.join("")),n.splice(0,n.length),++h.offset;else if(t instanceof HTMLImageElement){const e=t.alt;e&&(n.push(e),h.offset+=e.length)}u&&!o&&n.push("");const c=t.matches('[style*="table-cell"], th, td'),p=null==r?void 0:r.length;let f=t.firstChild;for(;f;)a(f,e,n,l,o,r,h),f=f.nextSibling;if(u&&o&&n.push(""),c&&t.nextSibling&&(n.push(" "),++h.offset,void 0!==p))for(let t=p,e=r.length;t<e;++t)++r[t].length;const g=n.length;d&&g&&(e.push(n.join("")),n.splice(0,g),++h.offset),g&&"P"===t.tagName&&t.nextSibling&&(e.push(""),++h.offset)}},3735:(t,e,n)=>{n.d(e,{Z:()=>o});var i=n(410),s=n(6875),a=n(1346),l=n(9041);function o(t,e=!0){const n=[],i=[],o=e?[]:void 0;(0,l.Z)(t,n,i,void 0,void 0,o),i.length&&n.push(i.join(""));let r=n.join("\n");return r=r.replace(/\u00A0/g," "),(null==o?void 0:o.length)&&((0,s.Z)(o),(0,a.Z)(o)),{value:r,entities:o}}i.GO.getRichValue=o},1293:(t,e,n)=>{n.d(e,{Z:()=>s});var i=n(3735);function s(t){return t.hasAttribute("contenteditable")||"INPUT"!==t.tagName?!(0,i.Z)(t,!1).value.trim():!t.value.trim()}},5565:(t,e,n)=>{function i(t,e){if("string"==typeof e)return void(t.innerHTML=e);const n=t.firstChild;n?t.lastChild===n?n.replaceWith(e):(t.textContent="",t.append(e)):t.append(e)}n.d(e,{Z:()=>i})},130:(t,e,n)=>{function i(t,e){t.setAttribute("dir","auto"),"string"==typeof e?e?t.innerHTML=e:t.textContent="":(t.textContent="",t.append(e))}n.d(e,{Z:()=>i})},6875:(t,e,n)=>{n.d(e,{Z:()=>s});const i=new Set(["messageEntityBold","messageEntityItalic","messageEntityCode","messageEntityPre","messageEntityUnderline","messageEntityStrike","messageEntityBlockquote","messageEntitySpoiler"]);function s(t){for(let e=0;e<t.length;++e){const n=t[e];let s=-1;do{if(s=t.findIndex(((t,s)=>i.has(t._)&&s!==e&&t._===n._&&t.offset-n.length===n.offset)),-1!==s){const e=t[s];n.length+=e.length,t.splice(s,1)}}while(-1!==s)}}},8859:(t,e,n)=>{n.d(e,{Z:()=>a});var i=n(2423);const s=new Set(["messageEntityPre","messageEntityCode"]);function a(t,e){let n=-1;return t.find((t=>(s.has(t._)&&(n=t.offset+t.length),e.offset<n&&!i.tY.has(e._)||(e._===t._||!i.tY.has(e._)&&!i.tY.has(t._))&&(e.offset>=t.offset&&e.length+e.offset<=t.length+t.offset))))}},6241:(t,e,n)=>{n.d(e,{Z:()=>a});var i=n(8859),s=n(1346);function a(t,e){const n=e.filter((e=>!(0,i.Z)(t,e)));t.push(...n),(0,s.Z)(t);for(let e=0;e<t.length;++e){const n=t[e];if("messageEntityEmoji"===n._){const i=t[e+1];i&&i.offset<n.offset+n.length&&(n.length=i.offset-n.offset)}}return t}},1346:(t,e,n)=>{function i(t){t.sort(((t,e)=>t.offset-e.offset||e.length-t.length))}n.d(e,{Z:()=>i})},3066:(t,e,n)=>{n.d(e,{Z:()=>s});var i=n(3178);function s(t,e={}){return t?(0,i.Z)(t,{entities:e.entities,noLinks:!0,wrappingDraft:!0,passEntities:{messageEntityTextUrl:!0,messageEntityMentionName:!0}}):(0,i.Z)("")}}}]);
//# sourceMappingURL=458.4b58734334c7cd94ca3d.chunk.js.map