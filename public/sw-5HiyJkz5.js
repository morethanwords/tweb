const ft={test:location.search.indexOf("test=1")>0,debug:location.search.indexOf("debug=1")>0,http:!1,ssl:!0,asServiceWorker:!1,transport:"websocket",noSharedWorker:location.search.indexOf("noSharedWorker=1")>0,noServiceWorker:location.search.indexOf("noServiceWorker=1")>0,multipleTransports:location.search.indexOf("noMultipleTransports=1")===-1,noPfs:!0};(ft.http=location.search.indexOf("http=1")>0)&&(ft.multipleTransports=!1);ft.multipleTransports&&(ft.http=!0);ft.http&&(ft.transport="https");const ue=ft.debug,Ys=typeof window<"u"?window:self,it=Ys,_t=typeof window<"u"?window:self,te=navigator?navigator.userAgent:null;navigator.userAgent.search(/OS X|iPhone|iPad|iOS/i);navigator.userAgent.toLowerCase().indexOf("android");(()=>{try{return+navigator.userAgent.match(/Chrom(?:e|ium)\/(.+?)(?:\s|\.)/)[1]}catch{}})();const gt="safari"in _t||!!(te&&(/\b(iPad|iPhone|iPod)\b/.test(te)||te.match("Safari")&&!te.match("Chrome"))),hs=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;(navigator.maxTouchPoints===void 0||navigator.maxTouchPoints>0)&&navigator.userAgent.search(/iOS|iPhone OS|Android|BlackBerry|BB10|Series ?[64]0|J2ME|MIDP|opera mini|opera mobi|mobi.+Gecko|Windows Phone/i)!=-1;const Vt=typeof ServiceWorkerGlobalScope<"u"&&self instanceof ServiceWorkerGlobalScope,fe=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&!Vt,jt=fe||Vt,Yt=()=>self.clients.matchAll({includeUncontrolled:!1,type:"window"}),us=(e,...t)=>{try{e.postMessage(...t)}catch(s){console.error("[worker] postMessage error:",s,t)}},fs=(e,...t)=>{Yt().then(s=>{s.length&&s.slice(e?0:-1).forEach(r=>{us(r,...t)})})},ps=(...e)=>{us(self,...e)},ds=()=>{};Vt&&fs.bind(null,!1);Vt&&fs.bind(null,!0);const Gs=Date.now();function Ze(){return"["+((Date.now()-Gs)/1e3).toFixed(3)+"]"}var kt=(e=>(e[e.None=0]="None",e[e.Error=1]="Error",e[e.Warn=2]="Warn",e[e.Log=4]="Log",e[e.Debug=8]="Debug",e))(kt||{});const Zs=[0,1,2,4,8],Xs=gt||hs,Xe=!Xs,we={reset:"\x1B[0m",bright:"\x1B[1m",dim:"\x1B[2m",underscore:"\x1B[4m",blink:"\x1B[5m",reverse:"\x1B[7m",hidden:"\x1B[8m",fg:{black:"\x1B[30m",red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",blue:"\x1B[34m",magenta:"\x1B[35m",cyan:"\x1B[36m",white:"\x1B[37m"},bg:{black:"\x1B[40m",red:"\x1B[41m",green:"\x1B[42m",yellow:"\x1B[43m",blue:"\x1B[44m",magenta:"\x1B[45m",cyan:"\x1B[46m",white:"\x1B[47m"}},Qs=[["debug",8],["info",4],["warn",2],["error",1],["assert",1],["trace",4],["group",4],["groupCollapsed",4],["groupEnd",4]];function X(e,t=7,s=!1,r=""){let i;!ue&&!s&&(t=1),Xe?r||(Vt?r=we.fg.yellow:fe&&(r=we.fg.cyan)):r="";const o=r;r?r=`%s ${r}%s`:r="%s";const l=function(..._){return t&4&&console.log(r,Ze(),e,..._)};Qs.forEach(([_,u])=>{l[_]=function(...c){return t&u&&console[_](r,Ze(),e,...c)}}),l.setPrefix=function(_){i=_,e="["+_+"]"},l.setPrefix(e),l.setLevel=function(_){t=Zs.slice(0,_+1).reduce((u,c)=>u|c,0)};const p={};return l.bindPrefix=function(_,u=t){return p[_]??(p[_]=X(`${i}] ${Xe&&o?we.reset:""}[${_}`,u,s,o))},l}function Ft(e){return new Promise(t=>{setTimeout(t,e)})}const tr=self,gs="cachedAssets";function ve(e){return e.ok&&e.status===200}function Qe(e){return Promise.race([e,Ft(1e4).then(()=>Promise.reject())])}async function er(e){try{const t=await Qe(tr.caches.open(gs)),s=await Qe(t.match(e.request,{ignoreVary:!0}));if(s&&ve(s))return s;const r={Vary:"*"};let i=await fetch(e.request,{headers:r});if(ve(i))t.put(e.request,i.clone());else if(i.status===304){const o=e.request.url.replace(/\?.+$/,"")+"?"+(Math.random()*1e5|0);i=await fetch(o,{headers:r}),ve(i)&&t.put(e.request,i.clone())}return i}catch{return fetch(e.request)}}function sr(e,t){return new Promise(s=>{const r=new FileReader;r.addEventListener("loadend",i=>{s(i.target.result)}),r[t](e)})}function rr(e){return sr(e,"readAsArrayBuffer")}function ae(e){return rr(e).then(t=>new Uint8Array(t))}function _s(...e){const t=e.reduce((i,o)=>i+(o.byteLength||o.length),0),s=new Uint8Array(t);let r=0;return e.forEach(i=>{s.set(i instanceof ArrayBuffer?new Uint8Array(i):i,r),r+=i.byteLength||i.length}),s}function ms(){}const ir={isFulfilled:!1,isRejected:!1,notify:()=>{},notifyAll:function(...e){this.lastNotify=e,this.listeners?.forEach(t=>t(...e))},addNotifyListener:function(e){this.lastNotify&&e(...this.lastNotify),(this.listeners??(this.listeners=[])).push(e)},resolve:function(e){this.isFulfilled||this.isRejected||(this.isFulfilled=!0,this._resolve(e),this.onFinish())},reject:function(...e){this.isRejected||this.isFulfilled||(this.isRejected=!0,this._reject(...e),this.onFinish())},onFinish:function(){this.notify=this.notifyAll=this.lastNotify=null,this.listeners&&(this.listeners.length=0),this.cancel&&(this.cancel=ms)}};function J(){let e,t;const s=new Promise((r,i)=>{e=r,t=i});return Object.assign(s,ir),s._resolve=e,s._reject=t,s}self.deferredPromise=J;function ys(e){const t=e.length,s=new Uint8Array(Math.ceil(t/2));let r=0;t%2&&(s[r++]=parseInt(e.charAt(0),16));for(let i=r;i<t;i+=2)s[r++]=parseInt(e.substr(i,2),16);return s}it.bytesFromHex=ys;function nr(e,t){const s=e.length;if(s!==t.length)return!1;for(let r=0;r<s;++r)if(e[r]!==t[r])return!1;return!0}function ce(e,t){let s=0,r=0;for(let i=0;i<4;i++){const o=e[t+i];if(s=(s<<7)+(o&127),r++,!(o&128))break}return[r,s]}function or(e){if(e[0]!==5)throw new Error("Invalid DecoderSpecificInfo tag");const[t,s]=ce(e,1),r=1+t;return e.subarray(r,r+s)}function ar(e){if(e[0]!==4)throw new Error("Invalid DecoderConfigDescriptor tag");const[t,s]=ce(e,1);let r=1+t;return r+=13,or(e.subarray(r))}function cr(e){if(e[0]!==3)throw new Error("Invalid ES_Descriptor tag");const t=new DataView(e.buffer,e.byteOffset,e.byteLength),[s,r]=ce(e,1);let i=1+s;i+=2;const o=t.getUint8(i);i+=1;const l=o&128,p=o&64;if(l&&(i+=2),p){const u=ce(e,i);i+=1+u[0]+u[1]}return{decoderConfigDescriptor:ar(e.subarray(i))}}const lr=[19,136],be=ys("0327000100041940150000000001f4000000bb750507138856e5a5"),hr=new TextEncoder().encode("esds"),ur=new TextEncoder().encode("mp4a");function ts(e,t,s=e.length){for(let r=s-t.length;r>=0;r--){let i=!0;for(let o=0;o<t.length;o++)if(e[r+o]!==t[o]){i=!1;break}if(i)return r}return-1}function fr(e){const t=new DataView(e.buffer,e.byteOffset,e.byteLength);let s=e.length,r=null;for(;;){const l=ts(e,hr,s);if(l===-1)break;s=l;const p=t.getUint32(l-4);if(p<0||l+p>e.length)continue;const _=ts(e,ur,l);_===-1||l-_>100||(r={offset:l+8,size:p-12})}if(!r)throw new Error("No ESDS found");const i=e.subarray(r.offset,r.offset+r.size),o=cr(i);if(!o)throw new Error("Invalid ESDS");if(!nr(o.decoderConfigDescriptor,lr))throw new Error("Not a broken DSCI");if(r.size<be.length)throw new Error(`ESDS Size not enough (expected at least ${be.length}, got ${r.size})`);e.set(be,r.offset)}function pr(e){try{return fr(e),!0}catch{return!1}}function dr(e,t,s=!0,r=!0){let i,o,l,p,_=!1;const u=h=>{const g=l,F=p;try{const T=e.apply(null,h);g(T)}catch(T){console.error("debounce error",T),F(T)}},c=(...h)=>{o||(o=new Promise((F,T)=>(l=F,p=T))),i?(clearTimeout(i),_=!0,p(),o=new Promise((F,T)=>(l=F,p=T))):s&&(u(h),_=!1);const g=_t.setTimeout(()=>{r&&(!s||_)&&u(h),i===g&&(i=o=l=p=void 0,_=!1)},t);return i=g,o.catch(ms),o};return c.clearTimeout=()=>{i&&(_t.clearTimeout(i),p(),i=o=l=p=void 0,_=!1)},c.isDebounced=()=>!!i,c}function gr(e){return e=parseInt((e||"1")+""),e<=4&&e>=1?e:1}const Me="account";function Gt(e){const t=new URL(e).searchParams;return gr(t.get(Me)||"")}function re(e){return Array.isArray(e)?e:[e]}function _r(e){return["image/jpeg","image/png","image/gif","image/svg+xml","image/webp","image/bmp","image/avif","image/jxl","video/mp4","video/webm","video/quicktime","audio/ogg","audio/mpeg","audio/mp4","audio/wav","application/json","application/pdf"].indexOf(e)===-1?"application/octet-stream":e}function ws(e,t=""){e=re(e);const s=_r(t);return new Blob(e,{type:s})}function Et(e,t){const s=new Error;return{type:e,stack:s.stack}}class vs{constructor(){throw new Error("Cannot instantiate a static utility class")}}const he=class he extends vs{static async get(){return this.deferred&&await this.deferred,this.key}static async getAsBase64(){const t=await this.get();if(!t)return null;const s=await crypto.subtle.exportKey("raw",t);return btoa(String.fromCharCode(...new Uint8Array(s)))}static save(t){this.key=t||null,this.deferred?.resolve(),this.deferred=void 0}static resetDeferred(){this.key=null,this.deferred=J()}};he.key=null,he.deferred=J();let ot=he;const mr=Date.now()%Math.random()*1e8|0;function ee(e,t){const s=e.indexOf(t);return(s===-1?void 0:e.splice(s,1))?.[0]}class yr{constructor(t){this._constructor(t)}_constructor(t){this.reuseResults=t,this.listeners={},this.listenerResults={}}addEventListener(t,s,r){var o;const i={callback:s,options:r};if(((o=this.listeners)[t]??(o[t]=new Set)).add(i),this.listenerResults.hasOwnProperty(t)&&(s(...this.listenerResults[t]),r?.once)){this.listeners[t].delete(i);return}}addMultipleEventsListeners(t){for(const s in t)this.addEventListener(s,t[s])}removeEventListener(t,s,r){if(this.listeners[t]){for(const i of this.listeners[t])if(i.callback===s){this.listeners[t].delete(i);break}}}invokeListenerCallback(t,s,...r){let i,o;try{i=s.callback(...r)}catch(l){o=l}if(s.options?.once&&this.removeEventListener(t,s.callback),o)throw o;return i}_dispatchEvent(t,s,...r){this.reuseResults&&(this.listenerResults[t]=r);const i=s&&[],o=this.listeners[t];for(const l of o||[])try{const p=this.invokeListenerCallback(t,l,...r);i&&i.push(p)}catch(p){if(i)throw p}return i}dispatchResultableEvent(t,...s){return this._dispatchEvent(t,!0,...s)}dispatchEvent(t,...s){this._dispatchEvent(t,!1,...s)}cleanup(){this.listeners={},this.listenerResults={}}}const wr=!0;class $t extends yr{constructor(t){super(!1),this.logSuffix=t,this.onMessage=s=>{const r=s.data,i=s.source||s.currentTarget;this.processTaskMap[r.type](r,i,s)},this.processResultTask=s=>{const{taskId:r,result:i,error:o}=s.payload,l=this.awaiting[r];l&&(this.debug&&this.log.debug("done",l.taskType,i,o),"error"in s.payload?l.reject(o):l.resolve(i),delete this.awaiting[r])},this.processAckTask=s=>{const r=s.payload,i=this.awaiting[r.taskId];if(!i)return;const o=i.resolve,l={cached:r.cached,result:r.cached?"result"in r?Promise.resolve(r.result):Promise.reject(r.error):new Promise((p,_)=>{i.resolve=p,i.reject=_})};o(l),r.cached&&delete this.awaiting[r.taskId]},this.processPingTask=(s,r,i)=>{this.pushTask(this.createTask("pong",void 0),i.source)},this.processPongTask=(s,r,i)=>{const o=this.pingResolves.get(r);o&&(this.pingResolves.delete(r),o())},this.processCloseTask=(s,r,i)=>{this.detachPort(r)},this.processBatchTask=(s,r,i)=>{const o={data:i.data,source:i.source,currentTarget:i.currentTarget};s.payload.forEach(l=>{o.data=l,this.onMessage(o)})},this.processLockTask=(s,r,i)=>{const o=s.payload;this.requestedLocks.has(o)||(this.requestedLocks.set(o,r),navigator.locks.request(o,()=>{this.processCloseTask(void 0,r,void 0),this.requestedLocks.delete(o)}))},this.processInvokeTask=async(s,r,i)=>{const o=s.id,l=s.payload;let p,_,u;l.void||(p={taskId:o},_=this.createTask("result",p)),l.withAck&&(u=this.createTask("ack",{taskId:o,cached:!0}));let c;try{const h=this.listeners[l.type];if(!h?.size)throw new Error("no listener");const g=h.values().next().value;let F=this.invokeListenerCallback(l.type,g,l.payload,r,i);if(l.void)return;if(c=F instanceof Promise,u){const T=!c;if(u.payload.cached=T,T&&(u.payload.result=F),this.pushTask(u,r),T)return}c&&(F=await F),F instanceof $t.TransferableResult&&(_.transfer=F.transferables,F=F.value),p.result=F}catch(h){if(this.log.error("worker task error:",h,s),l.void)return;if(u&&u.payload.cached){u.payload.error=h,this.pushTask(u,r);return}p.error=h}this.pushTask(_,r)},this.listenPorts=[],this.sendPorts=[],this.pingResolves=new Map,this.taskId=Math.random(),this.awaiting={},this.pending=new Map,this.log=X("MP"+(t?"-"+t:"")),this.debug=ue,this.heldLocks=new Map,this.requestedLocks=new Map,this.processTaskMap={result:this.processResultTask,ack:this.processAckTask,invoke:this.processInvokeTask,ping:this.processPingTask,pong:this.processPongTask,close:this.processCloseTask,lock:this.processLockTask,batch:this.processBatchTask}}setOnPortDisconnect(t){this.onPortDisconnect=t}attachPort(t){this.attachListenPort(t),this.attachSendPort(t)}attachListenPort(t){this.listenPorts.push(t),t.addEventListener("message",this.onMessage)}attachSendPort(t){if(this.log.warn("attaching send port"),t.start?.(),this.sendPorts.push(t),typeof window<"u"&&wr)if("locks"in navigator){const s=["lock",mr,this.logSuffix||"",Math.random()*2147483647|0].join("-");this.log.warn("created lock",s);const r=new Promise(i=>this.heldLocks.set(t,{resolve:i,id:s})).then(()=>this.heldLocks.delete(t));navigator.locks.request(s,()=>(this.resendLockTask(t),r))}else window.addEventListener("beforeunload",()=>{const s=this.createTask("close",void 0);this.postMessage(void 0,s)});this.releasePending()}resendLockTask(t){const s=this.heldLocks.get(t);s&&this.pushTask(this.createTask("lock",s.id),t)}detachPort(t){this.log.warn("disconnecting port"),ee(this.listenPorts,t),ee(this.sendPorts,t),t.removeEventListener?.("message",this.onMessage),t.close?.(),this.onPortDisconnect?.(t),this.heldLocks.get(t)?.resolve();const r=Et("PORT_DISCONNECTED");for(const i in this.awaiting){const o=this.awaiting[i];o.port===t&&(o.reject(r),delete this.awaiting[i])}}postMessage(t,s){(Array.isArray(t)?t:t?[t]:this.sendPorts).forEach(i=>{i.postMessage(s,s.transfer)})}async releasePending(){this.releasingPending||(this.releasingPending=!0,await Promise.resolve(),this.debug&&this.log.debug("releasing tasks, length:",this.pending.size),this.pending.forEach((t,s)=>{let r=t;{let o;r=[],t.forEach(l=>{l.transfer?(o=void 0,r.push(l)):(o||(o=this.createTask("batch",[]),r.push(o)),o.payload.push(l))})}const i=s?[s]:this.sendPorts;i.length&&(r.forEach(o=>{try{this.postMessage(i,o)}catch(l){this.log.error("postMessage error:",l,o,i)}}),this.pending.delete(s))}),this.debug&&this.log.debug("released tasks"),this.releasingPending=!1)}createTask(t,s,r){return{type:t,payload:s,id:this.taskId++,transfer:r}}createInvokeTask(t,s,r,i,o){return this.createTask("invoke",{type:t,payload:s,withAck:r,void:i},o)}pushTask(t,s){let r=this.pending.get(s);r||this.pending.set(s,r=[]),r.push(t),this.releasePending()}invokeVoid(t,s,r,i){const o=this.createInvokeTask(t,s,void 0,!0,i);this.pushTask(o,r)}invoke(t,s,r,i,o,l){this.debug&&this.log.debug("start",t,s);let p;const _=new Promise((u,c)=>{p=this.createInvokeTask(t,s,r,void 0,o),this.awaiting[p.id]={resolve:u,reject:c,taskType:t,port:i},this.pushTask(p,i)});if(l){const{reject:u}=this.awaiting[p.id];setTimeout(()=>{u(Et("TIMEOUT"))},l)}if(jt){_.finally(()=>{clearInterval(u)});const u=_t.setInterval(()=>{this.log.error("task still has no result",p,i)},jt?6e4:5e3)}return _}invokeExceptSource(t,s,r){const i=this.sendPorts.slice();ee(i,r),i.forEach(o=>{this.invokeVoid(t,s,o)})}async invokeExceptSourceAsync(t,s,r){const i=this.sendPorts.slice();ee(i,r),await Promise.all(i.map(o=>this.invoke(t,s,void 0,o)))}}(e=>{class t{constructor(r,i){this.value=r,this.transferables=i}}e.TransferableResult=t})($t||($t={}));var Ce=$t;class vr extends Ce{constructor(){super("CRYPTO"),this.lastIndex=-1}invokeCryptoNew({method:t,args:s,transfer:r}){const i={method:t,args:s},o=this.listeners.invoke;if(o?.size){let p=o.values().next().value.callback(i);return!jt&&!(p instanceof Promise)&&(p=Promise.resolve(p)),p}const l=t==="aes-encrypt"||t==="aes-decrypt"?this.lastIndex=(this.lastIndex+1)%this.sendPorts.length:0;return this.invoke("invoke",i,void 0,this.sendPorts[l],r)}invokeCrypto(t,...s){return this.invokeCryptoNew({method:t,args:s})}sendToOnePort(t){this.invokeVoid("port",void 0,this.sendPorts[0],[t])}}const Tt=new vr;it&&(it.cryptoMessagePort=Tt);const Le=class Le extends vs{static resolveDeferred(t){this.value=t,this.deferred?.resolve(),this.deferred=void 0}static async isUsingPasscode(){if(this.deferred&&await this.deferred,typeof this.value!="boolean")throw new Error("Is using passcode is not boolean WTF?");return this.value}static isUsingPasscodeUndeferred(){return this.value}static resetDeferred(){this.value=void 0,this.deferred=J()}};Le.deferred=J();let nt=Le;class br{constructor(t,s,r){this.mimeType=t,this.size=s,this.saveFileCallback=r,this.bytes=new Uint8Array(s)}async write(t,s){const r=s+t.byteLength;if(r>this.bytes.byteLength){const i=new Uint8Array(r);i.set(this.bytes,0),this.bytes=i}this.bytes.set(t,s)}truncate(){this.bytes=new Uint8Array}trim(t){this.bytes=this.bytes.slice(0,t)}finalize(t=!0){const s=ws(this.bytes,this.mimeType);return t&&this.saveFileCallback&&this.saveFileCallback(s),s}getParts(){return this.bytes}replaceParts(t){this.bytes=t}}const Sr=["cachedStreamChunks","cachedHlsStreamChunks","cachedHlsQualityFiles"],Fr="cachedFiles",Tr=[Fr,...Sr],Rt={cachedTime:"Time-Cached",contentLength:"Content-Length",contentType:"Content-Type"},Se={cachedAssets:{encryptable:!1},cachedBackgrounds:{encryptable:!1},cachedFiles:{encryptable:!0},cachedStreamChunks:{encryptable:!0},cachedHlsQualityFiles:{encryptable:!0},cachedHlsStreamChunks:{encryptable:!0}},bs=15e3,kr=bs,Mr=4,H=class H{constructor(t){this.dbName=t,this.useStorage=!0,ft.test&&(this.dbName+="_test"),H.STORAGES.length&&(this.useStorage=H.STORAGES[0].useStorage),this.config=Object.entries(Se).find(([s])=>s===t)?.[1],this.openDatabase(),H.STORAGES.push(this)}forget(){H.STORAGES=H.STORAGES.filter(t=>t!==this)}get isEncryptable(){return this.config?.encryptable}static async encrypt(t){const s=await ot.get(),r=await ae(t),i=t.type,o=await Tt.invokeCryptoNew({method:"aes-local-encrypt",args:[{key:s,data:r}],transfer:[r.buffer]});return new Blob([o],{type:i})}static async decrypt(t){const s=await ot.get(),r=await ae(t),i=t.type,o=await Tt.invokeCryptoNew({method:"aes-local-decrypt",args:[{key:s,encryptedData:r}],transfer:[r.buffer]});return new Blob([o],{type:i})}getDisabledPromises(){return[H.disabledPromise,H.disabledPromisesByKey.get(this.dbName)].filter(Boolean)}async waitToEnable(){let t;for(;(t=this.getDisabledPromises()).length;)await Promise.all(t)}openDatabase(){return this.openDbPromise??(this.openDbPromise=caches.open(this.dbName))}delete(t){return this.timeoutOperation(s=>s.delete("/"+t))}deleteAll(){return this.openDbPromise=void 0,caches.delete(this.dbName)}reset(){this.openDbPromise=void 0}async minimalBlockingIterateResponses(t){await this.waitToEnable();const s=10;await this.timeoutOperation(async r=>{const i=await r.keys();let o=performance.now();for(let l=0;l<i.length;l+=s){const p=i.slice(l,l+s);await Promise.all(p.map(async u=>{const c=await r.match(u),h=t({request:u,response:c,cache:r});h instanceof Promise&&await h}));const _=performance.now();_-o>Mr&&(await Ft(0),o=_)}},kr)}async has(t){return!!await this.timeoutOperation(r=>r.match("/"+t))}async get(t){await this.waitToEnable();const s=await this.timeoutOperation(r=>r.match("/"+t));if(s)return this.config?.encryptable&&await nt.isUsingPasscode()?new Response(await H.decrypt(await s.blob()),{headers:s.headers,status:s.status,statusText:s.statusText}):s}async save({entryName:t,response:s,size:r,contentType:i}){await this.waitToEnable();let o=new Response(s.body,{headers:{...Object.fromEntries(s.headers),[Rt.cachedTime]:Math.floor(Date.now()/1e3|0).toString(),[Rt.contentLength]:r.toString(),...i?{[Rt.contentType]:i}:{}},status:s.status,statusText:s.statusText});return this.config?.encryptable&&await nt.isUsingPasscode()&&(o=new Response(await H.encrypt(await s.blob()),{headers:o.headers,status:o.status,statusText:o.statusText})),this.timeoutOperation(l=>l.put("/"+t,o))}getFile(t,s="blob"){return this.get(t).then(r=>{if(!r)throw Et("NO_ENTRY_FOUND");return r[s]()})}saveFile(t,s){s instanceof Blob||(s=ws(s));const r=new Response(s);return this.save({entryName:t,response:r,size:s.size}).then(()=>s)}timeoutOperation(t,s=bs){return this.useStorage?new Promise(async(r,i)=>{let o=!1;const l=setTimeout(()=>{i(),o=!0},s);try{const p=await this.openDatabase();if(!p)throw this.useStorage=!1,this.openDbPromise=void 0,"no cache?";const _=await t(p);if(o)return;r(_)}catch(p){i(p)}clearTimeout(l)}):Promise.reject(Et("STORAGE_OFFLINE"))}prepareWriting(t,s,r){return{deferred:J(),getWriter:()=>new br(r,s,o=>this.saveFile(t,o).catch(()=>o))}}static toggleStorage(t,s){return this.STORAGES.forEach(r=>{r.useStorage=t}),Promise.resolve()}static async deleteAllStorages(){const t=Object.keys(Se);await Promise.all(t.map(async s=>{await new H(s).deleteAll()}))}static temporarilyToggle(t){t?(this.disabledPromise?.resolve(),this.disabledPromise=void 0):this.disabledPromise||(this.disabledPromise=J())}static temporarilyToggleByName(t,s){const r=this.disabledPromisesByKey.has(t);s?(this.disabledPromisesByKey.get(t)?.resolve(),this.disabledPromisesByKey.delete(t)):r||this.disabledPromisesByKey.set(t,J())}static temporarilyToggleByNames(t,s){t.forEach(r=>this.temporarilyToggleByName(r,s))}static async clearEncryptableStorages(){const t=Object.entries(Se).filter(([,{encryptable:s}])=>s).map(([s])=>s);await this.clearStoragesByNames(t)}static async clearStoragesByNames(t){await Promise.all(t.map(async s=>{const r=new H(s);try{await r.deleteAll()}catch(i){console.error(i)}finally{r.forget()}}))}static getOpenEncryptableStorages(){return this.STORAGES.filter(t=>t.isEncryptable)}static resetOpenEncryptableCacheStorages(){this.getOpenEncryptableStorages().forEach(s=>s.reset())}static getOpenStoragesByNames(t){return this.STORAGES.filter(s=>t.includes(s.dbName))}static async resetOpenStoragesByNames(t){this.getOpenStoragesByNames(t).forEach(r=>r.reset())}};H.STORAGES=[],H.disabledPromisesByKey=new Map;let V=H;function Ur(e){return new Promise(t=>{setTimeout(()=>{t(new Response("",{status:408,statusText:"Request timed out."}))},e)})}const Ss=self,Lt=new Map,es=new V("cachedStreamChunks"),xr=20*1024*1024;setInterval(()=>{const e=Ie();for(const[t,s]of Lt)if(t!==e){for(const r in s)s[r].reject();Lt.delete(t)}},12e4);const ie=new Map;Ss.streams=ie;class bt{constructor(t){this.info=t,this.loadedOffsets=new Set,this.destroy=()=>{this.destroyDebounced.clearTimeout(),ie.delete(this.id),$.invokeVoid("cancelFilePartRequests",{docId:bt.getDocId(this.info),accountNumber:this.info.accountNumber},Ie())},this.toggleInUse=s=>{this.inUse+=s?1:-1,this.inUse||this.destroy()},this.id=bt.getId(t),ie.set(this.id,this),this.inUse=0,this.limitPart=t.size>75*1024*1024?Br:Ir,this.destroyDebounced=dr(this.destroy,15e4,!1,!0)}async requestFilePartFromWorker(t,s,r=!1){const i={docId:bt.getDocId(this.info),dcId:this.info.dcId,offset:t,limit:s,accountNumber:this.info.accountNumber},o=JSON.stringify(i),l=Ie();let p=Lt.get(l);p||Lt.set(l,p={});let _=p[o];if(_)return _.then(c=>c.bytes);this.loadedOffsets.add(t),_=p[o]=J(),$.invoke("requestFilePart",i,void 0,l,void 0,6e4).then(_.resolve.bind(_),_.reject.bind(_)).finally(()=>{p[o]===_&&(delete p[o],Object.keys(p).length||Lt.delete(l))});const u=_.then(c=>c.bytes);return this.saveChunkToCache(u,t,s),!r&&this.preloadChunks(t,xr),u}requestFilePartFromCache(t,s,r){const i=this.getChunkKey(t,s);return es.getFile(i).then(o=>r?new Uint8Array:ae(o),o=>{o.type})}requestFilePart(t,s,r){return this.requestFilePartFromCache(t,s,r).then(o=>o||this.requestFilePartFromWorker(t,s,r))}saveChunkToCache(t,s,r){return t.then(i=>{const o=this.getChunkKey(s,r),l=new Response(i);return es.save({entryName:o,response:l,size:i.length,contentType:"application/octet-stream"})})}preloadChunk(t){this.loadedOffsets.has(t)||(this.loadedOffsets.add(t),this.requestFilePart(t,this.limitPart,!0))}preloadChunks(t,s){if(s>this.info.size&&(s=this.info.size),!t)this.preloadChunk(ss(t,this.limitPart));else for(;t<s;t+=this.limitPart)this.preloadChunk(t)}requestRange(t){this.destroyDebounced();const s=Ar(t,this.info.mimeType,this.info.size);if(s)return s;let[r,i]=t;const o=i&&i<this.limitPart?Or(i-r+1):this.limitPart,l=ss(r,o);i||(i=Math.min(r+o,this.info.size-1));let p;return(r!==l||i!==l+o)&&(p=i-l-o+1),Promise.all([this.requestFilePart(l,o),p&&this.requestFilePart(l+o,o)]).then(u=>{let c=_s(...u.filter(Boolean));if(r!==l||i!==l+o){const g=r-l,F=i-l+1;c=c.slice(g,F)}(this.shouldPatchMp4===!0||this.shouldPatchMp4===l)&&pr(c)&&(this.shouldPatchMp4=l);const h={"Accept-Ranges":"bytes","Content-Range":`bytes ${r}-${r+c.byteLength-1}/${this.info.size||"*"}`,"Content-Length":`${c.byteLength}`,"Response-Time":""+Date.now()};return this.info.mimeType&&(h["Content-Type"]=this.info.mimeType),new Response(c,{status:206,statusText:"Partial Content",headers:h})})}getChunkKey(t,s){return this.id+"?offset="+t+"&limit="+s}patchChromiumMp4(){this.shouldPatchMp4=!0}static get(t){return ie.get(this.getId(t))??new bt(t)}static getId(t){return`${t.accountNumber}-${this.getDocId(t)}`}static getDocId(t){return t.location.id}}function Fs(e){return JSON.parse(decodeURIComponent(e))}function Pr(e,t,s){async function r(){const i=Ts(e.request.headers.get("Range")),o=Fs(t),l=await Ss.clients.get(e.clientId);l?.type==="window"&&(o.accountNumber=Gt(l.url));const p=bt.get(o);return s==="_crbug1250841"&&p.patchChromiumMp4(),p.requestRange(i)}e.respondWith(Promise.race([Ur(45*1e3),r()]))}function Er({url:e,inUse:t,accountNumber:s}){[e]=e.split("?");const r="stream/",i=e.indexOf(r),o=Fs(e.slice(i+r.length));o.accountNumber=s,bt.get(o).toggleInUse(t)}function Ar(e,t,s){return e[0]===0&&e[1]===1?new Response(new Uint8Array(2).buffer,{status:206,statusText:"Partial Content",headers:{"Accept-Ranges":"bytes","Content-Range":`bytes 0-1/${s||"*"}`,"Content-Length":"2","Content-Type":t||"video/mp4"}}):null}const Ir=512*1024,Br=1024*1024,Cr=512*4;function Ts(e){if(!e)return[0,0];const[,t]=e.split("="),s=t.split(", "),[r,i]=s[0].split("-");return[+r,+i||0]}function ss(e,t=Cr){return e-e%t}function Or(e){return 2**Math.ceil(Math.log(e)/Math.log(2))}const ks=()=>({name:"tweb-common",version:8,stores:[{name:"session"},{name:"localStorage",encryptedName:"localStorage__encrypted"}]}),Dr=e=>({name:`tweb-account-${e}`,version:9,stores:[{name:"session",encryptedName:"session__encrypted"},{name:"stickerSets",encryptedName:"stickerSets__encrypted"},{name:"users",encryptedName:"users__encrypted"},{name:"chats",encryptedName:"chats__encrypted"},{name:"dialogs",encryptedName:"dialogs__encrypted"},{name:"messages",encryptedName:"messages__encrypted"},{name:"webapp",encryptedName:"webapp__encrypted"}]});it.getDatabaseState=Dr;const Ms="assets/img/logo_filled_rounded.png",Us="assets/img/logo_plain.svg";function xs(e,t,s){const i=p=>Object.keys(p).filter(_=>p[_]!==void 0),o=typeof e;return e&&t&&o==="object"&&o===typeof t?i(e).length===i(t).length&&i(e).every(p=>xs(e[p],t[p])):e===t}function Nr(e,t){if(t)for(const s in t)t[s]!==void 0&&(e[s]=t[s]);return e}const Wt=class Wt{constructor(t){Nr(this,t),ft.test&&(this.name+="_test"),this.storageIsAvailable=!0,this.log=X(["IDB",t.name].join("-")),this.log("constructor"),this.openDatabase(!0),Wt.INSTANCES.push(this)}isAvailable(){return this.storageIsAvailable}openDatabase(t=!1){if(this.openDbPromise&&!t)return this.openDbPromise;const s=(l,p)=>{const _=Array.from(l.indexNames);for(const u of _)l.deleteIndex(u);if(p.indexes?.length)for(const u of p.indexes)l.indexNames.contains(u.indexName)||l.createIndex(u.indexName,u.keyPath,u.objectParameters)},r=(l,p)=>{const _=l.createObjectStore(p.name);s(_,p)};try{var i=indexedDB.open(this.name,this.version);if(!i)return Promise.reject()}catch(l){return this.log.error("error opening db",l.message),this.storageIsAvailable=!1,Promise.reject(l)}let o=!1;return setTimeout(()=>{o||i.onerror(Et("IDB_CREATE_TIMEOUT"))},3e3),this.openDbPromise=new Promise((l,p)=>{i.onsuccess=_=>{o=!0;const u=i.result;let c=!1;this.log("Opened"),u.onerror=h=>{this.storageIsAvailable=!1,this.log.error("Error creating/accessing IndexedDB database",h),p(h)},u.onclose=h=>{this.log.error("closed:",h),!c&&this.openDatabase()},u.onabort=h=>{this.log.error("abort:",h);const g=h.target;this.openDatabase(c=!0),g.onerror&&g.onerror(h),u.close()},u.onversionchange=h=>{this.log.error("onversionchange, lol?")},l(this.db=u)},i.onerror=_=>{o=!0,this.storageIsAvailable=!1,this.log.error("Error creating/accessing IndexedDB database",_),p(_)},i.onupgradeneeded=_=>{o=!0,this.log.warn("performing idb upgrade from",_.oldVersion,"to",_.newVersion);const u=_.target,c=u.result;this.stores.forEach(h=>{if(!c.objectStoreNames.contains(h.name))r(c,h);else{const F=u.transaction.objectStore(h.name);s(F,h)}h.encryptedName&&!c.objectStoreNames.contains(h.encryptedName)&&c.createObjectStore(h.encryptedName)})}}).then(l=>this.openDbPromise=l)}async closeDatabase(){this.db&&(this.db.onclose=()=>{},this.db.close())}static create(t){return this.INSTANCES.find(s=>s.name===t.name)??new Wt(t)}static closeDatabases(t){this.INSTANCES.forEach(s=>{t&&t===s||s.closeDatabase()})}static deleteDatabaseByName(t){return new Promise((s,r)=>{this.INSTANCES.forEach(o=>{if(o.name===t)return o.closeDatabase()});const i=indexedDB.deleteDatabase(t);i.onerror=()=>r(),i.onsuccess=()=>s()})}};Wt.INSTANCES=[];let Ue=Wt;class zt{constructor(t,s){this.storeName=s,this.log=X(["IDB",t.name,s].join("-")),this.idb=Ue.create(t)}close(){return this.idb.closeDatabase()}delete(t,s){const r=Array.isArray(t);return r||(t=[].concat(t)),this.getObjectStore("readwrite",i=>{const o=t.map(l=>i.delete(l));return r?o:o[0]},"",s)}clear(t){return this.getObjectStore("readwrite",s=>s.clear(),"",t)}save(t,s,r){const i=Array.isArray(t);return i||(t=[t],s=[s]),this.getObjectStore("readwrite",o=>{const l=t.map((p,_)=>o.put(s[_],p));return i?l:l[0]},"",r)}get(t,s){const r=Array.isArray(t);if(r){if(!t.length)return Promise.resolve([])}else{if(!t)return;t=[].concat(t)}return this.getObjectStore("readonly",i=>{const o=t.map(l=>i.get(l));return r?o:o[0]},"",s)}async getObjectStore(t,s,r,i=this.storeName){let o;r&&(o=performance.now(),this.log(r+": start"));const l=setTimeout(()=>{this.log.error("transaction not finished",g,r)},1e4),p=this.idb.openDatabase(),_=p instanceof Promise?await p:p;let u,c;const h=new Promise((O,z)=>[u,c]=[O,z]),g=_.transaction([i],t,{durability:"relaxed"}),F=()=>{clearTimeout(l),c(g.error)},T=()=>{clearTimeout(l),r&&this.log(r+": end",performance.now()-o);const O=I.map(z=>z.result);u(k?O:O[0]),r&&this.log(r+": resolved",k?O:O[0])};g.onerror=F;const U=t==="readwrite";U&&(g.oncomplete=()=>T());const E=s(g.objectStore(i),T,F),k=Array.isArray(E),I=k?E:[].concat(E);if(U)return h;const W=I.length;let j=W;const M=()=>{g.error||--j||T()};for(let O=0;O<W;++O){const z=I[O];z.onerror=F,z.onsuccess=M}return h}getAll(t){return this.getObjectStore("readonly",s=>s.getAll(),"",t)}getAllKeys(t){return this.getObjectStore("readonly",s=>s.getAllKeys(),"",t)}getAllEntries(t){const s=[];return new Promise((r,i)=>{this.getObjectStore("readonly",(o,l,p)=>{const _=o.openCursor();return _.onsuccess=u=>{const c=u.target.result;c?(s.push([c.key,c.value]),c.continue()):(l(),r(s))},_.onerror=p,[]},"",t).catch(i)})}}const rt=self,Rr=location.protocol+"//"+location.hostname+location.pathname.split("/").slice(0,-1).join("/")+"/";let Ps=!0;class Lr{constructor(t,s,r){this.defaults=r,this.cache={},this.storage=new zt(t,s)}getDefault(t){const s=this.defaults[t];return typeof s=="function"?s():s}get(t){return this.cache.hasOwnProperty(t)?this.cache[t]:this.storage.get(t).then(r=>r,()=>{}).then(r=>this.cache.hasOwnProperty(t)?this.cache[t]:(r??(r=this.getDefault(t)),this.cache[t]=r))}getCached(t){const s=this.get(t);if(s instanceof Promise)throw"no property";return s}async set(t,s){const r=this.cache[t]??this.defaults[t];if(!xs(r,s)){this.cache[t]=s;try{this.storage.save(t,s)}catch{}}}}const Jt={push_mute_until:0,push_lang:{push_message_nopreview:"You have a new message",push_message_error:"Telegram is syncing in the background...",push_action_mute1d:"Mute for 24H",push_action_settings:"Settings"},push_settings:{},push_accounts:{},push_keys_ids_base64:[]},Z=new Lr(ks(),"session",Jt);for(const e in Jt)Z.get(e);async function Ot(e){const t=JSON.parse(JSON.stringify(e));C("push",t);let s=!1,r;try{if(e.mute==="1")throw"supress push notification because obj.mute is 1";const[i,o,l,p]=await Promise.all([Z.get("push_mute_until"),Z.get("push_settings"),Z.get("push_lang"),Yt()]);r=l;const _=Date.now();if(Oe()&&i&&_<i)throw`supress push notification because mute for ${Math.ceil((i-_)/6e4)} min`;if(p.length&&Ps)throw s=!1,"supress push notification because some instance is alive";await Jr(e,o,l).catch(h=>{throw C.error("push notification error",h,t),h})}catch(i){if(C(i),!s)return;const o="fix",l=rt.registration.showNotification("Telegram Web",{body:r.push_message_error,icon:Ms,tag:o,badge:Us,silent:!0});return l.then(()=>{setTimeout(()=>{Es(o)},2e3)}),l}}rt.handlePushNotificationObject=Ot;function zr(e){const t=e.data.json();if(!("p"in t)){e.waitUntil(Ot(t));return}const s={loc_key:"",loc_args:[],custom:{msg_id:""},random_id:0,description:"",title:"",mute:"0",user_id:0,accountNumber:1};C("encrypted push",t);const{p:r}=t;if(!r){C("no p"),e.waitUntil(Ot(s));return}const i=Z.getCached("push_keys_ids_base64"),o=i?.findIndex(p=>r.startsWith(p))??-1;if(o===-1){C("no key"),e.waitUntil(Ot(s));return}const l=i[o];s.accountNumber=o+1,s.p=r,s.keyIdBase64=l,e.waitUntil($.invoke("decryptPush",{p:r,keyIdBase64:l},void 0,void 0,void 0,1e3).catch(p=>(C.error("decryptPush error",p),s)).then(Ot))}async function qr(){return Promise.race([Ft(1e3).then(()=>{}),Promise.all([nt.isUsingPasscode(),ot.get()]).then(([e,t])=>e&&!t)])}function Wr(e){const t=e.notification;C("on notification click",t),t.close();const s=e.action;if(s==="mute1d"&&Oe()){C("[SW] mute for 1d"),Z.set("push_mute_until",Date.now()+864e5);return}const r=t.data;if(!r)return;const i=Promise.all([rt.clients.matchAll({type:"window"}),Z.get("push_settings"),Z.get("push_accounts"),qr()]).then(([o,l,p,_])=>{r.action=s;for(const u in p){const c=+u;if(p[c]===r.user_id){r.accountNumber=c;break}}xt=r;for(let u=0;u<o.length;++u){const c=o[u];if(!(!("focus"in c)||(+new URL(c.url).searchParams.get(Me)||1)!==r.accountNumber)){if(c.focus(),_)return;$.invokeVoid("pushClick",xt,c),xt=void 0;return}}if(rt.clients.openWindow){const u=new URL(l.baseUrl||Rr);return r.accountNumber&&r.accountNumber>1&&u.searchParams.set(Me,r.accountNumber+""),rt.clients.openWindow(u)}}).catch(o=>{C.error("Clients.matchAll error",o)});e.waitUntil(i)}const xe=new Set;let xt;function jr(e){$r(e.notification)}function $r(e){xe.delete(e)}function Es(e){for(const s of xe)try{if(e&&s.tag!==e)continue;s.close(),xe.delete(s)}catch{}let t;return"getNotifications"in rt.registration?t=rt.registration.getNotifications({tag:e}).then(s=>{for(let r=0,i=s.length;r<i;++r)try{s[r].close()}catch{}}).catch(s=>{C.error("Offline register SW error",s)}):t=Promise.resolve(),t}function Oe(){return hs}function As(e){let t;return e.custom&&(e.custom.channel_id?t=""+-e.custom.channel_id:e.custom.chat_id?t=""+-e.custom.chat_id:t=e.custom.from_id||""),e.custom.peerId=""+t,e}function Jr(e,t,s){e=As(e);const r=e.custom.peerId;let i=e.title||"Telegram",o=e.description||"",l="peer"+r;const p=r+"_"+e.custom.msg_id;if(Ht.has(p)){const h="ignoring push";throw C.warn(h,e),Ht.delete(p),h}(t?.nopreview||!e.loc_key)&&(i="Telegram",o=s.push_message_nopreview,l="unknown_peer");const _=[Oe()&&{action:"mute1d",title:s.push_action_mute1d}],u={body:o,icon:Ms,tag:l,data:e,actions:_.filter(Boolean),badge:Us,silent:e.custom.silent==="1"};return C("show notify",i,o,e,u),rt.registration.showNotification(i,u).catch(h=>{throw C.error("show notification promise error",h),h})}async function Hr(){const[e]=await Promise.all([nt.isUsingPasscode()]);return!e}async function Kr(e,t){Ps=e.localNotifications,xt&&t&&($.invokeVoid("pushClick",xt,t),xt=void 0),e.lang&&Z.set("push_lang",e.lang),e.settings&&Z.set("push_settings",e.settings);const s=await Hr();Z.set("push_accounts",s&&e.accounts||Jt.push_accounts),Z.set("push_keys_ids_base64",e.keysIdsBase64||Jt.push_keys_ids_base64)}function Vr(){Z.set("push_accounts",Jt.push_accounts)}const Ht=new Map;function Yr(e){Ht.set(e,Date.now())}setInterval(()=>{const e=Date.now();Ht.forEach((t,s)=>{e-t>3e4&&Ht.delete(s)})},30*6e4);rt.addEventListener("notificationclick",Wr);rt.addEventListener("notificationclose",jr);rt.addEventListener("push",zr);class Gr extends Ce{constructor(){super("SERVICE"),it&&(it.serviceMessagePort=this)}}function Zr(e,t,s){const r=(i,o)=>{e.attachListenPort(i),o&&e.attachSendPort(o)};e.setOnPortDisconnect(s),typeof SharedWorkerGlobalScope<"u"?_t.addEventListener("connect",i=>r(i.source,i.source)):typeof ServiceWorkerGlobalScope<"u"?r(_t,null):r(_t,_t)}const et=new Map,Fe=Et("UNKNOWN"),Xr=!1;self.downloadMap=et;const Qr={download:e=>{const{id:t}=e;if(et.has(t))return Promise.reject(Fe);const s=X("DOWNLOAD-"+t);s("prepare");const r=new CountQueuingStrategy({highWaterMark:1}),i=J();i.then(()=>{setTimeout(()=>{et.delete(t)},5e3)},()=>{et.delete(t)});let o;const l=new ReadableStream({start:_=>{o=_},cancel:_=>{s("cancel",t,_),i.reject(Fe)}},r),p={...e,readableStream:l,promise:i,controller:o,log:s};return et.set(t,p),i.catch(()=>{throw Fe})},downloadChunk:({id:e,chunk:t})=>{const s=et.get(e);return s?s.controller.enqueue(t):Promise.reject()},downloadFinalize:e=>{const t=et.get(e);return t?(t.log("finalize"),t.promise.resolve(),t.controller.close()):Promise.reject()},downloadCancel:e=>{const t=et.get(e);if(t)return t.log("cancel"),t.promise.reject(),t.controller.error()}};function ti(e){return e.addMultipleEventsListeners(Qr),{onDownloadFetch:ei,onClosedWindows:si}}function ei(e,t){Be("downloadRequestReceived",t);const s=Ft(100).then(()=>{const r=et.get(t);if(!r||r.used&&!Xr){C.warn("no such download",t);return}r.log("fetch"),r.used=!0;const i=r.readableStream;return new Response(i,{headers:r.headers,status:200})});e.respondWith(s)}function si(){if(C("cancelling all downloads"),et.size)for(const[e,t]of et)t.controller.error()}const qt={};function ri(e){return{files:e.getAll("files"),title:e.get("title"),text:e.get("text"),url:e.get("url")}}async function ii(e,t){try{C("share data",e);const s=ri(e);(qt[t]??(qt[t]=[])).push(s)}catch(s){C.warn("something wrong with the data",s)}}function ni(e){const t=qt[e.id];t&&(delete qt[e.id],C("releasing share events to client:",e.id,"length:",t.length),t.forEach(s=>{$.invokeVoid("share",s,e)}))}function oi(e,t){const s=e.request.formData().then(r=>(ii(r,e.resultingClientId),Response.redirect("..")));e.respondWith(s)}const rs=1,ai=2;function St(e,t){if(e.type===t)return e;if(!e.boxes)return null;for(const s of e.boxes){const r=St(s,t);if(r)return r}return null}function Pe(e){return new Uint8Array(e._raw.buffer,e._raw.byteOffset,e._raw.byteLength)}function ci(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Is={exports:{}};(function(e){var t=function(s){var r=1e7,i=7,o=9007199254740992,l=T(o),p="0123456789abcdefghijklmnopqrstuvwxyz",_=typeof BigInt=="function";function u(n,a,f,d){return typeof n>"u"?u[0]:typeof a<"u"?+a==10&&!f?P(n):Hs(n,a,f,d):P(n)}function c(n,a){this.value=n,this.sign=a,this.isSmall=!1}c.prototype=Object.create(u.prototype);function h(n){this.value=n,this.sign=n<0,this.isSmall=!0}h.prototype=Object.create(u.prototype);function g(n){this.value=n}g.prototype=Object.create(u.prototype);function F(n){return-o<n&&n<o}function T(n){return n<1e7?[n]:n<1e14?[n%1e7,Math.floor(n/1e7)]:[n%1e7,Math.floor(n/1e7)%1e7,Math.floor(n/1e14)]}function U(n){E(n);var a=n.length;if(a<4&&yt(n,l)<0)switch(a){case 0:return 0;case 1:return n[0];case 2:return n[0]+n[1]*r;default:return n[0]+(n[1]+n[2]*r)*r}return n}function E(n){for(var a=n.length;n[--a]===0;);n.length=a+1}function k(n){for(var a=new Array(n),f=-1;++f<n;)a[f]=0;return a}function I(n){return n>0?Math.floor(n):Math.ceil(n)}function W(n,a){var f=n.length,d=a.length,y=new Array(f),m=0,w=r,v,S;for(S=0;S<d;S++)v=n[S]+a[S]+m,m=v>=w?1:0,y[S]=v-m*w;for(;S<f;)v=n[S]+m,m=v===w?1:0,y[S++]=v-m*w;return m>0&&y.push(m),y}function j(n,a){return n.length>=a.length?W(n,a):W(a,n)}function M(n,a){var f=n.length,d=new Array(f),y=r,m,w;for(w=0;w<f;w++)m=n[w]-y+a,a=Math.floor(m/y),d[w]=m-a*y,a+=1;for(;a>0;)d[w++]=a%y,a=Math.floor(a/y);return d}c.prototype.add=function(n){var a=P(n);if(this.sign!==a.sign)return this.subtract(a.negate());var f=this.value,d=a.value;return a.isSmall?new c(M(f,Math.abs(d)),this.sign):new c(j(f,d),this.sign)},c.prototype.plus=c.prototype.add,h.prototype.add=function(n){var a=P(n),f=this.value;if(f<0!==a.sign)return this.subtract(a.negate());var d=a.value;if(a.isSmall){if(F(f+d))return new h(f+d);d=T(Math.abs(d))}return new c(M(d,Math.abs(f)),f<0)},h.prototype.plus=h.prototype.add,g.prototype.add=function(n){return new g(this.value+P(n).value)},g.prototype.plus=g.prototype.add;function O(n,a){var f=n.length,d=a.length,y=new Array(f),m=0,w=r,v,S;for(v=0;v<d;v++)S=n[v]-m-a[v],S<0?(S+=w,m=1):m=0,y[v]=S;for(v=d;v<f;v++){if(S=n[v]-m,S<0)S+=w;else{y[v++]=S;break}y[v]=S}for(;v<f;v++)y[v]=n[v];return E(y),y}function z(n,a,f){var d;return yt(n,a)>=0?d=O(n,a):(d=O(a,n),f=!f),d=U(d),typeof d=="number"?(f&&(d=-d),new h(d)):new c(d,f)}function x(n,a,f){var d=n.length,y=new Array(d),m=-a,w=r,v,S;for(v=0;v<d;v++)S=n[v]+m,m=Math.floor(S/w),S%=w,y[v]=S<0?S+w:S;return y=U(y),typeof y=="number"?(f&&(y=-y),new h(y)):new c(y,f)}c.prototype.subtract=function(n){var a=P(n);if(this.sign!==a.sign)return this.add(a.negate());var f=this.value,d=a.value;return a.isSmall?x(f,Math.abs(d),this.sign):z(f,d,this.sign)},c.prototype.minus=c.prototype.subtract,h.prototype.subtract=function(n){var a=P(n),f=this.value;if(f<0!==a.sign)return this.add(a.negate());var d=a.value;return a.isSmall?new h(f-d):x(d,Math.abs(f),f>=0)},h.prototype.minus=h.prototype.subtract,g.prototype.subtract=function(n){return new g(this.value-P(n).value)},g.prototype.minus=g.prototype.subtract,c.prototype.negate=function(){return new c(this.value,!this.sign)},h.prototype.negate=function(){var n=this.sign,a=new h(-this.value);return a.sign=!n,a},g.prototype.negate=function(){return new g(-this.value)},c.prototype.abs=function(){return new c(this.value,!1)},h.prototype.abs=function(){return new h(Math.abs(this.value))},g.prototype.abs=function(){return new g(this.value>=0?this.value:-this.value)};function D(n,a){var f=n.length,d=a.length,y=f+d,m=k(y),w=r,v,S,A,N,B;for(A=0;A<f;++A){N=n[A];for(var L=0;L<d;++L)B=a[L],v=N*B+m[A+L],S=Math.floor(v/w),m[A+L]=v-S*w,m[A+L+1]+=S}return E(m),m}function q(n,a){var f=n.length,d=new Array(f),y=r,m=0,w,v;for(v=0;v<f;v++)w=n[v]*a+m,m=Math.floor(w/y),d[v]=w-m*y;for(;m>0;)d[v++]=m%y,m=Math.floor(m/y);return d}function Q(n,a){for(var f=[];a-- >0;)f.push(0);return f.concat(n)}function Xt(n,a){var f=Math.max(n.length,a.length);if(f<=30)return D(n,a);f=Math.ceil(f/2);var d=n.slice(f),y=n.slice(0,f),m=a.slice(f),w=a.slice(0,f),v=Xt(y,w),S=Xt(d,m),A=Xt(j(y,d),j(w,m)),N=j(j(v,Q(O(O(A,v),S),f)),Q(S,2*f));return E(N),N}function zs(n,a){return-.012*n-.012*a+15e-6*n*a>0}c.prototype.multiply=function(n){var a=P(n),f=this.value,d=a.value,y=this.sign!==a.sign,m;if(a.isSmall){if(d===0)return u[0];if(d===1)return this;if(d===-1)return this.negate();if(m=Math.abs(d),m<r)return new c(q(f,m),y);d=T(m)}return zs(f.length,d.length)?new c(Xt(f,d),y):new c(D(f,d),y)},c.prototype.times=c.prototype.multiply;function ze(n,a,f){return n<r?new c(q(a,n),f):new c(D(a,T(n)),f)}h.prototype._multiplyBySmall=function(n){return F(n.value*this.value)?new h(n.value*this.value):ze(Math.abs(n.value),T(Math.abs(this.value)),this.sign!==n.sign)},c.prototype._multiplyBySmall=function(n){return n.value===0?u[0]:n.value===1?this:n.value===-1?this.negate():ze(Math.abs(n.value),this.value,this.sign!==n.sign)},h.prototype.multiply=function(n){return P(n)._multiplyBySmall(this)},h.prototype.times=h.prototype.multiply,g.prototype.multiply=function(n){return new g(this.value*P(n).value)},g.prototype.times=g.prototype.multiply;function qe(n){var a=n.length,f=k(a+a),d=r,y,m,w,v,S;for(w=0;w<a;w++){v=n[w],m=0-v*v;for(var A=w;A<a;A++)S=n[A],y=2*(v*S)+f[w+A]+m,m=Math.floor(y/d),f[w+A]=y-m*d;f[w+a]=m}return E(f),f}c.prototype.square=function(){return new c(qe(this.value),!1)},h.prototype.square=function(){var n=this.value*this.value;return F(n)?new h(n):new c(qe(T(Math.abs(this.value))),!1)},g.prototype.square=function(n){return new g(this.value*this.value)};function qs(n,a){var f=n.length,d=a.length,y=r,m=k(a.length),w=a[d-1],v=Math.ceil(y/(2*w)),S=q(n,v),A=q(a,v),N,B,L,Y,K,me,ye;for(S.length<=f&&S.push(0),A.push(0),w=A[d-1],B=f-d;B>=0;B--){for(N=y-1,S[B+d]!==w&&(N=Math.floor((S[B+d]*y+S[B+d-1])/w)),L=0,Y=0,me=A.length,K=0;K<me;K++)L+=N*A[K],ye=Math.floor(L/y),Y+=S[B+K]-(L-ye*y),L=ye,Y<0?(S[B+K]=Y+y,Y=-1):(S[B+K]=Y,Y=0);for(;Y!==0;){for(N-=1,L=0,K=0;K<me;K++)L+=S[B+K]-y+A[K],L<0?(S[B+K]=L+y,L=0):(S[B+K]=L,L=1);Y+=L}m[B]=N}return S=We(S,v)[0],[U(m),U(S)]}function Ws(n,a){for(var f=n.length,d=a.length,y=[],m=[],w=r,v,S,A,N,B;f;){if(m.unshift(n[--f]),E(m),yt(m,a)<0){y.push(0);continue}S=m.length,A=m[S-1]*w+m[S-2],N=a[d-1]*w+a[d-2],S>d&&(A=(A+1)*w),v=Math.ceil(A/N);do{if(B=q(a,v),yt(B,m)<=0)break;v--}while(v);y.push(v),m=O(m,B)}return y.reverse(),[U(y),U(m)]}function We(n,a){var f=n.length,d=k(f),y=r,m,w,v,S;for(v=0,m=f-1;m>=0;--m)S=v*y+n[m],w=I(S/a),v=S-w*a,d[m]=w|0;return[d,v|0]}function mt(n,a){var f,d=P(a);if(_)return[new g(n.value/d.value),new g(n.value%d.value)];var y=n.value,m=d.value,w;if(m===0)throw new Error("Cannot divide by zero");if(n.isSmall)return d.isSmall?[new h(I(y/m)),new h(y%m)]:[u[0],n];if(d.isSmall){if(m===1)return[n,u[0]];if(m==-1)return[n.negate(),u[0]];var v=Math.abs(m);if(v<r){f=We(y,v),w=U(f[0]);var S=f[1];return n.sign&&(S=-S),typeof w=="number"?(n.sign!==d.sign&&(w=-w),[new h(w),new h(S)]):[new c(w,n.sign!==d.sign),new h(S)]}m=T(v)}var A=yt(y,m);if(A===-1)return[u[0],n];if(A===0)return[u[n.sign===d.sign?1:-1],u[0]];y.length+m.length<=200?f=qs(y,m):f=Ws(y,m),w=f[0];var N=n.sign!==d.sign,B=f[1],L=n.sign;return typeof w=="number"?(N&&(w=-w),w=new h(w)):w=new c(w,N),typeof B=="number"?(L&&(B=-B),B=new h(B)):B=new c(B,L),[w,B]}c.prototype.divmod=function(n){var a=mt(this,n);return{quotient:a[0],remainder:a[1]}},g.prototype.divmod=h.prototype.divmod=c.prototype.divmod,c.prototype.divide=function(n){return mt(this,n)[0]},g.prototype.over=g.prototype.divide=function(n){return new g(this.value/P(n).value)},h.prototype.over=h.prototype.divide=c.prototype.over=c.prototype.divide,c.prototype.mod=function(n){return mt(this,n)[1]},g.prototype.mod=g.prototype.remainder=function(n){return new g(this.value%P(n).value)},h.prototype.remainder=h.prototype.mod=c.prototype.remainder=c.prototype.mod,c.prototype.pow=function(n){var a=P(n),f=this.value,d=a.value,y,m,w;if(d===0)return u[1];if(f===0)return u[0];if(f===1)return u[1];if(f===-1)return a.isEven()?u[1]:u[-1];if(a.sign)return u[0];if(!a.isSmall)throw new Error("The exponent "+a.toString()+" is too large.");if(this.isSmall&&F(y=Math.pow(f,d)))return new h(I(y));for(m=this,w=u[1];d&!0&&(w=w.times(m),--d),d!==0;)d/=2,m=m.square();return w},h.prototype.pow=c.prototype.pow,g.prototype.pow=function(n){var a=P(n),f=this.value,d=a.value,y=BigInt(0),m=BigInt(1),w=BigInt(2);if(d===y)return u[1];if(f===y)return u[0];if(f===m)return u[1];if(f===BigInt(-1))return a.isEven()?u[1]:u[-1];if(a.isNegative())return new g(y);for(var v=this,S=u[1];(d&m)===m&&(S=S.times(v),--d),d!==y;)d/=w,v=v.square();return S},c.prototype.modPow=function(n,a){if(n=P(n),a=P(a),a.isZero())throw new Error("Cannot take modPow with modulus 0");var f=u[1],d=this.mod(a);for(n.isNegative()&&(n=n.multiply(u[-1]),d=d.modInv(a));n.isPositive();){if(d.isZero())return u[0];n.isOdd()&&(f=f.multiply(d).mod(a)),n=n.divide(2),d=d.square().mod(a)}return f},g.prototype.modPow=h.prototype.modPow=c.prototype.modPow;function yt(n,a){if(n.length!==a.length)return n.length>a.length?1:-1;for(var f=n.length-1;f>=0;f--)if(n[f]!==a[f])return n[f]>a[f]?1:-1;return 0}c.prototype.compareAbs=function(n){var a=P(n),f=this.value,d=a.value;return a.isSmall?1:yt(f,d)},h.prototype.compareAbs=function(n){var a=P(n),f=Math.abs(this.value),d=a.value;return a.isSmall?(d=Math.abs(d),f===d?0:f>d?1:-1):-1},g.prototype.compareAbs=function(n){var a=this.value,f=P(n).value;return a=a>=0?a:-a,f=f>=0?f:-f,a===f?0:a>f?1:-1},c.prototype.compare=function(n){if(n===1/0)return-1;if(n===-1/0)return 1;var a=P(n),f=this.value,d=a.value;return this.sign!==a.sign?a.sign?1:-1:a.isSmall?this.sign?-1:1:yt(f,d)*(this.sign?-1:1)},c.prototype.compareTo=c.prototype.compare,h.prototype.compare=function(n){if(n===1/0)return-1;if(n===-1/0)return 1;var a=P(n),f=this.value,d=a.value;return a.isSmall?f==d?0:f>d?1:-1:f<0!==a.sign?f<0?-1:1:f<0?1:-1},h.prototype.compareTo=h.prototype.compare,g.prototype.compare=function(n){if(n===1/0)return-1;if(n===-1/0)return 1;var a=this.value,f=P(n).value;return a===f?0:a>f?1:-1},g.prototype.compareTo=g.prototype.compare,c.prototype.equals=function(n){return this.compare(n)===0},g.prototype.eq=g.prototype.equals=h.prototype.eq=h.prototype.equals=c.prototype.eq=c.prototype.equals,c.prototype.notEquals=function(n){return this.compare(n)!==0},g.prototype.neq=g.prototype.notEquals=h.prototype.neq=h.prototype.notEquals=c.prototype.neq=c.prototype.notEquals,c.prototype.greater=function(n){return this.compare(n)>0},g.prototype.gt=g.prototype.greater=h.prototype.gt=h.prototype.greater=c.prototype.gt=c.prototype.greater,c.prototype.lesser=function(n){return this.compare(n)<0},g.prototype.lt=g.prototype.lesser=h.prototype.lt=h.prototype.lesser=c.prototype.lt=c.prototype.lesser,c.prototype.greaterOrEquals=function(n){return this.compare(n)>=0},g.prototype.geq=g.prototype.greaterOrEquals=h.prototype.geq=h.prototype.greaterOrEquals=c.prototype.geq=c.prototype.greaterOrEquals,c.prototype.lesserOrEquals=function(n){return this.compare(n)<=0},g.prototype.leq=g.prototype.lesserOrEquals=h.prototype.leq=h.prototype.lesserOrEquals=c.prototype.leq=c.prototype.lesserOrEquals,c.prototype.isEven=function(){return(this.value[0]&1)===0},h.prototype.isEven=function(){return(this.value&1)===0},g.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},c.prototype.isOdd=function(){return(this.value[0]&1)===1},h.prototype.isOdd=function(){return(this.value&1)===1},g.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},c.prototype.isPositive=function(){return!this.sign},h.prototype.isPositive=function(){return this.value>0},g.prototype.isPositive=h.prototype.isPositive,c.prototype.isNegative=function(){return this.sign},h.prototype.isNegative=function(){return this.value<0},g.prototype.isNegative=h.prototype.isNegative,c.prototype.isUnit=function(){return!1},h.prototype.isUnit=function(){return Math.abs(this.value)===1},g.prototype.isUnit=function(){return this.abs().value===BigInt(1)},c.prototype.isZero=function(){return!1},h.prototype.isZero=function(){return this.value===0},g.prototype.isZero=function(){return this.value===BigInt(0)},c.prototype.isDivisibleBy=function(n){var a=P(n);return a.isZero()?!1:a.isUnit()?!0:a.compareAbs(2)===0?this.isEven():this.mod(a).isZero()},g.prototype.isDivisibleBy=h.prototype.isDivisibleBy=c.prototype.isDivisibleBy;function je(n){var a=n.abs();if(a.isUnit())return!1;if(a.equals(2)||a.equals(3)||a.equals(5))return!0;if(a.isEven()||a.isDivisibleBy(3)||a.isDivisibleBy(5))return!1;if(a.lesser(49))return!0}function pe(n,a){for(var f=n.prev(),d=f,y=0,m,w,v;d.isEven();)d=d.divide(2),y++;t:for(w=0;w<a.length;w++)if(!n.lesser(a[w])&&(v=t(a[w]).modPow(d,n),!(v.isUnit()||v.equals(f)))){for(m=y-1;m!=0;m--){if(v=v.square().mod(n),v.isUnit())return!1;if(v.equals(f))continue t}return!1}return!0}c.prototype.isPrime=function(n){var a=je(this);if(a!==s)return a;var f=this.abs(),d=f.bitLength();if(d<=64)return pe(f,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var y=Math.log(2)*d.toJSNumber(),m=Math.ceil(n===!0?2*Math.pow(y,2):y),w=[],v=0;v<m;v++)w.push(t(v+2));return pe(f,w)},g.prototype.isPrime=h.prototype.isPrime=c.prototype.isPrime,c.prototype.isProbablePrime=function(n,a){var f=je(this);if(f!==s)return f;for(var d=this.abs(),y=n===s?5:n,m=[],w=0;w<y;w++)m.push(t.randBetween(2,d.minus(2),a));return pe(d,m)},g.prototype.isProbablePrime=h.prototype.isProbablePrime=c.prototype.isProbablePrime,c.prototype.modInv=function(n){for(var a=t.zero,f=t.one,d=P(n),y=this.abs(),m,w,v;!y.isZero();)m=d.divide(y),w=a,v=d,a=f,d=y,f=w.subtract(m.multiply(f)),y=v.subtract(m.multiply(y));if(!d.isUnit())throw new Error(this.toString()+" and "+n.toString()+" are not co-prime");return a.compare(0)===-1&&(a=a.add(n)),this.isNegative()?a.negate():a},g.prototype.modInv=h.prototype.modInv=c.prototype.modInv,c.prototype.next=function(){var n=this.value;return this.sign?x(n,1,this.sign):new c(M(n,1),this.sign)},h.prototype.next=function(){var n=this.value;return n+1<o?new h(n+1):new c(l,!1)},g.prototype.next=function(){return new g(this.value+BigInt(1))},c.prototype.prev=function(){var n=this.value;return this.sign?new c(M(n,1),!0):x(n,1,this.sign)},h.prototype.prev=function(){var n=this.value;return n-1>-o?new h(n-1):new c(l,!0)},g.prototype.prev=function(){return new g(this.value-BigInt(1))};for(var ct=[1];2*ct[ct.length-1]<=r;)ct.push(2*ct[ct.length-1]);var It=ct.length,wt=ct[It-1];function $e(n){return Math.abs(n)<=r}c.prototype.shiftLeft=function(n){var a=P(n).toJSNumber();if(!$e(a))throw new Error(String(a)+" is too large for shifting.");if(a<0)return this.shiftRight(-a);var f=this;if(f.isZero())return f;for(;a>=It;)f=f.multiply(wt),a-=It-1;return f.multiply(ct[a])},g.prototype.shiftLeft=h.prototype.shiftLeft=c.prototype.shiftLeft,c.prototype.shiftRight=function(n){var a,f=P(n).toJSNumber();if(!$e(f))throw new Error(String(f)+" is too large for shifting.");if(f<0)return this.shiftLeft(-f);for(var d=this;f>=It;){if(d.isZero()||d.isNegative()&&d.isUnit())return d;a=mt(d,wt),d=a[1].isNegative()?a[0].prev():a[0],f-=It-1}return a=mt(d,ct[f]),a[1].isNegative()?a[0].prev():a[0]},g.prototype.shiftRight=h.prototype.shiftRight=c.prototype.shiftRight;function de(n,a,f){a=P(a);for(var d=n.isNegative(),y=a.isNegative(),m=d?n.not():n,w=y?a.not():a,v=0,S=0,A=null,N=null,B=[];!m.isZero()||!w.isZero();)A=mt(m,wt),v=A[1].toJSNumber(),d&&(v=wt-1-v),N=mt(w,wt),S=N[1].toJSNumber(),y&&(S=wt-1-S),m=A[0],w=N[0],B.push(f(v,S));for(var L=f(d?1:0,y?1:0)!==0?t(-1):t(0),Y=B.length-1;Y>=0;Y-=1)L=L.multiply(wt).add(t(B[Y]));return L}c.prototype.not=function(){return this.negate().prev()},g.prototype.not=h.prototype.not=c.prototype.not,c.prototype.and=function(n){return de(this,n,function(a,f){return a&f})},g.prototype.and=h.prototype.and=c.prototype.and,c.prototype.or=function(n){return de(this,n,function(a,f){return a|f})},g.prototype.or=h.prototype.or=c.prototype.or,c.prototype.xor=function(n){return de(this,n,function(a,f){return a^f})},g.prototype.xor=h.prototype.xor=c.prototype.xor;var ge=1<<30,js=(r&-r)*(r&-r)|ge;function Qt(n){var a=n.value,f=typeof a=="number"?a|ge:typeof a=="bigint"?a|BigInt(ge):a[0]+a[1]*r|js;return f&-f}function Je(n,a){if(a.compareTo(n)<=0){var f=Je(n,a.square(a)),d=f.p,y=f.e,m=d.multiply(a);return m.compareTo(n)<=0?{p:m,e:y*2+1}:{p:d,e:y*2}}return{p:t(1),e:0}}c.prototype.bitLength=function(){var n=this;return n.compareTo(t(0))<0&&(n=n.negate().subtract(t(1))),n.compareTo(t(0))===0?t(0):t(Je(n,t(2)).e).add(t(1))},g.prototype.bitLength=h.prototype.bitLength=c.prototype.bitLength;function He(n,a){return n=P(n),a=P(a),n.greater(a)?n:a}function _e(n,a){return n=P(n),a=P(a),n.lesser(a)?n:a}function Ke(n,a){if(n=P(n).abs(),a=P(a).abs(),n.equals(a))return n;if(n.isZero())return a;if(a.isZero())return n;for(var f=u[1],d,y;n.isEven()&&a.isEven();)d=_e(Qt(n),Qt(a)),n=n.divide(d),a=a.divide(d),f=f.multiply(d);for(;n.isEven();)n=n.divide(Qt(n));do{for(;a.isEven();)a=a.divide(Qt(a));n.greater(a)&&(y=a,a=n,n=y),a=a.subtract(n)}while(!a.isZero());return f.isUnit()?n:n.multiply(f)}function $s(n,a){return n=P(n).abs(),a=P(a).abs(),n.divide(Ke(n,a)).multiply(a)}function Js(n,a,f){n=P(n),a=P(a);var d=f||Math.random,y=_e(n,a),m=He(n,a),w=m.subtract(y).add(1);if(w.isSmall)return y.add(Math.floor(d()*w));for(var v=Bt(w,r).value,S=[],A=!0,N=0;N<v.length;N++){var B=A?v[N]+(N+1<v.length?v[N+1]/r:0):r,L=I(d()*B);S.push(L),L<v[N]&&(A=!1)}return y.add(u.fromArray(S,r,!1))}var Hs=function(n,a,f,d){f=f||p,n=String(n),d||(n=n.toLowerCase(),f=f.toLowerCase());var y=n.length,m,w=Math.abs(a),v={};for(m=0;m<f.length;m++)v[f[m]]=m;for(m=0;m<y;m++){var S=n[m];if(S!=="-"&&S in v&&v[S]>=w){if(S==="1"&&w===1)continue;throw new Error(S+" is not a valid digit in base "+a+".")}}a=P(a);var A=[],N=n[0]==="-";for(m=N?1:0;m<n.length;m++){var S=n[m];if(S in v)A.push(P(v[S]));else if(S==="<"){var B=m;do m++;while(n[m]!==">"&&m<n.length);A.push(P(n.slice(B+1,m)))}else throw new Error(S+" is not a valid character")}return Ve(A,a,N)};function Ve(n,a,f){var d=u[0],y=u[1],m;for(m=n.length-1;m>=0;m--)d=d.add(n[m].times(y)),y=y.times(a);return f?d.negate():d}function Ks(n,a){return a=a||p,n<a.length?a[n]:"<"+n+">"}function Bt(n,a){if(a=t(a),a.isZero()){if(n.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(a.equals(-1)){if(n.isZero())return{value:[0],isNegative:!1};if(n.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-n.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var f=Array.apply(null,Array(n.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return f.unshift([1]),{value:[].concat.apply([],f),isNegative:!1}}var d=!1;if(n.isNegative()&&a.isPositive()&&(d=!0,n=n.abs()),a.isUnit())return n.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(n.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:d};for(var y=[],m=n,w;m.isNegative()||m.compareAbs(a)>=0;){w=m.divmod(a),m=w.quotient;var v=w.remainder;v.isNegative()&&(v=a.minus(v).abs(),m=m.next()),y.push(v.toJSNumber())}return y.push(m.toJSNumber()),{value:y.reverse(),isNegative:d}}function Ye(n,a,f){var d=Bt(n,a);return(d.isNegative?"-":"")+d.value.map(function(y){return Ks(y,f)}).join("")}c.prototype.toArray=function(n){return Bt(this,n)},h.prototype.toArray=function(n){return Bt(this,n)},g.prototype.toArray=function(n){return Bt(this,n)},c.prototype.toString=function(n,a){if(n===s&&(n=10),n!==10||a)return Ye(this,n,a);for(var f=this.value,d=f.length,y=String(f[--d]),m="0000000",w;--d>=0;)w=String(f[d]),y+=m.slice(w.length)+w;var v=this.sign?"-":"";return v+y},h.prototype.toString=function(n,a){return n===s&&(n=10),n!=10||a?Ye(this,n,a):String(this.value)},g.prototype.toString=h.prototype.toString,g.prototype.toJSON=c.prototype.toJSON=h.prototype.toJSON=function(){return this.toString()},c.prototype.valueOf=function(){return parseInt(this.toString(),10)},c.prototype.toJSNumber=c.prototype.valueOf,h.prototype.valueOf=function(){return this.value},h.prototype.toJSNumber=h.prototype.valueOf,g.prototype.valueOf=g.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function Ge(n){if(F(+n)){var a=+n;if(a===I(a))return _?new g(BigInt(a)):new h(a);throw new Error("Invalid integer: "+n)}var f=n[0]==="-";f&&(n=n.slice(1));var d=n.split(/e/i);if(d.length>2)throw new Error("Invalid integer: "+d.join("e"));if(d.length===2){var y=d[1];if(y[0]==="+"&&(y=y.slice(1)),y=+y,y!==I(y)||!F(y))throw new Error("Invalid integer: "+y+" is not a valid exponent.");var m=d[0],w=m.indexOf(".");if(w>=0&&(y-=m.length-w-1,m=m.slice(0,w)+m.slice(w+1)),y<0)throw new Error("Cannot include negative exponent part for integers");m+=new Array(y+1).join("0"),n=m}var v=/^([0-9][0-9]*)$/.test(n);if(!v)throw new Error("Invalid integer: "+n);if(_)return new g(BigInt(f?"-"+n:n));for(var S=[],A=n.length,N=i,B=A-N;A>0;)S.push(+n.slice(B,A)),B-=N,B<0&&(B=0),A-=N;return E(S),new c(S,f)}function Vs(n){if(_)return new g(BigInt(n));if(F(n)){if(n!==I(n))throw new Error(n+" is not an integer.");return new h(n)}return Ge(n.toString())}function P(n){return typeof n=="number"?Vs(n):typeof n=="string"?Ge(n):typeof n=="bigint"?new g(n):n}for(var vt=0;vt<1e3;vt++)u[vt]=P(vt),vt>0&&(u[-vt]=P(-vt));return u.one=u[1],u.zero=u[0],u.minusOne=u[-1],u.max=He,u.min=_e,u.gcd=Ke,u.lcm=$s,u.isInstance=function(n){return n instanceof c||n instanceof h||n instanceof g},u.randBetween=Js,u.fromArray=function(n,a,f){return Ve(n.map(P),P(a||10),f)},u}();e.hasOwnProperty("exports")&&(e.exports=t)})(Is);var li=Is.exports,ht=ci(li),R={};R.parseBuffer=function(e){return new at(e).parse()};R.addBoxProcessor=function(e,t){typeof e!="string"||typeof t!="function"||(b.prototype._boxProcessors[e]=t)};R.createFile=function(){return new at};R.createBox=function(e,t,s){var r=b.create(e);return t&&t.append(r,s),r};R.createFullBox=function(e,t,s){var r=R.createBox(e,t,s);return r.version=0,r.flags=0,r};R.Utils={};R.Utils.dataViewToString=function(e,t){var s=t||"utf-8";if(typeof TextDecoder<"u")return new TextDecoder(s).decode(e);var r=[],i=0;if(s==="utf-8")for(;i<e.byteLength;){var o=e.getUint8(i++);o<128||(o<224?(o=(o&31)<<6,o|=e.getUint8(i++)&63):o<240?(o=(o&15)<<12,o|=(e.getUint8(i++)&63)<<6,o|=e.getUint8(i++)&63):(o=(o&7)<<18,o|=(e.getUint8(i++)&63)<<12,o|=(e.getUint8(i++)&63)<<6,o|=e.getUint8(i++)&63)),r.push(String.fromCharCode(o))}else for(;i<e.byteLength;)r.push(String.fromCharCode(e.getUint8(i++)));return r.join("")};R.Utils.utf8ToByteArray=function(e){var t,s;if(typeof TextEncoder<"u")t=new TextEncoder().encode(e);else for(t=[],s=0;s<e.length;++s){var r=e.charCodeAt(s);r<128?t.push(r):r<2048?(t.push(192|r>>6),t.push(128|63&r)):r<65536?(t.push(224|r>>12),t.push(128|63&r>>6),t.push(128|63&r)):(t.push(240|r>>18),t.push(128|63&r>>12),t.push(128|63&r>>6),t.push(128|63&r))}return t};R.Utils.appendBox=function(e,t,s){if(t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,s!==-1){if(s==null){e.boxes.push(t);return}var r=-1,i;if(typeof s=="number")r=s;else{if(typeof s=="string")i=s;else if(typeof s=="object"&&s.type)i=s.type;else{e.boxes.push(t);return}for(var o=0;o<e.boxes.length;o++)if(i===e.boxes[o].type){r=o+1;break}}e.boxes.splice(r,0,t)}};R.Cursor=function(e){this.offset=typeof e>"u"?0:e};var at=function(e){this._cursor=new R.Cursor,this.boxes=[],e&&(this._raw=new DataView(e))};at.prototype.fetch=function(e){var t=this.fetchAll(e,!0);return t.length?t[0]:null};at.prototype.fetchAll=function(e,t){var s=[];return at._sweep.call(this,e,s,t),s};at.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var e=b.parse(this);if(typeof e.type>"u")break;this.boxes.push(e)}return this};at._sweep=function(e,t,s){this.type&&this.type==e&&t.push(this);for(var r in this.boxes){if(t.length&&s)return;at._sweep.call(this.boxes[r],e,t,s)}};at.prototype.write=function(){var e=0,t;for(t=0;t<this.boxes.length;t++)e+=this.boxes[t].getLength(!1);var s=new Uint8Array(e);for(this._rawo=new DataView(s.buffer),this.bytes=s,this._cursor.offset=0,t=0;t<this.boxes.length;t++)this.boxes[t].write();return s.buffer};at.prototype.append=function(e,t){R.Utils.appendBox(this,e,t)};var b=function(){this._cursor=new R.Cursor};b.parse=function(e){var t=new b;return t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,t._parseBox(),e._cursor.offset=t._raw.byteOffset+t._raw.byteLength,t};b.create=function(e){var t=new b;return t.type=e,t.boxes=[],t};b.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca","ilst"];b.prototype._boxProcessors={};b.prototype._procField=function(e,t,s){this._parsing?this[e]=this._readField(t,s):this._writeField(t,s,this[e])};b.prototype._procFieldArray=function(e,t,s,r){var i;if(this._parsing)for(this[e]=[],i=0;i<t;i++)this[e][i]=this._readField(s,r);else for(i=0;i<this[e].length;i++)this._writeField(s,r,this[e][i])};b.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24)};b.prototype._procEntries=function(e,t,s){var r;if(this._parsing)for(this[e]=[],r=0;r<t;r++)this[e].push({}),s.call(this,this[e][r]);else for(r=0;r<t;r++)s.call(this,this[e][r])};b.prototype._procSubEntries=function(e,t,s,r){var i;if(this._parsing)for(e[t]=[],i=0;i<s;i++)e[t].push({}),r.call(this,e[t][i]);else for(i=0;i<s;i++)r.call(this,e[t][i])};b.prototype._procEntryField=function(e,t,s,r){this._parsing?e[t]=this._readField(s,r):this._writeField(s,r,e[t])};b.prototype._procSubBoxes=function(e,t=-1){const s=t===-1;var r;if(this._parsing){s&&(t=1/0);const i=this._offset+this.size;for(this[e]=[],r=0;r<t&&(this[e].push(b.parse(this)),!(s&&this._cursor.offset>=i));r++);}else for(s&&(t=this[e].length),r=0;r<t;r++)this._rawo?this[e][r].write():this.size+=this[e][r].getLength()};b.prototype._readField=function(e,t){switch(e){case"uint":return this._readUint(t);case"int":return this._readInt(t);case"template":return this._readTemplate(t);case"string":return t===-1?this._readTerminatedString():this._readString(t);case"data":return this._readData(t);case"utf8":return this._readUTF8String();default:return-1}};b.prototype._readInt=function(e){var t=null,s=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:t=this._raw.getInt8(s);break;case 16:t=this._raw.getInt16(s);break;case 32:t=this._raw.getInt32(s);break;case 64:{const r=this._raw.getInt32(s),i=this._raw.getInt32(s+4);t=ht(r).shiftLeft(32).add(i);break}}return this._cursor.offset+=e>>3,t};b.prototype._readUint=function(e){var t=null,s=this._cursor.offset-this._raw.byteOffset,r,i;switch(e){case 8:t=this._raw.getUint8(s);break;case 16:t=this._raw.getUint16(s);break;case 24:r=this._raw.getUint16(s),i=this._raw.getUint8(s+2),t=(r<<8)+i;break;case 32:t=this._raw.getUint32(s);break;case 64:{const o=this._raw.getUint32(s),l=this._raw.getUint32(s+4);t=ht(o).shiftLeft(32).add(l);break}}return this._cursor.offset+=e>>3,t};b.prototype._readString=function(e){for(var t="",s=0;s<e;s++){var r=this._readUint(8);t+=String.fromCharCode(r)}return t};b.prototype._readTemplate=function(e){var t=this._readUint(e/2),s=this._readUint(e/2);return t+s/Math.pow(2,e/2)};b.prototype._readTerminatedString=function(){for(var e="";this._cursor.offset-this._offset<this._raw.byteLength;){var t=this._readUint(8);if(t===0)break;e+=String.fromCharCode(t)}return e};b.prototype._readData=function(e){var t=e>0?e:this._raw.byteLength-(this._cursor.offset-this._offset);if(t>0){var s=new Uint8Array(this._raw.buffer,this._cursor.offset,t);return this._cursor.offset+=t,s}else return null};b.prototype._readUTF8String=function(){var e=this._raw.byteLength-(this._cursor.offset-this._offset),t=null;return e>0&&(t=new DataView(this._raw.buffer,this._cursor.offset,e),this._cursor.offset+=e),t&&R.Utils.dataViewToString(t)};b.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength){this._root._incomplete=!0;return}switch(this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1?this._parseContainerBox():this._data=this._readData())};b.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)};b.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(b.parse(this))};b.prototype.append=function(e,t){R.Utils.appendBox(this,e,t)};b.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1)for(var e=0;e<this.boxes.length;e++)this.size+=this.boxes[e].getLength();return this._data&&this._writeData(this._data),this.size};b.prototype.write=function(){if(this._parsing=!1,!this._parent)throw new Error(`no root at ${this.type}`);switch(this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._parent._rawo||console.log(this.type),this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1)for(var e=0;e<this.boxes.length;e++)this.boxes[e].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size};b.prototype._writeInt=function(e,t){if(this._rawo){var s=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setInt8(s,t);break;case 16:this._rawo.setInt16(s,t);break;case 32:this._rawo.setInt32(s,t);break;case 64:this._rawo.setUint32(s,t.shiftRight(32).and(4294967295).toJSNumber()),this._rawo.setUint32(s+4,t.and(4294967295).toJSNumber());break}this._cursor.offset+=e>>3}else this.size+=e>>3};b.prototype._writeUint=function(e,t){if(this._rawo){var s=this._cursor.offset-this._rawo.byteOffset,r,i;switch(e){case 8:this._rawo.setUint8(s,t);break;case 16:this._rawo.setUint16(s,t);break;case 24:r=(t&16776960)>>8,i=t&255,this._rawo.setUint16(s,r),this._rawo.setUint8(s+2,i);break;case 32:this._rawo.setUint32(s,t);break;case 64:{this._rawo.setUint32(s,t.shiftRight(32).and(4294967295).toJSNumber()),this._rawo.setUint32(s+4,t.and(4294967295).toJSNumber());break}}this._cursor.offset+=e>>3}else this.size+=e>>3};b.prototype._writeString=function(e,t){for(var s=0;s<e;s++)this._writeUint(8,t.charCodeAt(s))};b.prototype._writeTerminatedString=function(e){if(e.length!==0){for(var t=0;t<e.length;t++)this._writeUint(8,e.charCodeAt(t));this._writeUint(8,0)}};b.prototype._writeTemplate=function(e,t){var s=Math.floor(t),r=(t-s)*Math.pow(2,e/2);this._writeUint(e/2,s),this._writeUint(e/2,r)};b.prototype._writeData=function(e){var t;if(e)if(this._rawo){if(e instanceof Array){for(var s=this._cursor.offset-this._rawo.byteOffset,t=0;t<e.length;t++)this._rawo.setInt8(s+t,e[t]);this._cursor.offset+=e.length}e instanceof Uint8Array&&(this._root.bytes.set(e,this._cursor.offset),this._cursor.offset+=e.length)}else this.size+=e.length};b.prototype._writeUTF8String=function(e){var t=R.Utils.utf8ToByteArray(e);if(this._rawo)for(var s=new DataView(this._rawo.buffer,this._cursor.offset,t.length),r=0;r<t.length;r++)s.setUint8(r,t[r]);else this.size+=t.length};b.prototype._writeField=function(e,t,s){switch(e){case"uint":this._writeUint(t,s);break;case"int":this._writeInt(t,s);break;case"template":this._writeTemplate(t,s);break;case"string":t==-1?this._writeTerminatedString(s):this._writeString(t,s);break;case"data":this._writeData(s);break;case"utf8":this._writeUTF8String(s);break}};b.prototype._boxProcessors.avc1=b.prototype._boxProcessors.avc2=b.prototype._boxProcessors.avc3=b.prototype._boxProcessors.avc4=b.prototype._boxProcessors.hvc1=b.prototype._boxProcessors.hev1=b.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1)};b.prototype._boxProcessors.ctts=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"sample_count","uint",32),this._procEntryField(e,"sample_offset",this.version===1?"int":"uint",32)})};b.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)};b.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"segment_duration","uint",this.version===1?64:32),this._procEntryField(e,"media_time","int",this.version===1?64:32),this._procEntryField(e,"media_rate_integer","int",16),this._procEntryField(e,"media_rate_fraction","int",16)})};b.prototype._boxProcessors.emsg=function(){this._procFullBox(),this.version==1?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1)};b.prototype._boxProcessors.free=b.prototype._boxProcessors.skip=function(){this._procField("data","data",-1)};b.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32)};b.prototype._boxProcessors.ftyp=b.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var e=-1;this._parsing&&(e=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",e,"string",4)};b.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)};b.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1)};b.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",this.version==1?64:32),!this._parsing&&typeof this.language=="string"&&(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode((this.language>>10&31)+96,(this.language>>5&31)+96,(this.language&31)+96)),this._procField("pre_defined","uint",16)};b.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",this.version==1?64:32)};b.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32)};b.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32)};b.prototype._boxProcessors.mp4a=b.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procSubBoxes("esds",1)};b.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",this.version==1?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32)};b.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8")};b.prototype._boxProcessors.prft=function(){this._procFullBox(),this._procField("reference_track_ID","uint",32),this._procField("ntp_timestamp_sec","uint",32),this._procField("ntp_timestamp_frac","uint",32),this._procField("media_time","uint",this.version==1?64:32)};b.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8)};b.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),this.flags&1&&this._procField("scheme_uri","string",-1)};b.prototype._boxProcessors.sdtp=function(){this._procFullBox();var e=-1;this._parsing&&(e=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",e,"uint",8)};b.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",this.version==1?64:32),this._procField("first_offset","uint",this.version==1?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,function(e){this._parsing||(e.reference=(e.reference_type&1)<<31,e.reference|=e.referenced_size&2147483647,e.sap=(e.starts_with_SAP&1)<<31,e.sap|=(e.SAP_type&3)<<28,e.sap|=e.SAP_delta_time&268435455),this._procEntryField(e,"reference","uint",32),this._procEntryField(e,"subsegment_duration","uint",32),this._procEntryField(e,"sap","uint",32),this._parsing&&(e.reference_type=e.reference>>31&1,e.referenced_size=e.reference&2147483647,e.starts_with_SAP=e.sap>>31&1,e.SAP_type=e.sap>>28&7,e.SAP_delta_time=e.sap&268435455)})};b.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16)};b.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,function(e){this._procEntryField(e,"ranges_count","uint",32),this._procSubEntries(e,"ranges",e.ranges_count,function(t){this._procEntryField(t,"level","uint",8),this._procEntryField(t,"range_size","uint",24)})})};b.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)};b.prototype._boxProcessors.stts=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"sample_count","uint",32),this._procEntryField(e,"sample_delta","uint",32)})};b.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"sample_delta","uint",32),this._procEntryField(e,"subsample_count","uint",16),this._procSubEntries(e,"subsamples",e.subsample_count,function(t){this._procEntryField(t,"subsample_size","uint",this.version===1?32:16),this._procEntryField(t,"subsample_priority","uint",8),this._procEntryField(t,"discardable","uint",8),this._procEntryField(t,"codec_specific_parameters","uint",32)})})};b.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8)};b.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",this.version==1?64:32)};b.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),this.flags&1&&this._procField("base_data_offset","uint",64),this.flags&2&&this._procField("sample_description_offset","uint",32),this.flags&8&&this._procField("default_sample_duration","uint",32),this.flags&16&&this._procField("default_sample_size","uint",32),this.flags&32&&this._procField("default_sample_flags","uint",32)};b.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(this.length_size_of_traf_num&48)<<4,this.reserved|=(this.length_size_of_trun_num&12)<<2,this.reserved|=this.length_size_of_sample_num&3),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(this.reserved&48)>>4,this.length_size_of_trun_num=(this.reserved&12)>>2,this.length_size_of_sample_num=this.reserved&3),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,function(e){this._procEntryField(e,"time","uint",this.version===1?64:32),this._procEntryField(e,"moof_offset","uint",this.version===1?64:32),this._procEntryField(e,"traf_number","uint",(this.length_size_of_traf_num+1)*8),this._procEntryField(e,"trun_number","uint",(this.length_size_of_trun_num+1)*8),this._procEntryField(e,"sample_number","uint",(this.length_size_of_sample_num+1)*8)})};b.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",this.version==1?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32)};b.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32)};b.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),this.flags&1&&this._procField("data_offset","int",32),this.flags&4&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,function(e){this.flags&256&&this._procEntryField(e,"sample_duration","uint",32),this.flags&512&&this._procEntryField(e,"sample_size","uint",32),this.flags&1024&&this._procEntryField(e,"sample_flags","uint",32),this.flags&2048&&this._procEntryField(e,"sample_composition_time_offset",this.version===1?"int":"uint",32)})};b.prototype._boxProcessors["url "]=b.prototype._boxProcessors["urn "]=function(){this._procFullBox(),this.type==="urn "&&this._procField("name","string",-1),this._procField("location","string",-1)};b.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8")};b.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16)};b.prototype._boxProcessors.vttC=function(){this._procField("config","utf8")};b.prototype._boxProcessors.vtte=function(){};b.prototype._boxProcessors.stco=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procFieldArray("chunk_offsets",this.entry_count,"uint",32)};b.prototype._boxProcessors.stsz=function(){this._procFullBox(),this._procField("sample_size","uint",32),this._procField("sample_count","uint",32),this.sample_size===0&&this._procFieldArray("entry_sizes",this.sample_count,"uint",32)};b.prototype._boxProcessors.stsc=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"first_chunk","uint",32),this._procEntryField(e,"samples_per_chunk","uint",32),this._procEntryField(e,"sample_description_index","uint",32)})};b.prototype._boxProcessors.stss=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procFieldArray("sample_numbers",this.entry_count,"uint",32)};b.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)};b.prototype._boxProcessors.Opus=function(){this._procFieldArray("reserved1",3,"uint",16),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channel_count","uint",16),this._procField("sample_size","uint",16),this._procFieldArray("reserved3",2,"uint",16),this._procField("samplerate","template",32),this._procSubBoxes("entries")};b.prototype._boxProcessors.dOps=function(){this._procField("version","int",8),this._procField("output_channel_count","uint",8),this._procField("pre_skip","uint",16),this._procField("input_sample_rate","uint",32),this._procField("output_gain","uint",16),this._procField("channel_mapping_family","uint",8),this.channel_mapping_family!==0&&(this._procField("stream_count","uint",8),this._procField("coupled_count","uint",8),this._procFieldArray("channel_mapping",this.output_channel_count,"uint",8))};b.prototype._boxProcessors.fLaC=function(){this._procFieldArray("reserved1",3,"uint",16),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channel_count","uint",16),this._procField("sample_size","uint",16),this._procFieldArray("reserved3",2,"uint",16),this._procField("sample_rate","template",32),this._procSubBoxes("entries")};b.prototype._boxProcessors.dfLa=function(){this._procFullBox()};b.prototype._boxProcessors.btrt=function(){this._procField("bufferSizeDB","uint",32),this._procField("maxBitrate","uint",32),this._procField("avgBitrate","uint",32)};const hi=new Uint8Array([0,7,14,9,28,27,18,21,56,63,54,49,36,35,42,45,112,119,126,121,108,107,98,101,72,79,70,65,84,83,90,93,224,231,238,233,252,251,242,245,216,223,214,209,196,195,202,205,144,151,158,153,140,139,130,133,168,175,166,161,180,179,186,189,199,192,201,206,219,220,213,210,255,248,241,246,227,228,237,234,183,176,185,190,171,172,165,162,143,136,129,134,147,148,157,154,39,32,41,46,59,60,53,50,31,24,17,22,3,4,13,10,87,80,89,94,75,76,69,66,111,104,97,102,115,116,125,122,137,142,135,128,149,146,155,156,177,182,191,184,173,170,163,164,249,254,247,240,229,226,235,236,193,198,207,200,221,218,211,212,105,110,103,96,117,114,123,124,81,86,95,88,77,74,67,68,25,30,23,16,5,2,11,12,33,38,47,40,61,58,51,52,78,73,64,71,82,85,92,91,118,113,120,127,106,109,100,99,62,57,48,55,34,37,44,43,6,1,8,15,26,29,20,19,174,169,160,167,178,181,188,187,150,145,152,159,138,141,132,131,222,217,208,215,194,197,204,203,230,225,232,239,250,253,244,243]),ui=new Uint16Array([0,32773,32783,10,32795,30,20,32785,32819,54,60,32825,40,32813,32807,34,32867,102,108,32873,120,32893,32887,114,80,32853,32863,90,32843,78,68,32833,32963,198,204,32969,216,32989,32983,210,240,33013,33023,250,33003,238,228,32993,160,32933,32943,170,32955,190,180,32945,32915,150,156,32921,136,32909,32903,130,33155,390,396,33161,408,33181,33175,402,432,33205,33215,442,33195,430,420,33185,480,33253,33263,490,33275,510,500,33265,33235,470,476,33241,456,33229,33223,450,320,33093,33103,330,33115,350,340,33105,33139,374,380,33145,360,33133,33127,354,33059,294,300,33065,312,33085,33079,306,272,33045,33055,282,33035,270,260,33025,33539,774,780,33545,792,33565,33559,786,816,33589,33599,826,33579,814,804,33569,864,33637,33647,874,33659,894,884,33649,33619,854,860,33625,840,33613,33607,834,960,33733,33743,970,33755,990,980,33745,33779,1014,1020,33785,1e3,33773,33767,994,33699,934,940,33705,952,33725,33719,946,912,33685,33695,922,33675,910,900,33665,640,33413,33423,650,33435,670,660,33425,33459,694,700,33465,680,33453,33447,674,33507,742,748,33513,760,33533,33527,754,720,33493,33503,730,33483,718,708,33473,33347,582,588,33353,600,33373,33367,594,624,33397,33407,634,33387,622,612,33377,544,33317,33327,554,33339,574,564,33329,33299,534,540,33305,520,33293,33287,514]);function fi(e){let t=0;for(let s=0;s<e.length;s++)t=hi[t^e[s]];return t}function pi(e){let t=0;for(let s=0;s<e.length;s++)t=(t<<8^ui[t>>8^e[s]])&65535;return t}function di(e,t,s){for(;;){const r=s&127;if(s>>=7,s===0){e.setUint8(t++,r);break}else e.setUint8(t++,r|128)}return t}function gi(e){const t=new Uint8Array(1e4),s=new DataView(t.buffer,t.byteOffset,t.byteLength);s.setUint16(0,65528),s.setUint8(2,122);const r=e.pcms.length-1;if(r>7)throw new Error("Too many channels");s.setUint8(3,r<<4|8);let o=di(s,4,e.index);s.setUint16(o,e.blockSize-1),o+=2;const l=fi(t.subarray(0,o));s.setUint8(o++,l);for(const _ of e.pcms){s.setUint8(o++,2);let u=_[0],c=0,h=0;for(let g=0;g<e.blockSize;g++)h>=u.length&&(u=_[++c],h=0),s.setInt16(o,u[h++]),o+=2;c>0&&_.splice(0,c),h>0&&(_[0]=u.subarray(h))}const p=pi(t.subarray(0,o));return s.setUint16(o,p),o+=2,{data:t.subarray(0,o),duration:e.blockSize/48e3}}function _i(e){const t=new Uint8Array(38),s=new DataView(t.buffer);return s.setUint8(0,128),s.setUint8(1,0),s.setUint16(2,34),s.setUint16(4,e.blockSize),s.setUint16(6,e.blockSize),s.setUint16(8,0),s.setUint16(10,0),s.setUint16(12,0),s.setUint8(14,11),s.setUint8(15,184),s.setUint8(16,e.channelCount-1<<1),s.setUint8(17,240),s.setUint32(18,0),s.setUint32(22,0),s.setUint32(26,0),s.setUint32(30,0),s.setUint32(34,0),t}function mi(e){const t=St(e,"stbl"),s=St(e,"mdhd");let r,i,o,l,p,_,u;for(const x of t.boxes)x.type==="stts"&&(r=x),x.type==="stsc"&&(i=x),x.type==="stco"&&(o=x),x.type==="ctts"&&(l=x),x.type==="stsz"&&(p=x),x.type==="stsd"&&(_=x),x.type==="stss"&&(u=x);if(!r||!i||!o||!p||!_)throw new Error("Missing required box");const c=[];let h=!1,g=0,F=0,T,U,E,k,I,W=-1,j=-1,M=-1,O=-1,z=0;for(let x=0;x<p.sample_count;x++){const D={idx:x,size:p.sample_size||p.entry_sizes[x]};if(F+=D.size,c.push(D),x===0?(T=1,U=0,E=i.entries[U].samples_per_chunk,k=0,D.chunkIdx=T,D.chunkRunIdx=U,U+1<i.entry_count?I=i.entries[U+1].first_chunk-1:I=1/0):x<E?(D.chunkIdx=T,D.chunkRunIdx=U):(T++,D.chunkIdx=T,k=0,T<=I||(U++,U+1<i.entry_count?I=i.entries[U+1].first_chunk-1:I=1/0),D.chunkRunIdx=U,E+=i.entries[U].samples_per_chunk),D.descriptionIndex=i.entries[U].sample_description_index-1,D.offset=o.chunk_offsets[D.chunkIdx-1]+k,k+=D.size,x>W&&(j+=1,W<0&&(W=0),W+=r.entries[j].sample_count),x>0){const q=c[x-1];q.duration=r.entries[j].sample_delta,g+=q.duration,D.dts=q.dts+q.duration}else D.dts=0;l?(x>=M&&(O+=1,M<0&&(M=0),M+=l.entries[O].sample_count),D.cts=D.dts+l.entries[O].sample_offset):D.cts=D.dts,u?x===u.sample_numbers[z]-1?(D.isSync=!0,h=!0,z++):D.isSync=!1:(D.isSync=!0,h=!0)}if(c.length){const x=c[c.length-1];x.duration=Math.max(0,s.duration-x.dts),g+=x.duration}return{mdhd:s,totalSize:F,samples:c,hasSyncSamples:h}}async function yi(e){const{decodeOpus:t,chunk:s,samples:r}=e,i=2048;let o=null,l=0;const p=[];function _(u=!1){if(!u&&l<i)return;const c=u?l:i,h=gi({index:p.length,blockSize:c,pcms:o});l-=c,p.push(h)}for(const u of r){const{channelData:c,samplesDecoded:h}=await t(s.subarray(u.offset,u.offset+u.size));l+=h,o===null&&(o=Array.from({length:c.length},()=>[]));for(let g=0;g<c.length;g++)o[g].push(wi(c[g]));_()}return _(!0),p}function wi(e){const t=new Int16Array(e.length);for(let s=0;s<e.length;s++){const r=Math.max(-1,Math.min(1,e[s]));t[s]=r*32767.5-.5}return t}function vi(e,t){const{opusToFlac:s=!1}=t;let r,i;const o=_s(Pe(e.fetch("ftyp")),Pe(e.fetch("moov"))),l=R.parseBuffer(o.buffer),p=l.fetch("ftyp");p.compatible_brands.includes("iso6")||p.compatible_brands.push("iso6");const _=l.fetch("moov");let u=-1;const c=[];for(let g=0;g<_.boxes.length;g++){const F=_.boxes[g];if(F.type==="mvhd"&&(F.duration=0,F.next_track_ID=2),F.type!=="trak")continue;const T=F;u=g,c.push(T);const U=[];let E=null;for(const k of T.boxes){if(k.type==="tkhd"){k.duration=0,E=k.track_ID,U.push(k);continue}if(k.type==="mdia"){const I=St(k,"mdhd");I.duration=0;const W=St(k,"stbl"),j=[];for(const M of W.boxes){if(M.type==="stts"){M.entry_count=0,M.entries=[],j.push(M);continue}if(M.type==="stsc"){M.entry_count=0,M.entries=[],j.push(M);continue}if(M.type==="stsz"){M.sample_size=0,M.sample_count=0,M.entry_sizes=[],j.push(M);continue}if(M.type==="stco"){M.entry_count=0,M.chunk_offsets=[],j.push(M);continue}if(M.type==="stsd"){if(s&&M.entries[0].type==="Opus"){const O=M.entries[0],z=O.entries[0];if(z.type!=="dOps")throw new Error("Invalid Opus box");const x=R.createFullBox("fLaC",M,-1);x.reserved1=[0,0,0],x.reserved2=[0,0],x.reserved3=[0,0],x.data_reference_index=O.data_reference_index,x.channel_count=z.output_channel_count,x.sample_size=16,x.sample_rate=48e3;const D=R.createFullBox("dfLa",x,-1);D._data=_i({blockSize:4096/z.output_channel_count,channelCount:z.output_channel_count});const q=R.createFullBox("btrt",x,-1);q.bufferSizeDB=0,q.maxBitrate=48e3*16*z.output_channel_count,q.avgBitrate=q.maxBitrate/2,x.entries=[D,q],M.entries=[x],r=E,i={preSkip:z.pre_skip,channels:z.output_channel_count,streamCount:z.stream_count,coupledStreamCount:z.coupled_count,channelMappingTable:z.channel_mapping}}j.push(M);continue}}W.boxes=j,U.push(k)}}T.boxes=U}if(u===-1)throw new Error("No trak box found");const h=R.createFullBox("mvex",_,u+1);for(const g of c){const F=R.createFullBox("trex",h);F.track_ID=St(g,"tkhd").track_ID,F.default_sample_description_index=1,F.default_sample_duration=0,F.default_sample_size=0,F.default_sample_flags=0}return{opusTrackId:r,opusInitOptions:i,data:new Uint8Array(l.write())}}async function bi(e){const{chunk:t,seq:s=0,timestamp:r=ht.zero,decodeOpus:i,opusTrackId:o}=e,l=Pe(t),p=t.fetch("moov"),_=R.createFile(),u=R.createFullBox("moof"),c=R.createFullBox("mfhd",u);c.sequence_number=s;const h=[];let g=0;for(const E of p.boxes){if(E.type!=="trak")continue;const k=E,{mdhd:I,samples:W,totalSize:j,hasSyncSamples:M}=mi(k),O=R.createFullBox("traf",u),z=R.createFullBox("tfhd",O);z.flags=131072,z.track_ID=St(k,"tkhd").track_ID;const x=R.createFullBox("tfdt",O);x.version=1,x.baseMediaDecodeTime=r.multiply(I.timescale).divide(1e3);const D=R.createFullBox("trun",O);if(D.flags=3841,D.data_offset=0,o===z.track_ID){const q=await yi({decodeOpus:i,samples:W,chunk:l});D.sample_count=q.length,D.samples=q.map(Q=>(g+=Q.data.byteLength,{__data:Q.data,sample_duration:Math.round(Q.duration*I.timescale),sample_size:Q.data.byteLength,sample_flags:2<<24,sample_composition_time_offset:0}))}else g+=j,D.sample_count=W.length,D.samples=W.map(q=>{let Q=0;return M&&(q.isSync?Q|=2<<24:Q|=65536|1<<24),{__data:l.subarray(q.offset,q.offset+q.size),sample_duration:q.duration,sample_size:q.size,sample_flags:Q,sample_composition_time_offset:q.cts-q.dts}});h.push(D)}const F=R.createFullBox("mdat");F.data=new Uint8Array(g);let T=0;const U=u.getLength();for(const E of h){E.data_offset=U+T+8;for(const k of E.samples)F.data.set(k.__data,T),T+=k.sample_size}return _.append(u),_.append(F),new Uint8Array(_.write())}const Si=(e,t=4294967295,s=79764919)=>{const r=new Int32Array(256);let i,o,l,p=t;for(i=0;i<256;i++){for(l=i<<24,o=8;o>0;--o)l=l&2147483648?l<<1^s:l<<1;r[i]=l}for(i=0;i<e.length;i++)p=p<<8^r[(p>>24^e[i])&255];return p},is=(e,t=Si)=>{const s=k=>new Uint8Array(k.length/2).map((I,W)=>parseInt(k.substring(W*2,(W+1)*2),16)),r=k=>s(k)[0],i=k=>new DataView(s(k).buffer).getInt32(0,!0),o=new Map;[,8364,,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,,381,,,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,,382,376].forEach((k,I)=>o.set(k,I));const l=new Uint8Array(e.length);let p=!1,_=0,u,c=42,h=e.length>13&&e.substring(0,9)==="dynEncode",g,F=0,T;h&&(F=11,g=r(e.substring(9,F)),g<=1&&(F+=2,c=r(e.substring(11,F))),g===1&&(F+=8,T=i(e.substring(13,F))));const U=256-c;for(let k=F;k<e.length;k++){if(u=e.charCodeAt(k),u===61&&!p){p=!0;continue}if(u===92&&k<e.length-5&&h){const I=e.charCodeAt(k+1);(I===117||I===85)&&(u=parseInt(e.substring(k+2,k+6),16),k+=5)}if(u>255){const I=o.get(u);I&&(u=I+127)}p&&(p=!1,u-=64),l[_++]=u<c&&u>0?u+U:u-c}const E=l.subarray(0,_);if(h&&g===1){const k=t(E);if(k!==T){const I="Decode failed crc32 validation";throw console.error("`simple-yenc`\n",I+`
`,"Expected: "+T+"; Got: "+k+`
`,"Visit https://github.com/eshaz/simple-yenc for more information"),new Error(I)}}return E};function G(){const e=Uint8Array,t=Float32Array;G.modules||Object.defineProperties(G,{modules:{value:new WeakMap},setModule:{value(s,r){G.modules.set(s,Promise.resolve(r))}},getModule:{value(s,r){let i=G.modules.get(s);return i||(r?i=WebAssembly.compile(is(r)):(r=s.wasm,i=G.inflateDynEncodeString(r).then(o=>WebAssembly.compile(o))),G.modules.set(s,i)),i}},concatFloat32:{value(s,r){let i=new t(r),o=0,l=0;for(;o<s.length;)i.set(s[o],l),l+=s[o++].length;return i}},getDecodedAudio:{value:(s,r,i,o,l)=>({errors:s,channelData:r,samplesDecoded:i,sampleRate:o,bitDepth:l})},getDecodedAudioMultiChannel:{value(s,r,i,o,l,p){let _=[],u,c;for(u=0;u<i;u++){const h=[];for(c=0;c<r.length;)h.push(r[c++][u]||[]);_.push(G.concatFloat32(h,o))}return G.getDecodedAudio(s,_,o,l,p)}},inflateDynEncodeString:{value(s){return s=is(s),new Promise(r=>{const i=String.raw`dynEncode0114db91da9bu*ttt$#UU3yzzss|yusvuy&4<054<,5T44^T44<(6U~J(44< ~A544U~6J0444545 444J0444J,4U4U7U454U4Z4U4U^/6545T4T44BU~64CU~O4U54U~5 U5T4B4Z!4U~5U5U5T4U~6U4ZTU5U5T44~4O4U2ZTU5T44Z!4B6T44U~64B6U~O44U~4O4U~54U~5 44~C4~54U~5 44~5454U4B6Ub!444~UO4U~5 U54U4ZTU#44U$464<4~B6^4<444~U~B4U~54U544~544~U5 U#UJU#5TT4U0ZTTUX5U5T4T4U#~4OU4U$~C4~54U~5 T44$6U\!TTT4UaT4<6T4<64<Z!44~4N4<U~5 4UZ!4U_TU#44UU6U~B$544$6U\!4U6U#~B44U#~B$~64<6_TU#444U~B~6~54<Y!44<_!T4Y!4<64~444~AN44<U~6J4U5 44J4U[!U#44UO4U~54U~5 U54 7U6844J44J 4UJ4UJ04VK(44<J44<J$4U~54U~5 4U~5!TTT4U$5"U5TTTTTTT4U$"4VK,U54<(6U~64<$6_!4< 64~6A54A544U~6#J(U54A4U[!44J(44#~A4U6UUU[!4464~64_!4<64~54<6T4<4]TU5 T4Y!44~44~AN4U~54U~54U5 44J(44J UA!U5U#UJU"UJU#U"JU#U"JT4UZTU5T4UZTU5T4UDZTU5T4U$[T44~UO4U~5 UU4U~U$.U5T4UP[T4U~4~UO4U~5 U#<U#<4U~U2$.UUN 44 ~UO4U~5 44!~UO4U~5 4U~4~UO4U~5 44J44J(U5 44U~J@44U~J<44UD~J844U~J44U$54U$5U54U$54U1^4U1^!4U~54U~5U54U~6U4U^/65T4T4U$54U~4BU~4O4U54U~5 UU'464U'_/54UU~5T4T4U~4BU~UO4U54U~5 U54U~4U~4U~U'$!44~5U5T44\T44U<~$6U\!4U#aT4U~4U~4O4U~5 U5U5U5TTT4U$"4YTU5 4U4~C5U5 U5U5444$4~64~\TU5 4U~4U~5T4Y!44O4U~54U~54U5 4CYTU5 4U~4U~4U~4$6TU54U\!44B4B~[!4U~4UD~4U~4U~4$6TU54U\!44B4B~[!44U<~4U4~$5 4U"U#$544"Y!454U^!44<J44<(J454U~84UN!#%'+/37?GOWgwU;U9$%& !"#`;G.getModule(G,i).then(o=>WebAssembly.instantiate(o,{})).then(({exports:o})=>{const l=new Map(Object.entries(o)),p=l.get("puff"),_=l.get("memory").buffer,u=new e(_),c=new DataView(_);let h=l.get("__heap_base");const g=s.length,F=h;h+=4,c.setInt32(F,g,!0);const T=h;h+=g,u.set(s,T);const U=h;h+=4,c.setInt32(U,u.byteLength-h,!0),p(h,U,T,F),r(u.slice(h,h+c.getInt32(U,!0)))})})}}}),Object.defineProperty(this,"wasm",{enumerable:!0,get:()=>this._wasm}),this.getOutputChannels=(s,r,i)=>{let o=[],l=0;for(;l<r;)o.push(s.slice(l*i,l++*i+i));return o},this.allocateTypedArray=(s,r,i=!0)=>{const o=this._wasm.malloc(r.BYTES_PER_ELEMENT*s);return i&&this._pointers.add(o),{ptr:o,len:s,buf:new r(this._wasm.HEAP,o,s)}},this.free=()=>{this._pointers.forEach(s=>{this._wasm.free(s)}),this._pointers.clear()},this.codeToString=s=>{const r=[],i=new Uint8Array(this._wasm.HEAP);for(let o=i[s];o!==0;o=i[++s])r.push(o);return String.fromCharCode.apply(null,r)},this.addError=(s,r,i,o,l,p)=>{s.push({message:r,frameLength:i,frameNumber:o,inputBytes:l,outputSamples:p})},this.instantiate=(s,r)=>(r&&G.setModule(s,r),this._wasm=new s(G).instantiate(),this._pointers=new Set,this._wasm.ready.then(()=>this))}function Dt(e){function t(){}function s(M){throw M}for(var r=new Uint8Array(123),i=25;i>=0;--i)r[48+i]=52+i,r[65+i]=i,r[97+i]=26+i;r[43]=62,r[47]=63,Dt.wasm||Object.defineProperty(Dt,"wasm",{get:()=>String.raw`dynEncode01a36c6f98c83%y#6Ih-^*:8J#(3s/.*[v\z(oBMvm1I(&b?0=MPxA%T=} c0PN:QM_qA1k@6uk9F(Ac  )T=M]+aBc{!_#'.(hB\0E?s*i9)~Q6+=MlU<igW,$(mzq6"o1GwY$)(!j I,X_=M6JX>$F	M/=}WsF$9PsH03PWqC~}:ta/sdv[<x[0bRjzhqJ"'*034rv[B/9!rn5MEk5?7k,*drk4Vjooooal^=}MQ]Ql[g=M9	~3 9gGze	ulf	|Sot=z<h]9:#D3Le	[)hf?p9
Vn $%1rn:f+|;o:*W(J+vOb7<	[)oU89~3VN&vlGk&M6 6!^ vBL,Y+jLRekX\yF=1X1hQ^d@!G
 )+wyIOi;gR#'%fP S[Ec&0v\G-pSX-UQ<J#i"<o;6i|#mY	=$}
q_.}XixKQQK=MK8RM[@4(=M2 
'e3<&lw"j5i,{~OcWJXnrg/	lzdI~ j=Mv0A~DUn+mFiFU''^%np d)"~VYg}Q7"]eFZ0 v dc^i\	qd-|7{~UrV/wYF',nVcyi7e$ ~)&$d1G5S=M@=^=}QU:74t3?vs
A4e\WX2l<U{>f#pH5_r,=}7==T	qMa)_;T$k"b"l}"D:o5{6Nn?=M)~9* @kc$ne&^3/V"13H}oT{Z=j6_DKMw.tRcI!fuWwYYT I D=M5h=MtYn~e
ef1u)tpK*;;{Ot;pSo9<{	SS!<qVl>,(sU5-^SC%(%^}3I4}|
^h*{rzcTd<xOZ5?Lsk|L; -)rSXYWf{JA.pD LIoHI{/='+y3Mj:mP@,0	:>!\0%wAGi/XkK:PH_rrO8u=}8QR5y)P/!5Z#l;40R{W!U1{gTu&iF7zHTsCuPY$?*=Mq?N\d+iyzp(LvP~n:=kO~?Uh,a[SP,uNI<}:3; =@kj;@#G:W![>YyXvF?d!_o3)f(L~OM{^=Mu]6c$T@{I=M{d	=}8>LlUm(kx;Z+@XF@	h<FB+Q BG=hcWI
21R]r}^o'<<qNun%vu0lS% *5HV9O tn#heMKg=ML&67w+qEW+/M=}]z?H+'S [9j6%n38-1t)	,WGQ^P54wxv70FI,47-+Xdo6H=M.pU$7B)(=MO/k4,NHEzq,j[Ii[luBCsX{w+\;K@
M(Llvi?QP>fv;RMj\z-K{|xJt<a/}F|h_ Q%<g2(e3/m6Y/=s72r7 xIuhzY_1nf>Uc|zg}OU!%@mv9+Qc?'4c%%A'.Q0dSC%$p:(hLd<#h1X3.KqeH7u=q/<\iL$wGzEHY7RNBA8&.i? vch=DWmcl<|p7<#lsV3*5H]5Gqw,uhuJvJ?HL*,wB56T=}BWyM
[m)iM
e(78m}=w^kF#].'6"7*	U71\gkunH[[13.'5uCLBgaV3_vOqaUZ<-KsZ~\!^2^?*\RG+l)Df|]\x$4w9G AvpZX@@p	4z&j3=M=vgURWd/x+,ae*1vl
^m"@s# ;r[B- [a|>]6JHX@:{=}q!K "A=M=z*1z^5b*mZU ){
8ApG FE19bnX&>~1$5@a,'<i?2U;pw u f@2>y2LV^sY8,FQ<uDR.O lh%icU4Js|"VhejSqc5T^'l S#";R"sYY k 5wBYz
V9-[,\l
yh8@i1&q-b:|3d"YI_;UpCs]@D T\,"jif	hg> )[9),3=k@H79ywWB)*/#:%Ku3f@Z(M=M/}PCOCE?G(Mcp0YE$$IHXrpk%>n @-\?L}]Nqli3v3?r+4 )H}Q*8x(=M=}wf4FR!"\VT)jm8McFrH8[c@Jv
Tb!r~{%u3pC0wnP/{s5!f^"Qk5-Dh6 VGH#hdi\-3TE.[fLJ,KBF.Z*EV^
f#uY)PfZ	I2Ux4"BUR:eAAlD,[O0b){un\a?laP+ ?yw.3;+@>=}1vQ%n<_F!Z}"S');?LIH0#B#J=}"\?rp2q(=MYh x4_2gXP/_F|f*2 qcS
rQb.68W
gz**YbY,Z$ohdr #0^k\ umnxA5kmW,iL4aavw=M309WTn:-*bi%b	na
wz ~	/<4fP{}I1b=gM$7G=}sdP2UBeM&%T
5igee'"Ie$WK*E=M T	 oC7f*LBGWsnvw]0LQiK/	4tbU,2tppkJD7D8MLb?;$1\iJfAMCu)Ux}j4x%^q&]9F3+c60\7=My-)FF2g=}2H?.=MORl;U/ws:7p:ZL*wE#vShdJNqBJVAve7,@0PRC5a\}xr6poG_7dqwJ3|FKc+/N4J Vn=A,*=}o@b=MAf_JtSLI>Ix'=MCV^>V9-|CCt[
Fg7Wls,d%zjGI&)AeQ.:V$Po{]v,NXP8_#12u",4b"&Gz\g6&{cif5[=}#\e}~i~aN@v4Ll=}YEQ8_d*8Ma=M5nm'q\/+!4g,TN P0}[zZr)E;N$=ad;X\tI}TgrGu<rB}PB=}i5)Y.qSNaT,Bd'~h%tz{DW =M .ve6eRfhzLLRY"&z{4L.H41~dP lr*piz.a^/u?aelzZ>\=Hs1/=FeB{fU8gr4	 +@Y+1'{	1~F{M\5hL+;f4Rs++p\(KR{0;&e9l-Ez{D@Ct Hv#=1H/10X!L&[(h|g4Y~#'JdF4TbMSOr0pG]LUH<O"N+/#/]0DIH=Mk+v|.UK
F1c+$P7J>CKXN8G2g>}r.&Wq
6%!MU=}"Zj=}Y<upp6qf;	))%			^e	I!=MYNR@/mO(uWu!Vg5h8,Ar4Afge"Zz
i,kS%>6u
{rJ0qvHS8hmh<j
\r'mgB;9i{Rx+Tz
v[JZm[4}qR4f~ |195lK/=M0JNuMY4 #x|=>Z:nR{$* 2>%m QdP-
oJcNK)63W+nAWqs#F
6]c&:=}|<fe^	4#s^MY=M:uygmqErHY>?AXjb& 6yxH'+5pP*Gz7A)-	0BDmH +0GuRMGm/Y<go4H=}6-	s9u+,.0k5.&pz|Zdh<=!gaIC;|o~){P<F{De9?hB-
1WDPzjZ
aDM}O702?A,dOYTKm:hdUo}mwM!UxCGHFGfnk:e)ToHpcI#|&4qYwAE0x''=}D6j^p~Paw
N7~j:G H smm7-=}mi'p*K2V^%gg~l
o)k*cJ_ =MIj,KC}}Ps._ZN#G?UJejz(}g<68eK>$3s+]#[:J6@!U i{==}iU,m0cS$VN^7#v#I/Gu;0xNqJd-c;n	"QRsB|I }'C@/w+aAI2+1TOOz VTIn=}ga;v8\GTwaxh{dq_jJdGjyS{#*ST4~nvZmo	t]PJDwSTj%99{56#ySDvaw1j[28x8 EKv|Uhe(UYDSL_(4Ot=}w|8Hsfmc[DotPW]=}sKLV6kfx(&Azq1Q+j'A\BZd ;W*[$|ue&G{oaF=}C"|pzJ8D,eO2f:8O5\TFsP+#5[k0E{!W=M=Mx+G,?	htgw%uun/%=}PJKqCG=}S 7{8<<k e&f0&=}NhaT%5ldU|p &4^v2{h 7+xHdj@mh,f9P^"ewkWxW6?iCTN&pH5=M:dR,N:z4BZ@ 2it/FXOs0(R:zuw?d8\Q/9/p_2WGy3f8IV9I.\G =M9U+}J~@oq_>d1I=}=}I^p+k#ct(C=u+D=txtt>n*TPJz+9"2?]&KiNr/SLj{{OTd#{	c%ck{]j%61*fazd)O2%Px%ySc]uDG:$3&m=}J***1My61o*x~dScZj.=MeML\c>@f7~{
YQd0u&qaWg
1.{]1nne;DYRYjv-aR\=MVMANdYam+gHhI.@bLb%PPolIs,w/*%~@n4nN"-35<itQmJq'-:]R2yOIGY|1~n9\dQ~5fK\baozfnaZB:vn"glor1M%m_KJAkb)3L=q d]:}x--(=*fQ ]sFdmZ,^dH!7d=}6E
-/o=-P=MQDY\=}.s[rGJDob!S_pG	HT3ddvK[YMrcuOwPYM_n,%r\,rz%m:haMUNy=}vSbaPSNciFn;?]	si=}KS=}ahG|,f"'dN
3"A}U/.mIb5
mO [wm 3IL#W)_k4EKd%#4w: :;7wY|q7-
\o+V~QwD}KhD)djc0,};)jw3x|=I$xiKSL<m<o7q]o2
h=I)Mv*;v/oKE
FVV=}%ErYSHyG9*y9)!,5d/fV>6t
FtC5=xK	p=M(+~=M\:(5XV=MuS%$ik<d-o55o!Lt	+4LJfI:=}h\$8%?}^(;LG;1j#y:pQRE1WMG9uwG"}NfI%uzzoj)9C>ojy-Mw8,1B&!'!}u17HMm+	]oQp/<bC2|~dr<.:a4TCEmi3T7p#1_\mguiz$|LPzu][d=}+AqSc'u	81=}Y,2k#C.ea7G7D3l@xnN)]D!UgsMp9'B\#5Lkjy4[/R#In^PZm70]D\YRBA1F6."ff7J7!P=\Qzw%uUtI>_k!ORiX]GF	hbo	"_	'9M,Z*IOI&+1av]8u91Fc=M\#PCj&Y7TE:v&5I})S/ctvy.iu8I	>4vy%KiV@1 X3w,E
~FjWCGPcA,"s(\[1I8@nBK	tj5et~;d=M,?JuJ('>i7k:8g4HUHIh)H<OAJJ!}mW=M
zx=M/
N+v-I.'_Hhrr&% "uI%T%O vGmF7%2c=M;x/#g/}TIWtB(# I#Z3l*:P\J2M\jG=/qYT~FqnDRnd n,E?9+g){P :Omc|cSP{vD0aABA=3V,-sB/6W L\IhWB0z*/8Vu[flIG0=MFhmfB5lEPrsA"1n8x3'7-g&5F9	N[&WL{=}n=}fWI$1^1zF%Cd1
(JB~ok+]7<<2;,|Ry=}Cy<SgkAj,R]7YA7h?3(svpZWeWRG*
!N)SMk8AoUD
U^?AfF,N{+ILk=}|~T;V6iu=}UGa=Mh3	~c.}U7Z0@4f/<u/pk;8~0<XUnEgO#lO3:53j.6(To./s@LKt%#o3$'|.	iH/^*\;sySy]l~9wMnW}C,/&wP4nm62	jYhi)ljo/q9("{3-HDjIy2iVUS8O;QOPzYd?{(Z\f0'fm9^!62[UB+EP_v9pdp0],aVVT$#6@La:[T%xqADr#~=,BZ1@w;BH>,\gu+z#W:xHtLwNeG&w0A	Nhg[JK(M/o=}H>{N-pLG~%S|&48~3'tG90xDj0-6'"JbSBn%wf#i&=wC2t'!@m'qa$UjKkD2 Y$nNl bB2:Pbb!4!0Pi[O4*K1)Ek=Mgh,~p_ynTr_	0Zo&a%{g"+ jjvw]rdGqnxp<^L* O1LjK=">g':S>BqAsDs~KZ\I{$S6Ke am+Tfco~n_?zyGYNK]gvHb)'5Idj>W:ie=}kJ=}(+%9g?d(xo7s&Kl"zYkv#mO*sGR@3'M3.BB]=a~SQ9,x!@u50*! y!pVWvL4rIP26j!o-<ou@;|Y1H\t38n~;:qB@uJ>lQ5 
*j$^r\ \\Ml@1k+2(g+Y:X5%ji^u| QbO^[)t+J
%jfM@V2Mx9V8Na)4f#Tps!KPSMWq5#AJ'gdkza)IK6'Mj=M<TnVi=M&6hO]M6o
&C^X,nI]^zdIQHm5b 96i0}A+
Rli3^]R6iv)^\^UlPc"ZnGQm*L\@a	w@@Zr&b}5lr,uTfG?"
>]]|C*h&aX_[jz|#(BN \}Ba&WnG$GEC=}G9$p1A.\j=MV'Ns5Dh{+2-'U,sK-*uY(XXXn yF/EOmE@vqR(QLW;\bnl=M<aMUVU?{2^>Se[cqP*_kaUpv|fN^:7.6x7\<$s=M;t@d<Rz[l%m/HpyS;;g"s;=d 2STicQ.b/3i3o8uCj]$xOh.s~xUw3ZIFBs;!e-dej L"Rejj{ejjWyzbuiW202U6=}Ge3>_MR^ljs-g"lb]D_Ma dZa ?%JSy'tUDdM /W/<UL-t$tM-	"*RX_hJ2R"X LWofE4a	K)@e-n@;r\c$YNxHL)pI"T"H	7Io#'+5|ic@;MV7mxytF[8Y@(KlXSl+7 :=}r=}2/	"ur;r;zj1Boi4x	?P6,>9|,9QHf9UGoA)\|ZWB4i)VUJn{CQp{\3
WJ1"\K"5liI bD\F)_jk)"~p3]5(n5kY%zaTd=]V,XAG?
/$dX-Iq.i9hx;saetlWs+}]g.m-(-dJkI%i-j<3=sKDB*xgI&ATf+k6s^^H!x@mR0Yk4Q96}vO(G~qWrdS1]('+K<;-!5Fo@e+'.d.+lPrn7k*E(f*sIHLy}J4Di.}P{B0]&[6<xxrEa=MbKN|v+<Wugb:as@r< "kDlBX/n<7s-l|'d#[O">~\'K>^	0KDVQJ,Q'^x,YhuU=M"Ri@=Y8uL DEynV	(uMDphKS~Ge4pr#V.bI}C)K6VO*i@d7QHAgL-b4IH@Zo=}yK?GE:uD&&[hw:z|>Gmz ^4]XF	yWL Y 63t@-(\*vIHy%B=}kG=M[N9r.=62- N(Yd?%B=M(#>O]9=}Ji1z6.~C=}3C)!jSnS\ux<=]Qf*x &LJc2YfE7#?:h^..=M\/@ Yb\ua7vfopb_&rzlj$YNaf.p,&1IY=}x{]%zT6C1lPZ[1 +WzzNp!n!bK Y=e+wv\J>0?cc6A_dvrN2k<67z,	YHxDxZW>>(8),/>2:Gj*&"fDT50iV%:s88^V_|P~)Z
hKB9c/Zg&=J"hLeLK0nm~%Y D6[sno|de<a3I=}n0lp	'&qD,@q}bV&53_FzOm>qW%antx+~@'x0^w)WSoiFq<DNO%9Sro!U6^w^=}57=ifd:Awp khf/axr]sFWCc}h~1jly	iO1SZPoV# qo;j3w}4wLjgfO0n-? gi@HP-iU7 K_<UnHL5)[gR.^sI7\}~J1paQ,wJS.t/$bg9*[Aujr$cwoU{-Zn<77nyZr>Mj&aj3h<U"p)%;e;^0!8&Ve'=MS_Zv=2=k)U>'(]u?JMlkh]hmVzg[]U/Py045;:-6ce0CH=MTa*;6;mm7d,Wr!'CfEU6$?y^	+=M<7>9eXe"i|~i
=(zuRh|L
fcar@PNl@0lTV.P;e3OT]w<Q06lN5f|}IlNKLP60g5&tLK9D@VG~%cv
GDKfs /CXI @=0!K<>W-4	G{)L8?BPlrnya8_jGy./A;@F~R\g=V0:hF=M]{3 p<t? J(2X}}qXew}56vvn	v_ntO-t~d(6!Zhr/'u=}mRU+9r NtD\Gb0]utZk?<>L{Rhrdg_'gfUS 1jSJQ$=M_T_D+'J86A~)Bev>0Oj%NVhd4Q+BU"X Ba.'}_A17HDJvwS2%M3qC2	9=}] gs sl{ _K[e$xScBz,C6!r]?;f&	^a?]0B_b1oXh&"GsR
H Q}i7at e o=8	g(N Z\"7lKorvG7a*&<G44kDF.?64/{rzL0sZJN-6-_pr/[F](LJ|5(0k=/h]0h?=M
SHn];9XTpq=}gsK9X+n@5)'q@ /#(aVUo:r<ZrH}:_%&orI^smj7=M^M!d~~&h/ y3#'nEhs
)(q;LbaH	|d8D3MoXaF%E	#^[)O_#c	[Sl,@|r6@V[;r7$S#G S92eD?Mf.Y&S3s>tm+it DO'GJ9lR.33=.:oE>K<?m1q=MUU80Kx XQ3:II38<J%0q9P$_IF?-ud.hv$_GT43]Ttso^svtI\ZIn]x tR)xI(z?*'l5}Uyf%=_dR2^br$0$=:Jc@z>gNV1hQ=Qf4-8X,wm5*T8*$cmChSMrpp] U31l;s),YW~>Ghchk)dQGb%MlKj=}k:#H3\N>= 	U:.c9FS=}r\N1k."TW|;ZV]:0| C;\Y B~ #1bB|jj#_5 nZse$D_xxiST 4AkT=MfRG3\NQFN }?vX>bogV l2N9o/gK~Xh#|~+Ct~Ikbi3gK(5DVtWoX]m|F+.\OswR]6	 3_@bXT;xUq=Mq&O &l(e&J/
=}ZRTOjY4@U{\h'
h!LyOgyM0m|tkL2U~QoyT$]K\i)(Qe8Ov\GK)I-6qE]S5t91^ M@~ds=M_3uun\-=}X:i}}Ct:YU70jl#nO%6Nz1A(ARO ;5	a:N!0x*ljZIj59X)<o			9yW1j+)*p+&98MxDMHB6|T/FR-Hi=}VtIqXawB?loS)K&K.qT=M:4Bp=NstVM"a%*WqhoO3n;fFK-lg&JE+v=Q(6O+XTj8p_C;7/,|p8&QZ*.XY(.7M8|Z}CZvC;TK#Cw/erB4o3^!x?.K@MtF2/T=MY1-aF=_o% A_	uxO48%@z$0k-Hbt)tV2m/x_ ;<Asvkx7N5aFHz6^](l	_M/#y4<BN"Qu)K>Z~|8zLEjmr=Bus~ Fdcz]C)qy[Vox6W-40$Dot;V=$3dC2eiW[)a_w/Z,@_L<,[P-w=M
f'.i3>IT,=M__4#'D T}gF1t5WogD+39c,^Q=M:D
0ZxR1w1..=~5e)RivKBal!%%|~?uDx{N!ihCSxKVvQM"3-Lg#5-b,M{SJIo^z7R	EwHHN44D 4Mqp&j		=^=HON](: &h/7<I-)!P[6~gGhfI Rq-)N&Gx!5NG(W',&U$=}5{w#dJRw=}m}^
=eBtKbzur-"MFm6vt0sMUc4fT*f6MW3Y=M)hIW;gtk i	kkm/#1%dF XtC	|VA4'9%	m&9}UVqli:wS\aYfF\aUU-S'-
Z:rgK2<.}3hC7."v?PU2K,F9\K 	0.DEq-:m74F*^^o#O	3_|!vg'Sh-Py 5YIQxK#P4Kyw s*C@d*#SGK~\HMzL50S-L#UBN3tETpVt!CfFJ!"7$TO~Sw&|=M_	L\&=MD|>wkJ
zJ(ZAFJl-'gljAEN<-tJ=M[3*zn#8	]qP?Cnn=M0us x2avP^c=M|1W9
-?eG-)dnRP{!J[zM8zy(^mbp%7j[~R;&x^^+tk9w?#o"bjs\xf X'~S qiX[PTagSUNKeZXh3wX[*m	!(M+Zled}!"xB9BopJ":dUH*K{HhSAU@7<t/g*ywj
Wb:b[=}w:EhQ9W6zvuX/RDS-r!ZKCb=W!RUsf(V@z<H@('>([Z# )0z|F G{+7e	=}!.kg>X<}Wj%G@G|1Ee,*$x0g,t$4s;GL.@};F*=}o/jl=My[@'n?HQ9O(nk%9OU)k%O,H(D389}rbSOgdU{S<0\oc0dr3WXz=i_9mwvG{(Hn~*4^|*+K+	5
.wh/n';
YncK4u}rt:-/snKEi	405I*?EV*p+pNxH]VnoTM8x<n|llI- { D:]5\I3(0"i4U/ZcE:KXUVEQ4^z&*E|=MA:S(LiKoj%/YFu{2Xl2$R/	PXof?dyS3n8(Q5{
 mW~k'>Cq_H|Pz}ZS9yA?4OIOioB&Wl:x<ayaP3Dr:o&p=c!KQCKe9f	!1;fje<hqNYCp#'c(yCG?l{F8q)&!^QZYPA*f'C~Yv3'twyNxyQ%p\wG]mHQo:9EX|1qM@a4+[7drXuXm0}\5E3_70[cfQ	VJxn!\ulN-JmVg37D#\FxH=MnT~FVL*E-n#tzQl(E2K7&.+%MRyj-:(X#=M@l%j% 3G{9+z,{eZe+$[YT+[1f
2@5gi7;Ki_t8M%ek U08y7NmE7FoFH.Ui3K9VTr!!WIMvHD8](I	_CYG $$
JE~9-#dpR_jE].]bsPbY"y5HmdoKx*1tuS<RTewh|P;3e}6lhh6O=Mj,AWx^yyt5.;MGd8EiYBR$ 4+U~rAo{2TA3g6$1	mBg}<Qc;|"k nMwG\Pm7m12 s#s=}#'SaNh>_rvupC)]'[,	?=b\Ff,y%wS_+1VVx[EA6F5R
{d-R;&2,N32)QT {:~Vjdj1mAs&j=}bi_zL/](Fu(4&| >j*9* &&1mcaFCU"i *?		'+:<k#PZ +5xd/)+?~Lwzc;9Xro3
$Qh
;=}c Oe?kFPotT1LN{[Tc :RmkV /R>h=MNK'54w+w2v({),ETesuf;)=M>[8%HKWU9Rc/EvJYN%{9:~2o6]Dw4IR_.WsBTFn]@Q=BR#L"LT*NiB$,{9?%n)J%:
0,?jVNIMJJx%9Koc	3*4^O."cplh(SZ+ovhdejvy=	}=}<w]bU1Lw-02C@D=}M.qJP!TF*x8|kISBV~^;)83=M-y&a_;;A{D\z0,m4qRVYBFFdbVR*G$=M	qLejbG_>%+@cK%%+bO=}JZqN81|2?AQXl%'E>jc1 \ 9H]7 >>Gf0I873D]mr'[h7dQ.hT5 "	AhN=}2
sh5.hHgNhPs4Kp%'X\XsYAE^G))=}<T+D..jSb,HAJc~t|r#HaVjhHz>?^+*=MFRTT[Ff9Cs~w?AJMTR4
1j<1h&g,RM2Vlz  p(}J>tkJ"~3*"P_#7<4OT2r[UjfC:T14
*DgBMfo|ie;^]	 /\mm^I9l0O[D-N<+}yL*?$=}G"x&pBT?a?,S	^p'y(h\5Q),7N)J%KJ%WiD=>=M
2jr60;ibC&iREuYL_>"8[L#2:+"Ax[vkwN,-% /j<
=}^C|,p[?g=Miz]>YdsB$G-Ti0pIjY9c+2Dw'7Zd?+D\@z]E=ML$!4z=}nJl38i&b \gxxsU^;-m}r09_>N~7)3rc<Qwhb\?Aih#e,9 e(y;bDz*=M)C]&+nO n/Bmd%aK/ wZK8n!%m6'lHM8D3Z~{'Rt=t={tEjpa52<"a?3AuIL5IxIWn=}Z=MtcRt}GKaGH*4b5p22wC5[k02GQXD0:P=M
'9O_n8K[Sg='j282H2\-Q]{)=M tJQy=}Yj\=M 2<v0ha*}[Fr%{ziMs @^|_[yvuo4wocujT{t4wlsOZw)H{k>FoOu&;f) [2J(Zg' 8dFUo(AnR_u3b._rm:kU
UEhrj>3jW?VtGD3_\]bl2
![m<L]!;A{EyY:cwB0E""Zm*;q	krJ!C}he
V^2"s4 ,!/^m '#:GP C~^vz^i7IQ#UKo'8);-JD;CsY %-xo&vYKawd_g{=.nBxyFf-b=Ml-VV(A/\Wt'SM.2ShFkU_?[JIt?W{34A b8)D)<L,o{6cK={mR;
rc>zl93I1	=C=MXJx:i2JIt_k=}Lg/ ZIq9Ktl+B0O=Mb<]=}hG2=}dj9dSi ij/}Xd7] #W=Gfayjn=}:.26)8NEv>E6zG4p$/[|w;=erdQ4CA\=I!$~
48-JOG{}D5{NEJZC=}*SC3qa3/U|K<(4v8ptmf%E-(9o)H-mSNw^QFq 1]wJ<\-Wu6]R-%I3	nw,w!Ma A	t*=Wx-"SXZJUz]s>HNU 1igv[8GCUnL<TI2Fz/Aq_N=M/2@=}AwsGbacp7+RY(5#>;Kn'(YM(PDw15y4,<^YL\_'Tqk!p3)y)1jRinvZ-,zm,kHW 9CD4YL*\vKlHMWxY8PTECr>g-feGS_~zSzS}Y\MO3p3"BG!+o=MPyQ<9=MT) [ lE^dj\.[Ym |zpmJ5M-8-SRl%MEa5\Gws%~Hl&k<n=MLHxF0E~\[tNp'{g-%,#y]6[QRB:@&VOS<S
.W{5%*&P{r+o
{=}%G+0&P{2-{_=}d=}kb&4%DpN {^zqg.F-!$j4-89o<49Ky	GU&-)	=}#Ih#apkcqMW#LxW_>#Jrl#a	Q2;#@N8!@MD/!!Ay"bvP~V,N>"	RY"xpa]|?<dY"{E#YY=}n7m)]
JgZoL)pb	 E=}	7DIb8s3	Y=M9J~P$B="JU[~5.FN\"YM\yFt+
m'b<:h\@X TPq;y
"bR\>.lap6cnrq=}{[Ol!1("l&N{h7faz4-a qcU]g_Q.	]r:zca. '-3/yBw0j'9K|6 v2w4PFayDy;=}>EE Pz#<,@y! ]   2ct qAHM&Pe1!XOu^J82K8Ke]Fw}.Z]?S>ys[>UhnBpR*@h@7c)-I8w|&MM7NF$72&a.1n3B6K=k4ND[Ag^\MD_8MfT>b'[Lu^[3N]v(7UHe3(sQf+sR\RirpuC&ctJ+=}.H)XTGwcMK;F+YHQQRJNX;sqK^ >cy -(Dsbx:($E3Vz0QYwj:^vf9:5\K\[!P~_~wKGs6enn(Q+ {6j1.[mtp@=}'D2LeG_wcwKCThB8#u_UnIjZI3K4t7:<R\Z'FoEqWX:PaGPZ[B3fCd=}8\-IW-aJh	=M[gf1X3D!;-DOx}{7cH;|Lzi 84%,L}.9'=	#d	kDpmU>N	c/7aT>i8sp	k;JAf-o=}K2$ed*>yIeT.E^,~q$Gdb@QI
)"rAZm??(IK^	JK): ,'LHh8RkX?W<NYPX<:=MsQiw(N,>%x|wEa)"Px@Ynz=\LuM"* x) P]&Fu
ykw_%+'O?{*X+@k7l74
)"x}W~~EuVQB*L=}_V/32eg<&i&iivkhFMFW~SRZ$qt>0)k|$Nsc_*f>+5$u+).f+[/uk<A~\gC(/XOk9'wMjcK@7iI;i Z<)aC2]8d8ax.i4;mM_&}hMswI1?eNo*("/fTX?Z&=m1iRz<k*O\1?A{ES{wg\[b=}yb5UpcQJh=^YsZ
(t=:8)6{:PSatt;>8mocA{v)4c^?gC&7=}Rh;YTo^r6=}3Vbs,3J[ht5UX$.?\Sl~WpPd]*O8Sr<)C7BjD^CHJ*?{>E{FWZ?\K+0Hdzr#*YD)eE'uM|~_%;dJw4Z(z,|=M&| Rc hMb.)|.+J|j+oDKF8>pUIWH%wR$H=MYv[f5Rj{Obt 
&%MvMU@m1YA;B2diDD4x:NW.s-OBaKB>\su=}C:'?>zrz%Cs:$m }es&y;fbcf.E.r52}i"3ccm%	#hj::g"9Be[!62nAIO-n#U/Ei!w~Y~Y~YMuz}|fgdBNg%s oMbYt%Ofh	f5Oo(h=M-2w+4e$P@HGf(N3LKCos=M*	xYw?K+])DKgr*]BFI'F%%Zm*Ob&D
*@n+O^s!|>s(=}AQgKar^f)?!u_Ri=iif L!V jvw=Mux<nMM=TY!9098h2t$2:b2jq qoi||OLwU3+]T0	7bn&a=}G	]]Qq@1] <HX ,=[t%po?~qc}Y}98ibp^p p	}{W~xwx7v(s|KVg6
1~TG8+*qY/f~WX7[&T)u~lVJ E#-5;@H'BOr,($KC/ @b?%=}z]ZF0rW7!n&me:GO 3?zhAGQoOjs	L;y~llq{Wwi-erHrR=}.
+[13L8-58zmlP77AC6I+H~"6vm6J$s4guL- gdc=|xT*g6E7p)_rqo"	zX4.$3Whwqb0
*l(r>9Y]}^	zLNrP=9.b|o}r,mQ0
Yt?2 : azp}8?N1T0kaV
Q| >6_9 
{,@_:9K^	,_2}iErC=MT=M+Duy1[hr=})6udq7:pNI_y ZP@\xW|YHN r{paGn}r/]\F4OC{m"i] lT=VT 9'Wb> hF*j-]5$6Q}v?n{B[& *Gs=M* xg}.iA	A0:J5A'stn,5\k6,=M+N'ksmQ-v1.H*:5c(e<mEce{c:JU(+scz-_
*$R+ 3j;Zl5-+oF+mF<gu<%/cJ@g=k?z6KgH-l]+[zcCwAm:9JMAw'o#;C3Sj2w\N<p H'MqY0&xv)],>a$=Mv|z',z"qO?@}}1l	ZY=}-*("6S">|BL6OW=MvU\P%Yq=}?ao=G*%rX*^NbIq@o=}_4	!O"!4'?G]<4}P6,h,\JJ{JEDS	Dg}]DdKXMIK'AZmE-}0udxlk}'U[
ZO?aj|>? %mhG +0w$L	+}h'Y$c'10+qtd}2An^q&V}Q>G1
xIqKsw5s=
lA<NZB Dmq q}P5u7_LH1QV'BaPKo'9n^Ua&i5^r	:J"L:*o T& <2yv=}@	|!=M}{^q]N*yl
&m2$sy| o|uXWIT&r_8dqsddq=}4v-nMQ,0n8>^]TvEn?D(}Y}<}]n)vwmsY3" *IQ(|7A6/<.IZOj>I)qftMp,
!xJIdKQ:e1Qt $
Lb<Wu<nza'edClE!.y2GYf2^4J&58eCR#:hv&l0w 	 <uGb ?)7eRr95pE\w
M*7SLFM6GXr}']W6f#wUCPDR<d<X&,V-kN<1a-*_
M+g=>%yeiaT=;X+21}Gi	],7d;i}%0Z8rF;=aYC(]wF#*#wb8MQu[3l[Ml=M!QVK?fI|sn+53aCECJJl&{PpEgkoiW_i@W#d{KQa!#MAws=MwpF/QduAB	6){ZH4m
o6<<o#_QAi V~T%$sq,t8d/zbS;#s$7m 7o(lWlnA0avip?UXTu|2rn la??Wu|q7]=}AabPZ I93t!~5,:p
)A:QVMHv&
5%iF\
*kDw=G~o!3zrC BX8 &^p=}&"8Z8Q29e=\\o^A*]f%YhQr<
a=}_Kg!xiH(D*Jh,+3+MK+(vmZvD0VMl"]V^^+N]QRzg$bFV)=M=}Z_D$aq2 fVOHT=}NED+{bm64+<Gh%2F'Mc}UhO.OjD15BL2~N~4.4Ii/Kl=}' |9bi^}b;g1F,2<="h
2R.W'#D,J9#<TxKLg=MSnzMdaYZq}WcgT	~MA74:hL~0r}ZI-l.u6ezZc[Zw0AOZt4Tv/Tz=xI.b%{1wtw	{O{{~c7
0P@y**:I1sEk/w+"L,aCae q@C)~BsFaqBoZLDay-?+hC&BTMv+HqIW=^ =MFBXs0CZa=voWq
	gL4|6bP,.GGHsZ8\NEazzs\O_sTY\.y=d/iXCzZy$QFQg:]DaR@{jq'J"sCr4~mGr&U
4{ 6\l&g#wv=60{#|(@F   coKBBNP/QgsD
67OO0L$BtR)XH"zr:y|TX/4C?ORcz:7n)t.$Q)UX| .hX0O
2*EV)B"h]79aLsmQ1<H@*i~fa~p _%).hV|"
gIY !q=}T8=v!NmHL7YWu1qm\/Li<BXi}DNq\PME',b8vSXs(6Lx9Dr)et/hF~jG(\y_?
BWW&qYO~Y=T~Y~Y~Y6]/rLx!]@ dwz=MJiA,	v<lB(	nl=MyTg6LG6\H7XwvPWv=kFOnkimlynkqmlnkdmltn?kl?m?l|?nkhmlxnkpmlnkfmlvn_kn_m_l~_nkjmlznkrm=}<kI@<o	k9U?8O	4,6<6(80v@v&Tulypkqq2Tqrw1aJ?\"_;8p/u	LA	 o7@
m9	p,>|^J(RT~:{LH<@{|8O=M}[uA0$i
_tqMuw5QIXLP\=Mqa'4A-Mj=\xK4@vFXkO7:~!mF	S1O
;p	W,=M	>>9	+@~=}	^Fy^}vA "zrdw*}^1q=
?Ov?)Vrf\=MMIyw8}Rxf\ZLz^B3dfUkN58UIm "\bU$*Y&HZ{AtZ~@]]\qEAr\]h"]!9fB[  b^D&Z&h(dB:tbWSUH'J[=MYLHA]!^o%2DU2;D'e
!SFf3:;&#?f=ofDK#M#O'QR08P	(m9pxXR$\&2z%WZ$I&}$X*T}_'1=}}c xd_x^C}"Q3v0d91/ 8DHoiEsUKO0z,=}c.*)q3P]2c\FTT'#9Z*1x{af=}<A|<aI	9f[W\HX=}^$=tHMkcDC!$s
q I(S^C:y3qs*Kcc~c}e  '}"S&:*$ba7~_kYm53 'fvfwE cQLC $^0%&19;e'"'B2zMA7
d)Nl'=}d;yQ[?mSL+q4-LEX.aM>=}{M+%6AJN'MT7 B75	n[qD\?>Iz
Ej@E v]$^$P8@Nl9=MO z
Xqh)mWH ZH~~i{v6HjkRU)8=1z4w
 BPYrU~\Lmfzs84cR>
$yF#ec;%Ay 4~GgT|t'&rd{S=}E"vU/!pj}2i)4,M5O5Jj~}29:]-^Tak~S'75bzS a"M[Q@MD)LNsJj}|[|Q^
M^;Uq[~NR4b4"6W]4 sS=#S]3L4,;C}['V)l@>t=MvT0]VcE"98/ U<Z"fc]0hccC	x2CN&John5d!Ik	GfYdy^~V7r0=M|7Wr !~Bj!=}'Iw m9]<@]1HU)C]ZHU_5#I3vD,tnKr7-qO055P<nix1x F!B*4px=MuaW (_+/S[a~EI;3/9xg9xN?W8>
o:5zwYx iPM=vk:0(Lgi@GRBH?:VMY O;*N@=#fWjs9hH7YdH=M!~F1E%xGtMIKp=}+Pg#*#y|rCf{T+b,csp|2.aCsVJ. 9_lgG3OC%%_#3%Y'{}HZVkn.YVO?W1[g;SXi=}B<uQ(oJXcGM&]:	=1[pnwI%
ekDRPnG[+U?<N38yKbUwF*xHE1eY0yR *Q7!&\BTnP<_p	_'Pe]_yfZ.z5667[5(%*B6nUHta[boR-|z-7b1iS:"*2;9~AI{RZ^bkZEs|7^,a>@ #
VlY/b~Y~/V0{q)rwH4
s)h>%i=}rG}9ei]Yw.)=M1%rBEk0?UE8Z~S:{BjOR.ik
7FUC5umO}IFj"=;=}id@J%P8jbQ!	"6WW[PgUtT/W)F.W?8eAIG_X5N
L1R]r^7e:J*GOsSbSA	%d dbf."JpJKPB(-Fl=O(Y-b~LK75G?!5:JC5iQdnR)%W |>ktP71=}<?=7UV'(XiF!%0.jx.w'v.kE=+02VIeZ(@wB,C90{OoRoT @j>Sknfg2U\;n6tpcuI@jN|zvi>6tJ4)}y^A("^
]6<
h@dWj=MxvusB)tH!6J8'6:HS6/*99'vM(
:<cr:ygt
V9AhS[R'.7E[2y-OH42V00aHO
f;7dD7'@%%dos7!~+\ Jc}~W
Ng	k f* sfhIai.tXq6
=TPCMsh@V;|qDq\(r?s,>W\k"1O#aLy}V'"~E*jJ|Ey))i#s}p,y-O{ZEx%]jc?o{x=}vf'0=M(uo3"O]{=v;R:<6t,w64@x1vd{\j3) u-TOT
m2f\?N*|t[Fs
3vW<JLV2K4+s"g!jW"uwu*	vopQ=Kt.UA~~&Kp]NNr	@
M1o~$S=}A
}C%C#|Y~~Y~QV~Y~YXA_EJ~t~i#e_z}k{Oja9sPeT'%h\[T#GqH:5>V8c)[H
5k=}ku
jtKf~t6.e+=M6.<#T!K:N._va^bt<m>CJ>fM]UDuYn'(x mbCf>:=MU@w{pzAk_fQ7^"w}W!6|I%_))Ra%(B93u!Ag2hq9h 
Y6S	NW7bTLvp	v8Bmb,u/t01ez?JOa{4hEt@;9QV!USdsV~~Y0~Y~|V~<;E6rhH=MzL~~u#G5(>7,=MD\eQ3ZlUyG=U:6#zVn9/V}=}e$;Tcu7.Q4r=hEX:44LIq{}idI o\wp=MM\&QOZw|X)GkCi}ME[5u0sdL*|=
@yt2N>9BE/P;&~o)ZT4 fF@K^vc(~B? )%_Nb$Qt2!6S2,P@"/'(dA*YK2>M':XA%b8yK
y3B)AZg+Vdq2j@'3|-,aK]&*=M$
9'{HC(@&@TS R@>/3)87,amd-V Vn-/H)pna1=Mgy|QcTqavYY:yXeKA^F	9Ud+]_% F;iY~Y~Y<}Yz}q~YP<GrZUg) 6yil1_4-_AF59B7&><QiVM%%H,1}~G0F]En@Bsg]j	DoiGy72=MiaW>T9WZnfO\YH/|}+u!xG6N-??uN8]YeqDMpJS1uav23rA^0r3$t+ga*s^'fDm@6?k"d!B.?0"-	iT9w-A=.
Chz,<v6H6%o<=85iz<=
%Xk
'@(gVmqUm
)qlfB3rYa/XI=V(Or~?&-4F;np.H7*%8tq0nK $=}[%wMhRLIx*y 8=M\{,AxDUE1T7yy1J$GU!Sn>Mo>l	,	Bue}*Y)vq(7_&	3!X&BG"@XV.THRe z0FsyfJWZ:rafU.
!#w'3#U&ktT Er});vbek;<f@QB%CZ|[j/-L;m.F[-Aa#OcS#N_gO+% Q+6&:,;_XVo28hO	+LN='!7SV%jW%7L'H5E-,*	 &\-.aW74W63|ZfLR{@0{7P6zJ?AfV; qQM
T.8)a	4kURaqL9V'ho)::	_
$\lSC>q32(#o!ki+$O% >C%7[|w@c*{/v;=m*pL53nef1>VdUq'^<:3rJ|7UGer{!LI=MKd08V?d2#W.'i}9+$.m,zV4S\_H)$3^&%j-#f"V60J=}(FS\a%?A~]f<(y{ji$+*[}e>0;Jd(c}!sUQ*h>o/=}$-.]r#b%Se<B;kKRv(/l^z$t'?r#zv$]J.g;>Jx^KXm<Dy-C[CT4&F$~6G~1%j=MRM^!4zbRd-oC{]6r=MA}U\6_5,dL<wX3XXgdl)$jvu!>5@
q4+Q\7N1@^lV+<^,5yW8GQ\E/|GL]/TE_\4g5<4\ky V"6:\>RX4&Ib_>,=uopVolfoY/OX(g7q<qApP 4?77_xr}Rze V\*yy[mC"1>3p7,4 (q	4uC
2i'>:uxyCF^a-QG2Gt\b rueA8wp/XIW	=a*!VE=MZ;	BG
Kq=}RuL <(~OC4=MZK19G|]d0Nu"mxs2as=]c oEN~0U*2d "7j0f,xG%
My2\hiKs	pR<N$=}Q(}}V<1aK.bm({B+;*x8Ta"'87 )5{nOs*9;pyK:Jm{ /P	[,1oYk&_S~@X_.sP4*lD+E%3qW%jjr.gJ4k9L7@&aw\.WjSg4yj/r
 v(x?1p<;<(VS	<&\z\spfn[ 9p=3#6.2x?#}[cMToCT'42/9_;i*gM/h;4 8&ob+hpT[H$h!kf!pn%e	Dc;F[Wi#$H9hjFHpUdwpIlHfDL&5e2{x ,Tf)3fdS=McVk'$(2@Pu'dVh.::9%%?mZe=MbC/r){gz&F	ff[ qp#I~y?=MS=-^CI	9y/?:W^n+h8M'MJ5\55eJlYm9{z6u(K' nAo5X+T&4LtB<^IfS!y&,@(|ImeCLh@HiY28^7\q[<H/=}(
2&AAVUCn?K~PrH^MV-MZxF?-6n
k=M6LdX|IIiWd=}=P86"zswB:dK"*a|el{Jpc7H0Y O{+~xSxwbvx#~=M%sXB,;V{B\3*^8[T<*<BC-&StF'EyW1g~cT*,jS!D|?Vvcr
i	^|[-:QKnjKE-[#-x*T&-3W.su/v-h/'hRB.B_c"he$ w=MV]:'Sps=}Wm=7"fyx,+)8~c%$+^?Dl9pS)bS?-$SO=}3/Jp)'6yu~9SB4w6X,r-)Z37 , vR8sc}1ow._UIZ_eLl=}h=Mt(LM=M] {;Yrut%[E,y JAs-*yK&}v/v<+H(vr@4z&e|<dd(#E[RqodF] qf\4Kg2d^qi[8	xH?qf}{g2/| T.
#@~SY~Y~Y~Y~Y]
AV3O?OBq#c!cdK:"sgB5c'_p:n"rAb,*2rkgoemiq1
B#3K[GW/?%5M]IY1A$4L\HX0@bS[W?E-=}IYaT<H0@FV^Z	R{\)iJ	7yWoQB"bE$P

jbu.GZ0pP ZWIL& jcdbgY =.rL_"bA|#7UYT8f~Z/bBT_y>yt^3_LSX!zdxRv _i8bV |KmmmEE}C"""M9:F<S8MVVVIIc:~\/;Kxyy $zU|mY~yU~~|YR1)Yb[!o|Mc @%V=}AHOnn!C(jdueJ	
LNU11Pf~eo[n, _=M)355aD,*eg*		LU-~-o1H\< _5~i\
#;~}vI$])H=
/Zn49ZjlB<&,_F=}PiGF-@n-jo]~]L =)+Y.9IY*<(T_E5NPg=M!HPJnUywVX{ob5 \J
@%qW+q|nI.V3R#ahm^eOe?FF@r~,5tFZ.:rKT*Yi^gu=}g	Pfi=}mQT0AT
k>:g&|e"U[J&qUV;}Wce9v{&$<p[uO
uy?6F &0
{<UJ.2rLV:1qm[w=}w@f i)QX@AX
l;2{m-\J>'_Js=}/{~YXZpY><~Yaw5(Vl[o$Mn%7:s1s=2 >8pf!pWFxn*	ji)8.v,_LpR4uL*wA	Zf?x{"kB>8%ZE8A}Ya2IwlMkhG=MB--x{ /]=}e~Kj=M1eyGfb(Mb]^=M'O;?<ojluqmh=Mp xN4J^-as)hrh,&9a&=E|u-4qNXzDxYjRwn@Xdpq(b [rjJXVVtPxRWluAte'wV;C#$)$oE9p@nOl}|6=FPt/g5~yl?v I]j@qe;'pNfvS/f
;$'Rxi.5vPI}fW?I0v=}J+(i/DTioh/h>j1vTi oj3,_28H2XhpNrV -&S'#0&=MYf{^A
z|!PjQ|X^
z{@: 
z {: 
z{p. z|p> 
m* TlQ|8^
{x( B{x0 |x8 B|x@ 
:::::: ~ARX)XO{nA


	

VVVVVVVV:$l	U6DnUz ss tt uu vv ww xx yy z
#{'	{+I{/{3|7	)BY)$WI_r?pro:"l!|*'(
)jgh
iJ*4u#q0yURnR\ArU2lAURnVrpAV2g2,hR .*ir0jj u*u:2uJruZvjvzY~2vrv9C%J"W#+*a+2,:a,B-:Ja-ZR.zZa.b/ja/r0za01:a1Z2za2k*bk2!<bo
@r!=}pJPz!>bp=!?q:prtvxz|~^$cY~Y~Y~Y~Y'mP^uMO=mNP\qD-}D/=}C2D.x8 K7=MJ:=MI6!LJ8-O/VrWrl>56@3M	>
U	=}aI>Q6FPomHUmRbRabbgVjUfOVh9fphZNWnPX|PW^SddsdE-Y.I.]-wese0i{0};/m0g1c~Y~YflQE6/rW}l ytj2[":l]Kt$Y>$MlSP
 lT[hJD /<8932=}e7U)_v)stInXIBjHBMJwPD",PmJ1LFzTg(K:BL9UP6m|lm!00O/~{=}j}.wVA6rA0E <E&j
~Y\bV~YK~	~^0MYBT*^\? Z9eSkU<.24<k:k
"z0"as x>n7
mu0q&&W:Y0Y0/)z-hLEEWuJxLr6/.u(E8= 66p"}IPC.]y#U;l2HhlT<yz<rLQKKx@w>JTDqqXf>wZ)j.6;-?LNO=}An ?=}OOO*JqyzHP?<&P=a'k$p! !p!$1OI;@O;g#ETO$@:(>z0RHN=M	

R>Xz t\+| XPQVJ+Y9Z}@=cA'pCA^5)t[zHQ!+pqE'Z2{rnwY\7Ta"yRSIbmiZ=M2]qG}`});var o,l;function p(){var M=l.buffer;o=new Uint8Array(M)}function _(M){return Math.cos(M)}function u(M){return Math.exp(M)}var c=(M,O,z)=>o.copyWithin(M,O,O+z),h=M=>{s("OOM")},g=M=>{o.length,h()},F={b:_,a:u,c,d:g};function T(M){M.f()}var U={a:F},E,k,I,W,j;this.setModule=M=>{e.setModule(Dt,M)},this.getModule=()=>e.getModule(Dt),this.instantiate=()=>(this.getModule().then(M=>WebAssembly.instantiate(M,U)).then(M=>{const O=M.exports;E=O.g,k=O.h,I=O.i,W=O.j,j=O.k,l=O.e,p(),T(O),t()}),this.ready=new Promise(M=>{t=M}).then(()=>{this.HEAP=l.buffer,this.malloc=k,this.free=j,this.opus_frame_decoder_create=E,this.opus_frame_decode_float_deinterleaved=I,this.opus_frame_decoder_destroy=W}),this)}function dt(e={}){dt.errors||Object.defineProperties(dt,{errors:{value:new Map([[-1,"OPUS_BAD_ARG: One or more invalid/out of range arguments"],[-2,"OPUS_BUFFER_TOO_SMALL: Not enough bytes allocated in the buffer"],[-3,"OPUS_INTERNAL_ERROR: An internal error was detected"],[-4,"OPUS_INVALID_PACKET: The compressed data passed is corrupted"],[-5,"OPUS_UNIMPLEMENTED: Invalid/unsupported request number"],[-6,"OPUS_INVALID_STATE: An encoder or decoder structure is invalid or already freed"],[-7,"OPUS_ALLOC_FAIL: Memory allocation has failed"]])}}),this._init=()=>new this._WASMAudioDecoderCommon(this).instantiate(this._EmscriptenWASM,this._module).then(c=>{this._common=c,this._inputBytes=0,this._outputSamples=0,this._frameNumber=0,this._input=this._common.allocateTypedArray(this._inputSize,Uint8Array),this._output=this._common.allocateTypedArray(this._outputChannels*this._outputChannelSize,Float32Array);const h=this._common.allocateTypedArray(this._channels,Uint8Array);h.buf.set(this._channelMappingTable),this._decoder=this._common.wasm.opus_frame_decoder_create(this._sampleRate,this._channels,this._streamCount,this._coupledStreamCount,h.ptr,this._preSkip,this._forceStereo)}),Object.defineProperty(this,"ready",{enumerable:!0,get:()=>this._ready}),this.reset=()=>(this.free(),this._init()),this.free=()=>{this._common.free(),this._common.wasm.opus_frame_decoder_destroy(this._decoder),this._common.wasm.free(this._decoder)},this._decode=c=>{if(!(c instanceof Uint8Array))throw Error("Data to decode must be Uint8Array. Instead got "+typeof c);this._input.buf.set(c);let h=this._common.wasm.opus_frame_decode_float_deinterleaved(this._decoder,this._input.ptr,c.length,this._output.ptr),g;return h<0&&(g="libopus "+h+" "+(dt.errors.get(h)||"Unknown Error"),console.error(g),h=0),{outputBuffer:this._common.getOutputChannels(this._output.buf,this._outputChannels,h),samplesDecoded:h,error:g}},this.decodeFrame=c=>{let h=[];const g=this._decode(c);return g.error&&this._common.addError(h,g.error,c.length,this._frameNumber,this._inputBytes,this._outputSamples),this._frameNumber++,this._inputBytes+=c.length,this._outputSamples+=g.samplesDecoded,this._WASMAudioDecoderCommon.getDecodedAudioMultiChannel(h,[g.outputBuffer],this._outputChannels,g.samplesDecoded,this._sampleRate)},this.decodeFrames=c=>{let h=[],g=[],F=0,T=0;for(;T<c.length;){const U=c[T++],E=this._decode(U);h.push(E.outputBuffer),F+=E.samplesDecoded,E.error&&this._common.addError(g,E.error,U.length,this._frameNumber,this._inputBytes,this._outputSamples),this._frameNumber++,this._inputBytes+=U.length,this._outputSamples+=E.samplesDecoded}return this._WASMAudioDecoderCommon.getDecodedAudioMultiChannel(g,h,this._outputChannels,F,this._sampleRate)},this._isWebWorker=dt.isWebWorker,this._WASMAudioDecoderCommon=dt.WASMAudioDecoderCommon||G,this._EmscriptenWASM=dt.EmscriptenWASM||Dt,this._module=dt.module;const t=8,s=c=>typeof c=="number",r=e.sampleRate,i=e.channels,o=e.streamCount,l=e.coupledStreamCount,p=e.channelMappingTable,_=e.preSkip,u=e.forceStereo?1:0;if(i>2&&(!s(o)||!s(l)||!Array.isArray(p)))throw new Error("Invalid Opus Decoder Options for multichannel decoding.");return this._sampleRate=[8e3,12e3,16e3,24e3,48e3].includes(r)?r:48e3,this._channels=s(i)?i:2,this._streamCount=s(o)?o:1,this._coupledStreamCount=s(l)?l:this._channels-1,this._channelMappingTable=p||(this._channels===2?[0,1]:[0]),this._preSkip=_||0,this._forceStereo=i<=t&&i!=2?u:0,this._inputSize=32e3*.12*this._channels,this._outputChannelSize=120*48,this._outputChannels=this._forceStereo?2:this._channels,this._ready=this._init(),this}function ns(e,t,s){return Math.min(s,Math.max(t,e))}const Mt=self,Kt=new Map;Mt.pendingStreams=Kt;const Ee=new Map,se=new Map,Te=8e3,Fi=1e4,Ti=5e3,ki=1e3,os=3e4,Mi=5e3,as="video/mp4",Ui="application/vnd.apple.mpegurl";function xi(e){return e<0?1e3<<-e:1e3>>e}class Pi{constructor(t,s){this.call=t,this.accountNumber=s,this._generation=0,this._retryCount=0,this._destroyed=!1,this._controllers=new Set,this._waitingForBuffer=new Set,this._timeouts=new Set,this._hlsWaitingForBuffer=[],this._hlsWaitingForChunk=new Map,this._pendingRejects=[],this.destroy=(r=new Error("destroyed"))=>{this._log("destroying rtmp stream",r),Kt.delete(this.call.id),this.clearClock(),this.clearDeadTimeout();for(const i of this._timeouts)clearTimeout(i);this._opusDecoder!==void 0&&this._opusDecoder.free();for(const i of this._controllers)i.close();for(const i of this._waitingForBuffer)i.close();for(const i of this._pendingRejects)i(r);this._destroyed=!0,this._generation=0,Be("rtmpStreamDestroyed",this.call.id)},this.onHlsTimeout=()=>{const r=this._log.bindPrefix("onHlsTimeout");if(r("hls playlist refetch timeout"),this._hlsWaitingForBuffer.length||this._hlsWaitingForChunk.size){r("still active (some fetch is pending)"),this.setDeadTimeout(this.onHlsTimeout,os);return}r("destroying due to inactivity"),this.destroy()},this.decodeOpus=this.decodeOpus.bind(this),this._log=X("RTMP-"+(Date.now()+"").slice(-2)),this._log("constructor",t.id)}updateRtt(t){this._rtts.push(t)>10&&this._rtts.shift()}maybeAdjustBufferSize(){if(this._rtts.length<3)return;const t=this._log.bindPrefix("maybeAdjustBufferSize"),s=this._rtts.reduce((i,o)=>i+o,0)/this._rtts.length,r=Math.ceil(ns(s*3,Te,Fi)/this._chunkTime);if(t(`avg rtt=${s} target buffer size=${r}`),r!==this._bufferSize){const i=r-this._bufferSize;this._cutoff=this._cutoff.minus(this._chunkTime*i),this._bufferSize=r,t(`adjusted buffer size to ${r}`)}}async processChunk(t,s){return t?bi({chunk:t,seq:s,timestamp:ht(s).multiply(this._chunkTime),opusTrackId:this._initChunk.opusTrackId,decodeOpus:gt&&this.decodeOpus}):new Uint8Array(0)}async fetchChunk(t,s){const r=this._log.bindPrefix("fetchChunk-"+t.toString());if(t.isNegative()){r.warn("negative time");return}if(!s&&this._lastRequestedTime!==void 0&&t.lesserOrEquals(this._lastRequestedTime)){r.warn("last requested time is greater or equals",this._lastRequestedTime.toString());return}this._lastRequestedTime=t,r(`starting fetch time=${t}`);const i=Date.now(),o=await $.invoke("requestRtmpPart",{dcId:this._dcId,accountNumber:this.accountNumber,request:{_:"inputGroupCallStream",call:this.call,time_ms:t.toString(),scale:this._scale,video_channel:rs,video_quality:ai}}),l=Date.now()-i;if(this.updateRtt(l),r(`ended fetch time=${t}, rtt=${l}`),!o){r.warn("no bytes");return}if(o.container!=="mp4")throw new Error("Invalid container");return R.parseBuffer(o.bytes.slice(o.contentOffset).buffer)}async generateInitChunk(t){this._initChunk||(this._initChunk=vi(t,{opusToFlac:gt}),this._initChunk.opusInitOptions&&await this.initOpusDecoder(),this._retryCount=0)}async initOpusDecoder(t=!1){if(this._decoderInitPromise){await this._decoderInitPromise;return}this._log("creating opus decoder"),this._opusDecoder!==void 0&&!t&&this._opusDecoder.free();const s=new dt(this._initChunk.opusInitOptions);this._decoderInitPromise=s.ready,await this._decoderInitPromise,this._opusDecoder=s,this._log("opus decoder created")}async decodeOpus(t){return this._opusDecoder===void 0&&await this.initOpusDecoder(),this._opusDecoder.decodeFrame(t)}hasEnoughBuffer(){return!!this._initChunk&&this._bufferSize&&this._buffer.some(t=>!!t.segment)}sendBufferToController(t){this._log("sending buffer to controller"),t.enqueue(this._initChunk.data);for(const s of this._buffer){if(!s.segment)break;t.enqueue(s.segment)}}removeStaleChunks(){do{const t=this._buffer[0];if(t&&t.time.lt(this._cutoff))this._buffer.shift(),this._log("removing stale chunk",t.time.toString());else break}while(!0)}async _replenishBuffer(t=1,s=this._lastReplenishingPromise){const r=this._log.bindPrefix("replenishBuffer-"+this._replenishTempId++);this.removeStaleChunks();const i=this._generation,o=ns(this._bufferSize-this._buffer.length,0,t);if(!o){r("skipping replenish - buffer full");return}const l=()=>this._destroyed||this._generation!==i,p=this._lastRequestedTime,_=[];r(`replenishing buffer chunksToFetch=${o} lastBufferedChunkTime=${p} bufferLength=${this._buffer.length}`);for(let c=1;c<=o;++c){const h=p.add(this._chunkTime*c),g={time:h};this._buffer.push(g);const F=async T=>{try{g.iso=await this.fetchChunk(h,T)}catch(U){r("error",U.type,h.toString());const E=async k=>{if(await Ft(k),!l())return F(!0)};if(U.type==="TIME_TOO_BIG"){if(T)throw new Error("stream ended");const k=await this.fetchState();if(l())return;const I=this.findChannel(k),W=h.minus(ht(I.last_timestamp_ms)).add(this._chunkTime).toJSNumber();if(W<0)throw new Error("stream ended");return E(W)}else throw U}return g};_.push(F())}let u=await Promise.all(_);if(!l()&&(this.maybeAdjustBufferSize(),await s,!l())){if(u=u.filter(c=>c.time.gt(this._lastFlushedTime)),!u.length){r.warn("skipping flush - no new chunks");return}if(this._lastFlushedTime.notEquals(ht.zero)&&u[0].time.minus(this._lastFlushedTime).notEquals(this._chunkTime)&&r.error(`chunks are not continuous, lastFlushed=${this._lastFlushedTime.toString()}, newChunks=${u[0].time.toString()}`),this._lastFlushedTime=u[u.length-1].time,u=u.filter(c=>c.iso?!0:(this._log.error("empty chunk?",c),!1)),gt){for(const c of this._hlsWaitingForBuffer)c();this._hlsWaitingForBuffer.length=0;for(const c of u){await this.prepareChunkForFlushing(c);const h=this._hlsWaitingForChunk.get(c.seq)||[];this._hlsWaitingForChunk.delete(c.seq),r(`sending chunk to waiters time=${c.time} seq=${c.seq}`);for(const g of h)g(c.segment)}}else{for(const c of u){await this.prepareChunkForFlushing(c),r(`sending chunk to controller time=${c.time} seq=${c.seq}`);for(const h of this._controllers)h.enqueue(c.segment)}for(const c of this._waitingForBuffer)this.sendBufferToController(c),this._controllers.add(c);this._waitingForBuffer.clear()}r("buffer replenished")}}replenishBuffer(...t){const s=this._lastReplenishingPromise,r=this._lastReplenishingPromise=(async()=>{const i=this._replenishBuffer(...t);try{const o=await i;return await s,o}catch(o){throw o}})();return this._bufferSize-this._buffer.length>0&&this._lastRequestedTime.geq(ht.zero)?Promise.all([r,this.replenishBuffer()]).then(()=>{}):r}async prepareChunkForFlushing(t){this._initChunk||(this._log(`will add init chunk to time=${t.time.toString()}`),await this.generateInitChunk(t.iso));const s=this._lastChunkSeq++;t.seq=s,t.segment=await this.processChunk(t.iso,s)}async fetchState(){const t=J();let s=0,r;const i=()=>{if(s>3){t.reject(new Error("Failed to fetch state"));return}r&&(clearTimeout(r),this._timeouts.delete(r)),r=Mt.setTimeout(()=>{s++,i()},1e3),this._timeouts.add(r),$.invoke("requestRtmpState",{call:this.call,accountNumber:this.accountNumber}).then(o=>{clearTimeout(r),t.resolve(o)}).catch(o=>{this._log.error("error fetching state",o),s++,i()})};return i(),t}clearClock(){clearInterval(this._clock),this._clock=void 0}setClock(){const t=this._log.bindPrefix("clock"),s=this._clock=Mt.setInterval(()=>{this._time=this._time.add(this._chunkTime),this._cutoff=this._cutoff.add(this._chunkTime),this.notifyTime(),t(`tick ts=${this._time.toString()} cutoff=${this._cutoff.toString()}`),this.replenishBuffer().catch(r=>{this._destroyed||this._clock!==s||(t.error("error replenishing buffer",r),this._buffer.some(i=>i.segment)||this.handleError(r))})},this._chunkTime)}findChannel(t){const s=t.channels.find(r=>r.channel===rs);if(!s)throw C.error("no unified channel found",t),new Error("No unified channel found");return s}async _start(){const t=this._log.bindPrefix("start");t(`starting ${this.call.id} generation ${this._generation} -> ${this._generation+1}`,this),this.clearClock(),this._initChunk=void 0,this._lastChunkSeq=0,this._buffer=[],this._lastFlushedTime=ht.zero,this._replenishTempId=0,this._lastReplenishingPromise=Promise.resolve(),this._rtts=[];const s=++this._generation,r=()=>this._generation===s&&!this._destroyed,[i]=await Promise.all([this.fetchState(),se.get(this.call.id)&&Ft(Math.max(0,se.get(this.call.id)-Date.now()))]);if(!r())return;se.delete(this.call.id);const o=this.findChannel(i);if(t(`started, last_ts=${o.last_timestamp_ms}, scale=${o.scale}`),this._time=ht(o.last_timestamp_ms).minus(ki),this._lastRequestedTime=this._time,gt){const l=Ee.get(this.call.id);l&&l.gt(this._time)&&(this._time=l)}this._cutoff=this._time.minus(Te),this._scale=o.scale,this._chunkTime=xi(this._scale),this._bufferSize=Math.ceil(Te/this._chunkTime),this._dcId=i.dcId,this.notifyTime(),this.setClock(),await this.replenishBuffer(Math.ceil(Ti/this._chunkTime))}start(){this._start().catch(t=>this.handleError(t))}notifyTime(){gt&&Ee.set(this.call.id,this._time),Be("rtmpStreamTime",{callId:this.call.id,time:this._time.toString()})}handleError(t){if(this._destroyed)return!1;const s=this._log.bindPrefix("handleError");if(typeof t=="object"&&t&&typeof t.type=="string"){if(t.type.startsWith("FLOOD_WAIT")){const r=+t.type.split("_").pop();return se.set(this.call.id,Date.now()+r*1e3),this.start(),!0}if(t.type==="TIME_TOO_SMALL"||t.type==="TIME_INVALID")return s("rtmp stream need resync",t),this.start(),!0;if((t.type==="GROUPCALL_FORBIDDEN"||t.type==="VIDEO_CHANNEL_INVALID")&&this._retryCount<3)return s("retrying rtmp stream",t),this._retryCount+=1,this.start(),!0}s("rtmp stream error",t),this.destroy(t)}createStream(){const t=this._log.bindPrefix("createStream");let s;return new ReadableStream({start:r=>{t(`added rtmp stream controller call=${this.call.id} gen=${this._generation} destroyed=${this._destroyed}`),s=r,this._generation===0&&this.start(),this.clearDeadTimeout(),this.hasEnoughBuffer()?(this.sendBufferToController(r),this._controllers.add(r)):this._waitingForBuffer.add(r)},cancel:()=>{this._destroyed||(t("rtmp stream controller died",this.call.id),this._controllers.delete(s),this._waitingForBuffer.delete(s),this._controllers.size||this.setDeadTimeout(this.destroy,Mi))}})}clearDeadTimeout(){this._deadTimeout&&(clearTimeout(this._deadTimeout),this._deadTimeout=void 0)}setDeadTimeout(t,s){this.clearDeadTimeout(),this._deadTimeout=Mt.setTimeout(t,s)}generateHlsPlaylist(t,s=!1){const r=this._chunkTime/1e3,i=["#EXTM3U","#EXT-X-VERSION:7",`#EXT-X-TARGETDURATION:${Math.ceil(r)}`,`#EXT-X-MEDIA-SEQUENCE:${this._buffer[0]?.seq??0}`,"#EXT-X-INDEPENDENT-SEGMENTS",`#EXT-X-MAP:URI="${t}?hls=init"`];for(const o of this._buffer){if(!o.segment)break;i.push(`#EXTINF:${r},`,`${t}?hls=${o.seq}`)}return s&&i.push("#EXT-X-ENDLIST"),i.join(`
`)}async getHlsPlaylist(t){const s=this._log.bindPrefix("getHlsPlaylist");return s("getting hls playlist"),this.setDeadTimeout(this.onHlsTimeout,os),this._generation!==0?this.generateHlsPlaylist(t):(this.start(),new Promise(r=>{const i=o=>{s("hls playlist fetch error, returning empty+end",o),r(this.generateHlsPlaylist(t,!0))};this._pendingRejects.push(i),this._hlsWaitingForBuffer.push(()=>{const o=this._pendingRejects.indexOf(i);o!==-1&&this._pendingRejects.splice(o,1),r(this.generateHlsPlaylist(t))})}))}getInitChunk(){return this._initChunk?.data}async getHlsChunk(t){const s=this._log.bindPrefix("getHlsChunk");s("getting hls chunk",t);const r=this._buffer.find(i=>i.seq===t);if(r&&r.segment)return r.segment;if(this._buffer.length&&t<this._buffer[0].seq){s("hls chunk to old",t),s(this._buffer);return}return new Promise((i,o)=>{const l=Mt.setInterval(()=>{this._buffer.length&&t<this._buffer[0].seq&&(s("hls chunk fetch timeout",t),i(void 0))},this._chunkTime??500),p=u=>{clearInterval(l),o(u)},_=this._hlsWaitingForChunk.get(t)||[];_.push(u=>{const c=this._pendingRejects.indexOf(p);c!==-1&&this._pendingRejects.splice(c,1),clearInterval(l),i(u)}),this._pendingRejects.push(p),this._hlsWaitingForChunk.set(t,_)})}}async function Ei(e,t,s){const r=JSON.parse(decodeURIComponent(t));let i=Kt.get(r.id);const o=s?.startsWith("hls="),l=await Mt.clients.get(e.clientId),p=Gt(l.url);if(i||(C("creating rtmp stream",r.id),i=new Pi(r,p),Kt.set(r.id,i)),o){s=s.split("&t=")[0];const _=e.request.url.split("?")[0],u=s.slice(4);if(u==="playlist")return i.getHlsPlaylist(_).then(h=>new Response(h,{headers:{"Content-Type":Ui}}));if(u==="init"){const h=i.getInitChunk();return h?new Response(h,{headers:{"Content-Type":as}}):new Response("",{status:404})}const c=Number(u);return isNaN(c)?new Response("",{status:404}):i.getHlsChunk(c).then(h=>h?new Response(h,{headers:{"Content-Type":as}}):new Response("",{status:404}))}return new Response(i.createStream(),{headers:{"Content-Type":"video/mp4"}})}function Ai(e,t,s){const r=Ei(e,t,s);e.respondWith(r)}function Ii([e,t]){const s=Kt.get(e+"");s&&s.destroy(),gt&&t&&Ee.delete(e)}const Zt=()=>new Response("",{status:500,statusText:"Internal Server Error",headers:{"Cache-Control":"no-cache"}}),Bi="application/x-mpegurl",Bs=self;X("HLS");const At=X("SW-HLS");function Ci(e){return e?.mime_type===Bi}class Cs{constructor(){this.ongoingRequests=new Map}async performRequest(t,s){let r=this.ongoingRequests.get(t);r||this.ongoingRequests.set(t,r=s());const i=await r;return this.ongoingRequests.delete(t),i}}const cs=new V("cachedHlsQualityFiles"),Oi=new Cs;async function Di(e,t,s){const r=J();e.respondWith(r);try{const i=t,o=await Bs.clients.get(e.clientId),l=Gt(o.url),p=await Oi.performRequest(Ae(i),()=>Ni(i,l));r.resolve(new Response(p))}catch(i){r.resolve(Zt()),At.error(i)}}async function Ni(e,t){const r=await(await Ri(e,t)).text();return await Li(r,t)}function Ae(e){return`hls_quality_${e}`}async function Ri(e,t){try{const s=await cs.getFile(Ae(e));return At.info("using cached quality file",e),s}catch{At.info("fetching quality file",e);const s=await $.invoke("downloadDoc",{docId:e,accountNumber:t});return cs.saveFile(Ae(e),s),s}}async function Li(e,t){const s="mtproto:(\\d+)",r=e.match(new RegExp(s));if(!r)throw new Error("Wrong Hls quality file format");const i=r[1];if(At.info("targetDocId",i),!i)throw new Error("Wrong Hls quality file format");const o=await $.invoke("requestDoc",{docId:i,accountNumber:t}),l={docId:i,dcId:o.dc_id,size:o.size,mimeType:o.mime_type},p=`hls_stream/${encodeURIComponent(JSON.stringify(l))}`,_=new URL(p,location.origin).toString();return e.replace(new RegExp(s,"g"),_)}const Os=new V("cachedHlsStreamChunks"),zi=new Cs;async function qi(e,t){const s=[];let r=0;for(const l of t){const p=await zi.performRequest(De(e,l),()=>Wi(e,l));r+=p.length,s.push(p)}if(s.length===1)return s[0];const i=new Uint8Array(r);let o=0;for(const l of s)i.set(l,o),o+=l.length;return i}async function Wi(e,t){try{const s=De(e,t),r=await Os.getFile(s,"blob");return await ae(r)}catch{const{bytes:s}=await $.invoke("requestFilePart",{...e,...t});return ji(s,e,t),s}}function De(e,t){return`${e.accountNumber}-${e.docId}?offset=${t.offset}&limit=${t.limit}`}async function ji(e,t,s){const r=De(t,s),i=new Response(e);await Os.save({entryName:r,response:i,size:e.length,contentType:"application/octet-stream"})}const Nt=4096,pt=1024*1024;function $i(e,t){const s=Math.floor(e/Nt)*Nt,r=(Math.floor(t/Nt)+1)*Nt,i=Math.floor(e/pt)*pt,o=(Math.floor(e/pt)+1)*pt,l=Math.min(o,r),p=l-s,_=ls(p),u=Math.max(l-_,i),c=[{offset:u,limit:_}];let h=o;for(;h<t&&!((Math.floor(h/pt)+1)*pt>t);)c.push({offset:h,limit:pt}),h+=pt;if(h<=t){const T=t-h+1,U=ls(T);c.push({offset:h,limit:U})}const g=c[c.length-1],F=g.offset+g.limit-1;return{alignedLowerBound:u,alignedUpperBound:F,ranges:c}}function ls(e){return Math.max(2**Math.ceil(Math.log2(e)),Nt)}const Ji=self;async function Hi(e,t,s){const r=J();e.respondWith(r);try{const{docId:i,dcId:o,size:l,mimeType:p}=JSON.parse(decodeURIComponent(t)),_=Ts(e.request.headers.get("Range")),u=await Ji.clients.get(e.clientId),c=Gt(u.url),[h,g]=_,{ranges:F,alignedLowerBound:T}=$i(h,g),U=await qi({docId:i,dcId:o,accountNumber:c},F),E={"Accept-Ranges":"bytes","Content-Range":`bytes ${_[0]}-${_[1]}/${l||"*"}`,"Content-Length":`${g-h+1}`};E["Content-Type"]=p;const k=U.slice(h-T,g-T+1);r.resolve(new Response(k,{status:206,statusText:"Partial Content",headers:E}))}catch(i){r.resolve(Zt()),At.error(i)}}let Ds;function Ki(){return Ds}function Vi(e){return Ds=e}const Yi="mtproto:",Gi=1e6,Zi=1280,Xi=720;function Qi(e){let t=tn(e);if(Ki().IS_AV1_SUPPORTED||(t=t.filter(r=>r.codec!=="av01")),!t.length)return null;t.sort((r,i)=>r.bandwidth-i.bandwidth);let s=`#EXTM3U
`;for(const r of t){const{w:i,h:o,bandwidth:l,url:p}=r;s+=`#EXT-X-STREAM-INF:BANDWIDTH=${l},RESOLUTION=${i}x${o}
`,s+=p+`
`}return s+=`
#EXT-X-ENDLIST`,s}function tn(e){if(!e?.length)return[];const t=en(e),s=sn(e);return Object.entries(t).map(([r,i])=>{const{w:o=Zi,h:l=Xi,duration:p=0,video_codec:_}=i,{size:u}=e.find(h=>h.id.toString()===r),c=(p>0?u/p*8:Gi)|0;return{id:r,w:o,h:l,duration:p,bandwidth:c,url:s[r],codec:_}})}function en(e){const t={};for(const s of e){const r=s?.attributes?.find(i=>i._==="documentAttributeVideo");r&&(t[s.id]=r)}return t}function sn(e){const t={};for(const s of e)Ci(s)&&(t[nn(s)]=rn(s));return t}function rn(e){return`hls_quality_file/${e.id}`}function nn(e){const t=e.attributes?.find(r=>r._==="documentAttributeFilename");return(e.file_name||t?.file_name)?.slice(Yi.length)}async function on(e,t,s){const r=J();e.respondWith(r);try{const i=JSON.parse(decodeURIComponent(t)),o=await Bs.clients.get(e.clientId),l=Gt(o.url),p=i.location?.id,_=await $.invoke("requestAltDocsByDoc",{docId:p,accountNumber:l});if(!_)throw new Error("No alt docs found for document");const u=Qi(_);if(!u)throw new Error("Failed to create video source for hls streaming");r.resolve(new Response(u))}catch(i){r.resolve(Zt()),At.error(i)}}const an=new V("cachedBackgrounds");function cn(e){const t=e.request.url.match(/backgrounds.*/)[0];if(!t){e.respondWith(Zt());return}const s=J();e.respondWith(s),(async()=>{const r=await an.getFile(t,"blob");s.resolve(new Response(r,{status:200}))})()}X("SW-mtproto-bug",kt.None);function ne(e,t="auto"){if(e===0)return"0 B";const s=t==="auto",r=1024,i=Math.floor(Math.log(e)/Math.log(r)),o=t==="auto"?Math.max(0,i-1):t,l=Math.max(0,o),p=["B","KB","MB","GB"],_=(e/Math.pow(r,i)).toFixed(l);return[p[i],s?_:parseFloat(_)].reverse().join(" ")}function ke(e,t,s=!1){let r,i,o;const l=(...p)=>{if(r=!0,o=p,i)return;s&&(r=!1,t(...o));const _=i=Math.random();e(()=>{i===_&&(l.clear(),r&&(r=!1,t(...o)))})};return l.clear=()=>{i=void 0},l}function ln(e){return e instanceof Uint8Array?e:typeof e=="string"?new TextEncoder().encode(e):new Uint8Array(e)}function hn(e,t){let s,r,i=!1;function o(){r=self.setTimeout(()=>{i=!1,e(...s)?.then(()=>{r=void 0,i&&o()})},t)}const l=(...p)=>{s=p,i=!0,!r&&o()};return l.clear=()=>{self.clearTimeout(r),s=void 0,r=void 0,i=!1},l}class Ne extends Ce{constructor(){super("MTPROTO"),Ne.INSTANCE=this,it&&(it.mtprotoMessagePort=this)}static getInstance(){return this.INSTANCE}}const tt=class tt{constructor(t,s){this.db=t,this.encryptedStoreName=s,this.saveToIDB=async()=>{await this.waitToLoad();const r=performance.now(),i=await tt.encrypt(this.data),o=i.length,l=performance.now();await this.storage.save(tt.STORAGE_KEY,i);const p=performance.now();if(ue&&jt){const _=c=>c.toFixed(2);Ne.getInstance().invokeVoid("log",`[${this.db.name}-${this.encryptedStoreName}] Encrypted and saved ${o} bytes (${ne(o,2)}) of data in ${_(p-r)}ms -- (encrypted in ${_(l-r)}ms, saved in ${_(p-l)}ms)`)}},this.saveToIDBThrottled=hn(()=>this.saveToIDB(),tt.STORAGE_THROTTLE_TIME_MS),this.storage=new zt(t,s),this.log=X(`encrypted-storage-${s}`)}static getInstance(t,s){const r=this.getStorageKey(t.name,s);if(this.instances.has(r))return this.instances.get(r);const i=new tt(t,s);return this.instances.set(r,i),i}static getStorageKey(t,s){return`${t}**${s}`}static async encrypt(t){if(!Object.keys(t).length)return null;const s=await ot.get(),r=ln(JSON.stringify(t));return await Tt.invokeCryptoNew({method:"aes-local-encrypt",args:[{key:s,data:r}],transfer:[r.buffer]})}static async decrypt(t){const s=await ot.get(),r=await Tt.invokeCryptoNew({method:"aes-local-decrypt",args:[{key:s,encryptedData:t}],transfer:[t.buffer]}),i=new TextDecoder().decode(r);return JSON.parse(i)}loadEncrypted(){(async()=>(this.loadingDataPromise=this.loadFromIDB(),await this.loadingDataPromise,this.loadingDataPromise=void 0))()}async loadDecrypted(t){this.log("loading decrypted",t),this.data=t,await this.saveToIDB()}waitToLoad(){if(this.loadingDataPromise)return this.loadingDataPromise}async loadFromIDB(){try{const t=await this.storage.get(tt.STORAGE_KEY);if(t==null)throw null;if(!(t instanceof Uint8Array))throw new Error("Stored data in encrypted store is not a Uint8Array");const s=await tt.decrypt(t);this.data=s}catch(t){t&&this.log(t),this.data={}}return this.data}async reEncrypt(){await this.saveToIDB()}async save(t,s){await this.waitToLoad();const r=re(t),i=re(s);r.forEach((o,l)=>{this.data[o]=i[l]}),this.saveToIDBThrottled()}async get(t){return await this.waitToLoad(),t.map(s=>this.data[s])}async getAllEntries(){return await this.waitToLoad(),Object.entries(this.data)}async getAll(){return await this.waitToLoad(),Object.values(this.data)}async getAllKeys(){return await this.waitToLoad(),Object.keys(this.data)}async delete(t){await this.waitToLoad(),re(t).forEach(r=>{delete this.data[r]}),this.saveToIDBThrottled()}async clear(){this.data={},await this.storage.clear()}};tt.STORAGE_KEY="data",tt.STORAGE_THROTTLE_TIME_MS=0,tt.instances=new Map;let lt=tt;function un(){}const Ut=class Ut{constructor(t,s){this.db=t,this.storeName=s,this._save=async()=>{const i=this.saveDeferred;this.saveDeferred=J();const o=this.keysToSet;if(o.size){const l=Array.from(o.values());o.clear();const p=l.map(_=>this.cache[_]);try{(await this.getStorage()).save(l,p)}catch(_){this.log.error("set error",_,l,p)}}i.resolve(),o.size&&this.saveThrottled()},this._delete=async()=>{const i=this.deleteDeferred;this.deleteDeferred=J();const o=this.keysToDelete;if(o.size){const l=Array.from(o.values());o.clear();try{(await this.getStorage()).delete(l)}catch(p){this.log.error("delete error",p,l)}}i.resolve(),o.size&&this.deleteThrottled()},this._get=async()=>{const i=Array.from(this.getPromises.keys());(await this.getStorage()).get(i).then(l=>{for(let p=0,_=i.length;p<_;++p){const u=i[p],c=this.getPromises.get(u);c&&(c.resolve(this.cache[u]=l[p]),this.getPromises.delete(u))}},l=>{new Set(["NO_ENTRY_FOUND","STORAGE_OFFLINE"]).has(l.type)||(this.useStorage=!1,this.log.error("get error",l,i,this.storeName));for(let _=0,u=i.length;_<u;++_){const c=i[_],h=this.getPromises.get(c);h&&(h.resolve(void 0),this.getPromises.delete(c))}}).finally(()=>{this.getPromises.size&&this.getThrottled()})},this.log=X(`AS-${t.name}-${s}`),this.cache={},this.getPromises=new Map,this.keysToSet=new Set,this.saveDeferred=J(),this.keysToDelete=new Set,this.deleteDeferred=J();const r=t.stores.find(i=>i.name===s);this.isEncryptable=!!r?.encryptedName,this.encryptedStoreName=r?.encryptedName,Ut.STORAGES.length?this.useStorage=Ut.STORAGES[0].useStorage:this.useStorage=!0,this.savingFreezed=!1,Ut.STORAGES.push(this),this.saveThrottled=ke(queueMicrotask,this._save,!1),this.deleteThrottled=ke(queueMicrotask,this._delete,!1),this.getThrottled=ke(queueMicrotask,this._get,!1)}async getStorage(){if(this.storage)return this.storage;const t=this.isEncryptable?await nt.isUsingPasscode():!1,s=this.storage=t?lt.getInstance(this.db,this.encryptedStoreName):new zt(this.db,this.storeName);return s instanceof lt&&s.loadEncrypted(),s}isAvailable(){return this.useStorage}getCache(){return this.cache}getFromCache(t){return this.cache[t]}setToCache(t,s){return this.cache[t]=s}async get(t,s=!0){if(this.cache.hasOwnProperty(t)&&s)return this.getFromCache(t);if(this.useStorage){const r=this.getPromises.get(t);if(r)return r;const i=J();return this.getPromises.set(t,i),this.getThrottled(),i}}async getAll(){return(await this.getStorage()).getAll().catch(()=>[])}async getAllKeys(){return(await this.getStorage()).getAllKeys().catch(()=>[])}async getAllEntries(){return(await this.getStorage()).getAllEntries().catch(()=>[])}warnAboutSaving(){}set(t,s=!1){const r=this.useStorage&&!s&&!this.savingFreezed;this.warnAboutSaving();let i=!1;for(const o in t)if(t.hasOwnProperty(o)){const l=t[o];this.setToCache(o,l),r&&(this.keysToSet.add(o),this.keysToDelete.delete(o),this.saveThrottled()),i=!0}return r&&i?this.saveDeferred:Promise.resolve()}delete(t,s=!1){return this.warnAboutSaving(),t=""+t,s||delete this.cache[t],this.useStorage&&(this.keysToSet.delete(t),this.keysToDelete.add(t),this.deleteThrottled()),this.useStorage?this.deleteDeferred:Promise.resolve()}async clear(t=!1){if(!t)for(const s in this.cache)delete this.cache[s];try{const s=await this.getStorage();await s.clear(),s instanceof lt?await new zt(this.db,this.storeName).clear():this.isEncryptable&&await lt.getInstance(this.db,this.encryptedStoreName).clear()}catch{}}async unfreezeAsync(t){const s=this.savingFreezed;this.savingFreezed=!1;try{await t()}catch(r){console.error("unfreezeAsync callback error:",r)}this.savingFreezed=s}static toggleStorage(t,s){return Promise.all(this.STORAGES.map(r=>{if(r.useStorage=t,!(!jt||!s))if(!t)r.keysToSet.clear(),r.keysToDelete.clear(),r.getPromises.forEach(i=>i.resolve(void 0)),r.getPromises.clear();else return r.set(r.cache)})).catch(un)}static freezeSaving(t,s){this.STORAGES.forEach(r=>r.savingFreezed=!0);try{t()}catch(r){console.error("freezeSaving callback error:",r)}this.STORAGES.forEach(r=>r.savingFreezed=!1)}static async freezeSavingAsync(t){this.STORAGES.forEach(s=>s.savingFreezed=!0);try{await t()}catch(s){console.error("freezeSavingAsync callback error:",s)}this.STORAGES.forEach(s=>s.savingFreezed=!1)}async toggleEncrypted(t){if(!this.isEncryptable)return;const s=this.storage instanceof lt;if(t===s)return;const r=await this.getAllEntries();if(await this.storage.clear(),t){const i=this.storage=lt.getInstance(this.db,this.encryptedStoreName),o=Object.fromEntries(r);await i.loadDecrypted(o)}else{const i=this.storage=new zt(this.db,this.storeName),o=r.map(p=>p[0]),l=r.map(p=>p[1]);await i.save(o,l)}}async reEncrypt(){this.storage instanceof lt&&await this.storage.reEncrypt()}static async toggleEncryptedForAll(t){this.freezeSavingAsync(async()=>{await Promise.all(this.STORAGES.map(s=>s.toggleEncrypted(t)))})}static async reEncryptEncrypted(){this.freezeSavingAsync(async()=>{await Promise.all(this.STORAGES.map(t=>t.reEncrypt()))})}};Ut.STORAGES=[];let le=Ut;it&&(it.AppStorage=le);class fn extends le{constructor(){super(ks(),"session")}}const Re=new fn;Re.get("settings",!1).then(e=>{nt.resolveDeferred(e?.passcode?.enabled||!1)});it.commonStateStorage=Re;const Ct=X("SW-clear-old-cache");async function pn({onStorageError:e}){const t=await Re.get("settings"),s=t?.cacheTTL;if(typeof s!="number"||!s)return;const r=Math.floor(Date.now()/1e3-s);Ct({referenceTimeSeconds:r,cacheTTLSeconds:s});const i=[];let o=0;for(const c of Tr){const h=new V(c);Ct(`iterating ${c}`);let g;const F=[];try{await h.minimalBlockingIterateResponses(async({request:T,cache:U,response:E})=>{const k=parseInt(E.headers.get(Rt.cachedTime))||0;if(k<r)Ct(`deleteing cache from ${c}:`,T.url,{cachedTimeSeconds:k,referenceTimeSeconds:r}),await U.delete(T);else{const I=parseInt(E.headers.get(Rt.contentLength))||0;o+=I,F.push({request:T,response:E,timeSeconds:k,size:I,storageName:c})}}),i.push(...F)}catch(T){g=T}finally{h.forget()}g&&await e({storageName:c,error:g})}const l=t?.cacheSize;if(!l)return;Ct(`Total size before deletion: ${ne(o)}, Max size: ${ne(l)}`),i.sort((c,h)=>c.timeSeconds-h.timeSeconds);const p=new Map([["cachedFiles",[]],["cachedStreamChunks",[]],["cachedHlsStreamChunks",[]],["cachedHlsQualityFiles",[]]]);for(const c of i){const{size:h,storageName:g}=c;if(o<=l)break;o-=h,p.get(g)?.push(c)}const _=Array.from(p.entries()),u=c=>c.map(({request:h,size:g,timeSeconds:F})=>({url:h.url,size:ne(g),time:new Date(F*1e3)}));await Promise.all(_.map(async([c,h])=>{if(!h.length)return;Ct(`Deleting ${h.length} entries from ${c}`,u(h));const g=new V(c);try{await g.timeoutOperation(async F=>{await Promise.all(h.map(({request:T})=>F.delete(T)))})}finally{g.forget()}}))}const Ns=1e3,dn=60*Ns,gn=20*Ns,_n=10*dn;async function mn(e){await Ft(gn);const t=async()=>{await pn(e),setTimeout(t,_n)};t()}const C=X("SW",kt.Error|kt.Debug|kt.Log|kt.Warn,!0),ut=self;let Pt;const Ie=()=>Pt;let oe;const Be=(...e)=>{Yt().then(t=>{t.forEach(s=>{$.invokeVoid(...e,s)})})};C("init");const yn=e=>{const t=new MessageChannel;$.attachPort(Pt=t.port1),$.invokeVoid("port",void 0,e,[t.port2]);const s=new MessageChannel;Tt.attachPort(oe=s.port1),$.invokeVoid("serviceCryptoPort",void 0,e,[s.port2])},wn=e=>{!st.size&&!Pt&&(C("sending message port for mtproto"),yn(e))},Rs=(e,t)=>{const s=C.bindPrefix("windowConnected");if(s("new",e.id,"from",t,"before",st.size),e.frameType==="none"){C.warn("maybe a bugged Safari starting window",e.id);return}if(st.has(e.id)){s("already connected",e.id);return}s("before",Array.from(st)),$.invokeVoid("hello",void 0,e),wn(e),st.set(e.id,e),s("after",Array.from(st)),ni(e)},$=new Gr;$.addMultipleEventsListeners({environment:e=>{Vi(e)},notificationsClear:Es,toggleStorages:({enabled:e,clearWrite:t})=>{V.toggleStorage(e,t)},pushPing:(e,t)=>{Kr(e,t)},hello:(e,t)=>{Rs(t,"hello")},shownNotification:Yr,leaveRtmpCall:Ii,toggleStreamInUse:Er,toggleCacheStorage:e=>{V.temporarilyToggle(e)},resetEncryptableCacheStorages:()=>{V.resetOpenEncryptableCacheStorages()},toggleUsingPasscode:e=>{nt.resolveDeferred(e.isUsingPasscode),ot.save(e.encryptionKey)},saveEncryptionKey:e=>{ot.save(e)},fillPushObject:As,disableCacheStoragesByNames:e=>{V.temporarilyToggleByNames(e,!1)},enableCacheStoragesByNames:e=>{V.temporarilyToggleByNames(e,!0)},resetOpenCacheStoragesByNames:e=>{V.resetOpenStoragesByNames(e)}});const{onDownloadFetch:vn,onClosedWindows:bn}=ti($);async function Sn(){const e=await Yt(),t=e.length;C(`got ${t} windows from the start`),e.forEach(s=>{if(s.frameType==="none"){C.warn("skipping bugged Safari starting window",s.id);return}C("checking window",s.id);try{const r=$.invoke("hello",void 0,void 0,s);let i=!1;const o=setTimeout(()=>i=!0,5e3);r.finally(()=>{i||(clearTimeout(o),Rs(s,"startup check"))})}catch(r){C.error("failed to send hello to window",s.id,r)}})}Sn();const st=new Map;self.connectedWindows=st;Zr($,void 0,e=>{if(C("something has disconnected",e),!(e instanceof WindowClient)||!st.has(e.id)){C.warn("it is not a window");return}st.delete(e.id),C("window disconnected, left",st.size),st.size||(C.warn("no windows left"),nt.isUsingPasscodeUndeferred()&&Vr(),ot.resetDeferred(),nt.resetDeferred(),Pt&&($.detachPort(Pt),Pt=void 0),oe&&(Tt.detachPort(oe),oe=void 0),bn())});mn({onStorageError:async({storageName:e,error:t})=>{C(`Error clearing old cache in ${e}:`,t),C(`Clearing cache storage ${e}`);const s=await Yt();s.length&&await $.invoke("clearCacheStoragesByNames",[e],void 0,s[0])}});const Fn=e=>{if(!gt&&e.request.url.indexOf(location.origin+"/")===0&&e.request.url.match(/\.(js|css|jpe?g|json|wasm|png|mp3|svg|tgs|ico|woff2?|ttf|webmanifest?)(?:\?.*)?$/))return e.respondWith(er(e));try{const[t,s]=e.request.url.split("/").slice(-2),[r,i]=s.split("?");switch(t){case"stream":{Pr(e,r,i);break}case"d":case"download":{vn(e,r);break}case"share":{oi(e,r);break}case"ping":{e.respondWith(new Response("pong"));break}case"rtmp":{Ai(e,r,i);break}case"hls":{on(e,r,i);break}case"hls_quality_file":{Di(e,r,i);break}case"hls_stream":{Hi(e,r,i);break}case"backgrounds":{cn(e);break}}}catch(t){C.error("fetch error",t),e.respondWith(Zt())}},Ls=()=>{ut.onfetch=Fn};ut.addEventListener("install",e=>{C("installing"),e.waitUntil(ut.skipWaiting().then(()=>C("skipped waiting")))});ut.addEventListener("activate",e=>{C("activating",ut),e.waitUntil(ut.caches.delete(gs).then(()=>C("cleared assets cache"))),e.waitUntil(ut.clients.claim().then(()=>C("claimed clients")))});ut.onoffline=ut.ononline=Ls;Ls();
//# sourceMappingURL=sw-5HiyJkz5.js.map
