(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}})();const Ws="modulepreload",Vs=function(t,e){return new URL(t,e).href},At={},R=function(e,s,r){if(!s||s.length===0)return e();const n=document.getElementsByTagName("link");return Promise.all(s.map(o=>{if(o=Vs(o,r),o in At)return;At[o]=!0;const i=o.endsWith(".css"),c=i?'[rel="stylesheet"]':"";if(!!r)for(let h=n.length-1;h>=0;h--){const m=n[h];if(m.href===o&&(!i||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${c}`))return;const u=document.createElement("link");if(u.rel=i?"stylesheet":Ws,i||(u.as="script",u.crossOrigin=""),u.href=o,document.head.appendChild(u),i)return new Promise((h,m)=>{u.addEventListener("load",h),u.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>e())},bt=["web.telegram.org","webk.telegram.org"],co="pattern",Tt=Math.min(4,navigator.hardwareConcurrency??4),I={id:+"1025907",hash:"452b0359b988148995f22ff0f4229750",version:"1.8.0",versionFull:"1.8.0 (326)",build:+"326",langPackVersion:"2.1.9",langPack:"webk",langPackCode:"en",domains:bt,baseDcId:2,isMainDomain:bt.includes(location.hostname),suffix:"K",threads:Tt,cryptoWorkers:Tt};I.isMainDomain&&(I.id=2496,I.hash="8da85b0d5bfe62527e5b244c209159c3");function Lt(){return document.activeElement?.blur?(document.activeElement.blur(),!0):!1}function It(t){if(t||(t=window.event),t){t=t.originalEvent||t;try{t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.returnValue=!1,t.cancelBubble=!0}catch{}}return!1}const Z="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,mt=typeof window<"u"?window:self,ge=navigator?navigator.userAgent:null,ot=navigator.userAgent.search(/OS X|iPhone|iPad|iOS/i)!==-1,Xt=navigator.userAgent.toLowerCase().indexOf("android")!==-1,Gs=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),oe=(/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1)&&!mt.MSStream,Y="safari"in mt||!!(ge&&(/\b(iPad|iPhone|iPod)\b/.test(ge)||ge.match("Safari")&&!ge.match("Chrome"))),ie=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,Jt=Y&&oe,Q=(navigator.maxTouchPoints===void 0||navigator.maxTouchPoints>0)&&navigator.userAgent.search(/iOS|iPhone OS|Android|BlackBerry|BB10|Series ?[64]0|J2ME|MIDP|opera mini|opera mobi|mobi.+Gecko|Windows Phone/i)!=-1,Ys=Object.freeze(Object.defineProperty({__proto__:null,IS_ANDROID:Xt,IS_APPLE:ot,IS_APPLE_MOBILE:oe,IS_CHROMIUM:Gs,IS_FIREFOX:ie,IS_MOBILE:Q,IS_MOBILE_SAFARI:Jt,IS_SAFARI:Y,USER_AGENT:ge},Symbol.toStringTag,{value:"Module"}));function zs(t,e){return t.closest("."+e)}let le;function it(t){le?le.push(t):(le=[t],requestAnimationFrame(()=>{const e=le;le=void 0,e.forEach(s=>s())}))}let se,$e=!1;function uo(t){se?$e?t():se.push(t):(se=[t],requestAnimationFrame(()=>{$e=!0;for(let e=0;e<se.length;++e)se[e]();se=void 0,$e=!1}))}let re;function lo(){return re||(re=new Promise(t=>it(()=>t())),re.then(()=>{re=void 0}),re)}function js(){return new Promise(t=>{it(()=>{it(t)})})}function Mt(t){t.style.transform="translateY(-99999px)",t.focus(),js().then(()=>{t.style.transform=""})}const Le=Y&&Q&&Z;if(Le){const t="clientY";let e=0;const s={capture:!0,passive:!1},r=o=>{const i=o.touches[0],c=zs(i.target,"scrollable-y");if(c){const a=i[t],u=e-a,h=c.scrollTop,m=c.scrollHeight,p=c.clientHeight,g=h?Math.round(h+c.clientHeight+u):h+u;(m===p||g>=m||g<=0)&&o.preventDefault()}else o.preventDefault()};let n=0;document.addEventListener("focusin",o=>{!o.target.classList.contains("is-sticky-input-bugged")||o.timeStamp-n<50||(Mt(o.target),document.addEventListener("touchmove",r,s),document.addEventListener("touchstart",i=>{if(i.touches.length>1)return;e=i.touches[0][t]}))},{passive:!0}),document.addEventListener("focusout",o=>{document.removeEventListener("touchmove",r,s),n=o.timeStamp},{passive:!0}),document.addEventListener("visibilitychange",()=>{document.activeElement&&document.activeElement.classList.contains("is-sticky-input-bugged")&&document.activeElement.blur&&Mt(document.activeElement)},{passive:!0})}function ho(t){Le&&t.classList.add("is-sticky-input-bugged")}function pe(){}function pt(t){return new Promise(e=>{setTimeout(e,t)})}const qe=["b","Ğ±"],Ke={},Hs={text:"Roboto",icons:"tgico",monospace:"Roboto Mono"};function $s(t={text:qe,icons:void 0,monospace:qe}){if(!("fonts"in document))return Promise.resolve();const e=[];for(const s in t){let r=t[s];r==="all"&&(r=qe);const n=Hs[s],o=s==="icons"?[500]:[400,500];for(const i of o){const c=(r||[void 0]).map(a=>{var m,p;const u=[i,"1rem",n].join(" ");return(m=Ke[u]??(Ke[u]={}))[p=a||""]??(m[p]=document.fonts.load(u,a))});e.push(...c)}}return Promise.race([Promise.all(e).catch(pe),pt(1e3)])}const at=navigator.userAgent.search(/OS X|iPhone|iPad|iOS/i)!==-1;function Zt(t){return t instanceof URL||(t=new URL(t+"",location.href)),location.search&&t.protocol!=="blob:"&&new URLSearchParams(location.search).forEach((s,r)=>{t.searchParams.set(r,s)}),t.searchParams.delete("swfix"),t}function qs(){const t={construct(e,s){return s[0]=Zt(s[0]),new e(...s)}};[Worker,typeof SharedWorker<"u"&&SharedWorker].filter(Boolean).forEach(e=>{window[e.name]=new Proxy(e,t)})}qs();function Ks(){Element.prototype.toggleAttribute||(Element.prototype.toggleAttribute=function(t,e){return e!==void 0&&(e=!!e),this.hasAttribute(t)?e?!0:(this.removeAttribute(t),!1):e===!1?!1:(this.setAttribute(t,""),!0)})}const Xs=0,Do=1271266957,go=777,fo=777e3,mo=2147483647,po="",Fo=20*1024*1024,Eo="",vo=[7322096,16766590,13338331,9367192,16749490,16478047],Co="default_static",ct=4294967296,So=ct+1,Js=new Set(["web","k","z","a"]),_o=2147483646,Zs=0,Qs=1,er=new Set([Zs,Qs]);Math.max(...Array.from(er))+1;function tr(t,e){const s=t.findIndex(e);return s!==-1?t.splice(s,1)[0]:void 0}class ee{constructor(e){this._constructor(e)}_constructor(e){this.reuseResults=e,this.listeners={},this.listenerResults={}}addEventListener(e,s,r){var n;if(((n=this.listeners)[e]??(n[e]=[])).push({callback:s,options:r}),this.listenerResults.hasOwnProperty(e)&&(s(...this.listenerResults[e]),r?.once)){this.listeners[e].pop();return}}addMultipleEventsListeners(e){for(const s in e)this.addEventListener(s,e[s])}removeEventListener(e,s,r){this.listeners[e]&&tr(this.listeners[e],n=>n.callback===s)}invokeListenerCallback(e,s,...r){let n,o;try{n=s.callback(...r)}catch(i){o=i}if(s.options?.once&&this.removeEventListener(e,s.callback),o)throw o;return n}_dispatchEvent(e,s,...r){this.reuseResults&&(this.listenerResults[e]=r);const n=s&&[],o=this.listeners[e];return o&&o.slice().forEach(c=>{if(o.findIndex(h=>h.callback===c.callback)===-1)return;const u=this.invokeListenerCallback(e,c,...r);n&&n.push(u)}),n}dispatchResultableEvent(e,...s){return this._dispatchEvent(e,!0,...s)}dispatchEvent(e,...s){this._dispatchEvent(e,!1,...s)}cleanup(){this.listeners={},this.listenerResults={}}}const V={test:location.search.indexOf("test=1")>0,debug:location.search.indexOf("debug=1")>0,http:!1,ssl:!0,multipleConnections:!0,asServiceWorker:!1,transport:"websocket",noSharedWorker:location.search.indexOf("noSharedWorker=1")>0};V.http=location.search.indexOf("http=1")>0;V.http=!0;V.http&&(V.transport="https");const sr=!1,q=V.debug,rr=typeof window<"u"?window:self,y=rr,Qt=Date.now()%Math.random()*1e8|0;function Xe(t,e){const s=t.indexOf(e);return(s===-1?void 0:t.splice(s,1))?.[0]}const ve=typeof ServiceWorkerGlobalScope<"u"&&self instanceof ServiceWorkerGlobalScope,Ue=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&!ve,ae=Ue||ve,nr=()=>self.clients.matchAll({includeUncontrolled:!1,type:"window"}),es=(t,...e)=>{try{t.postMessage(...e)}catch(s){console.error("[worker] postMessage error:",s,e)}},ts=(t,...e)=>{nr().then(s=>{s.length&&s.slice(t?0:-1).forEach(r=>{es(r,...e)})})},ss=(...t)=>{es(self,...t)},rs=()=>{};ve&&ts.bind(null,!1);ve&&ts.bind(null,!0);const Je={};function Ie(t){return Je[t]??(Je[t]={type:t})}const or=Date.now();function Me(){return"["+((Date.now()-or)/1e3).toFixed(3)+"]"}var ns=(t=>(t[t.None=0]="None",t[t.Error=1]="Error",t[t.Warn=2]="Warn",t[t.Log=4]="Log",t[t.Debug=8]="Debug",t))(ns||{});const ir=[0,1,2,4,8],ar=Y||ie,cr=!ar,Rt={reset:"\x1B[0m",bright:"\x1B[1m",dim:"\x1B[2m",underscore:"\x1B[4m",blink:"\x1B[5m",reverse:"\x1B[7m",hidden:"\x1B[8m",fg:{black:"\x1B[30m",red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",blue:"\x1B[34m",magenta:"\x1B[35m",cyan:"\x1B[36m",white:"\x1B[37m"},bg:{black:"\x1B[40m",red:"\x1B[41m",green:"\x1B[42m",yellow:"\x1B[43m",blue:"\x1B[44m",magenta:"\x1B[45m",cyan:"\x1B[46m",white:"\x1B[47m"}},ur=[["debug",8],["info",4],["warn",2],["error",1],["assert",1],["trace",4],["group",4],["groupCollapsed",4],["groupEnd",4]];function z(t,e=7,s=!1,r=""){let n;!q&&!s&&(e=1),cr?r||(ve?r=Rt.fg.yellow:Ue&&(r=Rt.fg.cyan)):r="";const o=r;r?r=`%s ${r}%s`:r="%s";const i=function(...c){return e&4&&console.log(r,Me(),t,...c)};return ur.forEach(([c,a])=>{i[c]=function(...u){return e&a&&console[c](r,Me(),t,...u)}}),i.setPrefix=function(c){n=c,t="["+c+"]"},i.setPrefix(t),i.setLevel=function(c){e=ir.slice(0,c+1).reduce((a,u)=>a|u,0)},i.bindPrefix=function(c){return z(`${n}] [${c}`,e,s,o)},i}const lr=!0;class Ft extends ee{constructor(e){super(!1),this.logSuffix=e,this.onMessage=s=>{const r=s.data,n=s.source||s.currentTarget;this.processTaskMap[r.type](r,n,s)},this.processResultTask=s=>{const{taskId:r,result:n,error:o}=s.payload,i=this.awaiting[r];i&&(this.debug&&this.log.debug("done",i.taskType,n,o),"error"in s.payload?i.reject(o):i.resolve(n),delete this.awaiting[r])},this.processAckTask=s=>{const r=s.payload,n=this.awaiting[r.taskId];if(!n)return;const o=n.resolve,i={cached:r.cached,result:r.cached?"result"in r?Promise.resolve(r.result):Promise.reject(r.error):new Promise((c,a)=>{n.resolve=c,n.reject=a})};o(i),r.cached&&delete this.awaiting[r.taskId]},this.processPingTask=(s,r,n)=>{this.pushTask(this.createTask("pong",void 0),n.source)},this.processPongTask=(s,r,n)=>{const o=this.pingResolves.get(r);o&&(this.pingResolves.delete(r),o())},this.processCloseTask=(s,r,n)=>{this.detachPort(r)},this.processLockTask=(s,r,n)=>{const o=s.payload;this.requestedLocks.has(o)||(this.requestedLocks.set(o,r),navigator.locks.request(o,()=>{this.processCloseTask(void 0,r,void 0),this.requestedLocks.delete(o)}))},this.processInvokeTask=async(s,r,n)=>{const o=s.id,i=s.payload;let c,a,u;i.void||(c={taskId:o},a=this.createTask("result",c)),i.withAck&&(u=this.createTask("ack",{taskId:o,cached:!0}));let h;try{const m=this.listeners[i.type];if(!m?.length)throw new Error("no listener");const p=m[0];let g=this.invokeListenerCallback(i.type,p,i.payload,r,n);if(i.void)return;if(h=g instanceof Promise,u){const d=!h;if(u.payload.cached=d,d&&(u.payload.result=g),this.pushTask(u,r),d)return}h&&(g=await g),c.result=g}catch(m){if(this.log.error("worker task error:",m,s),i.void)return;if(u&&u.payload.cached){u.payload.error=m,this.pushTask(u,r);return}c.error=m}this.pushTask(a,r)},this.listenPorts=[],this.sendPorts=[],this.pingResolves=new Map,this.taskId=0,this.awaiting={},this.pending=new Map,this.log=z("MP"+(e?"-"+e:"")),this.debug=q,this.heldLocks=new Map,this.requestedLocks=new Map,this.processTaskMap={result:this.processResultTask,ack:this.processAckTask,invoke:this.processInvokeTask,ping:this.processPingTask,pong:this.processPongTask,close:this.processCloseTask,lock:this.processLockTask}}setOnPortDisconnect(e){this.onPortDisconnect=e}attachPort(e){this.attachListenPort(e),this.attachSendPort(e)}attachListenPort(e){this.listenPorts.push(e),e.addEventListener("message",this.onMessage)}attachSendPort(e){if(this.log.warn("attaching send port"),e.start?.(),this.sendPorts.push(e),typeof window<"u"&&lr)if("locks"in navigator){const s=["lock",Qt,this.logSuffix||"",Math.random()*2147483647|0].join("-");this.log.warn("created lock",s);const r=new Promise(n=>this.heldLocks.set(e,{resolve:n,id:s})).then(()=>this.heldLocks.delete(e));navigator.locks.request(s,()=>(this.resendLockTask(e),r))}else window.addEventListener("beforeunload",()=>{const s=this.createTask("close",void 0);this.postMessage(void 0,s)});this.releasePending()}resendLockTask(e){const s=this.heldLocks.get(e);s&&this.pushTask(this.createTask("lock",s.id),e)}detachPort(e){this.log.warn("disconnecting port"),Xe(this.listenPorts,e),Xe(this.sendPorts,e),e.removeEventListener?.("message",this.onMessage),e.close?.(),this.onPortDisconnect?.(e),this.heldLocks.get(e)?.resolve();const r=Ie("PORT_DISCONNECTED");for(const n in this.awaiting){const o=this.awaiting[n];o.port===e&&(o.reject(r),delete this.awaiting[n])}}postMessage(e,s){(Array.isArray(e)?e:e?[e]:this.sendPorts).forEach(n=>{n.postMessage(s,s.transfer)})}releasePending(){this.releasingPending||(this.releasingPending=!0,this.debug&&this.log.debug("releasing tasks, length:",this.pending.size),this.pending.forEach((e,s)=>{const r=e,n=s?[s]:this.sendPorts;n.length&&(r.forEach(o=>{try{this.postMessage(n,o)}catch(i){this.log.error("postMessage error:",i,o,n)}}),this.pending.delete(s))}),this.debug&&this.log.debug("released tasks"),this.releasingPending=!1)}createTask(e,s,r){return{type:e,payload:s,id:this.taskId++,transfer:r}}createInvokeTask(e,s,r,n,o){return this.createTask("invoke",{type:e,payload:s,withAck:r,void:n},o)}pushTask(e,s){let r=this.pending.get(s);r||this.pending.set(s,r=[]),r.push(e),this.releasePending()}invokeVoid(e,s,r,n){const o=this.createInvokeTask(e,s,void 0,!0,n);this.pushTask(o,r)}invoke(e,s,r,n,o){this.debug&&this.log.debug("start",e,s);let i;const c=new Promise((a,u)=>{i=this.createInvokeTask(e,s,r,void 0,o),this.awaiting[i.id]={resolve:a,reject:u,taskType:e,port:n},this.pushTask(i,n)});if(ae){c.finally(()=>{clearInterval(a)});const a=mt.setInterval(()=>{this.log.error("task still has no result",i,n)},6e4)}return c}invokeExceptSource(e,s,r){const n=this.sendPorts.slice();Xe(n,r),n.forEach(o=>{this.invokeVoid(e,s,o)})}}class Ce extends Ft{constructor(){super("MTPROTO"),Ce.INSTANCE=this,y&&(y.mtprotoMessagePort=this)}static getInstance(){return this.INSTANCE}}class hr extends ee{constructor(){super(),this.myId=Xs,this.connectionStatus={},this.premium=!1,this.addEventListener("user_auth",({id:e})=>{this.myId=e.toPeerId()}),this.addEventListener("premium_toggle_private",({isNew:e,isPremium:s})=>{this.premium=s,this.dispatchEventSingle("premium_toggle",s)}),this.addEventListener("connection_status_change",e=>{this.connectionStatus[e.name]=e}),this.dispatchEvent=(e,...s)=>{super.dispatchEvent(e,...s),Ce.getInstance().invokeVoid("event",{name:e,args:s})},ae||this.addEventListener("settings_updated",({settings:e})=>{this.settings=e})}getConnectionStatus(){return this.connectionStatus}getPremium(){return this.premium}dispatchEventSingle(...e){super.dispatchEvent(...e)}}const C=new hr;y.rootScope=C;function H(){const t={isFulfilled:!1,isRejected:!1,notify:()=>{},notifyAll:(...s)=>{t.lastNotify=s,t.listeners.forEach(r=>r(...s))},listeners:[],addNotifyListener:s=>{t.lastNotify&&s(...t.lastNotify),t.listeners.push(s)}},e=new Promise((s,r)=>{t.resolve=n=>{e.isFulfilled||e.isRejected||(e.isFulfilled=!0,s(n))},t.reject=(...n)=>{e.isRejected||e.isFulfilled||(e.isRejected=!0,r(...n))}});return e.catch(pe).finally(()=>{e.notify=e.notifyAll=e.lastNotify=null,e.listeners.length=0,e.cancel&&(e.cancel=pe)}),Object.assign(e,t),e}function Ze(t,e,s=!0){let r=null,n,o;return(...i)=>{n=!0,o=i,r||(s&&(n=!1,t(...o)),r=setInterval(()=>{if(!n){clearInterval(r),r=null;return}n=!1,t(...o)},e))}}function ut(t,e){if(e)for(const s in e)e[s]!==void 0&&(t[s]=e[s]);return t}const lt=class{constructor(t){ut(this,t),V.test&&(this.name+="_test"),this.storageIsAvailable=!0,this.log=z(["IDB",t.name].join("-")),this.log("constructor"),this.openDatabase(!0),lt.INSTANCES.push(this)}isAvailable(){return this.storageIsAvailable}openDatabase(t=!1){if(this.openDbPromise&&!t)return this.openDbPromise;const e=(o,i)=>{const c=Array.from(o.indexNames);for(const a of c)o.deleteIndex(a);if(i.indexes?.length)for(const a of i.indexes)o.indexNames.contains(a.indexName)||o.createIndex(a.indexName,a.keyPath,a.objectParameters)},s=(o,i)=>{const c=o.createObjectStore(i.name);e(c,i)};try{var r=indexedDB.open(this.name,this.version);if(!r)return Promise.reject()}catch(o){return this.log.error("error opening db",o.message),this.storageIsAvailable=!1,Promise.reject(o)}let n=!1;return setTimeout(()=>{n||r.onerror(Ie("IDB_CREATE_TIMEOUT"))},3e3),this.openDbPromise=new Promise((o,i)=>{r.onsuccess=c=>{n=!0;const a=r.result;let u=!1;this.log("Opened"),a.onerror=h=>{this.storageIsAvailable=!1,this.log.error("Error creating/accessing IndexedDB database",h),i(h)},a.onclose=h=>{this.log.error("closed:",h),!u&&this.openDatabase()},a.onabort=h=>{this.log.error("abort:",h);const m=h.target;this.openDatabase(u=!0),m.onerror&&m.onerror(h),a.close()},a.onversionchange=h=>{this.log.error("onversionchange, lol?")},o(this.db=a)},r.onerror=c=>{n=!0,this.storageIsAvailable=!1,this.log.error("Error creating/accessing IndexedDB database",c),i(c)},r.onupgradeneeded=c=>{n=!0,this.log.warn("performing idb upgrade from",c.oldVersion,"to",c.newVersion);const a=c.target,u=a.result;this.stores.forEach(h=>{if(!u.objectStoreNames.contains(h.name))s(u,h);else{const p=a.transaction.objectStore(h.name);e(p,h)}})}})}static create(t){return this.INSTANCES.find(e=>e.name===t.name)??new lt(t)}static closeDatabases(t){this.INSTANCES.forEach(e=>{if(t&&t===e)return;const s=e.db;s&&(s.onclose=()=>{},s.close())})}};let os=lt;os.INSTANCES=[];class dr{constructor(e,s){this.storeName=s,this.log=z(["IDB",e.name,s].join("-")),this.idb=os.create(e)}delete(e,s){const r=Array.isArray(e);return r||(e=[].concat(e)),this.getObjectStore("readwrite",n=>{const o=e.map(i=>n.delete(i));return r?o:o[0]},"",s)}clear(e){return this.getObjectStore("readwrite",s=>s.clear(),"",e)}save(e,s,r){const n=Array.isArray(e);return n||(e=[].concat(e),s=[].concat(s)),this.getObjectStore("readwrite",o=>{const i=e.map((c,a)=>o.put(s[a],c));return n?i:i[0]},"",r)}get(e,s){const r=Array.isArray(e);if(r){if(!e.length)return Promise.resolve([])}else{if(!e)return;e=[].concat(e)}return this.getObjectStore("readonly",n=>{const o=e.map(i=>n.get(i));return r?o:o[0]},"",s)}getObjectStore(e,s,r,n=this.storeName){let o;return r&&(o=performance.now(),this.log(r+": start")),this.idb.openDatabase().then(i=>new Promise((c,a)=>{const u=i.transaction([n],e),h=()=>{clearTimeout(g),a(u.error)},m=()=>{clearTimeout(g),r&&this.log(r+": end",performance.now()-o);const P=S.map(w=>w.result);c(F?P:P[0])};u.onerror=h;const p=e==="readwrite";p&&(u.oncomplete=()=>m());const g=setTimeout(()=>{this.log.error("transaction not finished",u,r)},1e4),d=s(u.objectStore(n)),F=Array.isArray(d),S=F?d:[].concat(d);if(p)return;const A=S.length;let T=A;const E=()=>{u.error||--T||m()};for(let P=0;P<A;++P){const w=S[P];w.onerror=h,w.onsuccess=E}}))}getAll(e){return this.getObjectStore("readonly",s=>s.getAll(),"",e)}}function Ot(){}const Qe=16,Pe=class{constructor(t,e){this.db=t,this.storeName=e,this.cache={},this.getPromises=new Map,this.keysToSet=new Set,this.saveDeferred=H(),this.keysToDelete=new Set,this.deleteDeferred=H(),this.storage=new dr(t,e),Pe.STORAGES.length?this.useStorage=Pe.STORAGES[0].useStorage:this.useStorage=!0,this.savingFreezed=!1,Pe.STORAGES.push(this),this.saveThrottled=Ze(async()=>{const s=this.saveDeferred;this.saveDeferred=H();const r=this.keysToSet;if(r.size){const n=Array.from(r.values());r.clear();const o=n.map(i=>this.cache[i]);try{await this.storage.save(n,o)}catch(i){console.error("[AS]: set error:",i,n,o)}}s.resolve(),r.size&&this.saveThrottled()},Qe,!1),this.deleteThrottled=Ze(async()=>{const s=this.deleteDeferred;this.deleteDeferred=H();const r=this.keysToDelete;if(r.size){const n=Array.from(r.values());r.clear();try{await this.storage.delete(n)}catch(o){console.error("[AS]: delete error:",o,n)}}s.resolve(),r.size&&this.deleteThrottled()},Qe,!1),this.getThrottled=Ze(async()=>{const s=Array.from(this.getPromises.keys());this.storage.get(s).then(r=>{for(let n=0,o=s.length;n<o;++n){const i=s[n],c=this.getPromises.get(i);c&&(c.resolve(this.cache[i]=r[n]),this.getPromises.delete(i))}},r=>{new Set(["NO_ENTRY_FOUND","STORAGE_OFFLINE"]).has(r.type)||(this.useStorage=!1,console.error("[AS]: get error:",r,s,e));for(let o=0,i=s.length;o<i;++o){const c=s[o],a=this.getPromises.get(c);a&&(a.resolve(void 0),this.getPromises.delete(c))}}).finally(()=>{this.getPromises.size&&this.getThrottled()})},Qe,!1)}isAvailable(){return this.useStorage}getCache(){return this.cache}getFromCache(t){return this.cache[t]}setToCache(t,e){return this.cache[t]=e}async get(t,e=!0){if(this.cache.hasOwnProperty(t)&&e)return this.getFromCache(t);if(this.useStorage){const s=this.getPromises.get(t);if(s)return s;const r=H();return this.getPromises.set(t,r),this.getThrottled(),r}}getAll(){return this.storage.getAll().catch(()=>[])}set(t,e=!1){const s=this.useStorage&&!e&&!this.savingFreezed;for(const r in t)if(t.hasOwnProperty(r)){const n=t[r];this.setToCache(r,n),s&&(this.keysToSet.add(r),this.keysToDelete.delete(r),this.saveThrottled())}return s?this.saveDeferred:Promise.resolve()}delete(t,e=!1){return t=""+t,e||delete this.cache[t],this.useStorage&&(this.keysToSet.delete(t),this.keysToDelete.add(t),this.deleteThrottled()),this.useStorage?this.deleteDeferred:Promise.resolve()}clear(t=!1){if(!t)for(const e in this.cache)delete this.cache[e];return this.storage.clear().catch(Ot)}static toggleStorage(t,e){return Promise.all(this.STORAGES.map(s=>{if(s.useStorage=t,!(!ae||!e))return t?s.set(s.cache):(s.keysToSet.clear(),s.keysToDelete.clear(),s.getPromises.forEach(r=>r.resolve(void 0)),s.getPromises.clear(),s.clear(!0))})).catch(Ot)}static freezeSaving(t,e){this.STORAGES.forEach(s=>s.savingFreezed=!0);try{t()}catch(s){console.error("freezeSaving callback error:",s)}this.STORAGES.forEach(s=>s.savingFreezed=!1)}};let We=Pe;We.STORAGES=[];y&&(y.AppStorage=We);const Dr={name:"tweb",version:7,stores:[{name:"session"},{name:"stickerSets"},{name:"users"},{name:"chats"},{name:"dialogs"},{name:"messages"}]};class gr extends We{constructor(){super(Dr,"session")}}const ne=new gr;y.stateStorage=ne;function is(t,e){const s=Object.keys,r=typeof t;return t&&e&&r==="object"&&r===typeof e?s(t).length===s(e).length&&s(t).every(o=>is(t[o],e[o])):t===e}function Ve(t){return t.charAt(0).toUpperCase()+t.slice(1)}const fr="((?:ğŸ‘¨ğŸ»â€â¤ï¸?â€ğŸ’‹â€ğŸ‘¨\uD83C[\uDFFB-\uDFFF]|ğŸ‘¨ğŸ¼â€â¤ï¸?â€ğŸ’‹â€ğŸ‘¨\uD83C[\uDFFB-\uDFFF]|ğŸ‘¨ğŸ½â€â¤ï¸?â€ğŸ’‹â€ğŸ‘¨\uD83C[\uDFFB-\uDFFF]|ğŸ‘¨ğŸ¾â€â¤ï¸?â€ğŸ’‹â€ğŸ‘¨\uD83C[\uDFFB-\uDFFF]|ğŸ‘¨ğŸ¿â€â¤ï¸?â€ğŸ’‹â€ğŸ‘¨\uD83C[\uDFFB-\uDFFF]|ğŸ‘©ğŸ»â€â¤ï¸?â€ğŸ’‹â€ğŸ‘¨\uD83C[\uDFFB-\uDFFF]|ğŸ‘©ğŸ»â€â¤ï¸?â€ğŸ’‹â€ğŸ‘©\uD83C[\uDFFB-\uDFFF]|ğŸ‘©ğŸ¼â€â¤ï¸?â€ğŸ’‹â€ğŸ‘¨\uD83C[\uDFFB-\uDFFF]|ğŸ‘©ğŸ¼â€â¤ï¸?â€ğŸ’‹â€ğŸ‘©\uD83C[\uDFFB-\uDFFF]|ğŸ‘©ğŸ½â€â¤ï¸?â€ğŸ’‹â€ğŸ‘¨\uD83C[\uDFFB-\uDFFF]|ğŸ‘©ğŸ½â€â¤ï¸?â€ğŸ’‹â€ğŸ‘©\uD83C[\uDFFB-\uDFFF]|ğŸ‘©ğŸ¾â€â¤ï¸?â€ğŸ’‹â€ğŸ‘¨\uD83C[\uDFFB-\uDFFF]|ğŸ‘©ğŸ¾â€â¤ï¸?â€ğŸ’‹â€ğŸ‘©\uD83C[\uDFFB-\uDFFF]|ğŸ‘©ğŸ¿â€â¤ï¸?â€ğŸ’‹â€ğŸ‘¨\uD83C[\uDFFB-\uDFFF]|ğŸ‘©ğŸ¿â€â¤ï¸?â€ğŸ’‹â€ğŸ‘©\uD83C[\uDFFB-\uDFFF]|ğŸ§‘ğŸ»â€â¤ï¸?â€ğŸ’‹â€ğŸ§‘\uD83C[\uDFFC-\uDFFF]|ğŸ§‘ğŸ¼â€â¤ï¸?â€ğŸ’‹â€ğŸ§‘\uD83C[\uDFFB\uDFFD-\uDFFF]|ğŸ§‘ğŸ½â€â¤ï¸?â€ğŸ’‹â€ğŸ§‘\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|ğŸ§‘ğŸ¾â€â¤ï¸?â€ğŸ’‹â€ğŸ§‘\uD83C[\uDFFB-\uDFFD\uDFFF]|ğŸ§‘ğŸ¿â€â¤ï¸?â€ğŸ’‹â€ğŸ§‘\uD83C[\uDFFB-\uDFFE]|ğŸ‘¨ğŸ»â€â¤ï¸?â€ğŸ‘¨\uD83C[\uDFFB-\uDFFF]|ğŸ‘¨ğŸ»â€ğŸ¤â€ğŸ‘¨\uD83C[\uDFFC-\uDFFF]|ğŸ‘¨ğŸ¼â€â¤ï¸?â€ğŸ‘¨\uD83C[\uDFFB-\uDFFF]|ğŸ‘¨ğŸ¼â€ğŸ¤â€ğŸ‘¨\uD83C[\uDFFB\uDFFD-\uDFFF]|ğŸ‘¨ğŸ½â€â¤ï¸?â€ğŸ‘¨\uD83C[\uDFFB-\uDFFF]|ğŸ‘¨ğŸ½â€ğŸ¤â€ğŸ‘¨\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|ğŸ‘¨ğŸ¾â€â¤ï¸?â€ğŸ‘¨\uD83C[\uDFFB-\uDFFF]|ğŸ‘¨ğŸ¾â€ğŸ¤â€ğŸ‘¨\uD83C[\uDFFB-\uDFFD\uDFFF]|ğŸ‘¨ğŸ¿â€â¤ï¸?â€ğŸ‘¨\uD83C[\uDFFB-\uDFFF]|ğŸ‘¨ğŸ¿â€ğŸ¤â€ğŸ‘¨\uD83C[\uDFFB-\uDFFE]|ğŸ‘©ğŸ»â€â¤ï¸?â€ğŸ‘¨\uD83C[\uDFFB-\uDFFF]|ğŸ‘©ğŸ»â€â¤ï¸?â€ğŸ‘©\uD83C[\uDFFB-\uDFFF]|ğŸ‘©ğŸ»â€ğŸ¤â€ğŸ‘¨\uD83C[\uDFFC-\uDFFF]|ğŸ‘©ğŸ»â€ğŸ¤â€ğŸ‘©\uD83C[\uDFFC-\uDFFF]|ğŸ‘©ğŸ¼â€â¤ï¸?â€ğŸ‘¨\uD83C[\uDFFB-\uDFFF]|ğŸ‘©ğŸ¼â€â¤ï¸?â€ğŸ‘©\uD83C[\uDFFB-\uDFFF]|ğŸ‘©ğŸ¼â€ğŸ¤â€ğŸ‘¨\uD83C[\uDFFB\uDFFD-\uDFFF]|ğŸ‘©ğŸ¼â€ğŸ¤â€ğŸ‘©\uD83C[\uDFFB\uDFFD-\uDFFF]|ğŸ‘©ğŸ½â€â¤ï¸?â€ğŸ‘¨\uD83C[\uDFFB-\uDFFF]|ğŸ‘©ğŸ½â€â¤ï¸?â€ğŸ‘©\uD83C[\uDFFB-\uDFFF]|ğŸ‘©ğŸ½â€ğŸ¤â€ğŸ‘¨\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|ğŸ‘©ğŸ½â€ğŸ¤â€ğŸ‘©\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|ğŸ‘©ğŸ¾â€â¤ï¸?â€ğŸ‘¨\uD83C[\uDFFB-\uDFFF]|ğŸ‘©ğŸ¾â€â¤ï¸?â€ğŸ‘©\uD83C[\uDFFB-\uDFFF]|ğŸ‘©ğŸ¾â€ğŸ¤â€ğŸ‘¨\uD83C[\uDFFB-\uDFFD\uDFFF]|ğŸ‘©ğŸ¾â€ğŸ¤â€ğŸ‘©\uD83C[\uDFFB-\uDFFD\uDFFF]|ğŸ‘©ğŸ¿â€â¤ï¸?â€ğŸ‘¨\uD83C[\uDFFB-\uDFFF]|ğŸ‘©ğŸ¿â€â¤ï¸?â€ğŸ‘©\uD83C[\uDFFB-\uDFFF]|ğŸ‘©ğŸ¿â€ğŸ¤â€ğŸ‘¨\uD83C[\uDFFB-\uDFFE]|ğŸ‘©ğŸ¿â€ğŸ¤â€ğŸ‘©\uD83C[\uDFFB-\uDFFE]|ğŸ§‘ğŸ»â€â¤ï¸?â€ğŸ§‘\uD83C[\uDFFC-\uDFFF]|ğŸ§‘ğŸ»â€ğŸ¤â€ğŸ§‘\uD83C[\uDFFB-\uDFFF]|ğŸ§‘ğŸ¼â€â¤ï¸?â€ğŸ§‘\uD83C[\uDFFB\uDFFD-\uDFFF]|ğŸ§‘ğŸ¼â€ğŸ¤â€ğŸ§‘\uD83C[\uDFFB-\uDFFF]|ğŸ§‘ğŸ½â€â¤ï¸?â€ğŸ§‘\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|ğŸ§‘ğŸ½â€ğŸ¤â€ğŸ§‘\uD83C[\uDFFB-\uDFFF]|ğŸ§‘ğŸ¾â€â¤ï¸?â€ğŸ§‘\uD83C[\uDFFB-\uDFFD\uDFFF]|ğŸ§‘ğŸ¾â€ğŸ¤â€ğŸ§‘\uD83C[\uDFFB-\uDFFF]|ğŸ§‘ğŸ¿â€â¤ï¸?â€ğŸ§‘\uD83C[\uDFFB-\uDFFE]|ğŸ§‘ğŸ¿â€ğŸ¤â€ğŸ§‘\uD83C[\uDFFB-\uDFFF]|ğŸ‘¨â€â¤ï¸?â€ğŸ’‹â€ğŸ‘¨|ğŸ‘©â€â¤ï¸?â€ğŸ’‹â€\uD83D[\uDC68\uDC69]|ğŸ«±ğŸ»â€ğŸ«²\uD83C[\uDFFC-\uDFFF]|ğŸ«±ğŸ¼â€ğŸ«²\uD83C[\uDFFB\uDFFD-\uDFFF]|ğŸ«±ğŸ½â€ğŸ«²\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|ğŸ«±ğŸ¾â€ğŸ«²\uD83C[\uDFFB-\uDFFD\uDFFF]|ğŸ«±ğŸ¿â€ğŸ«²\uD83C[\uDFFB-\uDFFE]|ğŸ‘¨â€â¤ï¸?â€ğŸ‘¨|ğŸ‘©â€â¤ï¸?â€\uD83D[\uDC68\uDC69]|ğŸ§‘â€ğŸ¤â€ğŸ§‘|ğŸ‘«\uD83C[\uDFFB-\uDFFF]|ğŸ‘¬\uD83C[\uDFFB-\uDFFF]|ğŸ‘­\uD83C[\uDFFB-\uDFFF]|ğŸ’\uD83C[\uDFFB-\uDFFF]|ğŸ’‘\uD83C[\uDFFB-\uDFFF]|ğŸ¤\uD83C[\uDFFB-\uDFFF]|\uD83D[\uDC6B-\uDC6D\uDC8F\uDC91]|ğŸ¤)|(?:\uD83D[\uDC68\uDC69]|ğŸ§‘)(?:\uD83C[\uDFFB-\uDFFF])?â€(?:âš•ï¸?|âš–ï¸?|âœˆï¸?|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|(?:\uD83C[\uDFCB\uDFCC]|\uD83D[\uDD74\uDD75]|â›¹)(?:(?:\uD83C[\uDFFB-\uDFFF]|ï¸?)â€[â™€â™‚]ï¸?)|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD4\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])?â€[â™€â™‚]ï¸?|(?:ğŸ‘¨â€ğŸ‘¨â€ğŸ‘¦â€ğŸ‘¦|ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§â€\uD83D[\uDC66\uDC67]|ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦|ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€\uD83D[\uDC66\uDC67]|ğŸ‘©â€ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦|ğŸ‘©â€ğŸ‘©â€ğŸ‘§â€\uD83D[\uDC66\uDC67]|ğŸ‘¨â€ğŸ‘¦â€ğŸ‘¦|ğŸ‘¨â€ğŸ‘§â€\uD83D[\uDC66\uDC67]|ğŸ‘¨â€ğŸ‘¨â€\uD83D[\uDC66\uDC67]|ğŸ‘¨â€ğŸ‘©â€\uD83D[\uDC66\uDC67]|ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦|ğŸ‘©â€ğŸ‘§â€\uD83D[\uDC66\uDC67]|ğŸ‘©â€ğŸ‘©â€\uD83D[\uDC66\uDC67]|ğŸ³ï¸?â€âš§ï¸?|ğŸ³ï¸?â€ğŸŒˆ|ğŸ˜¶â€ğŸŒ«ï¸?|â¤ï¸?â€ğŸ”¥|â¤ï¸?â€ğŸ©¹|ğŸ´â€â˜ ï¸?|ğŸ•â€ğŸ¦º|ğŸ»â€â„ï¸?|ğŸ‘â€ğŸ—¨|ğŸ‘¨â€\uD83D[\uDC66\uDC67]|ğŸ‘©â€\uD83D[\uDC66\uDC67]|ğŸ‘¯â€â™€ï¸?|ğŸ‘¯â€â™‚ï¸?|ğŸ˜®â€ğŸ’¨|ğŸ˜µâ€ğŸ’«|ğŸ¤¼â€â™€ï¸?|ğŸ¤¼â€â™‚ï¸?|ğŸ§â€â™€ï¸?|ğŸ§â€â™‚ï¸?|ğŸ§Ÿâ€â™€ï¸?|ğŸ§Ÿâ€â™‚ï¸?|ğŸˆâ€â¬›)|[#*0-9]ï¸??âƒ£|(?:[Â©Â®â„¢â™Ÿ]ï¸?)|(?:\uD83C[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE1A\uDE2F\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF3\uDFF5\uDFF7]|\uD83D[\uDC3F\uDC41\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3]|[â€¼â‰â„¹â†”-â†™â†©â†ªâŒšâŒ›âŒ¨ââ­-â¯â±â²â¸-âºâ“‚â–ªâ–«â–¶â—€â—»-â—¾â˜€-â˜„â˜â˜‘â˜”â˜•â˜˜â˜ â˜¢â˜£â˜¦â˜ªâ˜®â˜¯â˜¸-â˜ºâ™€â™‚â™ˆ-â™“â™ â™£â™¥â™¦â™¨â™»â™¿âš’-âš—âš™âš›âšœâš âš¡âš§âšªâš«âš°âš±âš½âš¾â›„â›…â›ˆâ›â›‘â›“â›”â›©â›ªâ›°-â›µâ›¸â›ºâ›½âœ‚âœˆâœ‰âœâœ’âœ”âœ–âœâœ¡âœ³âœ´â„â‡â—â£â¤â¡â¤´â¤µâ¬…-â¬‡â¬›â¬œâ­â­•ã€°ã€½ãŠ—ãŠ™])(?:ï¸?|(?!ï¸))|(?:(?:\uD83C[\uDFCB\uDFCC]|\uD83D[\uDD74\uDD75\uDD90]|[â˜â›·â›¹âœŒâœ])(?:ï¸?|(?!ï¸))|(?:\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC69\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDCAA\uDD7A\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD0C\uDD0F\uDD18-\uDD1C\uDD1E\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDD77\uDDB5\uDDB6\uDDB8\uDDB9\uDDBB\uDDCD-\uDDCF\uDDD1-\uDDDD\uDEC3-\uDEC5\uDEF0-\uDEF6]|[âœŠâœ‹]))(?:\uD83C[\uDFFB-\uDFFF])?|(?:ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿|ğŸ´ó §ó ¢ó ³ó £ó ´ó ¿|ğŸ´ó §ó ¢ó ·ó ¬ó ³ó ¿|ğŸ‡¦\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF]|ğŸ‡§\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF]|ğŸ‡¨\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF]|ğŸ‡©\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF]|ğŸ‡ª\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA]|ğŸ‡«\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7]|ğŸ‡¬\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE]|ğŸ‡­\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA]|ğŸ‡®\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9]|ğŸ‡¯\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5]|ğŸ‡°\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF]|ğŸ‡±\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE]|ğŸ‡²\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF]|ğŸ‡³\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF]|ğŸ‡´ğŸ‡²|ğŸ‡µ\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE]|ğŸ‡¶ğŸ‡¦|ğŸ‡·\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC]|ğŸ‡¸\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF]|ğŸ‡¹\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF]|ğŸ‡º\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF]|ğŸ‡»\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA]|ğŸ‡¼\uD83C[\uDDEB\uDDF8]|ğŸ‡½ğŸ‡°|ğŸ‡¾\uD83C[\uDDEA\uDDF9]|ğŸ‡¿\uD83C[\uDDE6\uDDF2\uDDFC]|\uD83C[\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC6F\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED7\uDEDD-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDD0D\uDD0E\uDD10-\uDD17\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3C\uDD3F-\uDD45\uDD47-\uDD76\uDD78-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCC\uDDD0\uDDDE-\uDDFF\uDE70-\uDE74\uDE78-\uDE7C\uDE80-\uDE86\uDE90-\uDEAC\uDEB0-\uDEBA\uDEC0-\uDEC2\uDED0-\uDED9\uDEE0-\uDEE7]|[â©-â¬â°â³â™¾â›âœ…âœ¨âŒââ“-â•â•-â—â°â¿î”Š])|ï¸)",me="a-z\\u00c0-\\u00d6\\u00d8-\\u00f6\\u00f8-\\u00ff\\u0100-\\u024f\\u0253\\u0254\\u0256\\u0257\\u0259\\u025b\\u0263\\u0268\\u026f\\u0272\\u0289\\u028b\\u02bb\\u0300-\\u036f\\u1e00-\\u1eff\\u0400-\\u04ff\\u0500-\\u0527\\u2de0-\\u2dff\\ua640-\\ua69f\\u0591-\\u05bf\\u05c1-\\u05c2\\u05c4-\\u05c5\\u05c7\\u05d0-\\u05ea\\u05f0-\\u05f4\\ufb1d-\\ufb28\\ufb2a-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40-\\ufb41\\ufb43-\\ufb44\\ufb46-\\ufb4f\\u0610-\\u061a\\u0620-\\u065f\\u066e-\\u06d3\\u06d5-\\u06dc\\u06de-\\u06e8\\u06ea-\\u06ef\\u06fa-\\u06fc\\u06ff\\u0750-\\u077f\\u08a0\\u08a2-\\u08ac\\u08e4-\\u08fe\\ufb50-\\ufbb1\\ufbd3-\\ufd3d\\ufd50-\\ufd8f\\ufd92-\\ufdc7\\ufdf0-\\ufdfb\\ufe70-\\ufe74\\ufe76-\\ufefc\\u200c\\u0e01-\\u0e3a\\u0e40-\\u0e4e\\u1100-\\u11ff\\u3130-\\u3185\\uA960-\\uA97F\\uAC00-\\uD7AF\\uD7B0-\\uD7FF\\u3003\\u3005\\u303b\\uff21-\\uff3a\\uff41-\\uff5a\\uff66-\\uff9f\\uffa1-\\uffdc",mr="0-9_"+me,Bt="Â·",Se="["+me+"0-9]",pr="((?:https?|ftp)://|mailto:)?",Fr=pr+"(?:"+Se+"{1,64}(?::"+Se+"{0,64})?@)?(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])(?:\\.(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])){3}|"+Se+"["+me+Bt+"0-9-]{0,64}(?:\\."+Se+"["+me+Bt+"0-9-]{0,64}){0,10}(?:\\.(xn--[0-9a-z]{2,16}|["+me+`]{2,24})))(?::\\d{2,5})?(?:/(?:\\S{0,255}[^\\s.;,(\\[\\]{}<>"'])?)?`,Er=/^((?:[^\/]+?):\/\/|mailto:)/,as="[a-zA-Z\\d_]{5,32}",vr="(?:\\s|^)((?:\\d{1,2}:)?(?:[0-5]?[0-9]):(?:[0-5][0-9]))(?:\\s|$)",Cr="\\/([a-zA-Z\\d_]{1,32})(?:@("+as+"))?(\\b|$)",yo=new RegExp("(^| )(@)("+as+")|("+Fr+")|(\\n)|("+fr+")|(^|[\\s\\(\\]])(#["+mr+"]{2,64})|(^|\\s)"+Cr+"|"+vr,"i"),wo=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,ko=/(^|\s|\n)(````?)([\s\S]+?)(````?)([\s\n\.,:?!;]|$)|(^|\s|\x01)(`|~~|\*\*|__|_-_|\|\|)([^\n]+?)\7([\x01\s\.,:?!;]|$)|@(\d+)\s*\((.+?)\)|(\[(.+?)\]\((.+?)\))/m,Po={Telegram:"tg://search_hashtag?hashtag={1}",Twitter:"https://twitter.com/hashtag/{1}",Instagram:"https://instagram.com/explore/tags/{1}/","Google Plus":"https://plus.google.com/explore/{1}"},ht={"`":"messageEntityCode","``":"messageEntityPre","**":"messageEntityBold",__:"messageEntityItalic","~~":"messageEntityStrike","_-_":"messageEntityUnderline","||":"messageEntitySpoiler"};new Set(Object.values(ht));const cs=new Set(["messageEntityEmoji","messageEntityLinebreak","messageEntityCaret"]),Ao=new Set(cs);for(const t in ht)cs.add(ht[t]);const Sr=/^\+\d+$/;function us(t){return t?t.match(Er):null}function ls(t,e){us(t)||(t="https://"+t);const s={url:t};let r,n,o;if(r=t.match(/^(?:https?:\/\/)?(?:(.+?)\.)?(?:(?:web|k|z|a)\.)?t(?:elegram)?\.me(?:\/(.+))?/)){const i=new URL(t);let c=r[1];c&&Js.has(r[1])&&(c=void 0),c&&(i.pathname=c+(i.pathname==="/"?"":i.pathname));const a=i.pathname.slice(1),u=a.split("/");if(u[0]&&u[0][0]==="$"&&u[0].length>1)o="invoice";else if(/^\+/.test(a)&&!Sr.test(a))o="joinchat";else if(u[0])switch(u[0]){case"addlist":case"joinchat":case"addstickers":case"addemoji":case"voicechat":case"invoice":if(u.length!==1&&!c){o=u[0];break}default:if(u.length<=2||u[1]?.match(/^\d+(?:\?(?:comment|thread)=\d+)?$/)){o="im";break}break}}else t.match(/^(?:https?:\/\/)?telesco\.pe\/([^/?]+)\/(\d+)/)?o="im":(n=t.match(/tg:(?:\/\/)?(.+?)(?:\?|$)/))&&(o="tg_"+n[1]);return window[o]||(o=void 0),s.onclick=o,s}y&&(y.wrapUrl=ls);function bo(t,e){hs(t),e===void 0?t.replaceChildren():typeof e=="string"?e?t.textContent=e:t.replaceChildren():t.replaceChildren(e)}function hs(t){t.setAttribute("dir","auto")}const To={messageActionChatCreate:"ActionCreateGroup",messageActionChatCreateYou:"ActionYouCreateGroup",messageActionChatEditTitle:"ActionChangedTitle",messageActionChatEditPhoto:"ActionChangedPhoto",messageActionChatEditVideo:"ActionChangedVideo",messageActionChatDeletePhoto:"ActionRemovedPhoto",messageActionChatReturn:"ActionAddUserSelf",messageActionChatReturnYou:"ActionAddUserSelfYou",messageActionChatJoined:"ActionAddUserSelfMega",messageActionChatJoinedYou:"ChannelMegaJoined",messageActionChatAddUser:"ActionAddUser",messageActionChatAddUsers:"ActionAddUser",messageActionChatLeave:"ActionLeftUser",messageActionChatLeaveYou:"YouLeft",messageActionChatDeleteUser:"ActionKickUser",messageActionChatJoinedByLink:"ActionInviteUser",messageActionPinMessage:"Chat.Service.Group.UpdatedPinnedMessage",messageActionContactSignUp:"Chat.Service.PeerJoinedTelegram",messageActionChannelCreate:"ActionCreateChannel",messageActionChannelEditTitle:"Chat.Service.Channel.UpdatedTitle",messageActionChannelEditPhoto:"Chat.Service.Channel.UpdatedPhoto",messageActionChannelEditVideo:"Chat.Service.Channel.UpdatedVideo",messageActionChannelDeletePhoto:"Chat.Service.Channel.RemovedPhoto",messageActionHistoryClear:"HistoryCleared",messageActionDiscussionStarted:"DiscussionStarted",messageActionChannelMigrateFrom:"ActionMigrateFromGroup","messageActionPhoneCall.video_in_ok":"ChatList.Service.VideoCall.incoming","messageActionPhoneCall.video_out_ok":"ChatList.Service.VideoCall.outgoing","messageActionPhoneCall.video_missed":"ChatList.Service.VideoCall.Missed","messageActionPhoneCall.video_cancelled":"ChatList.Service.VideoCall.Cancelled","messageActionPhoneCall.in_ok":"ChatList.Service.Call.incoming","messageActionPhoneCall.out_ok":"ChatList.Service.Call.outgoing","messageActionPhoneCall.missed":"ChatList.Service.Call.Missed","messageActionPhoneCall.cancelled":"ChatList.Service.Call.Cancelled","messageActionGroupCall.started":"Chat.Service.VoiceChatStarted.Channel","messageActionGroupCall.started_by":"Chat.Service.VoiceChatStarted","messageActionGroupCall.started_byYou":"Chat.Service.VoiceChatStartedYou","messageActionGroupCall.ended":"Chat.Service.VoiceChatFinished.Channel","messageActionGroupCall.ended_by":"Chat.Service.VoiceChatFinished","messageActionGroupCall.ended_byYou":"Chat.Service.VoiceChatFinishedYou",messageActionBotAllowed:"Chat.Service.BotPermissionAllowed"},Lo=Q?"Message.Unsupported.Mobile":"Message.Unsupported.Desktop";var K;(t=>{t.strings=new Map,t.countriesList=[];let e,s;t.requestedServerLanguage=!1,t.isRTL=!1;function r(l){t.isRTL=l}t.setRTL=r;function n(l){t.lastRequestedLangCode=l,t.lastRequestedNormalizedLangCode=l.split("-")[0]}function o(){return s||(s=Promise.all([ne.get("langPack"),t.polyfillPromise]).then(([l])=>l?(t.lastRequestedLangCode||n(l.lang_code),d(l),l):a()).finally(()=>{s=void 0}))}t.getCacheLangPack=o;function i(){if(t.timeFormat==="h12")try{const l=w({hour:"numeric",minute:"numeric",hour12:!0}),D=new Date;D.setHours(0);const v=l.format(D);t.amPmCache.am=v.split(/\s/)[1],D.setHours(12);const f=l.format(D);t.amPmCache.pm=f.split(/\s/)[1]}catch(l){console.error("cannot get am/pm",l),t.amPmCache={am:"AM",pm:"PM"}}}function c(l,D=!!t.timeFormat&&t.timeFormat!==l){t.timeFormat=l,i(),D&&(P.clear(),Array.from(document.querySelectorAll(".i18n")).forEach(f=>{const b=t.weakMap.get(f);b instanceof _&&b.update()}))}t.setTimeFormat=c;function a(){const l=I.langPackCode;return n(l),Promise.all([R(()=>import("./lang-c1c2a466.js"),[],import.meta.url),R(()=>import("./langSign-f5a5610c.js"),[],import.meta.url),R(()=>import("./countries-5301fc59.js"),[],import.meta.url)]).then(([D,v,f])=>{const b=[];m(D.default,b),m(v.default,b);const W={_:"langPackDifference",from_version:0,lang_code:l,strings:b,version:0,local:!0,countries:f.default};return g(W)})}t.loadLocalLangPack=a;function u(l,D){D=!0,t.requestedServerLanguage=!0;const v=C.managers;return Promise.all([v.apiManager.invokeApiCacheable("langpack.getLangPack",{lang_code:l,lang_pack:D?"web":I.langPack}),!D&&v.apiManager.invokeApiCacheable("langpack.getLangPack",{lang_code:l,lang_pack:"android"}),R(()=>import("./lang-c1c2a466.js"),[],import.meta.url),R(()=>import("./langSign-f5a5610c.js"),[],import.meta.url),v.apiManager.invokeApiCacheable("help.getCountriesList",{lang_code:l,hash:0}),t.polyfillPromise])}t.loadLangPack=u;function h(l,D){return C.managers.apiManager.invokeApi("langpack.getStrings",{lang_pack:I.langPack,lang_code:l,keys:D})}t.getStrings=h;function m(l,D=[]){for(const v in l){const f=l[v];typeof f=="string"?D.push({_:"langPackString",key:v,value:f}):D.push({_:"langPackStringPluralized",key:v,...f})}return D}t.formatLocalStrings=m;function p(l,D){return n(l),u(l,D).then(([v,f,b,W,N,ce])=>{let te=[];return[b,W].forEach(ze=>{m(ze.default,te)}),te=te.concat(...[v.strings,f.strings].filter(Boolean)),v.strings=te,v.countries=N,g(v)})}t.getLangPack=p;function g(l){return l.appVersion=I.langPackVersion,ne.set({langPack:l}).then(()=>(d(l),l))}t.saveLangPack=g,t.polyfillPromise=function(){return typeof Intl<"u"&&typeof Intl.PluralRules<"u"?Promise.resolve():R(()=>import("./pluralPolyfill-61f068d6.js"),[],import.meta.url).then(D=>{window.Intl=Object.assign(typeof Intl<"u"?Intl:{},D.default)})}();function d(l){const D=t.lastRequestedLangCode;if(l.lang_code!==D)return;try{e=new Intl.PluralRules(t.lastRequestedNormalizedLangCode)}catch(f){console.error("pluralRules error",f),e=new Intl.PluralRules(t.lastRequestedNormalizedLangCode.split("-",1)[0])}try{e=new Intl.PluralRules(l.lang_code)}catch(f){console.error("pluralRules error",f),e=new Intl.PluralRules(l.lang_code.split("-",1)[0])}t.strings.clear();for(const f of l.strings)t.strings.set(f.key,f);l.countries&&(t.countriesList.length=0,t.countriesList.push(...l.countries.countries),l.countries.countries.forEach(f=>{if(f.name){const b=f.default_name;t.strings.set(b,{_:"langPackString",key:b,value:f.name})}})),t.lastAppliedLangCode!==D&&(t.lastAppliedLangCode&&C.myId&&(C.managers.appReactionsManager.resetAvailableReactions(),C.managers.appUsersManager.indexMyself(),C.managers.dialogsStorage.indexMyDialog()),t.lastAppliedLangCode=D,P.clear(),i(),C.dispatchEvent("language_change",D)),Array.from(document.querySelectorAll(".i18n")).forEach(f=>{const b=t.weakMap.get(f);b&&b.update()})}t.applyLangPack=d;function F(l,D,v){const f=D[v.i++];Array.isArray(f)?l.push(...f):l.push(f)}function S(l,D,v={i:0}){const f=[],b=/(\*\*|__)(.+?)\1|(\n)|(\[.+?\]\(.*?\))|un\d|%\d\$.|%./g;let W=0;return l.replace(b,(N,ce,te,ze,ue,kt,Ns)=>{if(f.push(Ns.slice(W,kt)),ce){let J;switch(ce){case"**":{J=document.createElement("b");break}case"__":{J=document.createElement("i");break}}J.append(...S(te,D,v)),f.push(J)}else if(ze)f.push(document.createElement("br"));else if(ue){const J=ue.lastIndexOf("]"),Us=ue.slice(1,J),je=ue.slice(J+2,ue.length-1);let B;if(je&&us(je)){B=document.createElement("a");const He=ls(je);B.href=He.url,He.onclick&&B.setAttribute("onclick",He.onclick+"(this)"),B.target="_blank"}else B=D[v.i++],B instanceof DocumentFragment&&(B=B.firstChild),typeof B!="string"&&(B.textContent="");const Pt=S(Us,D,v);typeof B=="string"?f.push(...Pt):(B.append(...Pt),f.push(B))}else D&&F(f,D,v);return W=kt+N.length,""}),W!==l.length&&f.push(l.slice(W)),f}t.superFormatter=S;function A(l,D=!1,v){const f=t.strings.get(l);let b;if(f)if(f._==="langPackStringPluralized"&&v?.length){let N=v[0];typeof N=="string"&&(N=+N.replace(/\D/g,""));const ce=e.select(N);b=f[ce+"_value"]||f.other_value}else f._==="langPackString"?b=f.value:b=l;else b=l;const W=S(b,v);return D?W.map(N=>N instanceof Node?N.textContent:N).join(""):W}t.format=A,t.weakMap=new WeakMap;class T{constructor(D){this.element=D?.element||document.createElement("span"),this.element.classList.add("i18n"),this.property=D?.property,t.weakMap.set(this.element,this)}}class E extends T{constructor(D={}){super({...D,property:D.property??"innerHTML"}),D?.key&&this.update(D)}update(D){if(ut(this,D),this.property==="innerHTML")this.element.textContent="",this.element.append(...A(this.key,!1,this.args));else{const v=this.element[this.property],f=A(this.key,!0,this.args);v===void 0?this.element.dataset[this.property]=f:this.element[this.property]=f}}compareAndUpdate(D){if(!(this.key===D.key&&is(this.args,D.args)))return this.update(D)}}t.IntlElement=E;const P=new Map;function w(l={}){const D=JSON.stringify(l);let v=P.get(D);return v||(v=new Intl.DateTimeFormat(t.lastRequestedNormalizedLangCode+"-u-hc-"+t.timeFormat,l),P.set(D,v)),v}t.getDateTimeFormat=w,t.amPmCache={am:"AM",pm:"PM"};class _ extends T{constructor(D){super({...D,property:D.property??"textContent"}),hs(this.element),D?.date&&this.update(D)}update(D){ut(this,D);let v;if(this.options.hour&&this.options.minute&&Object.keys(this.options).length===2){const f=this.date.getHours();v=("0"+(t.timeFormat==="h12"?f%12||12:f)).slice(-2)+":"+("0"+this.date.getMinutes()).slice(-2),t.timeFormat==="h12"&&(v+=" "+(f<12?t.amPmCache.am:t.amPmCache.pm))}else{const f=w(this.options);v=Ve(f.format(this.date))}this.element[this.property]=v}}t.IntlDateElement=_;function U(l,D){return new E({key:l,args:D}).element}t.i18n=U;function Ye(l){return new E(l).element}t.i18n_=Ye;function X(l,D,v,f){return new E({element:l,key:D,args:v,property:f}).element}t._i18n=X})(K||(K={}));const O=K,Re=K.i18n,Io=K.i18n_,Mo=K._i18n;function _r(t,e){const s=t.slice(0,1);for(let r=1;r<t.length;++r){const n=t.length-1===r;s.push(typeof e=="function"?e(n):e),s.push(t[r])}return s}function Ro(t,e=!0,s){const r=_r(t,n=>{const o=n&&e?"AutoDownloadSettings.LastDelimeter":"AutoDownloadSettings.Delimeter";return s?K.format(o,!0):Re(o)});return s?r.join(""):r}y&&(y.I18n=K);function yr(t){return+t<0}function wr(t){return+t>=0}String.prototype.toUserId=function(){return(+this).toUserId()};String.prototype.toChatId=function(){return(+this).toChatId()};String.prototype.toPeerId=function(t){return(+this).toPeerId(t)};String.prototype.isPeerId=function(){return/^[\d-]/.test(this.toString())};Number.prototype.toUserId=function(){return+this};Number.prototype.toChatId=function(){return Math.abs(this)};Number.prototype.toPeerId=function(t){return t===void 0?+this:t?-Math.abs(this):+this};Number.prototype.isPeerId=function(){return!0};[["isUser",wr],["isAnyChat",yr]].forEach(t=>{const e=Array.isArray(t)?t[0]:t,s=Array.isArray(t)?t[1]:t;String.prototype[e]=function(){return s.call(null,this.toString())},Number.prototype[e]=function(){return s.call(null,+this)}});function kr(...t){const e=t.reduce((n,o)=>n+(o.byteLength||o.length),0),s=new Uint8Array(e);let r=0;return t.forEach(n=>{s.set(n instanceof ArrayBuffer?new Uint8Array(n):n,r),r+=n.byteLength||n.length}),s}Uint8Array.prototype.concat=function(...t){return kr(this,...t)};Uint8Array.prototype.toJSON=function(){return[...this]};Promise.prototype.finally=Promise.prototype.finally||function(t){const e=s=>Promise.resolve(t()).then(s);return this.then(s=>e(()=>s),s=>e(()=>Promise.reject(s)))};class Pr{constructor(){this.convertPromises={}}init(){this.worker=new Worker(new URL(""+new URL("webp.worker-895c8b50.js",import.meta.url).href,self.location)),this.worker.addEventListener("message",e=>{const r=e.data.payload,n=this.convertPromises[r.fileName];n&&(r.bytes?n.resolve(r.bytes):n.reject(),delete this.convertPromises[r.fileName])})}postMessage(e){this.init&&(this.init(),this.init=null),this.worker.postMessage(e)}convert(e,s){if(this.convertPromises.hasOwnProperty(e))return this.convertPromises[e];const r=H();return this.postMessage({type:"convertWebp",payload:{fileName:e,bytes:s}}),this.convertPromises[e]=r}}const ds=new Pr;y.webpWorkerController=ds;class Ar{constructor(){this.prefix="",this.cache={},this.useStorage=!0,V.test&&(this.prefix="t_")}get(e,s=!0){if(this.cache.hasOwnProperty(e)&&s)return this.cache[e];if(this.useStorage){let r;try{r=localStorage.getItem(this.prefix+e)}catch{this.useStorage=!1}if(r!==null)try{r=JSON.parse(r)}catch{}else r=void 0;return r}}set(e,s=!1){for(const r in e)if(e.hasOwnProperty(r)){const n=e[r];if(this.cache[r]=n,this.useStorage&&!s)try{const o=JSON.stringify(n);localStorage.setItem(this.prefix+r,o)}catch{this.useStorage=!1}}}delete(e,s=!1){e=""+e,s||delete this.cache[e];try{localStorage.removeItem(this.prefix+e)}catch{}}clear(){const e=["dc","server_time_offset","xt_instance","user_auth","state_id","k_build"];for(let s=1;s<=5;++s)e.push(`dc${s}_server_salt`),e.push(`dc${s}_auth_key`);for(const s of e)this.delete(s,!0)}toggleStorage(e,s){if(this.useStorage=e,!!s)if(!e)this.clear();else return this.set(this.cache)}}const Ds=class{constructor(){Ds.STORAGES.push(this),ae||(this.storage=new Ar)}async proxy(t,...e){return ae?Ce.getInstance().invoke("localStorageProxy",{type:t,args:e}):(e=Array.prototype.slice.call(e),this.storage[t].apply(this.storage,e))}get(t,e){return this.proxy("get",t,e)}set(t,e){return this.proxy("set",t,e)}delete(t,e){return this.proxy("delete",t,e)}clear(){return this.proxy("clear")}toggleStorage(t,e){return this.proxy("toggleStorage",t,e)}};let gs=Ds;gs.STORAGES=[];const L=new gs;y.appStorage=L;class br{reload(){try{location.reload()}catch{}}close(){try{window.close()}catch{}}focus(){window.focus()}}const fs=new br;function M(t){if(t===null||typeof t!="object")return t;if(t instanceof Date)return new Date(t.getTime());if(Array.isArray(t))return t.map(n=>M(n));if(ArrayBuffer.isView(t))return t.slice();const e=new t.constructor;for(var s in t)t.hasOwnProperty(s)&&(e[s]=M(t[s]));return e}const Oe=typeof SharedWorker<"u"&&!V.noSharedWorker,Tr=Z?"touchstart":"mousemove";class Lr extends ee{constructor(){super(),this._isIdle=!0,this.focusPromise=Promise.resolve(),this.focusResolve=()=>{},window.addEventListener("blur",()=>{this.isIdle=!0,window.addEventListener("focus",()=>{this.isIdle=!1},{once:!0})}),window.addEventListener(Tr,()=>{this.isIdle=!1},{once:!0,passive:!0}),this.addEventListener("change",e=>{e?this.focusPromise=new Promise(s=>{this.focusResolve=s}):this.focusResolve()})}getFocusPromise(){return this.focusPromise}get isIdle(){return this._isIdle}set isIdle(e){this._isIdle!==e&&(this._isIdle=e,this.dispatchEvent("change",e))}}const Be=new Lr,Ir=5e3,Mr=3e4,Rr=2e4,Or=Oe;class Br extends ee{constructor(){super(!1),this.log=z("INSTANCE"),this.clearInstance=()=>{this.masterInstance&&!this.deactivated&&(this.log.warn("clear master instance"),L.delete("xt_instance"))},this.checkInstance=async(e=Be.isIdle)=>{if(this.deactivated)return;const s=Date.now(),r={id:this.instanceId,idle:e,time:s},[n,o=I.build]=await Promise.all([L.get("xt_instance",!1),L.get("k_build",!1)]);if(o>I.build){this.masterInstance=!1,C.managers.networkerFactory.stopAll(),this.deactivateInstance("version"),Ge.toggleStorages(!1,!1);return}else if(Or){L.set({xt_instance:r});return}!e||!n||n.id===this.instanceId||n.time<s-Rr?(L.set({xt_instance:r}),this.masterInstance||(this.masterInstance=!0,C.managers.networkerFactory.startAll(),this.log.warn("now master instance",r)),this.clearDeactivateTimeout()):this.masterInstance&&(this.masterInstance=!1,C.managers.networkerFactory.stopAll(),this.log.warn("now idle instance",r),this.deactivateTimeout||(this.deactivateTimeout=window.setTimeout(()=>this.deactivateInstance("tabs"),Mr)))},this.log=z("INSTANCE"),this.instanceId=Qt}get deactivatedReason(){return this.deactivated}start(){if(this.reset(),!this.started){this.started=!0,Be.addEventListener("change",this.checkInstance),setInterval(this.checkInstance,Ir),this.checkInstance();try{document.documentElement.addEventListener("beforeunload",this.clearInstance)}catch{}}}reset(){this.masterInstance=!1,this.clearDeactivateTimeout(),this.deactivated=void 0}activateInstance(){this.deactivated&&(this.reset(),this.checkInstance(!1),this.dispatchEvent("activated"))}deactivateInstance(e){this.masterInstance||this.deactivated||(this.log.warn("deactivate",e),this.clearDeactivateTimeout(),this.deactivated=e,this.dispatchEvent("deactivated",e))}clearDeactivateTimeout(){this.deactivateTimeout&&(clearTimeout(this.deactivateTimeout),this.deactivateTimeout=0)}}const xe=new Br;y&&(y.singleInstance=xe);function xr(t,e){if(t!==void 0)return t=+t.toFixed(0),e?t<ct?t:t%ct:t}function Nr(t){return xr(t,!0)}const Ur=1e4;class ms extends ee{constructor(){super(!1),this.isAvailable=!0,this.isPushEnabled=!1,this.localNotificationsAvailable=!0,this.started=!1,this.settings={},this.isFirefox=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,this.userVisibleOnly=!this.isFirefox,this.log=z("PUSH-API"),this.subscribe=()=>{this.isAvailable&&navigator.serviceWorker.ready.then(e=>{e.pushManager.subscribe({userVisibleOnly:this.userVisibleOnly}).then(s=>{this.isPushEnabled=!0,this.pushSubscriptionNotify("subscribe",s)}).catch(s=>{Notification.permission==="denied"?this.log("Permission for Notifications was denied"):(this.log("Unable to subscribe to push.",s),this.userVisibleOnly||(this.userVisibleOnly=!0,setTimeout(this.subscribe,0)))})})},this.isAliveNotify=()=>{if(!this.isAvailable||xe.deactivatedReason)return;this.settings.baseUrl=(location.href||"").replace(/#.*$/,"");const e={},s={push_action_mute1d:Q?"PushNotification.Action.Mute1d.Mobile":"PushNotification.Action.Mute1d",push_action_settings:Q?"PushNotification.Action.Settings.Mobile":"PushNotification.Action.Settings",push_message_nopreview:"PushNotification.Message.NoPreview"};for(const r in s)e[r]=O.format(s[r],!0);this.serviceMessagePort.invokeVoid("pushPing",{localNotifications:this.localNotificationsAvailable,lang:e,settings:this.settings}),this.isAliveTO=setTimeout(this.isAliveNotify,Ur)},(!("PushManager"in window)||!("Notification"in window)||!("serviceWorker"in navigator))&&(this.log.warn("Push messaging is not supported."),this.isAvailable=!1,this.localNotificationsAvailable=!1),this.isAvailable&&Notification.permission==="denied"&&this.log.warn("The user has blocked notifications.")}start(){this.started||(this.started=!0,this.getSubscription(),this.setUpServiceWorkerChannel())}setLocalNotificationsDisabled(){this.localNotificationsAvailable=!1}getSubscription(){this.isAvailable&&navigator.serviceWorker.ready.then(e=>{e.pushManager.getSubscription().then(s=>{this.isPushEnabled=!!s,this.pushSubscriptionNotify("init",s)}).catch(s=>{this.log.error("Error during getSubscription()",s)})})}unsubscribe(){this.isAvailable&&navigator.serviceWorker.ready.then(e=>{e.pushManager.getSubscription().then(s=>{this.isPushEnabled=!1,s&&(this.pushSubscriptionNotify("unsubscribe",s),setTimeout(()=>{s.unsubscribe().then(r=>{this.isPushEnabled=!1}).catch(r=>{this.log.error("Unsubscription error: ",r)})},3e3))}).catch(s=>{this.log.error("Error thrown while unsubscribing from push messaging.",s)})})}forceUnsubscribe(){this.isAvailable&&navigator.serviceWorker.ready.then(e=>{e.pushManager.getSubscription().then(s=>{this.log.warn("force unsubscribe",s),s&&s.unsubscribe().then(r=>{this.log.warn("force unsubscribe successful",r),this.isPushEnabled=!1}).catch(r=>{this.log.error("Unsubscription error: ",r)})}).catch(s=>{this.log.error("Error thrown while unsubscribing from push messaging.",s)})})}setSettings(e){this.settings=M(e),clearTimeout(this.isAliveTO),this.isAliveNotify()}hidePushNotifications(){this.isAvailable&&this.serviceMessagePort.invokeVoid("notificationsClear",void 0)}setUpServiceWorkerChannel(){this.isAvailable&&(this.serviceMessagePort.addEventListener("pushClick",e=>{if(xe.deactivatedReason){fs.reload();return}this.dispatchEvent("push_notification_click",e)}),navigator.serviceWorker.ready.then(this.isAliveNotify))}pushSubscriptionNotify(e,s){if(s){const r=s.toJSON();if(!r||!r.endpoint||!r.keys||!r.keys.p256dh||!r.keys.auth){this.log.warn("Invalid push subscription",r),this.unsubscribe(),this.isAvailable=!1,this.pushSubscriptionNotify(e);return}this.log.warn("Push",e,r),this.dispatchEvent("push_"+e,{tokenType:10,tokenValue:JSON.stringify(r)})}else this.log.warn("Push",e,!1),this.dispatchEvent("push_"+e,!1)}ignorePushByMid(e,s){this.isAvailable&&this.serviceMessagePort.invokeVoid("shownNotification",e+"_"+Nr(s))}}const Ne=new ms;y&&(y.webPushApiManager=Ne);const Wr=Object.freeze(Object.defineProperty({__proto__:null,WebPushApiManager:ms,default:Ne},Symbol.toStringTag,{value:"Module"}));function Vr(t){const e=document.createElement("script"),s=new Promise(r=>{e.onload=e.onerror=()=>{r(e)}});return e.src=t,document.body.appendChild(e),s}function Gr(t){const e=Date.now();return t?e/1e3|0:e}class ps{constructor(){this.disabled=V.test||!I.domains.includes(location.hostname)}setAuthorized(e){if(!this.disabled)return L.get("tgme_sync").then(s=>{const r=Gr(!0);if(e&&s?.canRedirect===e&&s.ts+86400>r)return;L.set({tgme_sync:{canRedirect:e,ts:r}});const n=`_websync_?authed=${e?"1":"0"}&version=${encodeURIComponent(I.version+" "+I.suffix)}`,i=["//telegram.me/"+n,"//t.me/"+n].map(c=>Vr(c).then(a=>{a.remove()}));return Promise.all(i)})}}const Et=new ps;y&&(y.telegramMeWebManager=Et);const Yr=Object.freeze(Object.defineProperty({__proto__:null,TelegramMeWebManager:ps,default:Et},Symbol.toStringTag,{value:"Module"})),vt=typeof RTCPeerConnection<"u"&&!ie,zr=vt;let Ae;if(!Y)Ae=!0;else try{Ae=+navigator.userAgent.match(/Version\/(.+?) /)[1]>=14}catch{Ae=!1}const jr=Ae,Hr="filter"in(document.createElement("canvas").getContext("2d")||{}),$r=!!navigator?.geolocation?.getCurrentPosition&&!1,qr=vt,Fs=document.createElement("canvas").toDataURL("image/webp").startsWith("data:image/webp"),Ct=new Set(["image/jpeg","image/png","image/bmp"]);Fs&&Ct.add("image/webp");const Es=!!document.createElement("video").canPlayType("video/quicktime")||Y||oe,St=new Set(["image/gif","video/mp4","video/webm"]);Es&&St.add("video/quicktime");const Kr=[...Ct].concat([...St]),Xr=new Set(Kr),Jr=!ie&&!1,Zr="getDisplayMedia"in(navigator?.mediaDevices||{}),Qr=!!navigator?.vibrate,en=!!document.createElement("video").canPlayType("video/webm")&&!Y&&!oe,xt=document.createElement("audio"),vs=!!(xt.canPlayType&&xt.canPlayType("audio/ogg;").replace(/no/,""));let Cs=!1;try{const t=document.createElement("canvas").getContext("webgl"),e=t.getExtension("WEBGL_debug_renderer_info"),s=e&&t.getParameter(e.UNMASKED_RENDERER_WEBGL)||"";(s.match(/Apple/)&&!s.match(/Apple GPU/)||t.getSupportedExtensions().indexOf("WEBGL_compressed_texture_s3tc_srgb")===-1)&&(Cs=!0)}catch{}const tn=Cs,Nt={CAN_USE_TRANSFERABLES:jr,IS_APPLE_MX:tn,IS_CALL_SUPPORTED:zr,IS_CANVAS_FILTER_SUPPORTED:Hr,IS_EMOJI_SUPPORTED:at,IS_GEOLOCATION_SUPPORTED:$r,IS_GROUP_CALL_SUPPORTED:qr,IS_MOV_SUPPORTED:Es,IS_PARALLAX_SUPPORTED:Jr,IS_SCREEN_SHARING_SUPPORTED:Zr,IS_TOUCH_SUPPORTED:Z,IS_VIBRATE_SUPPORTED:Qr,IS_OPUS_SUPPORTED:vs,IS_SHARED_WORKER_SUPPORTED:Oe,IS_WEBM_SUPPORTED:en,IS_WEBP_SUPPORTED:Fs,IS_WEBRTC_SUPPORTED:vt,IMAGE_MIME_TYPES_SUPPORTED:Ct,MEDIA_MIME_TYPES_SUPPORTED:Xr,VIDEO_MIME_TYPES_SUPPORTED:St,...Ys};function sn(){return new Date().toLocaleString().match(/\s(AM|PM)/)?"h12":"h23"}const rn={8:new Uint8Array(1),16:new Uint16Array(1),32:new Uint32Array(1)};function dt(t){const e=rn[t];return crypto.getRandomValues(e),e[0]}function Oo(){return""+dt(32)+dt(32)%16777215}const nn=I.version,on=I.build,Ut={_:"theme",access_hash:"",id:"",settings:[{_:"themeSettings",pFlags:{},base_theme:{_:"baseThemeClassic"},accent_color:3379436,message_colors:[5221966],wallpaper:{_:"wallPaper",pFlags:{default:!0,pattern:!0},access_hash:"",document:void 0,id:"",slug:"pattern",settings:{_:"wallPaperSettings",pFlags:{},intensity:50,background_color:14409147,second_background_color:7054727,third_background_color:14014605,fourth_background_color:8960132}}},{_:"themeSettings",pFlags:{},base_theme:{_:"baseThemeNight"},accent_color:8877281,message_colors:[8877281],wallpaper:{_:"wallPaper",pFlags:{default:!0,pattern:!0,dark:!0},access_hash:"",document:void 0,id:"",slug:"pattern",settings:{_:"wallPaperSettings",pFlags:{},intensity:-50,background_color:16696470,second_background_color:14511289,third_background_color:9842623,fourth_background_color:5200853}}}],slug:"",title:"",emoticon:"ğŸ ",pFlags:{default:!0}},Wt=(t,e,s)=>({...Ut,name:t,settings:{...Ut.settings.find(r=>r.base_theme._===e),highlightningColor:s}}),x={allDialogsLoaded:{},pinnedOrders:{},contactsListCachedTime:0,updates:{},filtersArr:[],maxSeenMsgId:0,stateCreatedTime:Date.now(),recentEmoji:[],recentCustomEmoji:[],topPeersCache:{},recentSearch:[],version:nn,build:on,authState:{_:Q?"authStateSignIn":"authStateSignQr"},hiddenPinnedMessages:{},settings:{messagesTextSize:16,distanceUnit:"kilometers",sendShortcut:"enter",autoDownload:{photo:{contacts:!0,private:!0,groups:!0,channels:!0},video:{contacts:!0,private:!0,groups:!0,channels:!0},file:{contacts:!0,private:!0,groups:!0,channels:!0}},autoDownloadNew:{_:"autoDownloadSettings",file_size_max:3145728,pFlags:{video_preload_large:!0,audio_preload_next:!0},photo_size_max:1048576,video_size_max:15728640,video_upload_maxbitrate:100},stickers:{suggest:"all",dynamicPackOrder:!0,loop:!0},emoji:{suggest:!0,big:!0},themes:[Wt("day","baseThemeClassic","hsla(86.4, 43.846153%, 45.117647%, .4)"),Wt("night","baseThemeNight","hsla(299.142857, 44.166666%, 37.470588%, .4)")],theme:"system",notifications:{sound:!1},timeFormat:sn(),liteMode:{all:!1,animations:!1,chat:!1,chat_background:!1,chat_spoilers:!1,effects:!1,effects_premiumstickers:!1,effects_reactions:!1,effects_emoji:!1,emoji:!1,emoji_messages:!1,emoji_panel:!1,gif:!1,stickers:!1,stickers_chat:!1,stickers_panel:!1,video:!1}},playbackParams:{volume:1,muted:!1,playbackRate:1,playbackRates:{voice:1,video:1,audio:1},loop:!1,round:!1},keepSigned:!0,chatContextMenuHintWasShown:!1,hideChatJoinRequests:{},stateId:dt(32),notifySettings:{},confirmedWebViews:[]};function _e(t,e){t=t.split(" ",1)[0],e=e.split(" ",1)[0];const s=t.split("."),r=e.split(".");for(let n=0;n<s.length;++n){const o=+s[n],i=+r[n];if(o>i)return 1;if(o<i)return-1}return 0}function an(t){return typeof t=="object"&&t!==null}function Ss(t,e,s,r,n,o){for(const i in t){const c=o?`${o}.${i}`:i;n?.has(c)||(typeof e[i]!=typeof t[i]?(e[i]=M(t[i]),s?.(r||i)):an(t[i])&&Ss(t[i],e[i],s,r||i,n,c))}}function cn(t,e,s){const r=performance.now();return(s||console).warn(Me(),"start",e),t.then(()=>{(s||console).warn(Me(),"end",e,performance.now()-r)}),t}function un(t){return(...e)=>cn(...e,t)}const ln=24*60*60*1e3,ye=x.version,he=x.build,we=Object.keys(x),hn=["contactsListCachedTime","stateCreatedTime","maxSeenMsgId","filtersArr"];async function dn(){const t=z("STATE-LOADER"),e=performance.now(),s=un(t),r=we.map(E=>s(ne.get(E),"state "+E)).concat(s(L.get("user_auth"),"auth"),s(L.get("state_id"),"auth"),s(L.get("k_build"),"auth")).concat(s(ne.get("user_auth"),"old auth")),n=await Promise.all(r);t.warn("promises",performance.now()-e);const o=[],i=(E,P)=>{a[E]=P,o.push(E)},c=E=>{o.length=0,a=E,o.push(...Object.keys(a))};let a={};for(let E=0,P=we.length;E<P;++E){const w=we[E],_=n[E];_!==void 0?a[w]=_:i(w,M(x[w]))}n.splice(0,we.length);let u=n.shift();const h=n.shift(),m=n.shift(),p=n.shift();if(!u&&p){u=p;const E=["dc","server_time_offset","xt_instance"];for(let _=1;_<=5;++_)E.push(`dc${_}_server_salt`),E.push(`dc${_}_auth_key`);const P=await Promise.all(E.map(_=>ne.get(_)));E.push("user_auth"),P.push(typeof u=="number"||typeof u=="string"?{dcID:P[0]||I.baseDcId,date:Date.now()/1e3|0,id:u.toPeerId(!1)}:u);const w={};E.forEach((_,U)=>{w[_]=P[U]}),await L.set(w)}u&&(a.authState={_:"authStateSignedIn"},C.dispatchEvent("user_auth",typeof u=="number"||typeof u=="string"?{dcID:0,date:Date.now()/1e3|0,id:u.toPeerId(!1)}:u));const g=new Set;if(a.stateId!==h){if(h!==void 0){const E=new Map([["authState",void 0],["stateId",void 0]]);E.forEach((w,_)=>{E.set(_,M(a[_]))}),a=M(x),E.forEach((w,_)=>{a[_]=w});const P={chats:1,dialogs:1,users:1};for(const w in P)g.add(w);c(a)}await L.set({state_id:a.stateId})}const d=Date.now();a.stateCreatedTime+ln<d&&(q&&t("will refresh state",a.stateCreatedTime,d),(P=>{P.forEach(w=>{i(w,M(x[w]))})})(hn));const F=a.settings.autoDownload;if(F?.private!==void 0){const E=["contacts","private","groups","channels"];["photo","video","file"].forEach(w=>{const _=F[w]={};E.forEach(U=>{_[U]=F[U]})}),E.forEach(w=>{delete F[w]}),i("settings",a.settings)}Ss(x,a,E=>{i(E,a[E])},void 0,new Set(["settings.themes"]));let A,T;if(a.version!==ye||a.build!==he){if(a.build<322&&(i("allDialogsLoaded",M(x.allDialogsLoaded)),i("pinnedOrders",M(x.pinnedOrders)),i("filtersArr",M(x.filtersArr)),g.add("dialogs")),_e(a.version,"1.7.1")===-1){let E=!1;if(_e(a.version,"1.3.0")===-1)E=!0,a.settings.theme=M(x.settings.theme),a.settings.themes=M(x.settings.themes);else if(_e(a.version,"1.7.1")===-1){E=!0;const P=a.settings.themes;a.settings.themes=M(x.settings.themes);try{P.forEach(w=>{const _=w.background;if(!_)return;const U=a.settings.themes.find(l=>l.name===w.name);U.settings.highlightningColor=_.highlightningColor;const Ye=l=>l&&parseInt(l.slice(1),16),X=(_.color||"").split(",").map(Ye);if(_.color&&!_.slug)U.settings.wallpaper={_:"wallPaperNoFile",id:0,pFlags:{},settings:{_:"wallPaperSettings",pFlags:{}}};else{const l={_:"wallPaper",id:0,access_hash:0,slug:_.slug,document:{},pFlags:{},settings:{_:"wallPaperSettings",pFlags:{}}},D=l.settings;U.settings.wallpaper=l,_.slug&&!_.color?D.pFlags.blur=_.blur||void 0:_.intensity&&(D.intensity=_.intensity,l.pFlags.pattern=!0,l.pFlags.dark=_.intensity<0||void 0)}if(X.length){const l=U.settings.wallpaper.settings;l.background_color=X[0],l.second_background_color=X[1],l.third_background_color=X[2],l.fourth_background_color=X[3]}})}catch(w){console.error("migrating themes error",w)}}E&&i("settings",a.settings)}a.build<309&&(a.settings.liteMode.animations=!a.settings.animationsEnabled,a.settings.liteMode.video=!a.settings.autoPlay.videos,a.settings.liteMode.gif=!a.settings.autoPlay.gifs),a.build<312&&typeof a.settings.stickers.suggest=="boolean"&&(a.settings.stickers.suggest=a.settings.stickers.suggest?"all":"none"),_e(a.version,ye)!==0&&(A=ye,T=a.version),i("version",ye),i("build",he)}return m!==he&&(!m||m<he)&&L.set({k_build:he}),C.settings=a.settings,q&&t("state res",a,M(a)),t.warn("total",performance.now()-e),{state:a,resetStorages:g,newVersion:A,oldVersion:T,pushedKeys:o}}let Dn;function gn(){return Dn??(Dn=dn())}class fn{constructor(){this.sampleRate=48e3,this.tasks=[],this.keepAlive=!1,this.log=z("OPUS",ns.Error)}isPlaySupported(){return vs}loadWavWorker(){this.wavWorker||(this.wavWorker=new Worker("waveWorker.min.js"),this.wavWorker.addEventListener("message",e=>{const s=e.data;if(this.log("[WAV] got message:",s),s&&s.page){const r=s.page;this.onTaskEnd(this.tasks.shift(),r)}}))}loadWorker(){this.worker||(this.worker=new Worker("decoderWorker.min.js"),this.worker.addEventListener("message",e=>{const s=e.data;this.log("[DECODER] got message",s),s.type==="done"?(this.wavWorker.postMessage({command:"done"}),s.waveform&&(this.tasks[0].waveform=s.waveform)):this.wavWorker.postMessage({command:"encode",buffers:e.data},Y?void 0:s.map(r=>r.buffer))}))}setKeepAlive(e){this.keepAlive=e,this.keepAlive?(this.loadWorker(),this.loadWavWorker()):this.tasks.length||this.terminateWorkers()}onTaskEnd(e,s){s?(clearTimeout(e.timeout),e.callback.resolve({bytes:s,waveform:e.waveform})):e.callback.reject("timeout"),this.tasks.length&&this.executeNewTask(this.tasks[0]),this.terminateWorkers()}terminateWorkers(e=!1){(this.keepAlive||this.tasks.length)&&!e||(this.worker&&(this.worker.terminate(),this.worker=null),this.wavWorker&&(this.wavWorker.terminate(),this.wavWorker=null))}executeNewTask(e){this.worker.postMessage({command:"init",decoderSampleRate:this.sampleRate,outputBufferSampleRate:this.sampleRate}),this.wavWorker.postMessage({command:"init",wavBitDepth:16,wavSampleRate:this.sampleRate}),this.log("[DECODER] send decode"),this.worker.postMessage({command:"decode",pages:e.pages,waveform:e.withWaveform},Y?void 0:[e.pages.buffer]),e.timeout=window.setTimeout(()=>{this.log.error("decode timeout"),this.terminateWorkers(!0),this.tasks.length&&(this.loadWorker(),this.loadWavWorker()),this.onTaskEnd(this.tasks.shift())},1e4)}pushDecodeTask(e,s){return new Promise((r,n)=>{const o={pages:e,withWaveform:s,callback:{resolve:r,reject:n},timeout:0};this.loadWorker(),this.loadWavWorker(),this.tasks.push(o)===1&&this.executeNewTask(o)})}async decode(e,s=!1){return this.pushDecodeTask(e,s).then(async r=>{const n=new Blob([r.bytes],{type:"audio/wav"});return{url:await Ge.invoke("createObjectURL",n),waveform:r.waveform}})}}const _s=new fn;y.opusDecodeController=_s;class mn extends Ft{constructor(){super("CRYPTO"),this.lastIndex=-1}invokeCryptoNew({method:e,args:s,transfer:r}){const n={method:e,args:s},o=this.listeners.invoke;if(o?.length){let c=o[0].callback(n);return!ae&&!(c instanceof Promise)&&(c=Promise.resolve(c)),c}const i=e==="aes-encrypt"||e==="aes-decrypt"?this.lastIndex=(this.lastIndex+1)%this.sendPorts.length:0;return this.invoke("invoke",n,void 0,this.sendPorts[i],r)}invokeCrypto(e,...s){return this.invokeCryptoNew({method:e,args:s})}}const be=new mn;y&&(y.cryptoMessagePort=be);function pn(t){return["image/jpeg","image/png","image/gif","image/svg+xml","image/webp","image/bmp","video/mp4","video/webm","video/quicktime","audio/ogg","audio/mpeg","audio/mp4","audio/wav","application/json","application/pdf"].indexOf(t)===-1?"application/octet-stream":t}function ys(t,e=""){Array.isArray(t)||(t=[t]);const s=pn(e);return new Blob(t,{type:s})}class Fn{constructor(e,s,r){this.mimeType=e,this.size=s,this.saveFileCallback=r,this.bytes=new Uint8Array(s)}async write(e,s){const r=s+e.byteLength;if(r>this.bytes.byteLength){const n=new Uint8Array(r);n.set(this.bytes,0),this.bytes=n}this.bytes.set(e,s)}truncate(){this.bytes=new Uint8Array}trim(e){this.bytes=this.bytes.slice(0,e)}finalize(e=!0){const s=ys(this.bytes,this.mimeType);return e&&this.saveFileCallback&&this.saveFileCallback(s),s}getParts(){return this.bytes}replaceParts(e){this.bytes=e}}const Te=class{constructor(t){this.dbName=t,this.useStorage=!0,V.test&&(this.dbName+="_test"),Te.STORAGES.length&&(this.useStorage=Te.STORAGES[0].useStorage),this.openDatabase(),Te.STORAGES.push(this)}openDatabase(){return this.openDbPromise??(this.openDbPromise=caches.open(this.dbName))}delete(t){return this.timeoutOperation(e=>e.delete("/"+t))}deleteAll(){return caches.delete(this.dbName)}get(t){return this.timeoutOperation(e=>e.match("/"+t))}save(t,e){return this.timeoutOperation(s=>s.put("/"+t,e))}getFile(t,e="blob"){return this.get(t).then(s=>{if(!s)throw Ie("NO_ENTRY_FOUND");return s[e]()})}saveFile(t,e){e instanceof Blob||(e=ys(e));const s=new Response(e,{headers:{"Content-Length":""+e.size}});return this.save(t,s).then(()=>e)}timeoutOperation(t){return this.useStorage?new Promise(async(e,s)=>{let r=!1;const n=setTimeout(()=>{s(),r=!0},15e3);try{const o=await this.openDatabase();if(!o)throw this.useStorage=!1,this.openDbPromise=void 0,"no cache?";const i=await t(o);if(r)return;e(i)}catch(o){s(o)}clearTimeout(n)}):Promise.reject(Ie("STORAGE_OFFLINE"))}prepareWriting(t,e,s){return{deferred:H(),getWriter:()=>new Fn(s,e,n=>this.saveFile(t,n).catch(()=>n))}}static toggleStorage(t,e){return Promise.all(this.STORAGES.map(s=>{if(s.useStorage=t,!!e&&!t)return s.deleteAll()}))}};let ws=Te;ws.STORAGES=[];function Vt(t,e){return Promise.all([We.toggleStorage(t,e),ws.toggleStorage(t,e),L.toggleStorage(t,e)]).then(pe,pe)}class En extends Ft{constructor(){super("SERVICE"),y&&(y.serviceMessagePort=this)}}const vn=""+new URL("sw-015fe10f.js",import.meta.url).href;class Cn extends Ce{constructor(){super(),this.onMirrorTask=e=>{var i;const{name:s,key:r,value:n}=e;if(!e.hasOwnProperty("key")){this.mirrors[s]=n;return}const o=(i=this.mirrors)[s]??(i[s]={});n===void 0?delete o[r]:o[r]=n},this.mirrors={},this.tabState={chatPeerIds:[],idleStartTime:0},this.log("constructor"),this.registerWorker(),this.registerServiceWorker(),this.registerCryptoWorker(),this.addMultipleEventsListeners({convertWebp:({fileName:e,bytes:s})=>ds.convert(e,s),convertOpus:({fileName:e,bytes:s})=>_s.pushDecodeTask(s,!1).then(r=>r.bytes),event:({name:e,args:s})=>{C.dispatchEventSingle(e,...s)},localStorageProxy:e=>{const s=e;return L[s.type](...s.args)},mirror:this.onMirrorTask}),C.addEventListener("language_change",e=>{C.managers.networkerFactory.setLanguage(e)}),window.addEventListener("online",()=>{C.managers.networkerFactory.forceReconnectTimeout()}),C.addEventListener("logging_out",()=>{const e=["cachedFiles","cachedStreamChunks"];Promise.all([Vt(!1,!0),L.clear(),Promise.race([Et.setAuthorized(!1),pt(3e3)]),Ne.forceUnsubscribe(),Promise.all(e.map(s=>caches.delete(s)))]).finally(()=>{fs.reload()})}),Be.addEventListener("change",e=>{this.updateTabStateIdle(e)}),this.updateTabStateIdle(Be.isIdle),this.log("Passing environment:",Nt),this.invoke("environment",Nt)}pingServiceWorkerWithIframe(){if(this.pingServiceWorkerPromise)return this.pingServiceWorkerPromise;const e=this.pingServiceWorkerPromise=H(),s=document.createElement("iframe");s.hidden=!0;const r=()=>{setTimeout(()=>{this.pingServiceWorkerPromise=void 0},1e4),clearTimeout(n),s.remove(),s.removeEventListener("load",r),s.removeEventListener("error",r),e.resolve()};s.addEventListener("load",r),s.addEventListener("error",r),s.src="ping/"+(Math.random()*4294967295|0)+".nocache",document.body.append(s);const n=window.setTimeout(r,1e3);return e}attachServiceWorker(e){this.lastServiceWorker&&this.serviceMessagePort.detachPort(this.lastServiceWorker),this.serviceMessagePort.attachSendPort(this.lastServiceWorker=e),this.serviceMessagePort.invokeVoid("hello",void 0)}_registerServiceWorker(){navigator.serviceWorker.register(vn,{type:"module",scope:"./"}).then(e=>{this.log("SW registered",e);const s=new URL(window.location.href),r="swfix",n=+s.searchParams.get(r)||0;if(e.active&&!navigator.serviceWorker.controller){if(n>=3)throw new Error("no controller");return e.unregister().then(()=>{s.searchParams.set(r,""+(n+1)),window.location.href=s.toString()})}n&&(s.searchParams.delete(r),history.pushState(void 0,"",s)),(e.installing||e.waiting||e.active).addEventListener("statechange",c=>{this.log("SW statechange",c)});const i=navigator.serviceWorker.controller||e.installing||e.waiting||e.active;this.attachServiceWorker(i)}).catch(e=>{this.log.error("SW registration failed!",e),this.invokeVoid("serviceWorkerOnline",!1)})}registerServiceWorker(){if(!("serviceWorker"in navigator))return;this.serviceMessagePort=Ne.serviceMessagePort=new En;const e=navigator.serviceWorker;this._registerServiceWorker(),e.addEventListener("controllerchange",()=>{this.log.warn("controllerchange");const s=e.controller;this.attachServiceWorker(s),s.addEventListener("error",r=>{this.log.error("controller error:",r)})}),this.serviceMessagePort.attachListenPort(e),this.serviceMessagePort.addMultipleEventsListeners({port:(s,r,n)=>{this.invokeVoid("serviceWorkerPort",void 0,void 0,[n.ports[0]])},hello:(s,r)=>{this.serviceMessagePort.resendLockTask(r)},share:s=>{this.log("will try to share something"),this.share=s}}),e.addEventListener("messageerror",s=>{this.log.error("SW messageerror:",s)})}async registerCryptoWorker(){const e=g=>fetch(g).then(d=>d.text()).then(d=>{const F=location.pathname.split("/");F[F.length-1]="";const S=location.origin+F.join("/");return d=d.replace(/(import (?:.+? from )?['"])\//g,"$1"+S),new Blob([d],{type:"application/javascript"})}),s={construct(g,d){return{url:Zt(d[0]).toString()}}},r=[Worker,typeof SharedWorker<"u"&&SharedWorker].filter(Boolean);r.forEach(g=>window[g.name]=new Proxy(g,s));const n=new Worker(new URL(""+new URL("crypto.worker-ccfc0e7a.js",import.meta.url).href,self.location),{type:"module"});r.forEach(g=>window[g.name]=g);const o=n.url,i=g=>new a(g,{type:"module"}),c=g=>this.attachWorkerToPort(g,be,"crypto"),a=Oe?SharedWorker:Worker;be.addEventListener("port",(g,d,F)=>{this.invokeVoid("cryptoPort",void 0,void 0,[F.ports[0]])});const u=i(o);c(u);const h=await e(o);(await this.invoke("createProxyWorkerURLs",{originalUrl:o,blob:h})).slice(1).map(i).forEach(c)}registerWorker(){let e;Oe?e=new SharedWorker(new URL(""+new URL("mtproto.worker-76ae8eb5.js",import.meta.url).href,self.location),{type:"module"}):e=new Worker(new URL(""+new URL("mtproto.worker-76ae8eb5.js",import.meta.url).href,self.location),{type:"module"}),this.onWorkerFirstMessage(e)}attachWorkerToPort(e,s,r){const n=e.port||e;s.attachPort(n),e.addEventListener("error",o=>{this.log.error(r,"worker error",o)})}onWorkerFirstMessage(e){this.log("set webWorker"),this.attachWorkerToPort(e,this,"mtproto")}loadState(){return Promise.all([gn().then(e=>(this.newVersion=e.newVersion,this.oldVersion=e.oldVersion,this.mirrors.state=e.state,e))])}sendState(){return this.loadState().then(e=>{const[s]=e;return this.invoke("state",{...s,userId:C.myId.toUserId()}),e})}invokeCrypto(e,...s){return be.invokeCrypto(e,...s)}async toggleStorages(e,s){await Vt(e,s),this.invoke("toggleStorages",{enabled:e,clearWrite:s}),this.serviceMessagePort?.invokeVoid("toggleStorages",{enabled:e,clearWrite:s})}async getMirror(e){return this.mirrors[e]}getState(){return this.getMirror("state")}updateTabState(e,s){this.tabState[e]=s,this.invokeVoid("tabState",this.tabState)}updateTabStateIdle(e){this.updateTabState("idleStartTime",e?Date.now():0)}}const ks=new Cn;y.apiManagerProxy=ks;const Ge=ks,Ps={};q&&(window.DEBUG_MANAGER_REQUESTS=Ps);function Sn(t,e){return new Proxy({},{get:(r,n,o)=>(...i)=>{const c=Ge.invoke("manager",{name:t,method:n,args:i},e);return q&&Ps[t]?.has(n)&&console.warn("manager request",t,n,i,e),c}})}function Gt(t,e){return new Proxy(t,{get:(s,r,n)=>s[r]??(s[r]=Sn(r,e))})}let de;function _n(){return de||(de=Gt({},!1),de.acknowledged=Gt({},!0),de)}function yn(t,e,s){return Math.min(s,Math.max(e,t))}function $(t,e,s){t/=255,e/=255,s/=255;const r=Math.max(t,e,s),n=r-Math.min(t,e,s),o=n&&(r===t?(e-s)/n:r==e?2+(s-t)/n:4+(t-e)/n);return[60*(o<0?o+6:o),r&&n/r,r]}function _t(t,e,s){const r=(n,o=(n+t/60)%6)=>Math.round((s-s*e*Math.max(Math.min(o,4-o,1),0))*255);return[r(5),r(3),r(1)]}function As(t,e,s,r=1){t/=255,e/=255,s/=255;const n=Math.max(t,e,s),o=Math.min(t,e,s);let i,c;const a=(n+o)/2;if(n===o)i=c=0;else{const u=n-o;switch(c=a>.5?u/(2-n-o):u/(n+o),n){case t:i=(e-s)/u+(e<s?6:0);break;case e:i=(s-t)/u+2;break;case s:i=(t-e)/u+4;break}i/=6}return{h:i*360,s:c*100,l:a*100,a:r}}function wn(t,e,s,r){t/=360,e/=100,s/=100;let n,o,i;if(e===0)n=o=i=s;else{const c=function(m,p,g){return g<0&&(g+=1),g>1&&(g-=1),g<.16666666666666666?m+(p-m)*6*g:g<.5?p:g<.6666666666666666?m+(p-m)*(.6666666666666666-g)*6:m},a=s<.5?s*(1+e):s+e-s*e,u=2*s-a;n=c(u,a,t+1/3),o=c(u,a,t),i=c(u,a,t-1/3)}return[n,o,i,r].map(c=>Math.round(c*255))}function kn(t){const e=t.slice(5,-1).split(", "),s=+e.pop(),r=e.map(n=>n.endsWith("%")?+n.slice(0,-1):+n);return wn(r[0],r[1],r[2],s)}function bs(t){const e=[],s=t[0]==="#"?1:0;if(t.length===5+s&&(t=(s?"#":"")+"0"+t.slice(s)),t.length===3+s)for(let r=s;r<t.length;++r)e.push(parseInt(t[r]+t[r],16));else if(t.length===4+s){for(let r=s;r<t.length-1;++r)e.push(parseInt(t[r]+t[r],16));e.push(parseInt(t[t.length-1],16))}else for(let r=s;r<t.length;r+=2)e.push(parseInt(t.slice(r,r+2),16));return e}function j(t){return bs(t.slice(0,7))}function Bo(t){const e=bs(t);return As(e[0],e[1],e[2],e[3])}function fe(t){return"#"+t.map(e=>("0"+e.toString(16)).slice(-2)).join("")}function Pn(t){return fe(kn(t))}function An(t){return Pn(t).slice(0,-2)}function et(t,e,s){const r=new Array(3);for(let n=0;n<3;++n){const o=t[n],i=e[n];r[n]=Math.floor(i+(o-i)*s)}return r}function Yt(t){return(t[0]*.2126+t[1]*.7152+t[2]*.0722)/255}function bn(t,e){return t.map((s,r)=>Math.round((s+e[r])/2))}function Tn(t,e,s){const r=$(...e),n=$(...s),o=Math.min(1.5*r[1]/t[1],1);return r[0]=Math.min(360,n[0]-r[0]+t[0]),r[1]=Math.min(1,n[1]*t[1]/r[1]),r[2]=Math.min(1,(n[2]/r[2]+o-1)*t[2]/o),r[2]<.3?s:_t(...r)}function Ln(t,e,s,r){const n=$(...s);if(Math.min(Math.abs(n[0]-t[0]),Math.abs(n[0]-t[0]-360))>30)return s;const i=Math.min(1.5*n[1]/t[1],1);n[0]=Math.min(360,n[0]+e[0]-t[0]),n[1]=Math.min(1,n[1]*e[1]/t[1]),n[2]=Math.min(1,n[2]*(1-i+i*e[2]/t[2]));let c=_t(...n);const a=Yt(s),u=Yt(c);if(r?a>u:a<u){const p=.4*a/u+.6;c=In(c,p)}return c}function In(t,e){return t.map(s=>yn(Math.round(s*e),0,255))}function Ts(t){const e=(t<0?16777215+t:t).toString(16);return"#"+(e.length>=6?e:"0".repeat(6-e.length)+e)}function ke(t){return j(Ts(t))}function xo(t){return t.settings?[t.settings.background_color,t.settings.second_background_color,t.settings.third_background_color,t.settings.fourth_background_color].filter(Boolean).map(Ts).join(","):""}function Ls(t,e,s,r,n=!0){if(t<s&&e<r&&n)return k(t,e);let o=s,i=r;return t/e>s/r?i=e*s/t|0:(o=t*r/e|0,o>s&&(i=i*s/o|0,o=s)),n&&o>=t&&i>=e&&(o=t,i=e),k(o,i)}y.calcImageInBox=Ls;class Mn{constructor(e=0,s=e){this.width=e,this.height=s}aspect(e,s){return Ls(this.width,this.height,e.width,e.height,s)}aspectFitted(e){return this.aspect(e,!0)}aspectCovered(e){return this.aspect(e,!1)}}function k(t,e){return new Mn(t,e)}var Rn=(t=>(t[t.mobile=0]="mobile",t[t.medium=1]="medium",t[t.large=2]="large",t))(Rn||{});const On=600,Bn=1275,xn=1680,zt=k(20,20),jt=k(36,36),Ht=k(18,18);class Nn extends ee{constructor(){super(),this.screenSizes=[{key:0,value:On},{key:1,value:Bn},{key:2,value:xn}],this.sizes={handhelds:{regular:k(270,270),webpage:k(270,200),album:k(270,0),esgSticker:k(68,68),animatedSticker:k(180,180),staticSticker:k(180,180),emojiSticker:k(112,112),poll:k(240,0),round:k(240,240),documentName:k(200,0),invoice:k(270,270),extendedInvoice:k(270,270),customEmoji:zt,esgCustomEmoji:jt,emojiStatus:Ht,popupSticker:k(68,68)},desktop:{regular:k(420,340),webpage:k(420,340),album:k(420,0),esgSticker:k(72,72),animatedSticker:k(200,200),staticSticker:k(200,200),emojiSticker:k(112,112),poll:k(330,0),round:k(280,280),documentName:k(240,0),invoice:k(320,320),extendedInvoice:k(420,340),customEmoji:zt,esgCustomEmoji:jt,emojiStatus:Ht,popupSticker:k(80,80)}},this.isMobile=!1,this.handleResize=()=>{const e=window.innerWidth;let s=this.screenSizes[0].key;for(let n=this.screenSizes.length-1;n>=0;--n)if(this.screenSizes[n].value<e){s=(this.screenSizes[n+1]||this.screenSizes[n]).key;break}const r=this.activeScreen;this.activeScreen=s,this.isMobile=this.activeScreen===0,this.active=this.isMobile?this.sizes.handhelds:this.sizes.desktop,r!==s&&r!==void 0&&this.dispatchEvent("changeScreen",r,s),r!==void 0&&this.dispatchEvent("resize")},window.addEventListener("resize",()=>{this.rAF&&window.cancelAnimationFrame(this.rAF),this.rAF=window.requestAnimationFrame(()=>{this.handleResize(),this.rAF=0})}),this.handleResize()}}const Is=new Nn;y.mediaSizes=Is;class Un{constructor(){this.resetCache=()=>{this.computedStyle=void 0;const e=this.cache;this.cache={};for(const s in e)this.getProperty(s)},this.cache={},C.addEventListener("theme_changed",this.resetCache),Is.addEventListener("resize",this.resetCache)}getProperty(e){let s=this.cache[e];return s!==void 0?s:(this.computedStyle??(this.computedStyle=window.getComputedStyle(document.documentElement)),s=this.computedStyle.getPropertyValue("--"+e).trim(),this.setPropertyCache(e,s))}getPropertyAsSize(e){const s=this.getProperty(e);let r;return s[s.length-1]==="%"||(s.indexOf("rem")?r=+s.replace("rem","")*16:r=+s.replace("px","")),r}setPropertyCache(e,s){return this.cache[e]=s}}const Dt=new Un;y&&(y.customProperties=Dt);const $t={"primary-color":{rgb:!0,light:!0,lightFilled:!0,dark:!0,darkRgb:!0},"message-out-primary-color":{lightFilled:!0},"surface-color":{rgb:!0},"danger-color":{light:!0,dark:!0},"primary-text-color":{rgb:!0},"secondary-text-color":{light:!0,lightFilled:!0},"message-background-color":{light:!0,lightFilled:!0,dark:!0,darkFilled:!0},"message-out-background-color":{light:!0,lightFilled:!0,dark:!0,darkFilled:!0},"saved-color":{lightFilled:!0},"green-color":{}},tt={day:{"primary-color":"#3390ec","message-out-primary-color":"#4fae4e","message-background-color":"#ffffff","surface-color":"#ffffff","danger-color":"#df3f40","primary-text-color":"#000000","secondary-text-color":"#707579","saved-color":"#359AD4","green-color":"#70b768"},night:{"primary-color":"#8774E1","message-out-primary-color":"#8774E1","message-background-color":"#212121","surface-color":"#212121","danger-color":"#ff595a","primary-text-color":"#ffffff","secondary-text-color":"#aaaaaa","saved-color":"#8774E1","green-color":"#5CC85E"}};class Wn{constructor(){C.addEventListener("theme_change",()=>{this.setTheme()})}get themeColorElem(){return this._themeColorElem!==void 0?this._themeColorElem:this._themeColorElem=document.head.querySelector('[name="theme-color"]')||null}setThemeColor(e=this.themeColor){e||(e=this.isNight()?"#212121":"#ffffff");const s=this.themeColorElem;s&&s.setAttribute("content",e)}setThemeListener(){try{const e=window.matchMedia("(prefers-color-scheme: dark)"),s=()=>{this.systemTheme=e.matches?"night":"day",C.myId?C.dispatchEvent("theme_change"):this.setTheme()};"addEventListener"in e?e.addEventListener("change",s):"addListener"in e&&e.addListener(s),s()}catch{}}applyHighlightningColor(){let e;const s=this.getTheme();s.settings?.highlightningColor?(e=s.settings.highlightningColor,document.documentElement.style.setProperty("--message-highlightning-color",e)):document.documentElement.style.removeProperty("--message-highlightning-color"),!Z&&e&&(this.themeColor=An(e))}setTheme(){const e=this.isNight();document.head.querySelector('[name="color-scheme"]')?.setAttribute("content",e?"dark":"light"),document.documentElement.classList.toggle("night",e),this.setThemeColor();const r=this.getTheme();this.applyTheme(r);let n=this.styleElement;n||(n=this.styleElement=document.createElement("style"),document.head.append(n));const o=document.createElement("div");this.applyTheme(C.settings.themes.find(i=>i.name==="night"),o),n.textContent=`.night {${o.style.cssText}}`,this.applyHighlightningColor(),C.dispatchEventSingle("theme_changed")}async switchTheme(e){await C.managers.appStateManager.setByKey("settings.theme",e),C.dispatchEvent("theme_change")}isNight(){return this.getTheme().name==="night"}getTheme(e=C.settings.theme==="system"?this.systemTheme:C.settings.theme){return C.settings.themes.find(s=>s.name===e)}bindColorApplier(e){const s=new Set;return{applyAppColor:r=>(s.add(r.name),this.applyAppColor({...r,...e})),finalize:()=>{const r=e.isNight;for(const n in $t)s.has(n)||this.applyAppColor({name:n,hex:tt[r?"night":"day"][n],...e})}}}applyAppColor({name:e,hex:s,element:r,lightenAlpha:n=.08,darkenAlpha:o=n,mixColor:i,isNight:c=this.isNight()}){const a=$t[e],u=j(s),h=As(...u);i??(i=j(tt[c?"night":"day"]["surface-color"]));const m=et(u,i,n),p={...h,l:h.l-o*100},g=[[e,s],a.rgb&&[e+"-rgb",u.join(",")],a.light&&["light-"+e,`rgba(${u[0]}, ${u[1]}, ${u[2]}, ${n})`],a.lightFilled&&["light-filled-"+e,fe(m)],a.dark&&["dark-"+e,`hsl(${p.h}, ${p.s}%, ${p.l}%)`]],d=r===document.documentElement;g.filter(Boolean).forEach(([F,S])=>{r.style.setProperty("--"+F,S),d&&Dt.setPropertyCache(F,S)})}async applyNewTheme(e){const s=this.isNightTheme(e),r=this.getTheme(),n=C.settings.themes,o=e.settings.find(c=>c.base_theme._===(s?"baseThemeNight":"baseThemeClassic")),i={...e,name:r.name,settings:{...o,highlightningColor:""}};await this.AppBackgroundTab.setBackgroundDocument(o.wallpaper,i.settings),n[n.indexOf(r)]=i,await C.managers.appStateManager.setByKey("settings.themes",C.settings.themes),C.dispatchEvent("theme_change")}isNightTheme(e){return e.name==="night"||this.isNight()}applyTheme(e,s=document.documentElement){const r=this.isNightTheme(e),n=Array.isArray(e.settings)?e.settings.find(P=>P.base_theme._===(r?"baseThemeNight":"baseThemeClassic")):e.settings,o=tt[r?"night":"day"];let i=$(...j(o["primary-color"])),c=$(...ke(n.accent_color));const a=Ln(i,c,j(o["primary-color"]),!r),u=fe(a),{applyAppColor:h,finalize:m}=this.bindColorApplier({element:s,isNight:r});if(h({name:"primary-color",hex:u,darkenAlpha:.04}),h({name:"saved-color",hex:u,lightenAlpha:.64,mixColor:[255,255,255]}),!n.message_colors?.length)return;const p=r?.92:.12,g=j(o["message-out-primary-color"]);i=$(...g);const d=et(g,j(o["surface-color"]),p);let S=ke(n.message_colors[0]);n.message_colors.length>1&&(n.message_colors.slice(1).forEach(P=>{S=bn(S,ke(P))}),S=Tn(i,d,S)),c=$(...S);const T=n.outbox_accent_color!==void 0&&$(...ke(n.outbox_accent_color)),E=et(S,j(o["surface-color"]),p);h({name:"message-out-background-color",hex:fe(E),lightenAlpha:p}),h({name:"message-out-primary-color",hex:r?"#ffffff":fe(T?_t(...T):S),mixColor:E}),m()}getThemeParamsForWebView(){const e={bg_color:"surface-color",button_color:"primary-color",button_text_color:"#ffffff",hint_color:"secondary-text-color",link_color:"link-color",secondary_bg_color:"background-color-true",text_color:"primary-text-color"},s={};for(const r in e){const n=e[r];s[r]=n[0]==="#"?n:Dt.getProperty(n)}return s}}const Ms=new Wn;y&&(y.themeController=Ms);class Vn extends ee{constructor(){super(...arguments),this.overlaysActive=0}get isOverlayActive(){return this.overlaysActive>0}set isOverlayActive(e){this.overlaysActive+=e?1:-1,this.dispatchEvent("change",this.isOverlayActive)}}const st=new Vn;function No(t,e=t.split("?")){return Rs(e?.[1])}function Rs(t){const e={};return t&&t.split("&").forEach(s=>{const[r,n=""]=s.split("=");e[r]=decodeURIComponent(n)}),e}const Gn="onbeforeinstallprompt"in window;let gt;function Yn(){window.addEventListener("beforeinstallprompt",t=>{gt=async()=>{t.prompt();const{outcome:e}=await t.userChoice;e==="accepted"&&(gt=void 0)}})}function Uo(){return gt}const yt=["January","February","March","April","May","June","July","August","September","October","November","December"],zn=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Fe=yt.slice(),ft=zn.slice(),Ee=86400;function jn(){const t=O.getDateTimeFormat({weekday:"long"}),e=new Date(Date.UTC(2017,0,2)),s=[];for(let r=0;r<7;++r)s.push(Ve(t.format(e))),e.setDate(e.getDate()+1);return s}function Hn(){const t=O.getDateTimeFormat({month:"long"}),e=new Date(Date.UTC(2017,0,1)),s=[];for(let r=0;r<12;++r)s.push(Ve(t.format(e))),e.setMonth(e.getMonth()+1);return s}function qt(){Fe.splice(0,Fe.length,...Hn()),ft.splice(0,ft.length,...jn())}const Kt=t=>{const e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),s=e.getUTCDay()||7;e.setUTCDate(e.getUTCDate()+4-s);const r=new Date(Date.UTC(e.getUTCFullYear(),0,1));return Math.ceil(((e.getTime()-r.getTime())/Ee+1)/7)};function $n(t){const e=new Date,s=e.getTime()/1e3|0,r=t.getTime()/1e3|0,n={};return s-r<Ee&&e.getDate()===t.getDate()?n.hour=n.minute="2-digit":e.getFullYear()!==t.getFullYear()?(n.year=n.day="numeric",n.month="2-digit"):s-r<Ee*7&&Kt(e)===Kt(t)?n.weekday="short":(n.month="short",n.day="numeric"),new O.IntlDateElement({date:t,options:n}).element}function qn(t,e={}){const s=new Date,r=new Date(t*1e3),n=s.getTime()/1e3,o=Kn(r);let i;return n-t<Ee&&s.getDate()===r.getDate()?i=Re(e.capitalize?"Date.Today":"Peer.Status.Today"):n-t<Ee*2&&s.getDate()-1===r.getDate()?(i=Re(e.capitalize?"Yesterday":"Peer.Status.Yesterday"),e.capitalize&&(i.style.textTransform="capitalize")):s.getFullYear()!==r.getFullYear()?i=new O.IntlDateElement({date:r,options:{month:"short",day:"numeric",year:"numeric"}}).element:i=new O.IntlDateElement({date:r,options:{month:"short",day:"numeric"}}).element,{dateEl:i,timeEl:o}}function Wo(t,e=!0){const{dateEl:s,timeEl:r}=qn(t,{capitalize:e}),n=document.createDocumentFragment();return n.append(s," ",Re("ScheduleController.at")," ",r),n}function Kn(t){return new O.IntlDateElement({date:t,options:{hour:"2-digit",minute:"2-digit"}}).element}y&&(y.formatDateAccordingToTodayNew=$n);const Vo=(t,e={})=>{const s=e.monthAsNumber?".":" ",r=("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2)+(e.noSeconds?"":":"+("0"+t.getSeconds()).slice(-2));return(e.leadingZero?("0"+t.getDate()).slice(-2):t.getDate())+s+(e.monthAsNumber?("0"+(t.getMonth()+1)).slice(-2):yt[t.getMonth()])+s+t.getFullYear()+(e.noTime?"":", "+r)},G=2013,Xn=new RegExp("20[0-9]{1,2}"),wt="\\p{L}",Jn=new RegExp(`(${wt}{3,})`,"iu"),Zn=new RegExp(`(${wt}{3,}) ([0-9]{0,4})`,"iu"),Qn=new RegExp(`([0-9]{0,4}) (${wt}{2,})`,"iu"),eo=new RegExp("^([0-9]{1,4})(\\.| |/|\\-)([0-9]{1,4})$","i"),to=new RegExp("^([0-9]{1,2})(\\.| |/|\\-)([0-9]{1,2})(\\.| |/|\\-)([0-9]{1,4})$","i"),so=[31,29,31,30,31,30,31,31,30,31,30,31];function ro(t,e){const s=t.trim().toLowerCase();if(s.length<3)return;if(["today",O.format("Peer.Status.Today",!0)].some(o=>o.indexOf(s)===0)){const o=new Date,i=o.getFullYear(),c=o.getMonth(),a=o.getDate();o.setFullYear(i,c,a),o.setHours(0,0,0);const u=o.getTime();o.setFullYear(i,c,a+1),o.setHours(0,0,0);const h=o.getTime()-1;e.push({title:O.format("Date.Today",!0),minDate:u,maxDate:h});return}if(["yesterday",O.format("Peer.Status.Yesterday",!0)].some(o=>o.indexOf(s)===0)){const o=new Date,i=o.getFullYear(),c=o.getMonth(),a=o.getDate();o.setFullYear(i,c,a),o.setHours(0,0,0);const u=o.getTime()-864e5;o.setFullYear(i,c,a+1),o.setHours(0,0,0);const h=o.getTime()-86400001;e.push({title:Ve(O.format("Yesterday",!0)),minDate:u,maxDate:h});return}const r=ao(s);if(r>=0){const o=new Date,i=o.getTime(),c=o.getDay(),a=r-c;o.setDate(o.getDate()+a),o.getTime()>i&&o.setTime(o.getTime()-6048e5);const u=o.getFullYear(),h=o.getMonth(),m=o.getDate();o.setFullYear(u,h,m),o.setHours(0,0,0);const p=o.getTime();o.setFullYear(u,h,m+1),o.setHours(0,0,0);const g=o.getTime()-1;e.push({title:Bs(p),minDate:p,maxDate:g});return}let n;if((n=eo.exec(s))!==null){const o=n[1],i=n[3],c=parseInt(o),a=parseInt(i);if(c>0&&c<=31){if(a>=G&&c<=12){const u=a,h=c-1;De(e,h,u);return}else if(a<=12){const u=c-1,h=a-1;rt(e,u,h)}}else if(c>=G&&a<=12){const u=c,h=a-1;De(e,h,u)}return}if((n=to.exec(s))!==null){const o=n[1],i=n[3],c=n[5];if(!n[2]===n[4])return;const a=parseInt(o),u=parseInt(i)-1;let h=parseInt(c);h>=10&&h<=99&&(h+=2e3);const m=new Date().getFullYear();if(xs(a-1,u)&&h>=G&&h<=m){const p=new Date;p.setFullYear(h,u,a),p.setHours(0,0,0);const g=p.getTime();p.setFullYear(h,u,a+1),p.setHours(0,0,0);const d=p.getTime()-1;e.push({title:Os(g),minDate:g,maxDate:d});return}return}if((n=Zn.exec(s))!==null){const o=n[1],i=n[2],c=nt(o);if(c>=0){const a=+i||new Date().getUTCFullYear();if(a>0&&a<=31){const u=a-1;rt(e,u,c);return}else if(a>=G){De(e,c,a);return}}}if((n=Qn.exec(s))!==null){const o=n[1],i=n[2],c=nt(i);if(c>=0){const a=+o;if(a>0&&a<=31){const u=a-1;rt(e,u,c);return}else a>=G&&De(e,c,a)}}if((n=Jn.exec(s))!==null){const o=n[1],i=nt(o);if(i>=0){const c=new Date().getFullYear();for(let a=c;a>=G;--a)De(e,i,a)}}if((n=Xn.exec(s))!==null){let o=+n[0];const i=new Date().getFullYear();if(o<G){o=G;for(let c=i;c>=o;c--){const a=new Date;a.setFullYear(c,0,1),a.setHours(0,0,0);const u=a.getTime();a.setFullYear(c+1,0,1),a.setHours(0,0,0);const h=a.getTime()-1;e.push({title:""+c,minDate:u,maxDate:h})}}else if(o<=i){const c=new Date;c.setFullYear(o,0,1),c.setHours(0,0,0);const a=c.getTime();c.setFullYear(o+1,0,1),c.setHours(0,0,0);const u=c.getTime()-1;e.push({title:""+o,minDate:a,maxDate:u})}return}}function De(t,e,s){const r=new Date().getFullYear(),n=Date.now();if(s>=G&&s<=r){const o=new Date;o.setFullYear(s,e,1),o.setHours(0,0,0);const i=o.getTime();if(i>n)return;o.setMonth(o.getMonth()+1);const c=o.getTime()-1;t.push({title:no(i),minDate:i,maxDate:c})}}function rt(t,e,s){if(xs(e,s)){const r=new Date().getFullYear(),n=Date.now();for(let o=r;o>=G;o--){if(s===1&&e===28&&!io(o))continue;const i=new Date;i.setFullYear(o,s,e+1),i.setHours(0,0,0);const c=i.getTime();if(c>n)continue;i.setFullYear(o,s,e+2),i.setHours(0,0,0);const a=i.getTime()-1;o===r?t.push({title:oo(c),minDate:c,maxDate:a}):t.push({title:Os(c),minDate:c,maxDate:a})}}}function no(t){const e=new Date(t);return Fe[e.getMonth()]+" "+e.getFullYear()}function oo(t){const e=new Date(t);return Fe[e.getMonth()]+" "+e.getDate()}function Os(t){const e=new Date(t);return("0"+e.getDate()).slice(-2)+"."+("0"+(e.getMonth()+1)).slice(-2)+"."+e.getFullYear()}function Bs(t){const e=new Date(t);return ft[e.getDay()]}function xs(t,e){return e>=0&&e<12&&t>=0&&t<so[e]}function io(t){return t%4===0&&t%100!==0||t%400===0}function nt(t){t=t.toLowerCase();for(let e=0;e<12;e++)if([yt[e],Fe[e]].some(s=>s.toLowerCase().indexOf(t)===0))return e;return-1}function ao(t){const e=new Date;if(t.length<=3)return-1;for(let s=0;s<7;s++)if(e.setDate(e.getDate()+1),Bs(e.getTime()).toLowerCase().indexOf(t)===0)return e.getDay();return-1}y.fillTipDates=ro;document.addEventListener("DOMContentLoaded",async()=>{Ks(),Node.prototype.replaceChildren===void 0&&(Node.prototype.replaceChildren=function(...d){this.textContent="",d&&this.append(...d)}),C.managers=_n();const t=document.getElementById("manifest");t&&(t.href=`site${ot&&!oe?"_apple":""}.webmanifest?v=jw3mK7G9Aq`),xe.start();const e=window.visualViewport||window;let s=!1,r;const n=()=>{let d=(s&&!st.isOverlayActive?e.height||e.innerHeight:window.innerHeight)*.01;d=+d.toFixed(2),r!==d&&(Z&&r<d&&d-r>1&&Lt(),r=d,document.documentElement.style.setProperty("--vh",`${d}px`))};if(window.addEventListener("resize",n),n(),Le){const d=()=>{s=F===1&&Le&&!st.isOverlayActive,n(),e!==window&&(s?(window.removeEventListener("resize",n),e.addEventListener("resize",n)):(e.removeEventListener("resize",n),window.addEventListener("resize",n)))};let F;window.onImTabChange=S=>{const A=F!==void 0;F=S,(A||F===1)&&d()},st.addEventListener("change",()=>{d()})}if(ie&&!at&&document.addEventListener("dragstart",d=>{const F=d.target;if(F.tagName==="IMG"&&F.classList.contains("emoji"))return It(d),!1}),at&&document.documentElement.classList.add("native-emoji"),document.addEventListener("dragstart",d=>{if(d.target?.tagName==="IMG")return d.preventDefault(),!1}),document.addEventListener("contextmenu",d=>{d.target.tagName==="IMG"&&!window.appMediaViewer&&It(d)}),ie&&document.documentElement.classList.add("is-firefox","no-backdrop"),Q&&document.documentElement.classList.add("is-mobile"),ot)Y&&document.documentElement.classList.add("is-safari"),oe?document.documentElement.classList.add("is-ios"):document.documentElement.classList.add("is-mac");else if(Xt){document.documentElement.classList.add("is-android");const d=()=>{S=!0,window.addEventListener("resize",F,{once:!0})},F=()=>{S=!1,Lt()};let S=!1;document.addEventListener("touchend",A=>{const T=A.target.closest('[contenteditable="true"], input');T&&document.activeElement!==T&&!S&&(console.log("input click",A,document.activeElement,T,T.matches(":focus")),window.addEventListener("resize",d,{once:!0}))})}Z?document.documentElement.classList.add("is-touch"):document.documentElement.classList.add("no-touch"),Gn&&Yn();const o=performance.now(),i=O.getCacheLangPack(),[c,a]=await Promise.all([Ge.sendState().then(([d])=>d),i]);O.setTimeFormat(c.state.settings.timeFormat),C.managers.rootScope.getPremium().then(d=>{C.premium=d}),Ms.setThemeListener(),a.appVersion!==I.langPackVersion?O.getLangPack(a.lang_code):qt(),C.addEventListener("language_change",()=>{qt()});function u(d,F){d.style.opacity="0",F.then(()=>{window.requestAnimationFrame(()=>{d.style.opacity=""})})}console.log("got state, time:",performance.now()-o),a.lang_code,document.documentElement.dir="ltr";let h=c.state.authState;const p=location.hash.split("?"),g=Rs(p[1]??p[0].slice(1));if(g.tgWebAuthToken&&h._!=="authStateSignedIn"){const d={token:g.tgWebAuthToken,dcId:+g.tgWebAuthDcId,userId:g.tgWebAuthUserId.toUserId(),isTest:g.tgWebAuthTest!==void 0&&!!+g.tgWebAuthTest,tgAddr:g.tgaddr};if(d.isTest!==V.test){const F=new URLSearchParams(location.search);+g.tgWebAuthTest?F.set("test","1"):F.delete("test"),location.search=F.toString();return}C.managers.appStateManager.pushToState("authState",h={_:"authStateSignImport",data:d})}if(h._!=="authStateSignedIn"){console.log("Will mount auth page:",h._,Date.now()/1e3);const d=document.getElementById("auth-pages");let F;if(d){F=d.querySelector(".scrollable"),(!Z||Jt)&&F.classList.add("no-scrollbar"),F.style.opacity="0";const A=document.createElement("div");A.classList.add("auth-placeholder"),F.prepend(A),F.append(A.cloneNode())}try{await Promise.all([R(()=>Promise.resolve().then(()=>Yr),void 0,import.meta.url),R(()=>Promise.resolve().then(()=>Wr),void 0,import.meta.url)]).then(([A,T])=>{A.default.setAuthorized(!1),T.default.forceUnsubscribe()})}catch{}let S;switch(h._){case"authStateSignIn":S=(await R(()=>import("./pageSignIn-b7d5a2c7.js"),["./pageSignIn-b7d5a2c7.js","./putPreloader-7a17bbfb.js","./page-13ab4361.js","./lottieLoader-fd7499bf.js","./bytesCmp-af6e57f3.js","./pageSignQR-0ca9aedf.js"],import.meta.url)).default.mount();break;case"authStateSignQr":S=(await R(()=>import("./pageSignQR-0ca9aedf.js").then(A=>A.a),["./pageSignQR-0ca9aedf.js","./page-13ab4361.js","./bytesCmp-af6e57f3.js","./putPreloader-7a17bbfb.js"],import.meta.url)).default.mount();break;case"authStateAuthCode":S=(await R(()=>import("./pageAuthCode-f4ca274b.js"),["./pageAuthCode-f4ca274b.js","./page-13ab4361.js","./pageSignIn-b7d5a2c7.js","./putPreloader-7a17bbfb.js","./lottieLoader-fd7499bf.js","./bytesCmp-af6e57f3.js","./pageSignQR-0ca9aedf.js"],import.meta.url)).default.mount(h.sentCode);break;case"authStatePassword":S=(await R(()=>import("./pagePassword-eb4c1191.js"),["./pagePassword-eb4c1191.js","./putPreloader-7a17bbfb.js","./page-13ab4361.js","./bytesCmp-af6e57f3.js","./lottieLoader-fd7499bf.js","./loginPage-4ce5cd90.js"],import.meta.url)).default.mount();break;case"authStateSignUp":S=(await R(()=>import("./pageSignUp-77203b91.js"),["./pageSignUp-77203b91.js","./loginPage-4ce5cd90.js","./page-13ab4361.js","./lottieLoader-fd7499bf.js","./bytesCmp-af6e57f3.js","./putPreloader-7a17bbfb.js"],import.meta.url)).default.mount(h.authCode);break;case"authStateSignImport":S=(await R(()=>import("./pageSignImport-7acffe11.js"),["./pageSignImport-7acffe11.js","./putPreloader-7a17bbfb.js","./page-13ab4361.js"],import.meta.url)).default.mount(h.data);break}if(F){S&&await S;const A="fonts"in document?Promise.race([pt(1e3),document.fonts.ready]):Promise.resolve();u(F,A)}}else console.log("Will mount IM page:",Date.now()/1e3),u(document.getElementById("main-columns"),$s()),(await R(()=>import("./pageIm-ac332334.js"),["./pageIm-ac332334.js","./page-13ab4361.js"],import.meta.url)).default.mount()});export{st as $,I as A,Qt as B,jr as C,q as D,ee as E,yo as F,Ie as G,pe as H,Z as I,Xe as J,ut as K,is as L,y as M,M as N,Jt as O,z as P,Ls as Q,k as R,x as S,Eo as T,go as U,Q as V,bo as W,zs as X,js as Y,mt as Z,R as _,C as a,_n as a$,ae as a0,ns as a1,Ze as a2,Ro as a3,an as a4,Xs as a5,fr as a6,vo as a7,Bo as a8,ls as a9,Vo as aA,Gr as aB,Nr as aC,Js as aD,No as aE,qr as aF,Sr as aG,zr as aH,Be as aI,po as aJ,ko as aK,ht as aL,Co as aM,_s as aN,Le as aO,ho as aP,Mt as aQ,et as aR,As as aS,Jr as aT,mo as aU,Oe as aV,er as aW,xe as aX,kr as aY,Zs as aZ,Qs as a_,fo as aa,Lo as ab,So as ac,To as ad,Ee as ae,Kn as af,hs as ag,Wo as ah,qn as ai,Do as aj,Io as ak,tr as al,Fr as am,$n as an,_r as ao,Xr as ap,Fo as aq,Rn as ar,ie as as,Ao as at,cs as au,Qr as av,_o as aw,Ct as ax,St as ay,j as az,Ge as b,uo as b0,wn as b1,fe as b2,bs as b3,Ms as b4,Mn as b5,xo as b6,co as b7,Ut as b8,$r as b9,Uo as ba,ro as bb,us as bc,Zr as bd,Ne as be,fs as bf,ws as bg,_e as bh,Et as bi,Fs as bj,ds as bk,Po as bl,en as bm,ys as bn,It as c,Mo as d,O as e,L as f,Lt as g,H as h,Re as i,it as j,lo as k,$s as l,Is as m,wo as n,at as o,pt as p,oe as q,Oo as r,ne as s,Y as t,Hr as u,ot as v,Xt as w,tn as x,Dt as y,yn as z};
//# sourceMappingURL=index-754f9c9f.js.map
