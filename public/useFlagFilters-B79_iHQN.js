import{c as L,a9 as H,aQ as w,a6 as P,E as T,i as u,b as n,a5 as v,a,a2 as K,bY as W,ac as U,t as y,dR as j,af as D,aS as q,c8 as Q,aU as Y}from"./index-HSqJgTYz.js";import{I as k,B}from"./emailSetup-BUamKkuk.js";import{S as J}from"./scrollable2-CmNzxNOF.js";import{S as G}from"./index-DJy_jwrO.js";import{S as x}from"./chatBackground-Vu9g_UWZ.js";import{a9 as O}from"./appDialogsManager-BdIzaAuR.js";import{I as V}from"./iconTsx-SAombbu3.js";import{H as X}from"./heightTransition-BxC-prqj.js";const Z=(r=new Set)=>L(r,{equals:(A,i)=>A.size===i.size&&[...A].every(F=>i.has(F))}),ee=32,te="_Row_1klcf_1",ne="_RowCheckbox_1klcf_9",ie="_RowCheckboxWrapper_1klcf_14",re="_RowCheckboxCickArea_1klcf_19",oe="_RowSeparator_1klcf_23",se="_RowLabel_1klcf_29",le="_RowOffset_1klcf_38",ce="_Count_1klcf_42",ae="_CountArrow_1klcf_49",de="_toggled_1klcf_52",me="_ExpandedItems_1klcf_56",m={Row:te,RowCheckbox:ne,RowCheckboxWrapper:ie,RowCheckboxCickArea:re,RowSeparator:oe,RowLabel:se,RowOffset:le,Count:ce,CountArrow:ae,toggled:de,ExpandedItems:me},ue=y("<div><div><div></div></div><div></div><div><div>/"),ge=y("<div>"),he=y("<div><div></div><div></div><div>"),z=r=>{const[A,i]=L(!1),F=w(()=>r.items.every(e=>e.checked())),S=e=>{e.stopPropagation(),r.onMainCheckboxClick()};return[(()=>{const e=ue(),s=e.firstChild,d=s.firstChild,C=s.nextSibling,h=C.nextSibling,g=h.firstChild,c=g.firstChild;return e.$$click=()=>i(!A()),P(T,e,()=>!0),s.$$click=S,u(s,n(O,{get class(){return m.RowCheckbox},get checked(){return F()}}),d),u(h,()=>r.mainLabel,g),u(g,()=>r.checkedCount,c),u(g,()=>r.items.length,null),u(g,n(V,{get class(){return m.CountArrow},get classList(){return{[m.toggled]:A()}},icon:"arrowhead"}),null),v(l=>{const f=`${m.Row} hover-effect rp`,p=m.RowCheckboxWrapper,_=m.RowCheckboxClickArea,$=m.RowSeparator,M=m.RowLabel,E=m.Count;return f!==l._v$&&a(e,l._v$=f),p!==l._v$2&&a(s,l._v$2=p),_!==l._v$3&&a(d,l._v$3=_),$!==l._v$4&&a(C,l._v$4=$),M!==l._v$5&&a(h,l._v$5=M),E!==l._v$6&&a(g,l._v$6=E),l},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0}),e})(),n(X,{get children(){return n(K,{get when(){return A()},get children(){const e=ge();return u(e,n(W,{get each(){return r.items},children:s=>(()=>{const d=he(),C=d.firstChild,h=C.nextSibling,g=h.nextSibling;return U(d,"click",s.onClick,!0),P(T,d,()=>!0),u(h,n(O,{get class(){return m.RowCheckbox},get checked(){return s.checked()}})),u(g,()=>s.label),v(c=>{const l=`${m.Row} hover-effect rp`,f=m.RowOffset,p=m.RowCheckboxWrapper,_=m.RowLabel;return l!==c._v$7&&a(d,c._v$7=l),f!==c._v$8&&a(C,c._v$8=f),p!==c._v$9&&a(h,c._v$9=p),_!==c._v$10&&a(g,c._v$10=_),c},{_v$7:void 0,_v$8:void 0,_v$9:void 0,_v$10:void 0}),d})()})),v(()=>a(e,m.ExpandedItems)),e}})}})]};H(["click"]);const Ae="_SectionTitle_1lrbr_1",_e="_Footer_1lrbr_7",Fe="_Button_1lrbr_16",fe="_Search_1lrbr_22",ke="_Scrollable_1lrbr_26",R={SectionTitle:Ae,Footer:_e,Button:Fe,Search:fe,Scrollable:ke},Ce=y("<form>"),I=y("<div>"),Te=r=>{const{PeerTitleTsx:A}=j(),i=()=>r.filtersControls,F=()=>{r.onCommit(i().getCommittedReady())},S=e=>{e.preventDefault(),F()};return[n(K,{get when(){return r.hasSearch},get children(){return[n(x,{amount:"2px"}),(()=>{const e=Ce();return e.addEventListener("submit",S),u(e,n(G,{get value(){return i().search()},get onChange(){return i().onSearchChange},get children(){return[n(G.Label,{get children(){return n(k,{key:"Search"})}}),n(G.Input,{ref(s){const d=r.inputRef;typeof d=="function"?d(s):r.inputRef=s}})]}})),v(()=>a(e,R.Search)),e})(),n(x,{amount:"1rem"})]}}),n(J,{get class(){return R.Scrollable},withBorders:"both",relative:!0,get children(){return[(()=>{const e=I();return u(e,n(k,{key:"AdminRecentActionsFilters.ByType"})),v(()=>a(e,R.SectionTitle)),e})(),n(W,{get each(){return i().filterGroupsConfig()},children:e=>n(z,{get mainLabel(){return n(k,{get key(){return e.i18nKey}})},get checkedCount(){return i().flagGroupCheckCount(e)},onMainCheckboxClick:()=>i().onFlagGroupClick(e),get items(){return e.items.map(s=>({checked:()=>i().isFlagSelected(s.pFlag),label:n(k,{get key(){return s.i18nKey}}),onClick:()=>i().onFlagClick(s.pFlag)}))}})}),n(x,{amount:"1rem"}),(()=>{const e=I();return u(e,n(k,{key:"AdminRecentActionsFilters.ByAdmin"})),v(()=>a(e,R.SectionTitle)),e})(),n(K,{get when(){return i().adminIds().length},get children(){return n(z,{get mainLabel(){return n(k,{key:"AdminRecentActionsFilters.ShowAllAdminActions"})},get checkedCount(){return i().selectedAdminIds().size},get onMainCheckboxClick(){return i().onAllAdminsClick},get items(){return i().adminIds().map(e=>({checked:()=>i().isAdminIdSelected(e.toPeerId()),label:n(A,{get peerId(){return e.toPeerId()},limitSymbols:ee}),onClick:()=>i().onAdminClick(e.toPeerId())}))}})}}),n(K,{get when(){return i().notShowingAdmins()},get children(){const e=I();return u(e,n(k,{key:"AdminRecentActionsFilters.NotShowingAdmins",get args(){return[i().notShowingAdmins()+""]}})),v(()=>a(e,R.SectionTitle)),e}})]}}),n(x,{amount:"1rem"}),(()=>{const e=I();return u(e,n(B,{get class(){return R.Button},primary:!0,get onClick(){return r.onReset},get children(){return n(k,{key:"AdminRecentActionsFilters.ResetFilters"})}}),null),u(e,n(B,{get class(){return R.Button},primaryFilled:!0,onClick:F,get children(){return n(k,{key:"AdminRecentActionsFilters.ApplyFilters"})}}),null),v(()=>a(e,R.Footer)),e})()]};function Re({isBroadcast:r}){return[{i18nKey:"AdminRecentActionsFilters.MembersAndAdmins",items:[{pFlag:"join",i18nKey:"AdminRecentActionsFilters.NewMembers"},{pFlag:"leave",i18nKey:r?"AdminRecentActionsFilters.MembersLeftChannel":"AdminRecentActionsFilters.MembersLeftGroup"},{pFlag:"invite",i18nKey:"AdminRecentActionsFilters.InvitedMembers"},{pFlag:"ban",i18nKey:"AdminRecentActionsFilters.BannedMembers"},{pFlag:"unban",i18nKey:"AdminRecentActionsFilters.UnbannedMembers"},{pFlag:"kick",i18nKey:"AdminRecentActionsFilters.RemovedMembers"},{pFlag:"unkick",i18nKey:"AdminRecentActionsFilters.UnkickedMembers"},{pFlag:"promote",i18nKey:"AdminRecentActionsFilters.NewAdminRights"},{pFlag:"demote",i18nKey:"AdminRecentActionsFilters.RemovedAdminRights"}]},{i18nKey:r?"AdminRecentActionsFilters.ChannelSettings":"AdminRecentActionsFilters.GroupSettings",items:[{pFlag:"info",i18nKey:r?"AdminRecentActionsFilters.ChannelInfo":"AdminRecentActionsFilters.GroupInfo"},{pFlag:"settings",i18nKey:r?"AdminRecentActionsFilters.ChannelSettings":"AdminRecentActionsFilters.GroupSettings"},{pFlag:"invites",i18nKey:"AdminRecentActionsFilters.InviteLinks"},{pFlag:"group_call",i18nKey:"AdminRecentActionsFilters.GroupCall"},{pFlag:"forums",i18nKey:"AdminRecentActionsFilters.Forums"},{pFlag:"sub_extend",i18nKey:"AdminRecentActionsFilters.SubscriptionExtensions"}]},{i18nKey:"AdminRecentActionsFilters.Messages",items:[{pFlag:"send",i18nKey:"AdminRecentActionsFilters.SentMessages"},{pFlag:"delete",i18nKey:"AdminRecentActionsFilters.DeletedMessages"},{pFlag:"edit",i18nKey:"AdminRecentActionsFilters.EditedMessages"},{pFlag:"pinned",i18nKey:"AdminRecentActionsFilters.PinnedMessages"}]}]}const ve=40;function Be({channelId:r,isBroadcast:A}){const{rootScope:i}=j(),F=w(()=>Re({isBroadcast:A()})),S=()=>F().flatMap(t=>t.items.map(o=>o.pFlag)),e=()=>{const t=S();return Object.fromEntries(t.map(o=>[o,!0]))},[s]=D(r,t=>i.managers.appProfileManager.getChannelParticipants({id:t,filter:{_:"channelParticipantsAdmins"},offset:0,limit:ve})),[d,C]=L(""),[h,g]=q(e()),[c,l]=Z(),f=w(()=>s()?.participants?.filter(t=>"user_id"in t).map(t=>t.user_id)||[]),p=w(()=>{if(!s())return null;const t=f().length,o=s().count||t;return o-t>0?o-t:null}),_=w(()=>f().map(t=>t.toPeerId())),$=Q(c,(t,o)=>o.has(t.toPeerId()));return{filterGroupsConfig:F,adminIds:f,notShowingAdmins:p,setFromCommittedFilters:t=>{C(t?.search||""),g(Y(t?.flags||e())),l(new Set(t?.admins||_()))},getCommittedReady:()=>{const t=Object.entries(h).filter(([,N])=>N),o=t.length&&t.length<S().length?Object.fromEntries(t):void 0,b=c().size<_().length?Array.from(c()):void 0;return!d()&&!o&&!b?null:{search:d()||void 0,flags:o,admins:b}},search:d,selectedAdminIds:c,onSearchChange:C,onFlagClick:t=>{g(t,o=>!o)},onFlagGroupClick:t=>{const o=t.items.every(b=>h[b.pFlag]);g(t.items.map(b=>b.pFlag),!o)},onAllAdminsClick:()=>{const t=c().size===_().length;l(t?new Set:new Set(_()))},onAdminClick:t=>{const o=new Set(c());o.has(t.toPeerId())?o.delete(t.toPeerId()):o.add(t.toPeerId()),l(o)},isFlagSelected:t=>h[t],isAdminIdSelected:$,flagGroupCheckCount:t=>t.items.filter(o=>h[o.pFlag]).length}}export{Te as F,Z as c,ee as l,Be as u};
//# sourceMappingURL=useFlagFilters-B79_iHQN.js.map
