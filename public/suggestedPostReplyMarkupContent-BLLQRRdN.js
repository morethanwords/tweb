import{fU as G,c as R,b as t,i as c,dk as w,fT as v,di as N,a5 as C,a6 as f,E as S,a9 as k,t as h,d as O,a as x,K as j,de as H,dM as K,g as y,k as P}from"./index-BKArEJfv.js";import{d as $,_ as F,$ as E,Q as U,a9 as W}from"./appDialogsManager-e3KVNKCm.js";import{I as d}from"./emailSetup-Dn-rcfhb.js";import{S as l}from"./space-jLH6IJAt.js";import{P as Q}from"./publishTimeField-wLZGTd0s.js";import{u as X}from"./useAppConfig-BRK-764J.js";import"./page-tGDT43t7.js";import"./putPreloader-Bpgd7WUY.js";import"./avatar-B3piUcGv.js";import"./classNames-CN4lTu6a.js";import"./htmlToSpan-DhAls8qz.js";import"./wrapDuration-CGR38Gtg.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./toast-CzNKsOSh.js";import"./iconTsx-CEZQ1gXv.js";import"./fastBlur-Co-79rP4.js";import"./countryInputField-nKtJ2S_I.js";import"./transition-ClRFvYjQ.js";import"./scrollable2-BWCbsPxK.js";import"./chatBackground-Dh9axlMd.js";import"./tracking-DWwgOucp.js";import"./index-BVy3ZPtn.js";const q="_Description_jg6m1_1",z={Description:q};function M(){const[e]=X(),s=()=>(e()?.stars_suggested_post_commission_permille||G)/1e3;return{commission:s,formattedCommission:()=>`${Math.round(s()*100)}%`}}const B=h("<div>"),J=h('<button class="btn-primary btn-color-primary btn-large">'),V=$({name:"suggested-post-accept-with-time-popup-content",component:e=>{const[s,r]=R(),{commission:n,formattedCommission:m}=M();let a=!1;const o=()=>{a||(a=!0,O.managers.monoforumDialogsStorage.toggleSuggestedPostApproval({parentPeerId:e.peerId,messageId:e.message.mid,scheduleTimestamp:s()}),e.onFinish())};return[t(l,{amount:"0.5rem"}),(()=>{const i=B();return c(i,t(N,{get children(){return[t(w,{get when(){return e.offeredStars},get children(){return t(d,{key:"SuggestedPosts.AcceptOfferDescription.ForAdminPaid",get args(){return[t(F,{get peerId(){return e.message.fromId}}),t(d,{key:"Stars",get args(){return[E(e.offeredStars*n())]}}),m(),v+""]}})}}),t(w,{when:!0,get children(){return t(d,{key:"SuggestedPosts.AcceptOfferDescription.ForAdmin",get args(){return[t(F,{get peerId(){return e.message.fromId}})]}})}})]}})),C(()=>x(i,z.Description)),i})(),t(l,{amount:"1.5rem"}),t(Q,{noTimeLangKey:"SuggestedPosts.PublishingTime.PublishNow",get value(){return s()},onChange:r}),t(l,{amount:"2rem"}),(()=>{const i=J();return i.$$click=o,f(S,i,()=>!0),c(i,t(d,{key:"SuggestedPosts.Accept"})),i})(),t(l,{amount:"0.5rem"})]}});k(["click"]);class Y extends j{constructor({peerId:s,message:r,offeredStars:n,HotReloadGuard:m}){super("suggested-post-popup",{overlayClosable:!0,closable:!0,body:!0,title:"SuggestedPosts.AcceptOffer"});const a=new V;a.HotReloadGuard=m,a.feedProps({peerId:s,message:r,offeredStars:n,onFinish:()=>{this.hide()}}),this.body.append(a)}}const Z="_Caption_wd2cn_1",ee={Caption:Z},te=h("<div>"),se=h('<button class="btn-primary btn-color-primary btn-large">'),D=100,oe=$({name:"suggested-post-reject-popup-content",component:e=>{const[s,r]=R(""),n=()=>s().length>D;let m=!1;const a=()=>{m||n()||(m=!0,O.managers.monoforumDialogsStorage.toggleSuggestedPostApproval({parentPeerId:e.peerId,messageId:e.messageId,reject:!0,rejectComment:s()||void 0}),e.onFinish())};return[t(l,{amount:"0.5rem"}),t(H,{get value(){return s()},onRawInput:r,label:"SuggestedPosts.RejectComment.Label",maxLength:D}),(()=>{const o=te();return c(o,t(d,{key:"SuggestedPosts.RejectComment.Caption"})),C(()=>x(o,ee.Caption)),o})(),t(l,{amount:"2rem"}),(()=>{const o=se();return o.$$click=a,f(S,o,()=>!0),c(o,t(d,{key:"SuggestedPosts.Reject"})),C(()=>o.disabled=n()),o})(),t(l,{amount:"0.5rem"})]}});k(["click"]);class ne extends j{constructor({peerId:s,messageId:r}){super("suggested-post-popup",{overlayClosable:!0,closable:!0,body:!0,title:"SuggestedPosts.RejectOffer"});const n=new oe;n.feedProps({peerId:s,messageId:r,onFinish:()=>{this.hide()}}),this.body.append(n)}}const re=h('<div class=reply-markup><div class=reply-markup-row><button class=reply-markup-button><span class="reply-markup-button-text reply-markup-suggested-action"></span></button><button class=reply-markup-button><span class="reply-markup-button-text reply-markup-suggested-action"></span></button></div><div class=reply-markup-row><button class="reply-markup-button is-first is-last"><span class="reply-markup-button-text reply-markup-suggested-action">'),we=$({name:"suggested-post-reply-markup-content",component:e=>{const{rootScope:s,HotReloadGuard:r}=K(),{commission:n,formattedCommission:m}=M(),a=async()=>{const p=await s.managers.appPeersManager.canManageDirectMessages(e.message.peerId),g=e.message.suggested_post?.price?._==="starsAmount"&&+e.message.suggested_post?.price?.amount||void 0;let u=e.message.suggested_post?.schedule_date||void 0;if(u*1e3<Date.now()&&(u=void 0),p&&!u){new Y({message:e.message,peerId:e.chat.peerId,HotReloadGuard:r,offeredStars:g}).show();return}try{await U({className:"suggested-post-popup",titleLangKey:"SuggestedPosts.AcceptOffer",descriptionLangKey:p?g?"SuggestedPosts.AcceptOfferDescription.ForAdminPaid":"SuggestedPosts.AcceptOfferDescription.ForAdmin":"SuggestedPosts.AcceptOfferDescription.ForSubscriber",descriptionLangArgs:[await W({peerId:e.message.fromId,onlyFirstName:!0}),...p&&g?[P("Stars",[E((g*n()).toFixed(2))]),m(),v]:[]],button:{langKey:"SuggestedPosts.Accept"}}),await s.managers.monoforumDialogsStorage.toggleSuggestedPostApproval({parentPeerId:e.message.peerId,messageId:e.message.mid})}catch{}},o=()=>{new ne({peerId:e.message.peerId,messageId:e.message.mid}).show()},i=()=>{e.chat.input.initSuggestPostChange(e.message.mid)};return(()=>{const p=re(),g=p.firstChild,u=g.firstChild,I=u.firstChild,_=u.nextSibling,A=_.firstChild,L=g.nextSibling,b=L.firstChild,T=b.firstChild;return u.$$click=o,f(S,u,()=>!0),c(I,()=>y("crossround_filled"),null),c(I,P("SuggestedPosts.Reject"),null),_.$$click=a,f(S,_,()=>!0),c(A,()=>y("checkround_filled"),null),c(A,P("SuggestedPosts.Accept"),null),b.$$click=i,f(S,b,()=>!0),c(T,()=>y("newchat_filled"),null),c(T,P("SuggestedPosts.SuggestChanges"),null),p})()}});k(["click"]);export{we as default};
//# sourceMappingURL=suggestedPostReplyMarkupContent-BLLQRRdN.js.map
