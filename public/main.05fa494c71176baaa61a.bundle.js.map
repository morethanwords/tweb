{"version":3,"file":"main.05fa494c71176baaa61a.bundle.js","mappings":"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","sources":["webpack://tweb/webpack/runtime/chunk loaded","webpack://tweb/webpack/runtime/create fake namespace object","webpack://tweb/webpack/runtime/load script","webpack://tweb/./src/config/app.ts","webpack://tweb/./src/config/debug.ts","webpack://tweb/./src/config/state.ts","webpack://tweb/./src/helpers/getTimeFormat.ts","webpack://tweb/./src/environment/appleMx.ts","webpack://tweb/./src/environment/callSupport.ts","webpack://tweb/./src/environment/canUseTransferables.ts","webpack://tweb/./src/environment/canvasFilterSupport.ts","webpack://tweb/./src/environment/emojiSupport.ts","webpack://tweb/./src/environment/geolocationSupport.ts","webpack://tweb/./src/environment/groupCallSupport.ts","webpack://tweb/./src/environment/imageMimeTypesSupport.ts","webpack://tweb/./src/environment/mediaMimeTypesSupport.ts","webpack://tweb/./src/environment/movSupport.ts","webpack://tweb/./src/environment/opusSupport.ts","webpack://tweb/./src/environment/parallaxSupport.ts","webpack://tweb/./src/environment/screenSharingSupport.ts","webpack://tweb/./src/environment/sharedWorkerSupport.ts","webpack://tweb/./src/environment/touchSupport.ts","webpack://tweb/./src/environment/userAgent.ts","webpack://tweb/./src/environment/vibrateSupport.ts","webpack://tweb/./src/environment/videoMimeTypesSupport.ts","webpack://tweb/./src/environment/webmSupport.ts","webpack://tweb/./src/environment/webpSupport.ts","webpack://tweb/./src/environment/webrtcSupport.ts","webpack://tweb/./src/helpers/calcImageInBox.ts","webpack://tweb/./src/helpers/color.ts","webpack://tweb/./src/helpers/compareVersion.ts","webpack://tweb/./src/helpers/date.ts","webpack://tweb/./src/helpers/dom/blurActiveElement.ts","webpack://tweb/./src/helpers/dom/cancelEvent.ts","webpack://tweb/./src/helpers/dom/customProperties.ts","webpack://tweb/./src/helpers/dom/findUpClassName.ts","webpack://tweb/./src/helpers/dom/fixSafariStickyInput.ts","webpack://tweb/./src/helpers/dom/fixSafariStickyInputFocusing.ts","webpack://tweb/./src/helpers/dom/installPrompt.ts","webpack://tweb/./src/helpers/dom/loadFonts.ts","webpack://tweb/./src/helpers/dom/setInnerHTML.ts","webpack://tweb/./src/helpers/idleController.ts","webpack://tweb/./src/helpers/mediaSize.ts","webpack://tweb/./src/helpers/mediaSizes.ts","webpack://tweb/./src/helpers/number/clamp.ts","webpack://tweb/./src/helpers/overlayCounter.ts","webpack://tweb/./src/helpers/schedulers.ts","webpack://tweb/./src/helpers/string/parseUriParams.ts","webpack://tweb/./src/helpers/themeController.ts","webpack://tweb/./src/helpers/setWorkerProxy.ts","webpack://tweb/./src/environment/installPrompt.ts","webpack://tweb/./src/index.ts","webpack://tweb/./src/helpers/dom/toggleAttributePolyfill.ts","webpack://tweb/./src/lib/appManagers/appRuntimeManager.ts","webpack://tweb/./src/lib/appManagers/getProxiedManagers.ts","webpack://tweb/./src/lib/appManagers/utils/messageId/getServerMessageId.ts","webpack://tweb/./src/lib/files/idb.ts","webpack://tweb/./src/lib/langPack.ts","webpack://tweb/./src/lib/mtproto/mtproto_config.ts","webpack://tweb/./src/environment/index.ts","webpack://tweb/./src/lib/appManagers/utils/state/loadState.ts","webpack://tweb/./src/lib/mtproto/mtprotoworker.ts","webpack://tweb/./src/lib/mtproto/singleInstance.ts","webpack://tweb/./src/lib/mtproto/telegramMeWebManager.ts","webpack://tweb/./src/helpers/dom/loadScript.ts","webpack://tweb/./src/lib/mtproto/webPushApiManager.ts","webpack://tweb/./src/lib/opusDecodeController.ts","webpack://tweb/./src/lib/richTextProcessor/index.ts","webpack://tweb/./src/lib/richTextProcessor/wrapUrl.ts","webpack://tweb/./src/lib/rootScope.ts","webpack://tweb/./src/lib/webp/webpWorkerController.ts","webpack://tweb/webpack/bootstrap","webpack://tweb/webpack/runtime/compat get default export","webpack://tweb/webpack/runtime/define property getters","webpack://tweb/webpack/runtime/ensure chunk","webpack://tweb/webpack/runtime/get javascript chunk filename","webpack://tweb/webpack/runtime/get mini-css chunk filename","webpack://tweb/webpack/runtime/global","webpack://tweb/webpack/runtime/hasOwnProperty shorthand","webpack://tweb/webpack/runtime/make namespace object","webpack://tweb/webpack/runtime/publicPath","webpack://tweb/webpack/runtime/compat","webpack://tweb/webpack/runtime/jsonp chunk loading","webpack://tweb/webpack/startup"],"sourcesContent":["var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","var getProto = Object.getPrototypeOf ? (obj) => (Object.getPrototypeOf(obj)) : (obj) => (obj.__proto__);\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach((key) => (def[key] = () => (value[key])));\n\t}\n\tdef['default'] = () => (value);\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","var inProgress = {};\nvar dataWebpackPrefix = \"tweb:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t};\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n *\n * Originally from:\n * https://github.com/zhukov/webogram\n * Copyright (C) 2014 Igor Zhukov <igor.beatle@gmail.com>\n * https://github.com/zhukov/webogram/blob/master/LICENSE\n */\n\nimport type {DcId} from '../types';\n\nexport const MAIN_DOMAINS = ['web.telegram.org', 'webk.telegram.org'];\nexport const DEFAULT_BACKGROUND_SLUG = 'pattern';\n\nconst threads = Math.min(4, navigator.hardwareConcurrency ?? 4);\n\nconst App = {\n  id: +process.env.API_ID,\n  hash: process.env.API_HASH,\n  version: process.env.VERSION,\n  versionFull: process.env.VERSION_FULL,\n  build: +process.env.BUILD,\n  langPackVersion: '1.6.6',\n  langPack: 'webk',\n  langPackCode: 'en',\n  domains: MAIN_DOMAINS,\n  baseDcId: 2 as DcId,\n  isMainDomain: MAIN_DOMAINS.includes(location.hostname),\n  suffix: 'K',\n  threads,\n  cryptoWorkers: threads\n};\n\nif(App.isMainDomain) { // use Webogram credentials then\n  App.id = 2496;\n  App.hash = '8da85b0d5bfe62527e5b244c209159c3';\n}\n\nexport default App;\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport Modes from './modes';\n\nexport const IS_BETA = process.env.NODE_ENV !== 'production';\nexport const DEBUG = (IS_BETA || Modes.debug)/*  && false */;\nconst ctx: any = typeof(window) !== 'undefined' ? window : self;\nexport const MOUNT_CLASS_TO: any = DEBUG || true/*  && false */ ? ctx : {};\nexport default DEBUG;\n\n// let m = DEBUG;\n/* if(!DEBUG) {\n  ctx.sandpitTurtle = () => {\n    //if(!m) {\n      for(let i in MOUNT_CLASS_TO) {\n        ctx[i] = MOUNT_CLASS_TO[i];\n      }\n      //m = true;\n    //}\n\n    //DEBUG = !DEBUG;\n  };\n} */\n\n/* export const superDebug = (object: any, key: string) => {\n  var d = object[key];\n  var beforeStr = '', afterStr = '';\n  for(var r of d) {\n    beforeStr += r.before.hex + '\\n';\n    afterStr += r.after.hex + '\\n';\n  }\n\n  beforeStr = beforeStr.trim();\n  afterStr = afterStr.trim();\n  //var beforeStr = d.map((r) => r.before.hex).join('\\n');\n  //var afterStr = d.map((r) => r.after.hex).join('\\n');\n\n  var dada = (name: string, str: string) => {\n    var a = document.createElement('a');\n    a.target = '_blank';\n    a.download = name + '.txt';\n    a.href = URL.createObjectURL(new Blob([str], {\n      type: 'text/plain'\n    }));\n    document.body.append(a);\n    a.click();\n  };\n\n  dada(key + '_' + 'before', beforeStr);\n  dada(key + '_' + 'after', afterStr);\n}\n\nMOUNT_CLASS_TO.superDebug = superDebug; */\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport type {LiteModeKey} from '../helpers/liteMode';\nimport type {AppMediaPlaybackController} from '../components/appMediaPlaybackController';\nimport type {TopPeerType, MyTopPeer} from '../lib/appManagers/appUsersManager';\nimport type {AutoDownloadSettings, BaseTheme, NotifyPeer, PeerNotifySettings, Theme, ThemeSettings, WallPaper} from '../layer';\nimport type DialogsStorage from '../lib/storages/dialogs';\nimport type FiltersStorage from '../lib/storages/filters';\nimport type {AuthState, Modify} from '../types';\nimport {IS_MOBILE} from '../environment/userAgent';\nimport getTimeFormat from '../helpers/getTimeFormat';\nimport {nextRandomUint} from '../helpers/random';\nimport App from './app';\n\nconst STATE_VERSION = App.version;\nconst BUILD = App.build;\n\n// ! DEPRECATED\nexport type Background = {\n  type?: 'color' | 'image' | 'default', // ! DEPRECATED\n  blur: boolean,\n  highlightningColor?: string,\n  color?: string,\n  slug?: string,        // image slug\n  intensity?: number,   // pattern intensity\n  id: string | number,  // wallpaper id\n};\n\nexport type AppTheme = Modify<Theme, {\n  name: 'day' | 'night' | 'system',\n  settings?: Modify<ThemeSettings, {\n    highlightningColor: string\n  }>\n}>;\n\nexport type AutoDownloadPeerTypeSettings = {\n  contacts: boolean,\n  private: boolean,\n  groups: boolean,\n  channels: boolean\n};\n\nexport type State = {\n  allDialogsLoaded: DialogsStorage['allDialogsLoaded'],\n  pinnedOrders: DialogsStorage['pinnedOrders'],\n  // contactsList: UserId[],\n  contactsListCachedTime: number,\n  updates: Partial<{\n    seq: number,\n    pts: number,\n    date: number\n  }>,\n  // filters?: FiltersStorage['filters'], // ! DEPRECATED\n  filtersArr?: FiltersStorage['filtersArr'],\n  maxSeenMsgId: number,\n  stateCreatedTime: number,\n  recentEmoji: string[],\n  recentCustomEmoji: DocId[],\n  topPeersCache: {\n    [type in TopPeerType]?: {\n      peers: MyTopPeer[],\n      cachedTime: number\n    }\n  },\n  recentSearch: PeerId[],\n  version: typeof STATE_VERSION,\n  build: typeof BUILD,\n  authState: AuthState,\n  hiddenPinnedMessages: {[peerId: PeerId]: number},\n  settings: {\n    messagesTextSize: number,\n    distanceUnit: 'kilometers' | 'miles',\n    sendShortcut: 'enter' | 'ctrlEnter',\n    animationsEnabled?: boolean, // ! DEPRECATED\n    autoDownload: {\n      contacts?: boolean, // ! DEPRECATED\n      private?: boolean, // ! DEPRECATED\n      groups?: boolean, // ! DEPRECATED\n      channels?: boolean, // ! DEPRECATED\n      photo: AutoDownloadPeerTypeSettings,\n      video: AutoDownloadPeerTypeSettings,\n      file: AutoDownloadPeerTypeSettings\n    },\n    autoDownloadNew: AutoDownloadSettings,\n    autoPlay?: { // ! DEPRECATED\n      gifs: boolean,\n      videos: boolean\n    },\n    stickers: {\n      suggest: 'all' | 'installed' | 'none',\n      dynamicPackOrder: boolean,\n      loop: boolean\n    },\n    emoji: {\n      suggest: boolean,\n      big: boolean\n    },\n    background?: Background, // ! DEPRECATED\n    themes: AppTheme[],\n    theme: AppTheme['name'],\n    notifications: {\n      sound: boolean\n    },\n    nightTheme?: boolean, // ! DEPRECATED\n    timeFormat: 'h12' | 'h23',\n    liteMode: {[key in LiteModeKey]: boolean}\n  },\n  playbackParams: ReturnType<AppMediaPlaybackController['getPlaybackParams']>,\n  keepSigned: boolean,\n  chatContextMenuHintWasShown: boolean,\n  stateId: number,\n  notifySettings: {[k in Exclude<NotifyPeer['_'], 'notifyPeer'>]?: PeerNotifySettings.peerNotifySettings},\n  confirmedWebViews: BotId[]\n};\n\n// const BACKGROUND_DAY_MOBILE: Background = {\n//   blur: false,\n//   slug: '',\n//   color: '#dbddbb,#6ba587,#d5d88d,#88b884',\n//   highlightningColor: 'hsla(86.4, 43.846153%, 45.117647%, .4)',\n//   intensity: 0,\n//   id: '1'\n// };\n\n// const BACKGROUND_NIGHT_MOBILE: Background = {\n//   blur: false,\n//   slug: '',\n//   color: '#0f0f0f',\n//   highlightningColor: 'hsla(0, 0%, 3.82353%, 0.4)',\n//   intensity: 0,\n//   id: '-1'\n// };\n\nexport const DEFAULT_THEME: Theme = {\n  _: 'theme',\n  access_hash: '',\n  id: '',\n  settings: [{\n    _: 'themeSettings',\n    pFlags: {},\n    base_theme: {_: 'baseThemeClassic'},\n    accent_color: 0x3390ec,\n    message_colors: [0x4fae4e],\n    wallpaper: {\n      _: 'wallPaper',\n      pFlags: {\n        default: true,\n        pattern: true\n      },\n      access_hash: '',\n      document: undefined,\n      id: '',\n      slug: 'pattern',\n      settings: {\n        _: 'wallPaperSettings',\n        pFlags: {},\n        intensity: 50,\n        background_color: 0xdbddbb,\n        second_background_color: 0x6ba587,\n        third_background_color: 0xd5d88d,\n        fourth_background_color: 0x88b884\n      }\n    }\n  }, {\n    _: 'themeSettings',\n    pFlags: {},\n    base_theme: {_: 'baseThemeNight'},\n    accent_color: 0x8774E1,\n    message_colors: [0x8774E1],\n    wallpaper: {\n      _: 'wallPaper',\n      pFlags: {\n        default: true,\n        pattern: true,\n        dark: true\n      },\n      access_hash: '',\n      document: undefined,\n      id: '',\n      slug: 'pattern',\n      settings: {\n        _: 'wallPaperSettings',\n        pFlags: {},\n        intensity: -50,\n        background_color: 0xfec496,\n        second_background_color: 0xdd6cb9,\n        third_background_color: 0x962fbf,\n        fourth_background_color: 0x4f5bd5\n      }\n    }\n  }],\n  slug: '',\n  title: '',\n  emoticon: '',\n  pFlags: {default: true}\n};\n\nconst makeDefaultAppTheme = (\n  name: AppTheme['name'],\n  baseTheme: BaseTheme['_'],\n  highlightningColor: string\n): AppTheme => {\n  return {\n    ...DEFAULT_THEME,\n    name,\n    settings: {\n      ...DEFAULT_THEME.settings.find((s) => s.base_theme._ === baseTheme),\n      highlightningColor\n    }\n  };\n};\n\nexport const STATE_INIT: State = {\n  allDialogsLoaded: {},\n  pinnedOrders: {},\n  // contactsList: [],\n  contactsListCachedTime: 0,\n  updates: {},\n  filtersArr: [],\n  maxSeenMsgId: 0,\n  stateCreatedTime: Date.now(),\n  recentEmoji: [],\n  recentCustomEmoji: [],\n  topPeersCache: {},\n  recentSearch: [],\n  version: STATE_VERSION,\n  build: BUILD,\n  authState: {\n    _: IS_MOBILE ? 'authStateSignIn' : 'authStateSignQr'\n  },\n  hiddenPinnedMessages: {},\n  settings: {\n    messagesTextSize: 16,\n    distanceUnit: 'kilometers',\n    sendShortcut: 'enter',\n    autoDownload: {\n      photo: {\n        contacts: true,\n        private: true,\n        groups: true,\n        channels: true\n      },\n      video: {\n        contacts: true,\n        private: true,\n        groups: true,\n        channels: true\n      },\n      file: {\n        contacts: true,\n        private: true,\n        groups: true,\n        channels: true\n      }\n    },\n    autoDownloadNew: {\n      _: 'autoDownloadSettings',\n      file_size_max: 3145728,\n      pFlags: {\n        video_preload_large: true,\n        audio_preload_next: true\n      },\n      photo_size_max: 1048576,\n      video_size_max: 15728640,\n      video_upload_maxbitrate: 100\n    },\n    stickers: {\n      suggest: 'all',\n      dynamicPackOrder: true,\n      loop: true\n    },\n    emoji: {\n      suggest: true,\n      big: true\n    },\n    themes: [\n      makeDefaultAppTheme('day', 'baseThemeClassic', 'hsla(86.4, 43.846153%, 45.117647%, .4)'),\n      makeDefaultAppTheme('night', 'baseThemeNight', 'hsla(299.142857, 44.166666%, 37.470588%, .4)')\n    ],\n    theme: 'system',\n    notifications: {\n      sound: false\n    },\n    timeFormat: getTimeFormat(),\n    liteMode: {\n      all: false,\n      animations: false,\n      chat: false,\n      chat_background: false,\n      chat_spoilers: false,\n      effects: false,\n      effects_premiumstickers: false,\n      effects_reactions: false,\n      effects_emoji: false,\n      emoji: false,\n      emoji_messages: false,\n      emoji_panel: false,\n      gif: false,\n      stickers: false,\n      stickers_chat: false,\n      stickers_panel: false,\n      video: false\n    }\n  },\n  playbackParams: {\n    volume: 1,\n    muted: false,\n    playbackRate: 1,\n    playbackRates: {\n      voice: 1,\n      video: 1,\n      audio: 1\n    },\n    loop: false,\n    round: false\n  },\n  keepSigned: true,\n  chatContextMenuHintWasShown: false,\n  stateId: nextRandomUint(32),\n  notifySettings: {},\n  confirmedWebViews: []\n};\n","export default function getTimeFormat(): 'h12' | 'h23' {\n  // try {\n  //   const resolvedOptions = Intl.DateTimeFormat(navigator.language,  {hour: 'numeric'}).resolvedOptions();\n  //   if('hourCycle' in resolvedOptions) {\n  //     return (resolvedOptions as any).hourCycle === 'h12' ? 'h12' : 'h23';\n  //   } else {\n  //     return resolvedOptions.hour12 ? 'h12' : 'h23';\n  //   }\n  // } catch(err) {\n  return new Date().toLocaleString().match(/\\s(AM|PM)/) ? 'h12' : 'h23';\n  // }\n}\n","let IS_APPLE_MX = false;\n\ntry {\n  // Awesome detect from https://stackoverflow.com/a/65412357\n  const ctx = document.createElement('canvas').getContext('webgl');\n  const extension = ctx.getExtension('WEBGL_debug_renderer_info');\n  const renderer: string = extension && ctx.getParameter(extension.UNMASKED_RENDERER_WEBGL) || '';\n  if((renderer.match(/Apple/) && !renderer.match(/Apple GPU/)) ||\n    ctx.getSupportedExtensions().indexOf('WEBGL_compressed_texture_s3tc_srgb') === -1) {\n    IS_APPLE_MX = true;\n  }\n} catch(err) {\n\n}\n\nexport default IS_APPLE_MX;\n","import IS_WEBRTC_SUPPORTED from './webrtcSupport';\n\nconst IS_CALL_SUPPORTED = IS_WEBRTC_SUPPORTED;\n\nexport default IS_CALL_SUPPORTED;\n","import {IS_SAFARI} from './userAgent';\n\n/*\n * This is used as a workaround for a memory leak in Safari caused by using Transferable objects to\n * transfer data between WebWorkers and the main thread.\n * https://github.com/mapbox/mapbox-gl-js/issues/8771\n *\n * This should be removed once the underlying Safari issue is fixed.\n */\n\nlet CAN_USE_TRANSFERABLES: boolean;\nif(!IS_SAFARI) CAN_USE_TRANSFERABLES = true;\nelse {\n  try {\n    const match = navigator.userAgent.match(/Version\\/(.+?) /);\n    CAN_USE_TRANSFERABLES = +match[1] >= 14;\n  } catch(err) {\n    CAN_USE_TRANSFERABLES = false;\n  }\n}\n\nexport default CAN_USE_TRANSFERABLES;\n","const IS_CANVAS_FILTER_SUPPORTED = 'filter' in (document.createElement('canvas').getContext('2d') || {});\n\nexport default IS_CANVAS_FILTER_SUPPORTED;\n","const IS_EMOJI_SUPPORTED = navigator.userAgent.search(/OS X|iPhone|iPad|iOS/i) !== -1/*  && false *//*  || true */;\n\nexport default IS_EMOJI_SUPPORTED;\n","const IS_GEOLOCATION_SUPPORTED = !!navigator?.geolocation?.getCurrentPosition && false;\n\nexport default IS_GEOLOCATION_SUPPORTED;\n","import IS_WEBRTC_SUPPORTED from './webrtcSupport';\n\nconst IS_GROUP_CALL_SUPPORTED = IS_WEBRTC_SUPPORTED;\n\nexport default IS_GROUP_CALL_SUPPORTED;\n","import IS_WEBP_SUPPORTED from './webpSupport';\n\nconst IMAGE_MIME_TYPES_SUPPORTED = new Set([\n  'image/jpeg',\n  'image/png',\n  'image/bmp'\n]);\n\nif(IS_WEBP_SUPPORTED) {\n  IMAGE_MIME_TYPES_SUPPORTED.add('image/webp');\n}\n\nexport default IMAGE_MIME_TYPES_SUPPORTED;\n","import IMAGE_MIME_TYPES_SUPPORTED from './imageMimeTypesSupport';\nimport VIDEO_MIME_TYPES_SUPPORTED from './videoMimeTypesSupport';\n\nconst arr = [...IMAGE_MIME_TYPES_SUPPORTED].concat([...VIDEO_MIME_TYPES_SUPPORTED]);\n\nconst MEDIA_MIME_TYPES_SUPPORTED = new Set(arr);\n\nexport default MEDIA_MIME_TYPES_SUPPORTED;\n","import {IS_APPLE_MOBILE, IS_SAFARI} from './userAgent';\n\n// mov is not supported in Chrome on macOS\nconst IS_MOV_SUPPORTED = !!document.createElement('video').canPlayType('video/quicktime') || IS_SAFARI || IS_APPLE_MOBILE;\n\nexport default IS_MOV_SUPPORTED;\n","const audio = document.createElement('audio');\nconst IS_OPUS_SUPPORTED = !!(audio.canPlayType && audio.canPlayType('audio/ogg;').replace(/no/, ''))/*  && false */;\n\nexport default IS_OPUS_SUPPORTED;\n","import {IS_FIREFOX} from './userAgent';\n\nconst IS_PARALLAX_SUPPORTED = !IS_FIREFOX && false;\n\nexport default IS_PARALLAX_SUPPORTED;\n","const IS_SCREEN_SHARING_SUPPORTED = !!('getDisplayMedia' in (navigator?.mediaDevices || {}));\n\nexport default IS_SCREEN_SHARING_SUPPORTED;\n","import Modes from '../config/modes';\n\nconst IS_SHARED_WORKER_SUPPORTED = typeof(SharedWorker) !== 'undefined' && !Modes.noSharedWorker/*  && false */;\n\nexport default IS_SHARED_WORKER_SUPPORTED;\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\n// @ts-ignore\nconst IS_TOUCH_SUPPORTED = ('ontouchstart' in window) || (window.DocumentTouch && document instanceof DocumentTouch)/*  || true */;\nexport default IS_TOUCH_SUPPORTED;\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport ctx from './ctx';\n\nexport const USER_AGENT = navigator ? navigator.userAgent : null;\nexport const IS_APPLE = navigator.userAgent.search(/OS X|iPhone|iPad|iOS/i) !== -1;\nexport const IS_ANDROID = navigator.userAgent.toLowerCase().indexOf('android') !== -1;\nexport const IS_CHROMIUM = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);\n\n// https://stackoverflow.com/a/58065241\nexport const IS_APPLE_MOBILE = (/iPad|iPhone|iPod/.test(navigator.platform) ||\n  (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1)) &&\n  !(ctx as any).MSStream;\n\nexport const IS_SAFARI = !!('safari' in ctx) || !!(USER_AGENT && (/\\b(iPad|iPhone|iPod)\\b/.test(USER_AGENT) || (!!USER_AGENT.match('Safari') && !USER_AGENT.match('Chrome'))))/*  || true */;\nexport const IS_FIREFOX = navigator.userAgent.toLowerCase().indexOf('firefox') > -1;\n\nexport const IS_MOBILE_SAFARI = IS_SAFARI && IS_APPLE_MOBILE;\n\nexport const IS_MOBILE = (navigator.maxTouchPoints === undefined || navigator.maxTouchPoints > 0) && navigator.userAgent.search(/iOS|iPhone OS|Android|BlackBerry|BB10|Series ?[64]0|J2ME|MIDP|opera mini|opera mobi|mobi.+Gecko|Windows Phone/i) != -1;\n","const IS_VIBRATE_SUPPORTED = !!navigator?.vibrate;\n\nexport default IS_VIBRATE_SUPPORTED;\n","import IS_MOV_SUPPORTED from './movSupport';\n\nexport type VIDEO_MIME_TYPE = 'image/gif' | 'video/mp4' | 'video/webm' | 'video/quicktime';\nconst VIDEO_MIME_TYPES_SUPPORTED: Set<VIDEO_MIME_TYPE> = new Set([\n  'image/gif', // have to display it as video\n  'video/mp4',\n  'video/webm'\n]);\n\nif(IS_MOV_SUPPORTED) {\n  VIDEO_MIME_TYPES_SUPPORTED.add('video/quicktime');\n}\n\nexport default VIDEO_MIME_TYPES_SUPPORTED;\n","import {IS_APPLE_MOBILE, IS_SAFARI} from './userAgent';\n\nconst IS_WEBM_SUPPORTED = !!document.createElement('video').canPlayType('video/webm') && !IS_SAFARI && !IS_APPLE_MOBILE;\n\nexport default IS_WEBM_SUPPORTED;\n","const IS_WEBP_SUPPORTED = document.createElement('canvas').toDataURL('image/webp').startsWith('data:image/webp');\n\nexport default IS_WEBP_SUPPORTED;\n","import {IS_FIREFOX} from './userAgent';\n\nconst IS_WEBRTC_SUPPORTED = !!(typeof(RTCPeerConnection) !== 'undefined' && !IS_FIREFOX);\n\nexport default IS_WEBRTC_SUPPORTED;\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n *\n * Originally from:\n * https://github.com/zhukov/webogram\n * Copyright (C) 2014 Igor Zhukov <igor.beatle@gmail.com>\n * https://github.com/zhukov/webogram/blob/master/LICENSE\n */\n\nimport {MOUNT_CLASS_TO} from '../config/debug';\nimport {makeMediaSize} from './mediaSize';\n\nexport default function calcImageInBox(imageW: number, imageH: number, boxW: number, boxH: number, noZoom = true) {\n  if(imageW < boxW && imageH < boxH && noZoom) {\n    return makeMediaSize(imageW, imageH);\n  }\n\n  let boxedImageW = boxW;\n  let boxedImageH = boxH;\n\n  if((imageW / imageH) > (boxW / boxH)) {\n    boxedImageH = (imageH * boxW / imageW) | 0;\n  } else {\n    boxedImageW = (imageW * boxH / imageH) | 0;\n    if(boxedImageW > boxW) {\n      boxedImageH = (boxedImageH * boxW / boxedImageW) | 0;\n      boxedImageW = boxW;\n    }\n  }\n\n  // if (Config.Navigator.retina) {\n  //   imageW = Math.floor(imageW / 2)\n  //   imageH = Math.floor(imageH / 2)\n  // }\n\n  if(noZoom && boxedImageW >= imageW && boxedImageH >= imageH) {\n    boxedImageW = imageW;\n    boxedImageH = imageH;\n  }\n\n  return makeMediaSize(boxedImageW, boxedImageH);\n}\n\nMOUNT_CLASS_TO.calcImageInBox = calcImageInBox;\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport type {WallPaper} from '../layer';\nimport clamp from './number/clamp';\n\nexport type ColorHsla = {\n  h: number,\n  s: number,\n  l: number,\n  a: number\n};\n\nexport type ColorRgba = [number, number, number, number];\nexport type ColorRgb = [number, number, number];\n\n/**\n * https://stackoverflow.com/a/54070620/6758968\n * r, g, b in [0, 255]\n * @returns h in [0,360) and s, v in [0,1]\n */\nexport function rgbToHsv(r: number, g: number, b: number): [number, number, number] {\n  r /= 255, g /= 255, b /= 255;\n  const v = Math.max(r, g, b),\n    c = v - Math.min(r, g, b);\n  const h = c && ((v === r) ? (g - b ) / c : ((v == g) ? 2 + (b - r) / c : 4 + (r - g) / c));\n  return [60 * (h < 0 ? h + 6 : h), v && c / v, v];\n}\n\n/**\n * https://stackoverflow.com/a/54024653/6758968\n * @param h [0, 360]\n * @param s [0, 1]\n * @param v [0, 1]\n * @returns r, g, b in [0, 255]\n */\nexport function hsvToRgb(h: number, s: number, v: number): ColorRgb {\n  const f = (n: number, k: number = (n + h / 60) % 6) => Math.round((v - v * s * Math.max(Math.min(k, 4 - k, 1), 0)) * 255);\n  return [f(5), f(3), f(1)];\n}\n\n/**\n * @returns h [0, 360], s [0, 100], l [0, 100], a [0, 1]\n */\nexport function rgbaToHsla(r: number, g: number, b: number, a: number = 1): ColorHsla {\n  r /= 255, g /= 255, b /= 255;\n  const max = Math.max(r, g, b),\n    min = Math.min(r, g, b);\n  let h: number, s: number;\n  const l = (max + min) / 2;\n\n  if(max === min) {\n    h = s = 0; // achromatic\n  } else {\n    const d = max - min;\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n    switch(max) {\n      case r:\n        h = (g - b) / d + (g < b ? 6 : 0);\n        break;\n      case g:\n        h = (b - r) / d + 2;\n        break;\n      case b:\n        h = (r - g) / d + 4;\n        break;\n    }\n    h /= 6;\n  }\n\n  return {\n    h: h * 360,\n    s: s * 100,\n    l: l * 100,\n    a\n  };\n}\n\n// * https://stackoverflow.com/a/9493060/6758968\n/**\n * Converts an HSL color value to RGB. Conversion formula\n * adapted from http://en.wikipedia.org/wiki/HSL_color_space.\n *\n * @param   {number}  h       The hue [0, 360]\n * @param   {number}  s       The saturation [0, 1]\n * @param   {number}  l       The lightness [0, 1]\n * @return  {Array}           The RGB representation [0, 255]\n */\nexport function hslaToRgba(h: number, s: number, l: number, a: number): ColorRgba {\n  h /= 360, s /= 100, l /= 100;\n  let r: number, g: number, b: number;\n\n  if(s === 0) {\n    r = g = b = l; // achromatic\n  } else {\n    const hue2rgb = function hue2rgb(p: number, q: number, t: number) {\n      if(t < 0) t += 1;\n      if(t > 1) t -= 1;\n      if(t < 1/6) return p + (q - p) * 6 * t;\n      if(t < 1/2) return q;\n      if(t < 2/3) return p + (q - p) * (2/3 - t) * 6;\n      return p;\n    }\n\n    const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n    const p = 2 * l - q;\n    r = hue2rgb(p, q, h + 1/3);\n    g = hue2rgb(p, q, h);\n    b = hue2rgb(p, q, h - 1/3);\n  }\n\n  return [r, g, b, a].map((v) => Math.round(v * 255)) as ColorRgba;\n}\n\nexport function hslaStringToRgba(hsla: string) {\n  const splitted = hsla.slice(5, -1).split(', ');\n  const alpha = +splitted.pop();\n  const arr = splitted.map((val) => {\n    if(val.endsWith('%')) {\n      return +val.slice(0, -1);\n    }\n\n    return +val;\n  });\n\n  return hslaToRgba(arr[0], arr[1], arr[2], alpha);\n}\n\nexport function hexaToRgba(hexa: string) {\n  const arr: ColorRgba = [] as any;\n  const offset = hexa[0] === '#' ? 1 : 0;\n  if(hexa.length === (5 + offset)) {\n    hexa = (offset ? '#' : '') + '0' + hexa.slice(offset);\n  }\n\n  if(hexa.length === (3 + offset)) {\n    for(let i = offset; i < hexa.length; ++i) {\n      arr.push(parseInt(hexa[i] + hexa[i], 16));\n    }\n  } else if(hexa.length === (4 + offset)) {\n    for(let i = offset; i < (hexa.length - 1); ++i) {\n      arr.push(parseInt(hexa[i] + hexa[i], 16));\n    }\n\n    arr.push(parseInt(hexa[hexa.length - 1], 16));\n  } else {\n    for(let i = offset; i < hexa.length; i += 2) {\n      arr.push(parseInt(hexa.slice(i, i + 2), 16));\n    }\n  }\n\n  return arr;\n}\n\nexport function hexToRgb(hex: string) {\n  return hexaToRgba(hex.slice(0, 7)) as any as ColorRgb;\n}\n\nexport function hexaToHsla(hexa: string) {\n  const rgba = hexaToRgba(hexa);\n  return rgbaToHsla(rgba[0], rgba[1], rgba[2], rgba[3]);\n}\n\nexport function rgbaToHexa(rgba: ColorRgba | ColorRgb) {\n  return '#' + rgba.map((v) => ('0' + v.toString(16)).slice(-2)).join('');\n}\n\nexport function hslaStringToHexa(hsla: string) {\n  return rgbaToHexa(hslaStringToRgba(hsla));\n}\n\nexport function hslaStringToHex(hsla: string) {\n  return hslaStringToHexa(hsla).slice(0, -2);\n}\n\n/**\n * @param weight [0, 1]\n */\nexport function mixColors(color1: ColorRgb, color2: ColorRgb, weight: number) {\n  const out = new Array<number>(3) as ColorRgb;\n  for(let i = 0; i < 3; ++i) {\n    const v1 = color1[i], v2 = color2[i];\n    out[i] = Math.floor(v2 + (v1 - v2) * weight);\n  }\n\n  return out;\n}\n\nexport function computePerceivedBrightness(color: ColorRgb) {\n  return (color[0] * 0.2126 + color[1] * 0.7152 + color[2] * 0.0722) / 255;\n}\n\nexport function getAverageColor(color1: ColorRgb, color2: ColorRgb): ColorRgb {\n  return color1.map((v, i) => Math.round((v + color2[i]) / 2)) as ColorRgb;\n}\n\nexport function getAccentColor(baseHsv: number[], baseColor: ColorRgb, elementColor: ColorRgb): ColorRgb {\n  const hsvTemp3 = rgbToHsv(...baseColor);\n  const hsvTemp4 = rgbToHsv(...elementColor);\n\n  const dist = Math.min(1.5 * hsvTemp3[1] / baseHsv[1], 1);\n\n  hsvTemp3[0] = Math.min(360, hsvTemp4[0] - hsvTemp3[0] + baseHsv[0]);\n  hsvTemp3[1] = Math.min(1, hsvTemp4[1] * baseHsv[1] / hsvTemp3[1]);\n  hsvTemp3[2] = Math.min(1, (hsvTemp4[2] / hsvTemp3[2] + dist - 1) * baseHsv[2] / dist);\n  if(hsvTemp3[2] < 0.3) {\n    return elementColor;\n  }\n  return hsvToRgb(...hsvTemp3);\n}\n\nexport function changeColorAccent(baseHsv: number[], accentHsv: number[], color: ColorRgb, isDarkTheme: boolean) {\n  const colorHsv = rgbToHsv(...color);\n\n  const diffH = Math.min(Math.abs(colorHsv[0] - baseHsv[0]), Math.abs(colorHsv[0] - baseHsv[0] - 360));\n  if(diffH > 30) {\n    return color;\n  }\n\n  const dist = Math.min(1.5 * colorHsv[1] / baseHsv[1], 1);\n\n  colorHsv[0] = Math.min(360, colorHsv[0] + accentHsv[0] - baseHsv[0]);\n  colorHsv[1] = Math.min(1, colorHsv[1] * accentHsv[1] / baseHsv[1]);\n  colorHsv[2] = Math.min(1, colorHsv[2] * (1 - dist + dist * accentHsv[2] / baseHsv[2]));\n\n  let newColor = hsvToRgb(...colorHsv);\n\n  const origBrightness = computePerceivedBrightness(color);\n  const newBrightness = computePerceivedBrightness(newColor);\n\n  // We need to keep colors lighter in dark themes and darker in light themes\n  const needRevertBrightness = isDarkTheme ? origBrightness > newBrightness : origBrightness < newBrightness;\n\n  if(needRevertBrightness) {\n    const amountOfNew = 0.6;\n    const fallbackAmount = (1 - amountOfNew) * origBrightness / newBrightness + amountOfNew;\n    newColor = changeBrightness(newColor, fallbackAmount);\n  }\n\n  return newColor;\n}\n\nexport function changeBrightness(color: ColorRgb, amount: number) {\n  return color.map((v) => clamp(Math.round(v * amount), 0, 255)) as ColorRgb;\n}\n\nexport function getHexColorFromTelegramColor(color: number) {\n  const hex = (color < 0 ? 0xFFFFFF + color : color).toString(16);\n  return '#' + (hex.length >= 6 ? hex : '0'.repeat(6 - hex.length) + hex);\n}\n\nexport function getRgbColorFromTelegramColor(color: number) {\n  return hexToRgb(getHexColorFromTelegramColor(color));\n}\n\nexport function getColorsFromWallPaper(wallPaper: WallPaper) {\n  return wallPaper.settings ? [\n    wallPaper.settings.background_color,\n    wallPaper.settings.second_background_color,\n    wallPaper.settings.third_background_color,\n    wallPaper.settings.fourth_background_color\n  ].filter(Boolean).map(getHexColorFromTelegramColor).join(',') : '';\n}\n","export default function compareVersion(v1: string, v2: string): number {\n  v1 = v1.split(' ', 1)[0];\n  v2 = v2.split(' ', 1)[0];\n  const s1 = v1.split('.');\n  const s2 = v2.split('.');\n\n  for(let i = 0; i < s1.length; ++i) {\n    const v1 = +s1[i];\n    const v2 = +s2[i];\n    if(v1 > v2) return 1;\n    else if(v1 < v2) return -1;\n  }\n\n  return 0;\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport {MOUNT_CLASS_TO} from '../config/debug';\nimport I18n, {i18n} from '../lib/langPack';\nimport capitalizeFirstLetter from './string/capitalizeFirstLetter';\n\nexport const months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\nexport const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\nexport const monthsLocalized = months.slice();\nexport const daysLocalized = days.slice();\n\nexport const ONE_DAY = 86400;\n\nexport function getWeekDays() {\n  const dateTimeFormat = I18n.getDateTimeFormat({weekday: 'long'});\n  const date = new Date(Date.UTC(2017, 0, 2));\n  const out: string[] = [];\n  for(let i = 0; i < 7; ++i) {\n    out.push(capitalizeFirstLetter(dateTimeFormat.format(date)));\n    date.setDate(date.getDate() + 1);\n  }\n  return out;\n}\n\nexport function getMonths() {\n  const dateTimeFormat = I18n.getDateTimeFormat({month: 'long'});\n  const date = new Date(Date.UTC(2017, 0, 1));\n  const out: string[] = [];\n  for(let i = 0; i < 12; ++i) {\n    out.push(capitalizeFirstLetter(dateTimeFormat.format(date)));\n    date.setMonth(date.getMonth() + 1);\n  }\n  return out;\n}\n\nexport function fillLocalizedDates() {\n  monthsLocalized.splice(0, monthsLocalized.length, ...getMonths());\n  daysLocalized.splice(0, daysLocalized.length, ...getWeekDays());\n}\n\n// https://stackoverflow.com/a/6117889\nexport const getWeekNumber = (date: Date) => {\n  const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));\n  const dayNum = d.getUTCDay() || 7;\n  d.setUTCDate(d.getUTCDate() + 4 - dayNum);\n  const yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));\n  return Math.ceil((((d.getTime() - yearStart.getTime()) / ONE_DAY) + 1) / 7);\n};\n\nexport function formatDateAccordingToTodayNew(time: Date) {\n  const today = new Date();\n  const now = today.getTime() / 1000 | 0;\n  const timestamp = time.getTime() / 1000 | 0;\n\n  const options: Intl.DateTimeFormatOptions = {};\n  if((now - timestamp) < ONE_DAY && today.getDate() === time.getDate()) { // if the same day\n    options.hour = options.minute = '2-digit';\n  } else if(today.getFullYear() !== time.getFullYear()) { // different year\n    options.year = options.day = 'numeric';\n    options.month = '2-digit';\n  } else if((now - timestamp) < (ONE_DAY * 7) && getWeekNumber(today) === getWeekNumber(time)) { // current week\n    options.weekday = 'short';\n  } else { // same year\n    options.month = 'short';\n    options.day = 'numeric';\n  }\n\n  return new I18n.IntlDateElement({\n    date: time,\n    options\n  }).element;\n}\n\nexport function formatFullSentTimeRaw(timestamp: number, options: {\n  capitalize?: boolean\n} = {}) {\n  const date = new Date();\n  const time = new Date(timestamp * 1000);\n  const now = date.getTime() / 1000;\n\n  const timeEl = formatTime(time);\n\n  let dateEl: Node | string;\n  if((now - timestamp) < ONE_DAY && date.getDate() === time.getDate()) { // if the same day\n    dateEl = i18n(options.capitalize ? 'Date.Today' : 'Peer.Status.Today');\n  } else if((now - timestamp) < (ONE_DAY * 2) && (date.getDate() - 1) === time.getDate()) { // yesterday\n    dateEl = i18n(options.capitalize ? 'Yesterday' : 'Peer.Status.Yesterday');\n\n    if(options.capitalize) {\n      (dateEl as HTMLElement).style.textTransform = 'capitalize';\n    }\n  } else if(date.getFullYear() !== time.getFullYear()) { // different year\n    dateEl = new I18n.IntlDateElement({\n      date: time,\n      options: {\n        month: 'short',\n        day: 'numeric',\n        year: 'numeric'\n      }\n    }).element;\n    // dateStr = months[time.getMonth()].slice(0, 3) + ' ' + time.getDate() + ', ' + time.getFullYear();\n  } else {\n    dateEl = new I18n.IntlDateElement({\n      date: time,\n      options: {\n        month: 'short',\n        day: 'numeric'\n      }\n    }).element;\n    // dateStr = months[time.getMonth()].slice(0, 3) + ' ' + time.getDate();\n  }\n\n  return {dateEl, timeEl};\n}\n\nexport function formatFullSentTime(timestamp: number, capitalize = true) {\n  const {dateEl, timeEl} = formatFullSentTimeRaw(timestamp, {\n    capitalize\n  });\n\n  const fragment = document.createDocumentFragment();\n  fragment.append(dateEl, ' ', i18n('ScheduleController.at'), ' ', timeEl);\n  return fragment;\n}\n\nexport function formatTime(date: Date) {\n  return new I18n.IntlDateElement({\n    date,\n    options: {\n      hour: '2-digit',\n      minute: '2-digit'\n    }\n  }).element;\n}\n\nMOUNT_CLASS_TO && (MOUNT_CLASS_TO.formatDateAccordingToTodayNew = formatDateAccordingToTodayNew);\n\nexport const getFullDate = (date: Date, options: Partial<{\n  noTime: true,\n  noSeconds: true,\n  monthAsNumber: true,\n  leadingZero: true\n}> = {}) => {\n  const joiner = options.monthAsNumber ? '.' : ' ';\n  const time = ('0' + date.getHours()).slice(-2) + ':' + ('0' + date.getMinutes()).slice(-2) + (options.noSeconds ? '' : ':' + ('0' + date.getSeconds()).slice(-2));\n\n  return (options.leadingZero ? ('0' + date.getDate()).slice(-2) : date.getDate()) +\n    joiner + (options.monthAsNumber ? ('0' + (date.getMonth() + 1)).slice(-2) : months[date.getMonth()]) +\n    joiner + date.getFullYear() +\n    (options.noTime ? '' : ', ' + time);\n};\n\n// https://github.com/DrKLO/Telegram/blob/d52b2c921abd3c1e8d6368858313ad0cb0468c07/TMessagesProj/src/main/java/org/telegram/ui/Adapters/FiltersView.java\nconst minYear = 2013;\nconst yearPattern = new RegExp('20[0-9]{1,2}');\nconst anyLetterRegExp = `\\\\p{L}`;\nconst monthPattern = new RegExp(`(${anyLetterRegExp}{3,})`, 'iu');\nconst monthYearOrDayPattern = new RegExp(`(${anyLetterRegExp}{3,}) ([0-9]{0,4})`, 'iu');\nconst yearOrDayAndMonthPattern = new RegExp(`([0-9]{0,4}) (${anyLetterRegExp}{2,})`, 'iu');\nconst shortDate = new RegExp('^([0-9]{1,4})(\\\\.| |/|\\\\-)([0-9]{1,4})$', 'i');\nconst longDate = new RegExp('^([0-9]{1,2})(\\\\.| |/|\\\\-)([0-9]{1,2})(\\\\.| |/|\\\\-)([0-9]{1,4})$', 'i');\nconst numberOfDaysEachMonth = [31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];\nexport type DateData = {\n  title: string,\n  minDate: number,\n  maxDate: number,\n};\nexport function fillTipDates(query: string, dates: DateData[]) {\n  const q = query.trim().toLowerCase();\n\n  if(q.length < 3) {\n    return;\n  }\n\n  if(['today', I18n.format('Peer.Status.Today', true)].some((haystack) => haystack.indexOf(q) === 0)) {\n    const date = new Date();\n    const year = date.getFullYear();\n    const month = date.getMonth();\n    const day = date.getDate();\n    date.setFullYear(year, month, day);\n    date.setHours(0, 0, 0);\n\n    const minDate = date.getTime();\n    date.setFullYear(year, month, day + 1);\n    date.setHours(0, 0, 0);\n\n    const maxDate = date.getTime() - 1;\n    dates.push({\n      title: I18n.format('Date.Today', true),\n      minDate,\n      maxDate\n    });\n    return;\n  }\n\n  if(['yesterday', I18n.format('Peer.Status.Yesterday', true)].some((haystack) => haystack.indexOf(q) === 0)) {\n    const date = new Date();\n    const year = date.getFullYear();\n    const month = date.getMonth();\n    const day = date.getDate();\n    date.setFullYear(year, month, day);\n    date.setHours(0, 0, 0);\n\n    const minDate = date.getTime() - 86400000;\n    date.setFullYear(year, month, day + 1);\n    date.setHours(0, 0, 0);\n\n    const maxDate = date.getTime() - 86400001;\n    dates.push({\n      title: capitalizeFirstLetter(I18n.format('Yesterday', true)),\n      minDate,\n      maxDate\n    });\n    return;\n  }\n\n  const dayOfWeek = getDayOfWeek(q);\n  if(dayOfWeek >= 0) {\n    const date = new Date();\n    const now = date.getTime();\n    const currentDay = date.getDay();\n    const distance = dayOfWeek - currentDay;\n    date.setDate(date.getDate() + distance);\n    if(date.getTime() > now) {\n      date.setTime(date.getTime() - 604800000);\n    }\n    const year = date.getFullYear()\n    const month = date.getMonth();\n    const day = date.getDate();\n    date.setFullYear(year, month, day);\n    date.setHours(0, 0, 0);\n\n    const minDate = date.getTime();\n    date.setFullYear(year, month, day + 1);\n    date.setHours(0, 0, 0);\n\n    const maxDate = date.getTime() - 1;\n    dates.push({\n      title: formatWeekLong(minDate),\n      minDate,\n      maxDate\n    });\n    return;\n  }\n\n  let matches: any[];\n  if((matches = shortDate.exec(q)) !== null) {\n    const g1 = matches[1];\n    const g2 = matches[3];\n    const k = parseInt(g1);\n    const k1 = parseInt(g2);\n    if(k > 0 && k <= 31) {\n      if(k1 >= minYear && k <= 12) {\n        const selectedYear = k1;\n        const month = k - 1;\n        createForMonthYear(dates, month, selectedYear);\n        return;\n      } else if(k1 <= 12) {\n        const day = k - 1;\n        const month = k1 - 1;\n        createForDayMonth(dates, day, month);\n      }\n    } else if(k >= minYear && k1 <= 12) {\n      const selectedYear = k;\n      const month = k1 - 1;\n      createForMonthYear(dates, month, selectedYear);\n    }\n\n    return;\n  }\n\n  if((matches = longDate.exec(q)) !== null) {\n    const g1 = matches[1];\n    const g2 = matches[3];\n    const g3 = matches[5];\n    if(!matches[2] === matches[4]) {\n      return;\n    }\n\n    const day = parseInt(g1);\n    const month = parseInt(g2) - 1;\n    let year = parseInt(g3);\n    if(year >= 10 && year <= 99) {\n      year += 2000;\n    }\n\n    const currentYear = new Date().getFullYear();\n    if(validDateForMonth(day - 1, month) && year >= minYear && year <= currentYear) {\n      const date = new Date();\n      date.setFullYear(year, month, day);\n      date.setHours(0, 0, 0);\n\n      const minDate = date.getTime();\n      date.setFullYear(year, month, day + 1);\n      date.setHours(0, 0, 0);\n\n      const maxDate = date.getTime() - 1;\n      dates.push({\n        title: formatterYearMax(minDate),\n        minDate,\n        maxDate\n      });\n      return;\n    }\n\n    return;\n  }\n\n  if((matches = monthYearOrDayPattern.exec(q)) !== null) {\n    const g1 = matches[1];\n    const g2 = matches[2];\n    const month = getMonth(g1);\n    if(month >= 0) {\n      const k = +g2 || new Date().getUTCFullYear();\n      if(k > 0 && k <= 31) {\n        const day = k - 1;\n        createForDayMonth(dates, day, month);\n        return;\n      } else if(k >= minYear) {\n        const selectedYear = k;\n        createForMonthYear(dates, month, selectedYear);\n        return;\n      }\n    }\n  }\n\n  if((matches = yearOrDayAndMonthPattern.exec(q)) !== null) {\n    const g1 = matches[1];\n    const g2 = matches[2];\n    const month = getMonth(g2);\n    if(month >= 0) {\n      const k = +g1;\n      if(k > 0 && k <= 31) {\n        const day = k - 1;\n        createForDayMonth(dates, day, month);\n        return;\n      } else if(k >= minYear) {\n        const selectedYear = k;\n        createForMonthYear(dates, month, selectedYear);\n      }\n    }\n  }\n\n  if((matches = monthPattern.exec(q)) !== null) {\n    const g1 = matches[1];\n    const month = getMonth(g1);\n    if(month >= 0) {\n      const currentYear = new Date().getFullYear();\n      for(let i = currentYear; i >= minYear; --i) {\n        createForMonthYear(dates, month, i);\n      }\n    }\n  }\n\n  if((matches = yearPattern.exec(q)) !== null) {\n    let selectedYear = +matches[0];\n    const currentYear = new Date().getFullYear();\n    if(selectedYear < minYear) {\n      selectedYear = minYear;\n      for(let i = currentYear; i >= selectedYear; i--) {\n        const date = new Date();\n        date.setFullYear(i, 0, 1);\n        date.setHours(0, 0, 0);\n\n        const minDate = date.getTime();\n        date.setFullYear(i + 1, 0, 1);\n        date.setHours(0, 0, 0);\n\n        const maxDate = date.getTime() - 1;\n        dates.push({\n          title: '' + i,\n          minDate,\n          maxDate\n        });\n      }\n    } else if(selectedYear <= currentYear) {\n      const date = new Date();\n      date.setFullYear(selectedYear, 0, 1);\n      date.setHours(0, 0, 0);\n\n      const minDate = date.getTime();\n      date.setFullYear(selectedYear + 1, 0, 1);\n      date.setHours(0, 0, 0);\n\n      const maxDate = date.getTime() - 1;\n      dates.push({\n        title: '' + selectedYear,\n        minDate,\n        maxDate\n      });\n    }\n\n    return;\n  }\n}\n\nfunction createForMonthYear(dates: DateData[], month: number, selectedYear: number) {\n  const currentYear = new Date().getFullYear();\n  const today = Date.now();\n  if(selectedYear >= minYear && selectedYear <= currentYear) {\n    const date = new Date();\n    date.setFullYear(selectedYear, month, 1);\n    date.setHours(0, 0, 0);\n    const minDate = date.getTime();\n    if(minDate > today) {\n      return;\n    }\n    date.setMonth(date.getMonth() + 1);\n    const maxDate = date.getTime() - 1;\n\n    dates.push({\n      title: formatterMonthYear(minDate),\n      minDate,\n      maxDate\n    });\n  }\n}\n\nfunction createForDayMonth(dates: DateData[], day: number, month: number) {\n  if(validDateForMonth(day, month)) {\n    const currentYear = new Date().getFullYear();\n    const today = Date.now();\n\n    for(let i = currentYear; i >= minYear; i--) {\n      if(month === 1 && day === 28 && !isLeapYear(i)) {\n        continue;\n      }\n\n      const date = new Date();\n      date.setFullYear(i, month, day + 1);\n      date.setHours(0, 0, 0);\n\n      const minDate = date.getTime();\n      if(minDate > today) {\n        continue;\n      }\n\n      date.setFullYear(i, month, day + 2);\n      date.setHours(0, 0, 0);\n      const maxDate = date.getTime() - 1;\n      if(i === currentYear) {\n        dates.push({\n          title: formatterDayMonth(minDate),\n          minDate,\n          maxDate\n        });\n      } else {\n        dates.push({\n          title: formatterYearMax(minDate),\n          minDate,\n          maxDate\n        });\n      }\n    }\n  }\n}\n\nfunction formatterMonthYear(timestamp: number) {\n  const date = new Date(timestamp);\n  return monthsLocalized[date.getMonth()]/* .slice(0, 3) */ + ' ' + date.getFullYear();\n}\n\nfunction formatterDayMonth(timestamp: number) {\n  const date = new Date(timestamp);\n  return monthsLocalized[date.getMonth()]/* .slice(0, 3) */ + ' ' + date.getDate();\n}\n\nfunction formatterYearMax(timestamp: number) {\n  const date = new Date(timestamp);\n  return ('0' + date.getDate()).slice(-2) + '.' + ('0' + (date.getMonth() + 1)).slice(-2) + '.' + date.getFullYear();\n}\n\nfunction formatWeekLong(timestamp: number) {\n  const date = new Date(timestamp);\n  return daysLocalized[date.getDay()];\n}\n\nfunction validDateForMonth(day: number, month: number) {\n  if(month >= 0 && month < 12) {\n    if(day >= 0 && day < numberOfDaysEachMonth[month]) {\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction isLeapYear(year: number) {\n  return ((year % 4 === 0) && (year % 100 !== 0)) || (year % 400 === 0);\n}\n\nfunction getMonth(q: string) {\n  q = q.toLowerCase();\n  for(let i = 0; i < 12; i++) {\n    if([months[i], monthsLocalized[i]].some((month) => month.toLowerCase().indexOf(q) === 0)) {\n      return i;\n    }\n  }\n  return -1;\n}\n\nfunction getDayOfWeek(q: string) {\n  const c = new Date();\n  if(q.length <= 3) {\n    return -1;\n  }\n\n  for(let i = 0; i < 7; i++) {\n    c.setDate(c.getDate() + 1);\n\n    if(formatWeekLong(c.getTime()).toLowerCase().indexOf(q) === 0) {\n      return c.getDay();\n    }\n  }\n  return -1;\n}\n\nMOUNT_CLASS_TO.fillTipDates = fillTipDates;\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nexport default function blurActiveElement() {\n  if((document.activeElement as HTMLInputElement)?.blur) {\n    (document.activeElement as HTMLInputElement).blur();\n    return true;\n  }\n\n  return false;\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n *\n * Originally from:\n * https://github.com/zhukov/webogram\n * Copyright (C) 2014 Igor Zhukov <igor.beatle@gmail.com>\n * https://github.com/zhukov/webogram/blob/master/LICENSE\n */\n\nexport default function cancelEvent(event?: Event) {\n  event ||= window.event;\n  if(event) {\n    // 'input' event will have cancelable=false, but we still need to preventDefault\n    // if(!event.cancelable) {\n    //   return false;\n    // }\n\n    // @ts-ignore\n    event = event.originalEvent || event;\n\n    try {\n      if(event.stopPropagation) event.stopPropagation();\n      if(event.preventDefault) event.preventDefault();\n      event.returnValue = false;\n      event.cancelBubble = true;\n    } catch(err) {}\n  }\n\n  return false;\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport type {AppColorName} from '../themeController';\nimport {MOUNT_CLASS_TO} from '../../config/debug';\nimport rootScope from '../../lib/rootScope';\nimport mediaSizes from '../mediaSizes';\n\nexport type CustomProperty = string;\n\nexport class CustomProperties {\n  private cache: {[k in CustomProperty]?: string};\n  private computedStyle: CSSStyleDeclaration;\n\n  constructor() {\n    this.cache = {};\n\n    rootScope.addEventListener('theme_changed', this.resetCache);\n    mediaSizes.addEventListener('resize', this.resetCache);\n  }\n\n  protected resetCache = () => {\n    this.computedStyle = undefined;\n    const cache = this.cache;\n    this.cache = {};\n\n    for(const i in cache) {\n      this.getProperty(i as CustomProperty);\n    }\n  };\n\n  public getProperty(name: CustomProperty) {\n    let value = this.cache[name];\n    if(value !== undefined) {\n      return value;\n    }\n\n    this.computedStyle ??= window.getComputedStyle(document.documentElement);\n\n    value = this.computedStyle.getPropertyValue('--' + name).trim();\n    return this.setPropertyCache(name, value);\n  }\n\n  public getPropertyAsSize(name: CustomProperty) {\n    const value = this.getProperty(name);\n    let size: number;\n\n    if(value[value.length - 1] === '%') {\n\n    } else if(value.indexOf('rem')) {\n      size = +value.replace('rem', '') * 16;\n    } else {\n      size = +value.replace('px', '');\n    }\n\n    return size;\n  }\n\n  public setPropertyCache(name: CustomProperty, value: string) {\n    return this.cache[name] = value;\n  }\n}\n\nconst customProperties = new CustomProperties();\nMOUNT_CLASS_TO && (MOUNT_CLASS_TO.customProperties = customProperties);\nexport default customProperties;\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\n// export function findUpClassName<T>(el: any, className: string): T;\nexport default function findUpClassName(el: EventTarget | {closest: (selector: string) => any}, className: string): HTMLElement {\n  return (el as any).closest('.' + className);\n  /* if(el.classList.contains(className)) return el; // 03.02.2020\n\n  while(el.parentElement) {\n    el = el.parentElement;\n    if(el.classList.contains(className))\n      return el;\n  }\n  return null; */\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport {doubleRaf} from '../schedulers';\n\nexport default function fixSafariStickyInput(input: HTMLElement) {\n  input.style.transform = 'translateY(-99999px)';\n  /* input.style.position = 'fixed';\n  input.style.top = '-99999px';\n  input.style.left = '0'; */\n  input.focus();\n\n  // setTimeout(() => {\n  doubleRaf().then(() => {\n    // fastSmoothScroll(findUpClassName(input, 'scrollable-y') || window as any, document.activeElement as HTMLElement, 'start', 4, undefined, FocusDirection.Static);\n    /* input.style.position = '';\n    input.style.top = ''; */\n    input.style.transform = '';\n    // fastSmoothScroll(findUpClassName(input, 'scrollable-y') || window as any, document.activeElement as HTMLElement, 'start', 4, undefined, FocusDirection.Static);\n\n    /* setTimeout(() => {\n      fastSmoothScroll(findUpClassName(input, 'scrollable-y') || window as any, document.activeElement as HTMLElement, 'start', 4);\n    }, 50); */\n  });\n  // }, 0);\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport IS_TOUCH_SUPPORTED from '../../environment/touchSupport';\nimport {IS_MOBILE, IS_SAFARI} from '../../environment/userAgent';\nimport findUpClassName from './findUpClassName';\nimport fixSafariStickyInput from './fixSafariStickyInput';\n\nexport const IS_STICKY_INPUT_BUGGED = IS_SAFARI && IS_MOBILE && IS_TOUCH_SUPPORTED;\n\nif(IS_STICKY_INPUT_BUGGED) {\n  const key: 'clientY' | 'pageY' = 'clientY';\n  let startY = 0;\n  const o = {capture: true, passive: false};\n  const onTouchMove = (e: TouchEvent) => {\n    const touch = e.touches[0];\n\n    // console.log('touchmove y', touch[key], startY);\n\n    const scrollable = findUpClassName(touch.target, 'scrollable-y');\n    if(scrollable) {\n      const y = touch[key];\n      const scrolled = startY - y;\n\n      /* if(y < startY) {\n        startY = y;\n      } */\n\n      const scrollTop = scrollable.scrollTop;\n      const scrollHeight = scrollable.scrollHeight;\n      const clientHeight = scrollable.clientHeight;\n      const nextScrollTop = scrollTop ? Math.round(scrollTop + scrollable.clientHeight + scrolled) : scrollTop + scrolled;\n      // const needCancel = scrollHeight !== clientHeight ? (scrollTop && diff <= 1) || (scrollTop - diff) < 0 : true;\n      const needCancel = scrollHeight === clientHeight || nextScrollTop >= scrollHeight || nextScrollTop <= 0;\n      if(needCancel) {\n        e.preventDefault();\n      }\n\n      // console.log('touchmove with scrollable', scrollTop, startY, scrolled, nextScrollTop, needCancel, e.cancelable);\n    } else {\n      e.preventDefault();\n\n      // console.log('touchmove no scrollable', e, touch);\n    }\n\n    // if(e.target === document.documentElement || e.target === document.body) e.preventDefault();\n  };\n\n  // let el = document.createElement('div');\n  // document.body.prepend(el);\n  // let a = 0;\n\n  // let hasFocus = false;\n  let lastFocusOutTimeStamp = 0;\n  document.addEventListener('focusin', (e) => {\n    if(!(e.target as HTMLElement).classList.contains('is-sticky-input-bugged') || (e.timeStamp - lastFocusOutTimeStamp) < 50/*  && document.activeElement === input */) {\n      return;\n    }\n\n    // console.log('focusin', e, e.timeStamp);\n\n    // hasFocus = true;\n    // document.body.classList.add('is-keyboard-opened');\n\n    // el.innerText = 'focusin ' + ++a;\n\n    /* a < 2 &&  */fixSafariStickyInput(e.target as HTMLElement);\n\n    document.addEventListener('touchmove', onTouchMove, o);\n    document.addEventListener('touchstart', (e) => {\n      if(e.touches.length > 1) return;\n      const touchStart = e.touches[0];\n\n      startY = touchStart[key];\n    });\n  }, {passive: true});\n\n  document.addEventListener('focusout', (e) => {\n    // console.log('focusout', e, e.timeStamp);\n    document.removeEventListener('touchmove', onTouchMove, o);\n\n    lastFocusOutTimeStamp = e.timeStamp;\n\n    // el.innerText = 'focusout ' + ++a;\n\n    // if(hasFocus) {\n    //   hasFocus = false;\n    //   document.body.classList.remove('is-keyboard-opened');\n    // }\n  }, {passive: true});\n\n  document.addEventListener('visibilitychange', () => {\n    // console.log('window visibilitychange');\n    if(document.activeElement &&\n      document.activeElement.classList.contains('is-sticky-input-bugged') &&\n      (document.activeElement as HTMLElement).blur) {\n      fixSafariStickyInput(document.activeElement as HTMLElement);\n    }\n\n    /* blurActiveElement();\n    window.scrollTo(0, 0);\n    setVH(); */\n  }, {passive: true});\n}\n\nexport default function fixSafariStickyInputFocusing(input: HTMLElement) {\n  if(!IS_STICKY_INPUT_BUGGED) return;\n  input.classList.add('is-sticky-input-bugged');\n}\n","let callback: () => Promise<void>;\nexport default function cacheInstallPrompt() {\n  window.addEventListener('beforeinstallprompt', (deferredPrompt: any) => {\n    callback = async() => {\n      deferredPrompt.prompt();\n      const {outcome} = await deferredPrompt.userChoice;\n      const installed = outcome === 'accepted';\n      if(installed) {\n        callback = undefined;\n      }\n    };\n  });\n}\n\nexport function getInstallPrompt() {\n  return callback;\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport noop from '../noop';\nimport pause from '../schedulers/pause';\n\nconst texts = ['b', ''];\ntype FontType = 'text' | 'icons' | 'monospace';\n\nconst cache: {\n  [key: string]: {\n    [text: string]: Promise<any>\n  }\n} = {};\n\nconst fonts: {[type in FontType]: string} = {\n  text: 'Roboto',\n  icons: 'tgico',\n  monospace: 'Roboto Mono'\n};\n\nexport default function loadFonts(types: {[type in FontType]?: string[] | 'all'} = {\n  text: texts,\n  icons: undefined,\n  monospace: texts\n}): Promise<any> {\n  if(!('fonts' in document)) {\n    return Promise.resolve();\n  }\n\n  const promises: Promise<any>[] = [];\n  for(const type in types) {\n    let _texts = types[type as FontType];\n    if(_texts === 'all') {\n      _texts = texts;\n    }\n\n    const font = fonts[type as FontType];\n    const weights = type === 'icons' ? [500] : [400, 500];\n    for(const weight of weights) {\n      const _promises = (_texts || [undefined]).map((text) => {\n        const key = [weight, '1rem', font].join(' ');\n        const promise = (cache[key] ??= {})[text || ''] ??= document.fonts.load(key, text);\n        return promise;\n      });\n      promises.push(..._promises);\n    }\n  }\n\n  return Promise.race([\n    Promise.all(promises).catch(noop),\n    pause(1000)\n  ]);\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\n// import I18n from '../../lib/langPack';\n\nexport default function setInnerHTML(elem: Element, html: string | DocumentFragment | Element) {\n  setDirection(elem);\n  if(html === undefined) {\n    elem.replaceChildren();\n  } else if(typeof(html) === 'string') {\n    if(!html) elem.replaceChildren();\n    else elem.textContent = html;\n  } else {\n    elem.replaceChildren(html);\n  }\n}\n\nexport function setDirection(elem: Element) {\n  // if(!I18n.isRTL) {\n  elem.setAttribute('dir', 'auto');\n  // }\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport IS_TOUCH_SUPPORTED from '../environment/touchSupport';\nimport EventListenerBase from './eventListenerBase';\n\nconst FOCUS_EVENT_NAME = IS_TOUCH_SUPPORTED ? 'touchstart' : 'mousemove';\nconst DO_NOT_IDLE = false;\n\nexport class IdleController extends EventListenerBase<{\n  change: (idle: boolean) => void\n}> {\n  private _isIdle: boolean;\n\n  private focusPromise: Promise<void>;\n  private focusResolve: () => void;\n\n  constructor() {\n    super();\n\n    this._isIdle = true;\n    this.focusPromise = Promise.resolve();\n    this.focusResolve = () => {};\n\n    window.addEventListener('blur', () => {\n      this.isIdle = true;\n\n      window.addEventListener('focus', () => {\n        this.isIdle = false;\n      }, {once: true});\n    });\n\n    // * Prevent setting online after reloading page\n    window.addEventListener(FOCUS_EVENT_NAME, () => {\n      this.isIdle = false;\n    }, {once: true, passive: true});\n\n    this.addEventListener('change', (idle) => {\n      if(idle) {\n        this.focusPromise = new Promise((resolve) => {\n          this.focusResolve = resolve;\n        });\n      } else {\n        this.focusResolve();\n      }\n    });\n  }\n\n  public getFocusPromise() {\n    return this.focusPromise;\n  }\n\n  public get isIdle() {\n    return this._isIdle;\n  }\n\n  public set isIdle(value: boolean) {\n    if(this._isIdle === value) {\n      return;\n    }\n\n    if(DO_NOT_IDLE && value) {\n      return;\n    }\n\n    this._isIdle = value;\n    this.dispatchEvent('change', value);\n  }\n}\n\nconst idleController = new IdleController();\nexport default idleController;\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport calcImageInBox from './calcImageInBox';\n\nexport class MediaSize {\n  constructor(public width = 0, public height = width) {\n\n  }\n\n  public aspect(boxSize: MediaSize, fitted: boolean) {\n    return calcImageInBox(this.width, this.height, boxSize.width, boxSize.height, fitted);\n  }\n\n  public aspectFitted(boxSize: MediaSize) {\n    return this.aspect(boxSize, true);\n  }\n\n  public aspectCovered(boxSize: MediaSize) {\n    return this.aspect(boxSize, false);\n  }\n}\n\nexport function makeMediaSize(width?: number, height?: number): MediaSize {\n  return new MediaSize(width, height);\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport {MOUNT_CLASS_TO} from '../config/debug';\nimport EventListenerBase from './eventListenerBase';\nimport {makeMediaSize, MediaSize} from './mediaSize';\n\ntype MediaTypeSizes = {\n  regular: MediaSize,\n  webpage: MediaSize,\n  album: MediaSize,\n  esgSticker: MediaSize,\n  animatedSticker: MediaSize,\n  staticSticker: MediaSize,\n  emojiSticker: MediaSize,\n  poll: MediaSize,\n  round: MediaSize,\n  documentName: MediaSize,\n  invoice: MediaSize,\n  extendedInvoice: MediaSize,\n  customEmoji: MediaSize,\n  esgCustomEmoji: MediaSize,\n  emojiStatus: MediaSize,\n  popupSticker: MediaSize\n};\n\nexport type MediaSizeType = keyof MediaTypeSizes;\n\nexport enum ScreenSize {\n  mobile,\n  medium,\n  large\n}\n\nconst MOBILE_SIZE = 600;\nconst MEDIUM_SIZE = 1275;\nconst LARGE_SIZE = 1680;\n\nconst CUSTOM_EMOJI_SIZE = makeMediaSize(20, 20);\nconst ESG_CUSTOM_EMOJI_SIZE = makeMediaSize(36, 36);\nconst EMOJI_STATUS_SIZE = makeMediaSize(18, 18);\n\nclass MediaSizes extends EventListenerBase<{\n  changeScreen: (from: ScreenSize, to: ScreenSize) => void,\n  resize: () => void\n}> {\n  private screenSizes: {key: ScreenSize, value: number}[] = [\n    {key: ScreenSize.mobile, value: MOBILE_SIZE},\n    {key: ScreenSize.medium, value: MEDIUM_SIZE},\n    {key: ScreenSize.large, value: LARGE_SIZE}\n  ];\n\n  private sizes: {[k in 'desktop' | 'handhelds']: MediaTypeSizes} = {\n    handhelds: {\n      regular: makeMediaSize(270, 270),\n      webpage: makeMediaSize(270, 200),\n      album: makeMediaSize(270, 0),\n      esgSticker: makeMediaSize(68, 68),\n      animatedSticker: makeMediaSize(180, 180),\n      staticSticker: makeMediaSize(180, 180),\n      emojiSticker: makeMediaSize(112, 112),\n      poll: makeMediaSize(240, 0),\n      round: makeMediaSize(240, 240),\n      documentName: makeMediaSize(200, 0),\n      invoice: makeMediaSize(270, 270),\n      extendedInvoice: makeMediaSize(270, 270),\n      customEmoji: CUSTOM_EMOJI_SIZE,\n      esgCustomEmoji: ESG_CUSTOM_EMOJI_SIZE,\n      emojiStatus: EMOJI_STATUS_SIZE,\n      popupSticker: makeMediaSize(68, 68)\n    },\n    desktop: {\n      regular: makeMediaSize(420, 340),\n      webpage: makeMediaSize(420, 340),\n      album: makeMediaSize(420, 0),\n      esgSticker: makeMediaSize(72, 72),\n      animatedSticker: makeMediaSize(200, 200),\n      staticSticker: makeMediaSize(200, 200),\n      emojiSticker: makeMediaSize(112, 112),\n      poll: makeMediaSize(330, 0),\n      round: makeMediaSize(280, 280),\n      documentName: makeMediaSize(240, 0),\n      invoice: makeMediaSize(320, 320),\n      extendedInvoice: makeMediaSize(420, 340),\n      customEmoji: CUSTOM_EMOJI_SIZE,\n      esgCustomEmoji: ESG_CUSTOM_EMOJI_SIZE,\n      emojiStatus: EMOJI_STATUS_SIZE,\n      popupSticker: makeMediaSize(80, 80)\n    }\n  };\n\n  public isMobile = false;\n  public active: MediaTypeSizes;\n  public activeScreen: ScreenSize;\n  private rAF: number;\n\n  constructor() {\n    super();\n\n    window.addEventListener('resize', () => {\n      if(this.rAF) window.cancelAnimationFrame(this.rAF);\n      this.rAF = window.requestAnimationFrame(() => {\n        this.handleResize();\n        this.rAF = 0;\n      });\n    });\n    this.handleResize();\n  }\n\n  private handleResize = () => {\n    const innerWidth = window.innerWidth;\n    // this.isMobile = innerWidth <= 720;\n\n    let activeScreen = this.screenSizes[0].key;\n    for(let i = this.screenSizes.length - 1; i >= 0; --i) {\n      if(this.screenSizes[i].value < innerWidth) {\n        activeScreen = (this.screenSizes[i + 1] || this.screenSizes[i]).key;\n        break;\n      }\n    }\n\n    const wasScreen = this.activeScreen;\n    this.activeScreen = activeScreen;\n    this.isMobile = this.activeScreen === ScreenSize.mobile;\n    this.active = this.isMobile ? this.sizes.handhelds : this.sizes.desktop;\n\n    // console.time('esg');\n    // const computedStyle = window.getComputedStyle(document.documentElement);\n    // this.active.esgSticker.width = parseFloat(computedStyle.getPropertyValue('--esg-sticker-size'));\n    // console.timeEnd('esg');\n\n    if(wasScreen !== activeScreen) {\n      // console.log('changeScreen', this.activeScreen, activeScreen);\n\n      if(wasScreen !== undefined) {\n        this.dispatchEvent('changeScreen', wasScreen, activeScreen);\n      }\n    }\n\n    if(wasScreen !== undefined) {\n      this.dispatchEvent('resize');\n    }\n\n    /* if(this.isMobile) {\n      for(let i in this.active) {\n        // @ts-ignore\n        let size = this.active[i];\n        size.width = innerWidth\n      }\n    } */\n  };\n}\n\nconst mediaSizes = new MediaSizes();\nMOUNT_CLASS_TO.mediaSizes = mediaSizes;\nexport default mediaSizes;\n","export default function clamp(v: number, min: number, max: number): number {\n  return Math.min(max, Math.max(min, v));\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport EventListenerBase from './eventListenerBase';\n\nexport class OverlayCounter extends EventListenerBase<{\n  change: (isActive: boolean) => void\n}> {\n  public overlaysActive = 0;\n\n  get isOverlayActive() {\n    return this.overlaysActive > 0;\n  }\n\n  set isOverlayActive(value: boolean) {\n    this.overlaysActive += value ? 1 : -1;\n    this.dispatchEvent('change', this.isOverlayActive);\n  }\n}\n\nconst overlayCounter = new OverlayCounter();\nexport default overlayCounter;\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\n// * Jolly Cobra's schedulers\nimport {NoneToVoidFunction} from '../types';\n\n/*\nexport function throttleWithTickEnd<F extends AnyToVoidFunction>(fn: F) {\n  return throttleWith(onTickEnd, fn);\n}\n\nexport function throttleWithNow<F extends AnyToVoidFunction>(fn: F) {\n  return throttleWith(runNow, fn);\n}\n\nexport function onTickEnd(cb: NoneToVoidFunction) {\n  Promise.resolve().then(cb);\n}\n\nfunction runNow(fn: NoneToVoidFunction) {\n  fn();\n} */\n\nlet fastRafCallbacks: NoneToVoidFunction[] | undefined;\nexport function fastRaf(callback: NoneToVoidFunction) {\n  if(!fastRafCallbacks) {\n    fastRafCallbacks = [callback];\n\n    requestAnimationFrame(() => {\n      const currentCallbacks = fastRafCallbacks!;\n      fastRafCallbacks = undefined;\n      currentCallbacks.forEach((cb) => cb());\n    });\n  } else {\n    fastRafCallbacks.push(callback);\n  }\n}\n\nlet fastRafConventionalCallbacks: NoneToVoidFunction[] | undefined, processing = false;\nexport function fastRafConventional(callback: NoneToVoidFunction) {\n  if(!fastRafConventionalCallbacks) {\n    fastRafConventionalCallbacks = [callback];\n\n    requestAnimationFrame(() => {\n      processing = true;\n      for(let i = 0; i < fastRafConventionalCallbacks.length; ++i) {\n        fastRafConventionalCallbacks[i]();\n      }\n\n      fastRafConventionalCallbacks = undefined;\n      processing = false;\n    });\n  } else if(processing) {\n    callback();\n  } else {\n    fastRafConventionalCallbacks.push(callback);\n  }\n}\n\nlet rafPromise: Promise<void>;\nexport function fastRafPromise() {\n  if(rafPromise) return rafPromise;\n\n  rafPromise = new Promise<void>((resolve) => fastRaf(() => resolve()));\n  rafPromise.then(() => {\n    rafPromise = undefined;\n  });\n\n  return rafPromise;\n}\n\nexport function doubleRaf() {\n  return new Promise<void>((resolve) => {\n    fastRaf(() => {\n      fastRaf(resolve);\n    });\n  });\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nexport default function parseUriParams(uri: string, splitted = uri.split('?')) {\n  return parseUriParamsLine(splitted?.[1]);\n}\n\nexport function parseUriParamsLine(line: string) {\n  const params: any = {};\n  if(!line) {\n    return params;\n  }\n\n  line.split('&').forEach((item) => {\n    const [key, value = ''] = item.split('=');\n    params[key] = decodeURIComponent(value);\n  });\n\n  return params;\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport type {AppTheme} from '../config/state';\nimport type {Theme} from '../layer';\nimport type AppBackgroundTab from '../components/sidebarLeft/tabs/background';\nimport IS_TOUCH_SUPPORTED from '../environment/touchSupport';\nimport rootScope from '../lib/rootScope';\nimport {changeColorAccent, ColorRgb, getAccentColor, getAverageColor, getHexColorFromTelegramColor, getRgbColorFromTelegramColor, hexToRgb, hslaStringToHex, hsvToRgb, mixColors, rgbaToHexa, rgbaToHsla, rgbToHsv} from './color';\nimport {MOUNT_CLASS_TO} from '../config/debug';\nimport customProperties from './dom/customProperties';\nimport {TelegramWebViewTheme} from '../types';\n\nexport type AppColorName = 'primary-color' | 'message-out-primary-color' |\n  'surface-color' | 'danger-color' | 'primary-text-color' |\n  'secondary-text-color' | 'message-out-background-color' |\n  'saved-color' | 'message-background-color';\ntype AppColor = {\n  rgb?: boolean,\n  light?: boolean,\n  lightFilled?: boolean,\n  dark?: boolean,\n  darkRgb?: boolean,\n  darkFilled?: boolean\n};\n\nconst appColorMap: {[name in AppColorName]: AppColor} = {\n  'primary-color': {\n    rgb: true,\n    light: true,\n    lightFilled: true,\n    dark: true,\n    darkRgb: true\n  },\n  'message-out-primary-color': {\n    lightFilled: true\n  },\n  'surface-color': {\n    rgb: true\n  },\n  'danger-color': {\n    light: true,\n    dark: true\n  },\n  'primary-text-color': {\n    rgb: true\n  },\n  'secondary-text-color': {\n    light: true,\n    lightFilled: true\n  },\n  'message-background-color': {\n    light: true,\n    lightFilled: true,\n    dark: true,\n    darkFilled: true\n  },\n  'message-out-background-color': {\n    light: true,\n    lightFilled: true,\n    dark: true,\n    darkFilled: true\n  },\n  'saved-color': {\n    lightFilled: true\n  }\n};\n\nconst colorMap: {\n  [name in AppTheme['name']]?: {\n    [name in AppColorName]?: string\n  }\n} = {\n  day: {\n    'primary-color': '#3390ec',\n    'message-out-primary-color': '#4fae4e',\n    'message-background-color': '#ffffff',\n    'surface-color': '#ffffff',\n    'danger-color': '#df3f40',\n    'primary-text-color': '#000000',\n    'secondary-text-color': '#707579',\n    'saved-color': '#359AD4'\n  },\n  night: {\n    'primary-color': '#8774E1',\n    'message-out-primary-color': '#8774E1',\n    'message-background-color': '#212121',\n    'surface-color': '#212121',\n    'danger-color': '#ff595a',\n    'primary-text-color': '#ffffff',\n    'secondary-text-color': '#aaaaaa',\n    'saved-color': '#8774E1'\n  }\n};\n\nexport class ThemeController {\n  private themeColor: string;\n  private _themeColorElem: Element;\n  private systemTheme: AppTheme['name'];\n  private styleElement: HTMLStyleElement;\n  public AppBackgroundTab: typeof AppBackgroundTab;\n\n  constructor() {\n    rootScope.addEventListener('theme_change', () => {\n      this.setTheme();\n    });\n\n    // rootScope.addEventListener('settings_updated', ())\n  }\n\n  private get themeColorElem() {\n    if(this._themeColorElem !== undefined) {\n      return this._themeColorElem;\n    }\n\n    return this._themeColorElem = document.head.querySelector('[name=\"theme-color\"]') as Element || null;\n  }\n\n  public setThemeColor(color = this.themeColor) {\n    if(!color) {\n      color = this.isNight() ? '#212121' : '#ffffff';\n    }\n\n    const themeColorElem = this.themeColorElem;\n    if(themeColorElem) {\n      themeColorElem.setAttribute('content', color);\n    }\n  }\n\n  public setThemeListener() {\n    try {\n      const darkModeMediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\n      const checkDarkMode = () => {\n        // const theme = this.getTheme();\n        this.systemTheme = darkModeMediaQuery.matches ? 'night' : 'day';\n        // const newTheme = this.getTheme();\n\n        if(rootScope.myId) {\n          rootScope.dispatchEvent('theme_change');\n        } else {\n          this.setTheme();\n        }\n      };\n\n      if('addEventListener' in darkModeMediaQuery) {\n        darkModeMediaQuery.addEventListener('change', checkDarkMode);\n      } else if('addListener' in darkModeMediaQuery) {\n        (darkModeMediaQuery as any).addListener(checkDarkMode);\n      }\n\n      checkDarkMode();\n    } catch(err) {\n\n    }\n  }\n\n  public applyHighlightningColor() {\n    let hsla: string;\n    const theme = this.getTheme();\n    if(theme.settings?.highlightningColor) {\n      hsla = theme.settings.highlightningColor;\n      document.documentElement.style.setProperty('--message-highlightning-color', hsla);\n    } else {\n      document.documentElement.style.removeProperty('--message-highlightning-color');\n    }\n\n    if(!IS_TOUCH_SUPPORTED && hsla) {\n      this.themeColor = hslaStringToHex(hsla);\n    }\n  }\n\n  public setTheme() {\n    const isNight = this.isNight();\n    const colorScheme = document.head.querySelector('[name=\"color-scheme\"]');\n    colorScheme?.setAttribute('content', isNight ? 'dark' : 'light');\n\n    document.documentElement.classList.toggle('night', isNight);\n    this.setThemeColor();\n    const theme = this.getTheme();\n    this.applyTheme(theme);\n\n    let style = this.styleElement;\n    if(!style) {\n      style = this.styleElement = document.createElement('style');\n      document.head.append(style);\n    }\n\n    const e = document.createElement('div');\n    this.applyTheme(rootScope.settings.themes.find((theme) => theme.name === 'night'), e);\n    style.textContent = `.night {${e.style.cssText}}`;\n\n    this.applyHighlightningColor();\n    rootScope.dispatchEventSingle('theme_changed');\n  }\n\n  public async switchTheme(name: AppTheme['name']) {\n    await rootScope.managers.appStateManager.setByKey('settings.theme', name);\n    rootScope.dispatchEvent('theme_change');\n  }\n\n  public isNight() {\n    return this.getTheme().name === 'night';\n  }\n\n  public getTheme(name: AppTheme['name'] = rootScope.settings.theme === 'system' ? this.systemTheme : rootScope.settings.theme) {\n    return rootScope.settings.themes.find((t) => t.name === name);\n  }\n\n  // theme applier\n  private bindColorApplier(options: Pick<Parameters<ThemeController['applyAppColor']>[0], 'element' | 'isNight'>) {\n    const appliedColors: Set<AppColorName> = new Set();\n    return {\n      applyAppColor: (_options: Omit<Parameters<ThemeController['applyAppColor']>[0], keyof typeof options>) => {\n        appliedColors.add(_options.name);\n        return this.applyAppColor({..._options, ...options});\n      },\n      finalize: () => {\n        const isNight = options.isNight;\n        for(const name in appColorMap) {\n          if(!appliedColors.has(name as AppColorName)) {\n            this.applyAppColor({\n              name: name as AppColorName,\n              hex: colorMap[isNight ? 'night' : 'day'][name as AppColorName],\n              ...options\n            });\n          }\n        }\n      }\n    };\n  };\n\n  public applyAppColor({\n    name,\n    hex,\n    element,\n    lightenAlpha = 0.08,\n    darkenAlpha = lightenAlpha,\n    mixColor,\n    isNight = this.isNight()\n  }: {\n    name: AppColorName,\n    hex: string,\n    element: HTMLElement,\n    lightenAlpha?: number\n    darkenAlpha?: number,\n    mixColor?: ColorRgb,\n    isNight?: boolean\n  }) {\n    const appColor = appColorMap[name];\n    const rgb = hexToRgb(hex);\n    const hsla = rgbaToHsla(...rgb);\n\n    mixColor ??= hexToRgb(colorMap[isNight ? 'night' : 'day']['surface-color']);\n    const lightenedRgb = mixColors(rgb, mixColor, lightenAlpha);\n\n    const darkenedHsla: typeof hsla = {\n      ...hsla,\n      l: hsla.l - darkenAlpha * 100\n    };\n\n    const properties: [string, string][] = [\n      [name, hex],\n      appColor.rgb && [name + '-rgb', rgb.join(',')],\n      appColor.light && ['light-' + name, `rgba(${rgb[0]}, ${rgb[1]}, ${rgb[2]}, ${lightenAlpha})`],\n      appColor.lightFilled && ['light-filled-' + name, rgbaToHexa(lightenedRgb)],\n      appColor.dark && ['dark-' + name, `hsl(${darkenedHsla.h}, ${darkenedHsla.s}%, ${darkenedHsla.l}%)`]\n      // appColor.darkFilled && ['dark-' + name, `hsl(${darkenedHsla.h}, ${darkenedHsla.s}%, ${darkenedHsla.l}%)`]\n    ];\n\n    const isDocumentElement = element === document.documentElement;\n    properties.filter(Boolean).forEach(([name, value]) => {\n      element.style.setProperty('--' + name, value);\n\n      if(isDocumentElement) {\n        customProperties.setPropertyCache(name as AppColorName, value);\n      }\n    });\n  }\n\n  public async applyNewTheme(theme: Theme) {\n    const isNight = this.isNightTheme(theme);\n    const currentTheme = this.getTheme();\n    const themes = rootScope.settings.themes;\n    const themeSettings = theme.settings.find((themeSettings) => themeSettings.base_theme._ === (isNight ? 'baseThemeNight' : 'baseThemeClassic'));\n    const newAppTheme: AppTheme = {\n      ...theme,\n      name: currentTheme.name,\n      settings: {\n        ...themeSettings,\n        highlightningColor: ''\n      }\n    };\n\n    await this.AppBackgroundTab.setBackgroundDocument(themeSettings.wallpaper, newAppTheme.settings);\n    themes[themes.indexOf(currentTheme)] = newAppTheme;\n    await rootScope.managers.appStateManager.setByKey('settings.themes', rootScope.settings.themes);\n    rootScope.dispatchEvent('theme_change');\n  }\n\n  private isNightTheme(theme: Theme | AppTheme) {\n    return (theme as AppTheme).name === 'night' || this.isNight();\n  }\n\n  public applyTheme(theme: Theme | AppTheme, element = document.documentElement) {\n    const isNight = this.isNightTheme(theme);\n    const themeSettings = Array.isArray(theme.settings) ?\n      theme.settings.find((settings) => settings.base_theme._ === (isNight ? 'baseThemeNight' : 'baseThemeClassic')) :\n      theme.settings;\n    const baseColors = colorMap[isNight ? 'night' : 'day'];\n\n    let hsvTemp1 = rgbToHsv(...hexToRgb(baseColors['primary-color'])); // primary base\n    let hsvTemp2 = rgbToHsv(...getRgbColorFromTelegramColor(themeSettings.accent_color)); // new primary\n\n    const newAccentRgb = changeColorAccent(\n      hsvTemp1,\n      hsvTemp2,\n      hexToRgb(baseColors['primary-color']),\n      !isNight\n    );\n    const newAccentHex = rgbaToHexa(newAccentRgb);\n\n    const {applyAppColor, finalize} = this.bindColorApplier({element, isNight});\n\n    applyAppColor({\n      name: 'primary-color',\n      hex: newAccentHex,\n      darkenAlpha: 0.04\n    });\n\n    applyAppColor({\n      name: 'saved-color',\n      hex: newAccentHex,\n      lightenAlpha: 0.64,\n      mixColor: [255, 255, 255]\n    });\n\n    if(!themeSettings.message_colors?.length) {\n      return;\n    }\n\n    const messageLightenAlpha = isNight ? 0.92 : 0.12;\n    const baseMessageColor = hexToRgb(baseColors['message-out-primary-color']);\n    hsvTemp1 = rgbToHsv(...baseMessageColor);\n    const baseMessageOutBackgroundColor = mixColors(baseMessageColor, hexToRgb(baseColors['surface-color']), messageLightenAlpha);\n\n    const firstColor = getRgbColorFromTelegramColor(themeSettings.message_colors[0]);\n\n    let myMessagesAccent = firstColor;\n    if(themeSettings.message_colors.length > 1) {\n      // const w = getAccentColor(hsvTemp1, baseMessageOutBackgroundColor, myMessagesAccent);\n\n      themeSettings.message_colors.slice(1).forEach((nextColor) => {\n        myMessagesAccent = getAverageColor(myMessagesAccent, getRgbColorFromTelegramColor(nextColor));\n      });\n\n      myMessagesAccent = getAccentColor(hsvTemp1, baseMessageOutBackgroundColor, myMessagesAccent);\n\n      // console.log('www', rgbaToHexa(w), rgbaToHexa(myMessagesAccent));\n    }\n\n    const o = myMessagesAccent;\n    hsvTemp2 = rgbToHsv(...o);\n\n    // const c = changeColorAccent(\n    //   hsvTemp1,\n    //   hsvTemp2,\n    //   baseMessageOutBackgroundColor\n    // );\n\n    // console.log(o, c, rgbaToHexa(o), rgbaToHexa(c));\n\n    const accentColor2 = themeSettings.outbox_accent_color !== undefined && rgbToHsv(...getRgbColorFromTelegramColor(themeSettings.outbox_accent_color));\n\n    const newMessageOutBackgroundColor = mixColors(myMessagesAccent, hexToRgb(baseColors['surface-color']), messageLightenAlpha);\n\n    applyAppColor({\n      name: 'message-out-background-color',\n      hex: rgbaToHexa(newMessageOutBackgroundColor),\n      lightenAlpha: messageLightenAlpha\n    });\n\n    applyAppColor({\n      name: 'message-out-primary-color',\n      hex: isNight ? '#ffffff' : rgbaToHexa(accentColor2 ? hsvToRgb(...accentColor2) : myMessagesAccent),\n      mixColor: newMessageOutBackgroundColor\n    });\n\n    // if(accentColor2) {\n    //   console.log(rgbaToHexa(myMessagesAccent), rgbaToHexa(hsvToRgb(...accentColor2)));\n    // }\n\n    finalize();\n  }\n\n  public getThemeParamsForWebView() {\n    const themePropertiesMap: {[key in keyof TelegramWebViewTheme]: string} = {\n      bg_color: 'surface-color',\n      button_color: 'primary-color',\n      button_text_color: '#ffffff',\n      hint_color: 'secondary-text-color',\n      link_color: 'link-color',\n      secondary_bg_color: 'background-color-true',\n      text_color: 'primary-text-color'\n    };\n    const themeParams: TelegramWebViewTheme = {} as any;\n    for(const key in themePropertiesMap) {\n      const value = themePropertiesMap[key as keyof TelegramWebViewTheme];\n      themeParams[key as keyof TelegramWebViewTheme] = value[0] === '#' ? value : customProperties.getProperty(value as AppColorName);\n    }\n\n    return themeParams;\n  }\n}\n\nconst themeController = new ThemeController();\nMOUNT_CLASS_TO && (MOUNT_CLASS_TO.themeController = themeController);\nexport default themeController;\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nexport default function setWorkerProxy() {\n  // * hook worker constructor to set search parameters (test, debug, etc)\n  const workerHandler = {\n    construct(target: any, args: any) {\n      let url = args[0] + '';\n      if(url.indexOf('blob:') !== 0) {\n        url += location.search;\n      }\n\n      return new target(url);\n    }\n  };\n\n  [\n    Worker,\n    typeof(SharedWorker) !== 'undefined' && SharedWorker\n  ].filter(Boolean).forEach((w) => {\n    window[w.name as any] = new Proxy(w, workerHandler);\n  });\n}\n\nsetWorkerProxy();\n","const IS_INSTALL_PROMPT_SUPPORTED = 'onbeforeinstallprompt' in window;\nexport default IS_INSTALL_PROMPT_SUPPORTED;\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport App from './config/app';\nimport blurActiveElement from './helpers/dom/blurActiveElement';\nimport cancelEvent from './helpers/dom/cancelEvent';\nimport {IS_STICKY_INPUT_BUGGED} from './helpers/dom/fixSafariStickyInputFocusing';\nimport loadFonts from './helpers/dom/loadFonts';\nimport IS_EMOJI_SUPPORTED from './environment/emojiSupport';\nimport {IS_ANDROID, IS_APPLE, IS_APPLE_MOBILE, IS_FIREFOX, IS_MOBILE, IS_MOBILE_SAFARI, IS_SAFARI} from './environment/userAgent';\nimport './materialize.scss';\nimport './scss/style.scss';\nimport pause from './helpers/schedulers/pause';\nimport setWorkerProxy from './helpers/setWorkerProxy';\nimport toggleAttributePolyfill from './helpers/dom/toggleAttributePolyfill';\nimport rootScope from './lib/rootScope';\nimport IS_TOUCH_SUPPORTED from './environment/touchSupport';\nimport I18n from './lib/langPack';\nimport './helpers/peerIdPolyfill';\nimport './lib/polyfill';\nimport apiManagerProxy from './lib/mtproto/mtprotoworker';\nimport getProxiedManagers from './lib/appManagers/getProxiedManagers';\nimport themeController from './helpers/themeController';\nimport overlayCounter from './helpers/overlayCounter';\nimport singleInstance from './lib/mtproto/singleInstance';\nimport {parseUriParamsLine} from './helpers/string/parseUriParams';\nimport Modes from './config/modes';\nimport {AuthState} from './types';\nimport {IS_BETA} from './config/debug';\nimport IS_INSTALL_PROMPT_SUPPORTED from './environment/installPrompt';\nimport cacheInstallPrompt from './helpers/dom/installPrompt';\nimport {fillLocalizedDates} from './helpers/date';\n// import appNavigationController from './components/appNavigationController';\n\ndocument.addEventListener('DOMContentLoaded', async() => {\n  toggleAttributePolyfill();\n\n  // polyfill for replaceChildren\n  if((Node as any).prototype.replaceChildren === undefined) {\n    (Node as any).prototype.replaceChildren = function(...nodes: any[]) {\n      this.textContent = '';\n      // while(this.lastChild) {\n      //   this.removeChild(this.lastChild);\n      // }\n      if(nodes) {\n        this.append(...nodes);\n      }\n    }\n  }\n\n  rootScope.managers = getProxiedManagers();\n\n  const manifest = document.getElementById('manifest') as HTMLLinkElement;\n  manifest.href = `site${IS_APPLE && !IS_APPLE_MOBILE ? '_apple' : ''}.webmanifest?v=jw3mK7G9Aq`;\n\n  singleInstance.start();\n\n  // We listen to the resize event (https://css-tricks.com/the-trick-to-viewport-units-on-mobile/)\n  const w = window.visualViewport || window; // * handle iOS keyboard\n  let setViewportVH = false/* , hasFocus = false */;\n  let lastVH: number;\n  const setVH = () => {\n    const vh = (setViewportVH && !overlayCounter.isOverlayActive ? (w as VisualViewport).height || (w as Window).innerHeight : window.innerHeight) * 0.01;\n    if(lastVH === vh) {\n      return;\n    } else if(IS_TOUCH_SUPPORTED && lastVH < vh && (vh - lastVH) > 1) {\n      blurActiveElement(); // (Android) fix blurring inputs when keyboard is being closed (e.g. closing keyboard by back arrow and touching a bubble)\n    }\n\n    lastVH = vh;\n\n    // const vh = document.documentElement.scrollHeight * 0.01;\n    document.documentElement.style.setProperty('--vh', `${vh}px`);\n\n    // console.log('setVH', vh, setViewportVH ? w : window);\n\n    /* if(setViewportVH && userAgent.isSafari && touchSupport.isTouchSupported && document.activeElement && (document.activeElement as HTMLElement).blur) {\n      const rect = document.activeElement.getBoundingClientRect();\n      if(rect.top < 0 || rect.bottom >= (w as any).height) {\n        fastSmoothScroll(findUpClassName(document.activeElement, 'scrollable-y') || window as any, document.activeElement as HTMLElement, 'center', 4, undefined, FocusDirection.Static);\n      }\n    } */\n  };\n\n  setWorkerProxy;\n\n  // const [_, touchSupport, userAgent, _rootScope, _appStateManager, _I18n, __/* , ___ */] = await Promise.all([\n  //   import('./lib/polyfill'),\n  //   import('./environment/touchSupport'),\n  //   import('./environment/userAgent'),\n  //   import('./lib/rootScope'),\n  //   import('./lib/appManagers/appStateManager'),\n  //   import('./lib/langPack'),\n  //   import('./helpers/peerIdPolyfill'),\n  //   // import('./helpers/cacheFunctionPolyfill')\n  // ]);\n\n  /* const {IS_TOUCH_SUPPORTED} = touchSupport;\n  const {IS_FIREFOX, IS_MOBILE, IS_APPLE, IS_SAFARI, IS_APPLE_MOBILE, IS_ANDROID} = userAgent;\n  const rootScope = _rootScope.default;\n  const appStateManager = _appStateManager.default;\n  const I18n = _I18n.default; */\n\n  window.addEventListener('resize', setVH);\n  setVH();\n\n  if(IS_STICKY_INPUT_BUGGED) {\n    const toggleResizeMode = () => {\n      setViewportVH = tabId === 1 && IS_STICKY_INPUT_BUGGED && !overlayCounter.isOverlayActive;\n      setVH();\n\n      if(w !== window) {\n        if(setViewportVH) {\n          window.removeEventListener('resize', setVH);\n          w.addEventListener('resize', setVH);\n        } else {\n          w.removeEventListener('resize', setVH);\n          window.addEventListener('resize', setVH);\n        }\n      }\n    };\n\n    let tabId: number;\n    (window as any).onImTabChange = (id: number) => {\n      const wasTabId = tabId !== undefined;\n      tabId = id;\n\n      if(wasTabId || tabId === 1) {\n        toggleResizeMode();\n      }\n    };\n\n    overlayCounter.addEventListener('change', () => {\n      toggleResizeMode();\n    });\n  }\n\n  if(IS_FIREFOX && !IS_EMOJI_SUPPORTED) {\n    document.addEventListener('dragstart', (e) => {\n      const target = e.target as HTMLElement;\n      if(target.tagName === 'IMG' && target.classList.contains('emoji')) {\n        cancelEvent(e);\n        return false;\n      }\n    });\n  }\n\n  if(IS_EMOJI_SUPPORTED) {\n    document.documentElement.classList.add('native-emoji');\n  }\n\n  // prevent firefox image dragging\n  document.addEventListener('dragstart', (e) => {\n    if((e.target as HTMLElement)?.tagName === 'IMG') {\n      e.preventDefault();\n      return false;\n    }\n  });\n\n  // restrict contextmenu on images (e.g. webp stickers)\n  document.addEventListener('contextmenu', (e) => {\n    if((e.target as HTMLElement).tagName === 'IMG' && !(window as any).appMediaViewer) {\n      cancelEvent(e);\n    }\n  });\n\n  if(IS_FIREFOX) {\n    document.documentElement.classList.add('is-firefox', 'no-backdrop');\n  }\n\n  if(IS_MOBILE) {\n    document.documentElement.classList.add('is-mobile');\n  }\n\n  if(IS_APPLE) {\n    if(IS_SAFARI) {\n      document.documentElement.classList.add('is-safari');\n    }\n\n    // document.documentElement.classList.add('emoji-supported');\n\n    if(IS_APPLE_MOBILE) {\n      document.documentElement.classList.add('is-ios');\n    } else {\n      document.documentElement.classList.add('is-mac');\n    }\n  } else if(IS_ANDROID) {\n    document.documentElement.classList.add('is-android');\n\n    // force losing focus on input blur\n    // focusin and focusout are not working on mobile\n\n    const onInResize = () => {\n      hasFocus = true;\n      window.addEventListener('resize', onOutResize, {once: true});\n    };\n\n    const onOutResize = () => {\n      hasFocus = false;\n      blurActiveElement();\n    };\n\n    let hasFocus = false;\n    document.addEventListener('touchend', (e) => {\n      const input = (e.target as HTMLElement).closest('[contenteditable=\"true\"], input');\n      if(!input) {\n        return;\n      }\n\n      if(document.activeElement !== input && !hasFocus) {\n        console.log('input click', e, document.activeElement, input, input.matches(':focus'));\n        window.addEventListener('resize', onInResize, {once: true});\n      }\n    });\n  }\n\n  if(!IS_TOUCH_SUPPORTED) {\n    document.documentElement.classList.add('no-touch');\n  } else {\n    document.documentElement.classList.add('is-touch');\n    /* document.addEventListener('touchmove', (event: any) => {\n      event = event.originalEvent || event;\n      if(event.scale && event.scale !== 1) {\n        event.preventDefault();\n      }\n    }, {capture: true, passive: false}); */\n  }\n\n  if(IS_INSTALL_PROMPT_SUPPORTED) {\n    cacheInstallPrompt();\n  }\n\n  const perf = performance.now();\n\n  // await pause(1000000);\n\n  const langPromise = I18n.getCacheLangPack();\n\n  const [stateResult, langPack] = await Promise.all([\n    // loadState(),\n    apiManagerProxy.sendState().then(([stateResult]) => stateResult),\n    langPromise\n  ]);\n  I18n.setTimeFormat(stateResult.state.settings.timeFormat);\n\n  rootScope.managers.rootScope.getPremium().then((isPremium) => {\n    rootScope.premium = isPremium;\n  });\n\n  themeController.setThemeListener();\n\n  if(langPack.appVersion !== App.langPackVersion) {\n    I18n.getLangPack(langPack.lang_code);\n  } else {\n    fillLocalizedDates();\n  }\n\n  rootScope.addEventListener('language_change', () => {\n    fillLocalizedDates();\n  });\n\n  /**\n   * won't fire if font is loaded too fast\n   */\n  function fadeInWhenFontsReady(elem: HTMLElement, promise: Promise<any>) {\n    elem.style.opacity = '0';\n\n    promise.then(() => {\n      window.requestAnimationFrame(() => {\n        elem.style.opacity = '';\n      });\n    });\n  }\n\n  console.log('got state, time:', performance.now() - perf);\n\n  if(langPack.lang_code === 'ar' && IS_BETA && false) {\n    document.body.classList.add('is-rtl');\n    document.documentElement.dir = 'rtl';\n    document.documentElement.lang = langPack.lang_code;\n    I18n.setRTL(true);\n  } else {\n    document.documentElement.dir = 'ltr';\n  }\n\n  let authState = stateResult.state.authState;\n\n  const hash = location.hash;\n  const splitted = hash.split('?');\n  const params = parseUriParamsLine(splitted[1] ?? splitted[0].slice(1));\n  if(params.tgWebAuthToken && authState._ !== 'authStateSignedIn') {\n    const data: AuthState.signImport['data'] = {\n      token: params.tgWebAuthToken,\n      dcId: +params.tgWebAuthDcId,\n      userId: params.tgWebAuthUserId.toUserId(),\n      isTest: params.tgWebAuthTest !== undefined && !!+params.tgWebAuthTest,\n      tgAddr: params.tgaddr\n    };\n\n    if(data.isTest !== Modes.test) {\n      const urlSearchParams = new URLSearchParams(location.search);\n      if(+params.tgWebAuthTest) {\n        urlSearchParams.set('test', '1');\n      } else {\n        urlSearchParams.delete('test');\n      }\n\n      location.search = urlSearchParams.toString();\n      return;\n    }\n\n    rootScope.managers.appStateManager.pushToState('authState', authState = {_: 'authStateSignImport', data});\n\n    // appNavigationController.overrideHash('?tgaddr=' + encodeURIComponent(params.tgaddr));\n  }\n\n  if(authState._ !== 'authStateSignedIn'/*  || 1 === 1 */) {\n    console.log('Will mount auth page:', authState._, Date.now() / 1000);\n\n    const el = document.getElementById('auth-pages');\n    let scrollable: HTMLElement;\n    if(el) {\n      scrollable = el.querySelector('.scrollable') as HTMLElement;\n      if((!IS_TOUCH_SUPPORTED || IS_MOBILE_SAFARI)) {\n        scrollable.classList.add('no-scrollbar');\n      }\n\n      // * don't remove this line\n      scrollable.style.opacity = '0';\n\n      const placeholder = document.createElement('div');\n      placeholder.classList.add('auth-placeholder');\n\n      scrollable.prepend(placeholder);\n      scrollable.append(placeholder.cloneNode());\n    }\n\n    try {\n      await Promise.all([\n        import('./lib/mtproto/telegramMeWebManager'),\n        import('./lib/mtproto/webPushApiManager')\n      ]).then(([meModule, pushModule]) => {\n        meModule.default.setAuthorized(false);\n        pushModule.default.forceUnsubscribe();\n      });\n    } catch(err) {\n\n    }\n\n    let pagePromise: Promise<void>;\n    // langPromise.then(async() => {\n    switch(authState._) {\n      case 'authStateSignIn':\n        pagePromise = (await import('./pages/pageSignIn')).default.mount();\n        break;\n      case 'authStateSignQr':\n        pagePromise = (await import('./pages/pageSignQR')).default.mount();\n        break;\n      case 'authStateAuthCode':\n        pagePromise = (await import('./pages/pageAuthCode')).default.mount(authState.sentCode);\n        break;\n      case 'authStatePassword':\n        pagePromise = (await import('./pages/pagePassword')).default.mount();\n        break;\n      case 'authStateSignUp':\n        pagePromise = (await import('./pages/pageSignUp')).default.mount(authState.authCode);\n        break;\n      case 'authStateSignImport':\n        pagePromise = (await import('./pages/pageSignImport')).default.mount(authState.data);\n        break;\n    }\n    // });\n\n    if(scrollable) {\n      // wait for text appear\n      if(pagePromise) {\n        await pagePromise;\n      }\n\n      const promise = 'fonts' in document ?\n        Promise.race([\n          pause(1000),\n          document.fonts.ready\n        ]) :\n        Promise.resolve();\n      fadeInWhenFontsReady(scrollable, promise);\n    }\n\n    /* setTimeout(async() => {\n      (await import('./pages/pageAuthCode')).default.mount({\n        \"_\": \"auth.sentCode\",\n        \"pFlags\": {},\n        \"flags\": 6,\n        \"type\": {\n          \"_\": \"auth.sentCodeTypeSms\",\n          \"length\": 5\n        },\n        \"phone_code_hash\": \"\",\n        \"next_type\": {\n          \"_\": \"auth.codeTypeCall\"\n        },\n        \"timeout\": 120,\n        \"phone_number\": \"\"\n      });\n\n      (await import('./pages/pageSignQR')).default.mount();\n\n      (await import('./pages/pagePassword')).default.mount();\n\n      (await import('./pages/pageSignUp')).default.mount({\n        \"phone_code_hash\": \"\",\n        \"phone_number\": \"\"\n      });\n    }, 500); */\n  } else {\n    console.log('Will mount IM page:', Date.now() / 1000);\n    fadeInWhenFontsReady(document.getElementById('main-columns'), loadFonts());\n    (await import('./pages/pageIm')).default.mount();\n  }\n});\n","export default function toggleAttributePolyfill() {\n  if(!Element.prototype.toggleAttribute) {\n    Element.prototype.toggleAttribute = function(name, force) {\n      if(force !== void 0) force = !!force;\n\n      if(this.hasAttribute(name)) {\n        if(force) return true;\n\n        this.removeAttribute(name);\n        return false;\n      }\n      if(force === false) return false;\n\n      this.setAttribute(name, '');\n      return true;\n    };\n  }\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n *\n * Originally from:\n * https://github.com/zhukov/webogram\n * Copyright (C) 2014 Igor Zhukov <igor.beatle@gmail.com>\n * https://github.com/zhukov/webogram/blob/master/LICENSE\n */\n\nexport class AppRuntimeManager {\n  public reload() {\n    try {\n      location.reload();\n    } catch(e) {};\n\n    // if(window.chrome && chrome.runtime && chrome.runtime.reload) {\n    //   chrome.runtime.reload();\n    // }\n  }\n\n  public close() {\n    try {\n      window.close();\n    } catch(e) {}\n  }\n\n  /**\n   * Better to call from event\n   */\n  public focus() {\n    // // @ts-ignore\n    // if(window.navigator.mozApps && document.hidden) {\n    //   // Get app instance and launch it to bring app to foreground\n    //   // @ts-ignore\n    //   window.navigator.mozApps.getSelf().onsuccess = function() {\n    //     this.result.launch();\n    //   };\n    // } else {\n    //   // @ts-ignore\n    //   if(window.chrome && chrome.app && chrome.app.window) {\n    //     // @ts-ignore\n    //     chrome.app.window.current().focus();\n    //   }\n\n    window.focus();\n    // }\n  }\n}\n\nconst appRuntimeManager = new AppRuntimeManager();\nexport default appRuntimeManager;\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport type createManagers from './createManagers';\nimport {ModifyFunctionsToAsync} from '../../types';\nimport apiManagerProxy from '../mtproto/mtprotoworker';\nimport {AckedResult} from '../mtproto/superMessagePort';\nimport noop from '../../helpers/noop';\nimport dT from '../../helpers/dT';\nimport DEBUG from '../../config/debug';\n\n// let stats: {\n//   [manager: string]: {\n//     [method: string]: {\n//       times: number[],\n//       byArgs: {\n//         [args: string]: number[]\n//       }\n//     }\n//   }\n// } = {};\n\n// let sentCount = 0;\n// let sentMethods: {[key: string]: number} = {};\n// let sentMethods2: {[key: string]: number} = {};\n// function collectStats(manager: string, method: string, args: any[], promise: Promise<any>) {\n//   ++sentCount;\n\n//   const key = [manager, method].join('-');\n//   if(!sentMethods[key]) sentMethods[key] = 0;\n//   ++sentMethods[key];\n\n//   const key2 = [('00000' + sentCount).slice(-5), key].join('-');\n\n//   const byManager = stats[manager] ??= {};\n//   const byMethod = byManager[method] ??= {times: [], byArgs: {}};\n\n//   const perf = performance.now();\n//   promise.catch(noop).finally(() => {\n//     const time = performance.now() - perf;\n//     byMethod.times.push(time);\n\n//     sentMethods2[key2] = time;\n\n//     try {\n//       const argsString = JSON.stringify(args);\n//       byMethod.byArgs[argsString].push(time);\n//     } catch(err) {}\n//   });\n// }\n\n// setInterval(() => {\n//   console.log(dT(), '[PROXY] stats', stats, sentCount, sentMethods, sentMethods2);\n//   sentCount = 0;\n//   stats = {};\n//   sentMethods = {};\n//   sentMethods2 = {};\n// }, 2000);\n\nconst DEBUG_MANAGER_REQUESTS: {[managerName: string]: Set<string>} = {\n  // appProfileManager: new Set(['getProfile', 'getProfileByPeerId'])\n};\nif(DEBUG) {\n  (window as any).DEBUG_MANAGER_REQUESTS = DEBUG_MANAGER_REQUESTS;\n}\n\nfunction createProxy(/* source: T,  */name: string, ack?: boolean) {\n  const proxy = new Proxy({}, {\n    get: (target, p, receiver) => {\n      // console.log('get', target, p, receiver);\n      // @ts-ignore\n      // const value = source[p];\n      // if(typeof(value) !== 'function') {\n      //   return value;\n      // }\n\n      return (...args: any[]) => {\n        const promise = apiManagerProxy.invoke('manager', {\n          name,\n          method: p as string,\n          args\n        }, ack as any);\n\n        if(DEBUG) {\n          if(DEBUG_MANAGER_REQUESTS[name]?.has(p as any)) {\n            console.warn('manager request', name, p, args, ack);\n          }\n        }\n\n        // collectStats(name, p as string, args, promise);\n\n        return promise;\n\n        // @ts-ignore\n        // return Promise.resolve(value.call(source, ...args));\n      };\n    }\n  });\n\n  return proxy;\n}\n\ntype AA<T> = {\n  [key in keyof T]: T[key] extends (...args: infer A) => infer R ? (...args: A) => Promise<AckedResult<Awaited<R>>> : never\n};\n\ntype T = Awaited<ReturnType<typeof createManagers>>;\ntype ProxiedManagers = {\n  [name in keyof T]?: ModifyFunctionsToAsync<T[name]>;\n} & {\n  acknowledged?: {\n    [name in keyof T]?: AA<T[name]>;\n  }\n};\n\nfunction createProxyProxy(proxied: any, ack?: boolean) {\n  return new Proxy(proxied, {\n    get: (target, p, receiver) => {\n      // @ts-ignore\n      return target[p] ??= createProxy(p as string, ack);\n    }\n  });\n}\n\nlet proxied: ProxiedManagers;\nexport default function getProxiedManagers() {\n  if(proxied) {\n    return proxied;\n  }\n\n  proxied = createProxyProxy({}, false);\n  proxied.acknowledged = createProxyProxy({}, true);\n  return proxied;\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport clearMessageId from './clearMessageId';\n\n/**\n * * will ignore outgoing offset\n */\nexport default function getServerMessageId(messageId: number) {\n  return clearMessageId(messageId, true);\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n *\n * Originally from:\n * https://github.com/zhukov/webogram\n * Copyright (C) 2014 Igor Zhukov <igor.beatle@gmail.com>\n * https://github.com/zhukov/webogram/blob/master/LICENSE\n */\n\nimport {Database} from '../../config/databases';\nimport Modes from '../../config/modes';\nimport makeError from '../../helpers/makeError';\nimport safeAssign from '../../helpers/object/safeAssign';\nimport {logger} from '../logger';\n\n/**\n * https://developer.mozilla.org/en-US/docs/Web/API/IDBObjectStore/createIndex\n */\nexport type IDBIndex = {\n  indexName: string,\n  keyPath: string,\n  objectParameters: IDBIndexParameters\n};\n\nexport type IDBStore = {\n  name: string,\n  indexes?: IDBIndex[]\n};\n\nexport type IDBOptions = {\n  name?: string,\n  storeName: string,\n  stores?: IDBStore[],\n  version?: number\n};\n\nconst DEBUG = false;\n\nexport class IDB {\n  private static INSTANCES: IDB[] = [];\n  private openDbPromise: Promise<IDBDatabase>;\n  private db: IDBDatabase;\n  private storageIsAvailable: boolean;\n  private log: ReturnType<typeof logger>;\n  private name: string;\n  private version: number;\n  private stores: IDBStore[];\n\n  constructor(db: Database<any>) {\n    safeAssign(this, db);\n\n    if(Modes.test) {\n      this.name += '_test';\n    }\n\n    this.storageIsAvailable = true;\n    this.log = logger(['IDB', db.name].join('-'));\n    this.log('constructor');\n\n    this.openDatabase(true);\n\n    IDB.INSTANCES.push(this);\n  }\n\n  public isAvailable() {\n    return this.storageIsAvailable;\n  }\n\n  public openDatabase(createNew = false): Promise<IDBDatabase> {\n    if(this.openDbPromise && !createNew) {\n      return this.openDbPromise;\n    }\n\n    const createIndexes = (os: IDBObjectStore, store: IDBStore) => {\n      const indexNames = Array.from(os.indexNames);\n      for(const indexName of indexNames) {\n        os.deleteIndex(indexName);\n      }\n\n      if(!store.indexes?.length) {\n        return;\n      }\n\n      for(const index of store.indexes) {\n        if(os.indexNames.contains(index.indexName)) {\n          continue;\n        }\n\n        os.createIndex(index.indexName, index.keyPath, index.objectParameters);\n      }\n    };\n\n    const createObjectStore = (db: IDBDatabase, store: IDBStore) => {\n      const os = db.createObjectStore(store.name);\n      createIndexes(os, store);\n    };\n\n    try {\n      var request = indexedDB.open(this.name, this.version);\n\n      if(!request) {\n        return Promise.reject();\n      }\n    } catch(error) {\n      this.log.error('error opening db', (error as Error).message);\n      this.storageIsAvailable = false;\n      return Promise.reject(error);\n    }\n\n    let finished = false;\n    setTimeout(() => {\n      if(!finished) {\n        request.onerror(makeError('IDB_CREATE_TIMEOUT') as Event);\n      }\n    }, 3000);\n\n    return this.openDbPromise = new Promise<IDBDatabase>((resolve, reject) => {\n      request.onsuccess = (event) => {\n        finished = true;\n        const db = request.result;\n        let calledNew = false;\n\n        this.log('Opened');\n\n        db.onerror = (error) => {\n          this.storageIsAvailable = false;\n          this.log.error('Error creating/accessing IndexedDB database', error);\n          reject(error);\n        };\n\n        db.onclose = (e) => {\n          this.log.error('closed:', e);\n          !calledNew && this.openDatabase();\n        };\n\n        db.onabort = (e) => {\n          this.log.error('abort:', e);\n          const transaction = e.target as IDBTransaction;\n\n          this.openDatabase(calledNew = true);\n\n          if(transaction.onerror) {\n            transaction.onerror(e);\n          }\n\n          db.close();\n        };\n\n        db.onversionchange = (e) => {\n          this.log.error('onversionchange, lol?');\n        };\n\n        resolve(this.db = db);\n      };\n\n      request.onerror = (event) => {\n        finished = true;\n        this.storageIsAvailable = false;\n        this.log.error('Error creating/accessing IndexedDB database', event);\n        reject(event);\n      };\n\n      request.onupgradeneeded = (event) => {\n        finished = true;\n        this.log.warn('performing idb upgrade from', event.oldVersion, 'to', event.newVersion);\n\n        const target = event.target as IDBOpenDBRequest;\n        const db = target.result;\n        this.stores.forEach((store) => {\n          /* if(db.objectStoreNames.contains(store.name)) {\n            //if(event.oldVersion === 1) {\n              db.deleteObjectStore(store.name);\n            //}\n          } */\n\n          if(!db.objectStoreNames.contains(store.name)) {\n            createObjectStore(db, store);\n          } else {\n            const txn = target.transaction;\n            const os = txn.objectStore(store.name);\n            createIndexes(os, store);\n          }\n        });\n      };\n    });\n  }\n\n  public static create<T extends Database<any>>(db: T) {\n    return this.INSTANCES.find((instance) => instance.name === db.name) ?? new IDB(db);\n  }\n\n  public static closeDatabases(preserve?: IDB) {\n    this.INSTANCES.forEach((storage) => {\n      if(preserve && preserve === storage) {\n        return;\n      }\n\n      const db = storage.db;\n      if(db) {\n        db.onclose = () => {};\n        db.close();\n      }\n    });\n  }\n}\n\nexport default class IDBStorage<T extends Database<any>, StoreName extends string = T['stores'][0]['name']> {\n  private log: ReturnType<typeof logger>;\n  private storeName: T['stores'][0]['name'];\n  private idb: IDB;\n\n  constructor(db: T, storeName: typeof db['stores'][0]['name']) {\n    this.storeName = storeName;\n    this.log = logger(['IDB', db.name, storeName].join('-'));\n    this.idb = IDB.create(db);\n  }\n\n  /**\n   * ! WARNING ! function requires at least one opened connection\n   */\n  /* public static clearObjectStores() {\n    const storage = this.STORAGES[0];\n    this.closeDatabases(storage);\n\n    const names = Array.from(storage.db.objectStoreNames);\n    const promises = names.map((name) => storage.clear(name));\n    return Promise.all(promises);\n  } */\n\n  /* public static deleteDatabase() {\n    this.closeDatabases();\n\n    const storages = this.STORAGES;\n    const dbNames = Array.from(new Set(storages.map((storage) => storage.name)));\n    const promises = dbNames.map((dbName) => {\n      return new Promise<void>((resolve, reject) => {\n        const deleteRequest = indexedDB.deleteDatabase(dbName);\n\n        deleteRequest.onerror = () => {\n          reject();\n        };\n\n        deleteRequest.onsuccess = () => {\n          resolve();\n        };\n      });\n    });\n\n    return Promise.all(promises);\n  } */\n\n  public delete(entryName: string | string[], storeName?: StoreName): Promise<void> {\n    // return Promise.resolve();\n    const isArray = Array.isArray(entryName);\n    if(!isArray) {\n      entryName = [].concat(entryName);\n    }\n\n    return this.getObjectStore('readwrite', (objectStore) => {\n      const promises = (entryName as string[]).map((entryName) => objectStore.delete(entryName));\n      return isArray ? promises : promises[0];\n    }, DEBUG ? 'delete: ' + (entryName as string[]).join(', ') : '', storeName);\n  }\n\n  public clear(storeName?: StoreName): Promise<void> {\n    return this.getObjectStore('readwrite', (objectStore) => objectStore.clear(), DEBUG ? 'clear' : '', storeName);\n  }\n\n  public save(entryName: string | string[], value: any | any[], storeName?: StoreName) {\n    // const handleError = (error: Error) => {\n    //   this.log.error('save: transaction error:', entryName, value, db, error, error && error.name);\n    //   if((!error || error.name === 'InvalidStateError')/*  && false */) {\n    //     setTimeout(() => {\n    //       this.save(entryName, value);\n    //     }, 2e3);\n    //   } else {\n    //     //console.error('IndexedDB saveFile transaction error:', error, error && error.name);\n    //   }\n    // };\n\n    const isArray = Array.isArray(entryName);\n    if(!isArray) {\n      entryName = [].concat(entryName);\n      value = [].concat(value);\n    }\n\n    return this.getObjectStore('readwrite', (objectStore) => {\n      const promises = (entryName as string[]).map((entryName, idx) => objectStore.put(value[idx], entryName));\n      return isArray ? promises : promises[0];\n    }, DEBUG ? 'save: ' + (entryName as string[]).join(', ') : '', storeName);\n  }\n\n  // public saveFile(fileName: string, blob: Blob | Uint8Array) {\n  //   //return Promise.resolve(blobConstruct([blob]));\n  //   if(!(blob instanceof Blob)) {\n  //     blob = blobConstruct(blob);\n  //   }\n\n  //   return this.save(fileName, blob);\n  // }\n\n  /* public saveFileBase64(db: IDBDatabase, fileName: string, blob: Blob | any): Promise<Blob> {\n    if(this.getBlobSize(blob) > 10 * 1024 * 1024) {\n      return Promise.reject();\n    }\n\n    if(!(blob instanceof Blob)) {\n      var safeMimeType = blobSafeMimeType(blob.type || 'image/jpeg');\n      var address = 'data:' + safeMimeType + ';base64,' + bytesToBase64(blob);\n      return this.storagePutB64String(db, fileName, address).then(() => {\n        return blob;\n      });\n    }\n\n    try {\n      var reader = new FileReader();\n    } catch (e) {\n      this.storageIsAvailable = false;\n      return Promise.reject();\n    }\n\n    let promise = new Promise<Blob>((resolve, reject) => {\n      reader.onloadend = () => {\n        this.storagePutB64String(db, fileName, reader.result as string).then(() => {\n          resolve(blob);\n        }, reject);\n      }\n\n      reader.onerror = reject;\n    });\n\n\n    try {\n      reader.readAsDataURL(blob);\n    } catch (e) {\n      this.storageIsAvailable = false;\n      return Promise.reject();\n    }\n\n    return promise;\n  }\n\n  public storagePutB64String(db: IDBDatabase, fileName: string, b64string: string) {\n    try {\n      var objectStore = db.transaction([this.storeName], 'readwrite')\n        .objectStore(this.storeName);\n      var request = objectStore.put(b64string, fileName);\n    } catch(error) {\n      this.storageIsAvailable = false;\n      return Promise.reject(error);\n    }\n\n    return new Promise((resolve, reject) => {\n      request.onsuccess = function(event) {\n        resolve();\n      };\n\n      request.onerror = reject;\n    });\n  }\n\n  public getBlobSize(blob: any) {\n    return blob.size || blob.byteLength || blob.length;\n  } */\n\n  public get<T>(entryName: string[], storeName?: StoreName): Promise<T[]>;\n  public get<T>(entryName: string, storeName?: StoreName): Promise<T>;\n  public get<T>(entryName: string | string[], storeName?: StoreName): Promise<T> | Promise<T[]> {\n    // return Promise.reject();\n\n    const isArray = Array.isArray(entryName);\n    if(!isArray) {\n      if(!entryName) {\n        return undefined;\n      }\n\n      entryName = [].concat(entryName);\n    } else if(!entryName.length) {\n      return Promise.resolve([]) as any;\n    }\n\n    return this.getObjectStore<T>('readonly', (objectStore) => {\n      const promises = (entryName as string[]).map((entryName) => objectStore.get(entryName));\n      return isArray ? promises : promises[0];\n    }, DEBUG ? 'get: ' + (entryName as string[]).join(', ') : '', storeName);\n  }\n\n  private getObjectStore<T>(\n    mode: IDBTransactionMode,\n    callback: (objectStore: IDBObjectStore) => IDBRequest | IDBRequest[],\n    log?: string,\n    storeName = this.storeName\n  ) {\n    let perf: number;\n\n    if(log) {\n      perf = performance.now();\n      this.log(log + ': start');\n    }\n\n    return this.idb.openDatabase().then((db) => {\n      return new Promise<T>((resolve, reject) => {\n        /* if(mode === 'readwrite') {\n          return;\n        } */\n\n        const transaction = db.transaction([storeName], mode);\n\n        const onError = () => {\n          clearTimeout(timeout);\n          reject(transaction.error);\n        };\n\n        // let resolved = false;\n        const onComplete = (/* what: string */) => {\n          clearTimeout(timeout);\n\n          if(log) {\n            this.log(log + ': end', performance.now() - perf/* , what */);\n          }\n\n          // if(resolved) {\n          //   return;\n          // }\n\n          // resolved = true;\n          const results = requests.map((r) => r.result);\n          resolve(isArray ? results : results[0]);\n        };\n\n        transaction.onerror = onError;\n\n        // * have to wait while clearing or setting something\n        const waitForTransactionComplete = mode === 'readwrite';\n        if(waitForTransactionComplete) {\n          transaction.oncomplete = () => onComplete(/* 'transaction' */);\n        }\n\n        const timeout = setTimeout(() => {\n          this.log.error('transaction not finished', transaction, log);\n        }, 10000);\n\n        /* transaction.addEventListener('abort', (e) => {\n          //handleError();\n          this.log.error('IndexedDB: transaction abort!', transaction.error);\n        }); */\n\n        const callbackResult = callback(transaction.objectStore(storeName));\n\n        const isArray = Array.isArray(callbackResult);\n        const requests: IDBRequest[] = isArray ? callbackResult : [].concat(callbackResult) as any;\n\n        if(waitForTransactionComplete) {\n          return;\n        }\n\n        const length = requests.length;\n        let left = length;\n\n        const onRequestFinished = () => {\n          if(transaction.error) {\n            return;\n          }\n\n          if(!--left) {\n            onComplete(/* 'requests' */);\n          }\n        };\n\n        for(let i = 0; i < length; ++i) {\n          const request = requests[i];\n          request.onerror = onError;\n          request.onsuccess = onRequestFinished;\n        }\n      });\n    });\n  }\n\n  public getAll<T>(storeName?: StoreName): Promise<T[]> {\n    return this.getObjectStore<T[]>('readonly', (objectStore) => objectStore.getAll(), DEBUG ? 'getAll' : '', storeName);\n  }\n\n  /* public getAllKeys(): Promise<Array<string>> {\n    console.time('getAllEntries');\n    return this.openDatabase().then((db) => {\n      var objectStore = db.transaction([this.storeName], 'readonly')\n        .objectStore(this.storeName);\n      var request = objectStore.getAllKeys();\n\n      return new Promise((resolve, reject) => {\n        request.onsuccess = function(event) {\n          // @ts-ignore\n          var result = event.target.result;\n          resolve(result);\n          console.timeEnd('getAllEntries');\n        }\n\n        request.onerror = reject;\n      });\n    });\n  } */\n\n  /* public isFileExists(fileName: string): Promise<boolean> {\n    console.time('isFileExists');\n    return this.openDatabase().then((db) => {\n      var objectStore = db.transaction([this.storeName], 'readonly')\n        .objectStore(this.storeName);\n      var request = objectStore.openCursor(fileName);\n\n      return new Promise((resolve, reject) => {\n        request.onsuccess = function(event) {\n          // @ts-ignore\n          var cursor = event.target.result;\n          resolve(!!cursor);\n          console.timeEnd('isFileExists');\n        }\n\n        request.onerror = reject;\n      });\n    });\n  } */\n\n  /* public getFileWriter(fileName: string, mimeType: string) {\n    var fakeWriter = FileManager.getFakeFileWriter(mimeType, (blob) => {\n      return this.saveFile(fileName, blob);\n    });\n\n    return Promise.resolve(fakeWriter);\n  } */\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport type lang from '../lang';\nimport type langSign from '../langSign';\nimport type {State} from '../config/state';\nimport DEBUG, {MOUNT_CLASS_TO} from '../config/debug';\nimport {HelpCountriesList, HelpCountry, LangPackDifference, LangPackString} from '../layer';\nimport stateStorage from './stateStorage';\nimport App from '../config/app';\nimport rootScope from './rootScope';\nimport {IS_MOBILE} from '../environment/userAgent';\nimport deepEqual from '../helpers/object/deepEqual';\nimport safeAssign from '../helpers/object/safeAssign';\nimport capitalizeFirstLetter from '../helpers/string/capitalizeFirstLetter';\nimport matchUrlProtocol from './richTextProcessor/matchUrlProtocol';\nimport wrapUrl from './richTextProcessor/wrapUrl';\nimport {setDirection} from '../helpers/dom/setInnerHTML';\n\nexport const langPack: {[actionType: string]: LangPackKey} = {\n  'messageActionChatCreate': 'ActionCreateGroup',\n  'messageActionChatCreateYou': 'ActionYouCreateGroup',\n  'messageActionChatEditTitle': 'ActionChangedTitle',\n  'messageActionChatEditPhoto': 'ActionChangedPhoto',\n  'messageActionChatEditVideo': 'ActionChangedVideo',\n  'messageActionChatDeletePhoto': 'ActionRemovedPhoto',\n  'messageActionChatReturn': 'ActionAddUserSelf',\n  'messageActionChatReturnYou': 'ActionAddUserSelfYou',\n  'messageActionChatJoined': 'ActionAddUserSelfMega',\n  'messageActionChatJoinedYou': 'ChannelMegaJoined',\n  'messageActionChatAddUser': 'ActionAddUser',\n  'messageActionChatAddUsers': 'ActionAddUser',\n  'messageActionChatLeave': 'ActionLeftUser',\n  'messageActionChatLeaveYou': 'YouLeft',\n  'messageActionChatDeleteUser': 'ActionKickUser',\n  'messageActionChatJoinedByLink': 'ActionInviteUser',\n  'messageActionPinMessage': 'Chat.Service.Group.UpdatedPinnedMessage',\n  'messageActionContactSignUp': 'Chat.Service.PeerJoinedTelegram',\n  'messageActionChannelCreate': 'ActionCreateChannel',\n  'messageActionChannelEditTitle': 'Chat.Service.Channel.UpdatedTitle',\n  'messageActionChannelEditPhoto': 'Chat.Service.Channel.UpdatedPhoto',\n  'messageActionChannelEditVideo': 'Chat.Service.Channel.UpdatedVideo',\n  'messageActionChannelDeletePhoto': 'Chat.Service.Channel.RemovedPhoto',\n  'messageActionHistoryClear': 'HistoryCleared',\n  'messageActionDiscussionStarted': 'DiscussionStarted',\n\n  'messageActionChannelMigrateFrom': 'ActionMigrateFromGroup',\n\n  'messageActionPhoneCall.video_in_ok': 'ChatList.Service.VideoCall.incoming',\n  'messageActionPhoneCall.video_out_ok': 'ChatList.Service.VideoCall.outgoing',\n  'messageActionPhoneCall.video_missed': 'ChatList.Service.VideoCall.Missed',\n  'messageActionPhoneCall.video_cancelled': 'ChatList.Service.VideoCall.Cancelled',\n  'messageActionPhoneCall.in_ok': 'ChatList.Service.Call.incoming',\n  'messageActionPhoneCall.out_ok': 'ChatList.Service.Call.outgoing',\n  'messageActionPhoneCall.missed': 'ChatList.Service.Call.Missed',\n  'messageActionPhoneCall.cancelled': 'ChatList.Service.Call.Cancelled',\n\n  'messageActionGroupCall.started': 'Chat.Service.VoiceChatStarted.Channel',\n  'messageActionGroupCall.started_by': 'Chat.Service.VoiceChatStarted',\n  'messageActionGroupCall.started_byYou': 'Chat.Service.VoiceChatStartedYou',\n  'messageActionGroupCall.ended': 'Chat.Service.VoiceChatFinished.Channel',\n  'messageActionGroupCall.ended_by': 'Chat.Service.VoiceChatFinished',\n  'messageActionGroupCall.ended_byYou': 'Chat.Service.VoiceChatFinishedYou',\n\n  'messageActionBotAllowed': 'Chat.Service.BotPermissionAllowed'\n};\n\nexport type LangPackKey = /* string |  */keyof typeof lang | keyof typeof langSign;\n\nexport type FormatterArgument = string | number | Node | FormatterArgument[];\nexport type FormatterArguments = FormatterArgument[];\n\nexport const UNSUPPORTED_LANG_PACK_KEY: LangPackKey = IS_MOBILE ? 'Message.Unsupported.Mobile' : 'Message.Unsupported.Desktop';\n\nnamespace I18n {\n  export const strings: Map<LangPackKey, LangPackString> = new Map();\n  export const countriesList: HelpCountry[] = [];\n  let pluralRules: Intl.PluralRules;\n\n  let cacheLangPackPromise: Promise<LangPackDifference>;\n  export let lastRequestedLangCode: string;\n  export let lastRequestedNormalizedLangCode: string;\n  export let lastAppliedLangCode: string;\n  export let requestedServerLanguage = false;\n  export let timeFormat: State['settings']['timeFormat'];\n  export let isRTL = false;\n\n  export function setRTL(rtl: boolean) {\n    isRTL = rtl;\n  }\n\n  function setLangCode(langCode: string) {\n    lastRequestedLangCode = langCode;\n    lastRequestedNormalizedLangCode = langCode.split('-')[0];\n  }\n\n  export function getCacheLangPack(): Promise<LangPackDifference> {\n    if(cacheLangPackPromise) return cacheLangPackPromise;\n    return cacheLangPackPromise = Promise.all([\n      stateStorage.get('langPack') as Promise<LangPackDifference>,\n      polyfillPromise\n    ]).then(([langPack]) => {\n      if(!langPack/*  || true */) {\n        return loadLocalLangPack();\n      } else if(DEBUG && false) {\n        return getLangPack(langPack.lang_code);\n      }/*  else if(langPack.appVersion !== App.langPackVersion) {\n        return getLangPack(langPack.lang_code);\n      } */\n\n      if(!lastRequestedLangCode) {\n        setLangCode(langPack.lang_code);\n      }\n\n      applyLangPack(langPack);\n      return langPack;\n    }).finally(() => {\n      cacheLangPackPromise = undefined;\n    });\n  }\n\n  function updateAmPm() {\n    if(timeFormat === 'h12') {\n      try {\n        const dateTimeFormat = getDateTimeFormat({hour: 'numeric', minute: 'numeric', hour12: true});\n        const date = new Date();\n        date.setHours(0);\n        const amText = dateTimeFormat.format(date);\n        amPmCache.am = amText.split(/\\s/)[1];\n        date.setHours(12);\n        const pmText = dateTimeFormat.format(date);\n        amPmCache.pm = pmText.split(/\\s/)[1];\n      } catch(err) {\n        console.error('cannot get am/pm', err);\n        amPmCache = {am: 'AM', pm: 'PM'};\n      }\n    }\n  }\n\n  export function setTimeFormat(\n    format: State['settings']['timeFormat'],\n    haveToUpdate = !!timeFormat && timeFormat !== format\n  ) {\n    timeFormat = format;\n\n    updateAmPm();\n\n    if(haveToUpdate) {\n      cachedDateTimeFormats.clear();\n      const elements = Array.from(document.querySelectorAll(`.i18n`)) as HTMLElement[];\n      elements.forEach((element) => {\n        const instance = weakMap.get(element);\n\n        if(instance instanceof IntlDateElement) {\n          instance.update();\n        }\n      });\n    }\n  }\n\n  export function loadLocalLangPack() {\n    const defaultCode = App.langPackCode;\n    setLangCode(defaultCode);\n    return Promise.all([\n      import('../lang'),\n      import('../langSign'),\n      import('../countries')\n    ]).then(([lang, langSign, countries]) => {\n      const strings: LangPackString[] = [];\n      formatLocalStrings(lang.default, strings);\n      formatLocalStrings(langSign.default, strings);\n\n      const langPack: LangPackDifference = {\n        _: 'langPackDifference',\n        from_version: 0,\n        lang_code: defaultCode,\n        strings,\n        version: 0,\n        local: true,\n        countries: countries.default\n      };\n      return saveLangPack(langPack);\n    });\n  }\n\n  export function loadLangPack(langCode: string, web?: boolean) {\n    web = true;\n    requestedServerLanguage = true;\n    const managers = rootScope.managers;\n    return Promise.all([\n      managers.apiManager.invokeApiCacheable('langpack.getLangPack', {\n        lang_code: langCode,\n        lang_pack: web ? 'web' : App.langPack\n      }),\n      !web && managers.apiManager.invokeApiCacheable('langpack.getLangPack', {\n        lang_code: langCode,\n        lang_pack: 'android'\n      }),\n      import('../lang'),\n      import('../langSign'),\n      managers.apiManager.invokeApiCacheable('help.getCountriesList', {\n        lang_code: langCode,\n        hash: 0\n      }) as Promise<HelpCountriesList.helpCountriesList>,\n      polyfillPromise\n    ]);\n  }\n\n  export function getStrings(langCode: string, strings: string[]) {\n    return rootScope.managers.apiManager.invokeApi('langpack.getStrings', {\n      lang_pack: App.langPack,\n      lang_code: langCode,\n      keys: strings\n    });\n  }\n\n  export function formatLocalStrings(strings: any, pushTo: LangPackString[] = []) {\n    for(const i in strings) {\n      // @ts-ignore\n      const v = strings[i];\n      if(typeof(v) === 'string') {\n        pushTo.push({\n          _: 'langPackString',\n          key: i,\n          value: v\n        });\n      } else {\n        pushTo.push({\n          _: 'langPackStringPluralized',\n          key: i,\n          ...v\n        });\n      }\n    }\n\n    return pushTo;\n  }\n\n  export function getLangPack(langCode: string, web?: boolean) {\n    setLangCode(langCode);\n    return loadLangPack(langCode, web).then(([langPack1, langPack2, localLangPack1, localLangPack2, countries, _]) => {\n      let strings: LangPackString[] = [];\n\n      [localLangPack1, localLangPack2].forEach((l) => {\n        formatLocalStrings(l.default as any, strings);\n      });\n\n      strings = strings.concat(...[langPack1.strings, langPack2.strings].filter(Boolean));\n\n      langPack1.strings = strings;\n      langPack1.countries = countries;\n      return saveLangPack(langPack1);\n    });\n  }\n\n  export function saveLangPack(langPack: LangPackDifference) {\n    langPack.appVersion = App.langPackVersion;\n\n    return stateStorage.set({langPack}).then(() => {\n      applyLangPack(langPack);\n      return langPack;\n    });\n  }\n\n  export const polyfillPromise = (function checkIfPolyfillNeeded() {\n    if(typeof(Intl) !== 'undefined' && typeof(Intl.PluralRules) !== 'undefined'/*  && false */) {\n      return Promise.resolve();\n    } else {\n      return import('./pluralPolyfill').then((_Intl) => {\n        (window as any).Intl = Object.assign(typeof(Intl) !== 'undefined' ? Intl : {}, _Intl.default);\n      });\n    }\n  })();\n\n  export function applyLangPack(langPack: LangPackDifference) {\n    const currentLangCode = lastRequestedLangCode;\n    if(langPack.lang_code !== currentLangCode) {\n      return;\n    }\n\n    try {\n      pluralRules = new Intl.PluralRules(lastRequestedNormalizedLangCode);\n    } catch(err) {\n      console.error('pluralRules error', err);\n      pluralRules = new Intl.PluralRules(lastRequestedNormalizedLangCode.split('-', 1)[0]);\n    }\n\n    try {\n      pluralRules = new Intl.PluralRules(langPack.lang_code);\n    } catch(err) {\n      console.error('pluralRules error', err);\n      pluralRules = new Intl.PluralRules(langPack.lang_code.split('-', 1)[0]);\n    }\n\n    strings.clear();\n\n    for(const string of langPack.strings) {\n      strings.set(string.key as LangPackKey, string);\n    }\n\n    if(langPack.countries) {\n      countriesList.length = 0;\n      countriesList.push(...langPack.countries.countries);\n\n      langPack.countries.countries.forEach((country) => {\n        if(country.name) {\n          const langPackKey: any = country.default_name;\n          strings.set(langPackKey, {\n            _: 'langPackString',\n            key: langPackKey,\n            value: country.name\n          });\n        }\n      });\n    }\n\n    if(lastAppliedLangCode !== currentLangCode) {\n      if(lastAppliedLangCode && rootScope.myId) {\n        rootScope.managers.appReactionsManager.resetAvailableReactions();\n        rootScope.managers.appUsersManager.indexMyself();\n        rootScope.managers.dialogsStorage.indexMyDialog();\n      }\n\n      lastAppliedLangCode = currentLangCode;\n      cachedDateTimeFormats.clear();\n      updateAmPm();\n      rootScope.dispatchEvent('language_change', currentLangCode);\n    }\n\n    const elements = Array.from(document.querySelectorAll(`.i18n`)) as HTMLElement[];\n    elements.forEach((element) => {\n      const instance = weakMap.get(element);\n\n      if(instance) {\n        instance.update();\n      }\n    });\n  }\n\n  function pushNextArgument(out: ReturnType<typeof superFormatter>, args: FormatterArguments, indexHolder: {i: number}) {\n    const arg = args[indexHolder.i++];\n    if(Array.isArray(arg)) {\n      out.push(...arg as any);\n    } else {\n      out.push(arg);\n    }\n  }\n\n  export function superFormatter(input: string, args?: FormatterArguments, indexHolder = {i: 0}): Exclude<FormatterArgument, FormatterArgument[]>[] {\n    const out: ReturnType<typeof superFormatter> = [];\n    const regExp = /(\\*\\*|__)(.+?)\\1|(\\n)|(\\[.+?\\]\\(.*?\\))|un\\d|%\\d\\$.|%./g;\n\n    let lastIndex = 0;\n    input.replace(regExp, (match, p1: any, p2: any, p3: any, p4: string, offset: number, string: string) => {\n      // console.table({match, p1, p2, offset, string});\n\n      out.push(string.slice(lastIndex, offset));\n\n      if(p1) {\n        // offset += p1.length;\n        let element: HTMLElement;\n        switch(p1) {\n          case '**': {\n            element = document.createElement('b');\n            break;\n          }\n\n          case '__': {\n            element = document.createElement('i');\n            break;\n          }\n        }\n\n        element.append(...superFormatter(p2, args, indexHolder) as any);\n        out.push(element);\n      } else if(p3) {\n        out.push(document.createElement('br'));\n      } else if(p4) {\n        const idx = p4.lastIndexOf(']');\n        const text = p4.slice(1, idx);\n\n        const url = p4.slice(idx + 2, p4.length - 1);\n        let a: HTMLAnchorElement;\n        if(url && matchUrlProtocol(url)) {\n          a = document.createElement('a');\n          const wrappedUrl = wrapUrl(url);\n          a.href = wrappedUrl.url;\n          if(wrappedUrl.onclick) a.setAttribute('onclick', wrappedUrl.onclick + '(this)');\n          a.target = '_blank';\n        } else {\n          a = args[indexHolder.i++] as HTMLAnchorElement;\n\n          if(a instanceof DocumentFragment) { // right after wrapRichText\n            a = a.firstChild as any;\n          }\n\n          if(typeof(a) !== 'string') {\n            a.textContent = ''; // reset content\n          }\n        }\n\n        const formatted = superFormatter(text, args, indexHolder) as any;\n        if(typeof(a) === 'string') {\n          out.push(...formatted);\n        } else {\n          a.append(...formatted);\n          out.push(a);\n        }\n      } else if(args) {\n        pushNextArgument(out, args, indexHolder);\n      }\n\n      lastIndex = offset + match.length;\n      return '';\n    });\n\n    if(lastIndex !== input.length) {\n      out.push(input.slice(lastIndex));\n    }\n\n    return out;\n  }\n\n  export function format(key: LangPackKey, plain: true, args?: FormatterArguments): string;\n  export function format(key: LangPackKey, plain?: false, args?: FormatterArguments): ReturnType<typeof superFormatter>;\n  export function format(key: LangPackKey, plain = false, args?: FormatterArguments): ReturnType<typeof superFormatter> | string {\n    const str = strings.get(key);\n    let input: string;\n    if(str) {\n      if(str._ === 'langPackStringPluralized' && args?.length) {\n        let v = args[0] as number | string;\n        if(typeof(v) === 'string') v = +v.replace(/\\D/g, '');\n        const s = pluralRules.select(v);\n        // @ts-ignore\n        input = str[s + '_value'] || str['other_value'];\n      } else if(str._ === 'langPackString') {\n        input = str.value;\n      } else {\n        // input = '[' + key + ']';\n        input = key;\n      }\n    } else {\n      // input = '[' + key + ']';\n      input = key;\n    }\n\n    const result = superFormatter(input, args);\n    if(plain) { // * let's try a hack now... (don't want to replace []() entity)\n      return result.map((item) => item instanceof Node ? item.textContent : item).join('');\n    } else {\n      return result;\n    }\n\n    /* if(plain) {\n      if(args?.length) {\n        const regExp = /un\\d|%\\d\\$.|%./g;\n        let i = 0;\n        input = input.replace(regExp, (match, offset, string) => {\n          return '' + args[i++];\n        });\n      }\n\n      return input;\n    } else {\n      return superFormatter(input, args);\n    } */\n  }\n\n  export const weakMap: WeakMap<HTMLElement, IntlElementBase<IntlElementBaseOptions>> = new WeakMap();\n\n  export type IntlElementBaseOptions = {\n    element?: HTMLElement,\n    property?: 'innerText' | 'innerHTML' | 'placeholder' | 'textContent',\n  };\n\n  abstract class IntlElementBase<Options extends IntlElementBaseOptions> {\n    public element: IntlElementBaseOptions['element'];\n    public property: IntlElementBaseOptions['property'];\n\n    constructor(options?: Options) {\n      this.element = options?.element || document.createElement('span');\n      this.element.classList.add('i18n');\n\n      this.property = options?.property;\n      if(options && ((options as any as IntlElementOptions).key || (options as any as IntlDateElementOptions).date)) {\n        this.update(options);\n      }\n\n      weakMap.set(this.element, this);\n    }\n\n    abstract update(options?: Options): void;\n  }\n\n  export type IntlElementOptions = IntlElementBaseOptions & {\n    key?: LangPackKey,\n    args?: FormatterArguments\n  };\n  export class IntlElement extends IntlElementBase<IntlElementOptions> {\n    public key: IntlElementOptions['key'];\n    public args: IntlElementOptions['args'];\n\n    constructor(options: IntlElementOptions = {}) {\n      super({...options, property: options.property ?? 'innerHTML'});\n    }\n\n    public update(options?: IntlElementOptions) {\n      safeAssign(this, options);\n\n      if(this.property === 'innerHTML') {\n        this.element.textContent = '';\n        this.element.append(...format(this.key, false, this.args) as any);\n      } else {\n        // @ts-ignore\n        const v = this.element[this.property];\n        const formatted = format(this.key, true, this.args);\n\n        // * hasOwnProperty won't work here\n        if(v === undefined) this.element.dataset[this.property] = formatted;\n        else (this.element as HTMLInputElement)[this.property] = formatted;\n      }\n    }\n\n    public compareAndUpdate(options?: IntlElementOptions) {\n      if(this.key === options.key && deepEqual(this.args, options.args)) {\n        return;\n      }\n\n      return this.update(options);\n    }\n  }\n\n  const cachedDateTimeFormats: Map<string, Intl.DateTimeFormat> = new Map();\n  export function getDateTimeFormat(options: Intl.DateTimeFormatOptions = {}) {\n    const json = JSON.stringify(options);\n    let dateTimeFormat = cachedDateTimeFormats.get(json);\n    if(!dateTimeFormat) {\n      dateTimeFormat = new Intl.DateTimeFormat(lastRequestedNormalizedLangCode + '-u-hc-' + timeFormat, options);\n      cachedDateTimeFormats.set(json, dateTimeFormat);\n    }\n\n    return dateTimeFormat;\n  }\n\n  export let amPmCache = {am: 'AM', pm: 'PM'};\n  export type IntlDateElementOptions = IntlElementBaseOptions & {\n    date?: Date,\n    options: Intl.DateTimeFormatOptions\n  };\n  export class IntlDateElement extends IntlElementBase<IntlDateElementOptions> {\n    public date: IntlDateElementOptions['date'];\n    public options: IntlDateElementOptions['options'];\n\n    constructor(options: IntlDateElementOptions) {\n      super({...options, property: options.property ?? 'textContent'});\n      setDirection(this.element);\n    }\n\n    public update(options?: IntlDateElementOptions) {\n      safeAssign(this, options);\n\n      let text: string;\n      if(this.options.hour && this.options.minute && Object.keys(this.options).length === 2/*  && false */) {\n        const hours = this.date.getHours();\n        text = ('0' + (timeFormat === 'h12' ? (hours % 12) || 12 : hours)).slice(-2) + ':' + ('0' + this.date.getMinutes()).slice(-2);\n        // if(this.options.second) {\n        //   text += ':' + ('0' + this.date.getSeconds()).slice(-2);\n        // }\n\n        if(timeFormat === 'h12') {\n          text += ' ' + (hours < 12 ? amPmCache.am : amPmCache.pm);\n        }\n      } else {\n        // * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/Locale/hourCycle#adding_an_hour_cycle_via_the_locale_string\n        const dateTimeFormat = getDateTimeFormat(this.options);\n        text = capitalizeFirstLetter(dateTimeFormat.format(this.date));\n      }\n\n      (this.element as any)[this.property] = text;\n    }\n  }\n\n  export function i18n(key: LangPackKey, args?: FormatterArguments) {\n    return new IntlElement({key, args}).element;\n  }\n\n  export function i18n_(options: IntlElementOptions) {\n    return new IntlElement(options).element;\n  }\n\n  export function _i18n(element: HTMLElement, key: LangPackKey, args?: FormatterArguments, property?: IntlElementOptions['property']) {\n    return new IntlElement({element, key, args, property}).element;\n  }\n}\n\nexport {I18n};\nexport default I18n;\n\nconst i18n = I18n.i18n;\nexport {i18n};\n\nconst i18n_ = I18n.i18n_;\nexport {i18n_};\n\nconst _i18n = I18n._i18n;\nexport {_i18n};\n\nexport function joinElementsWith(elements: (Node | string)[], joiner: typeof elements[0] | ((isLast: boolean) => typeof elements[0])) {\n  const arr = elements.slice(0, 1);\n  for(let i = 1; i < elements.length; ++i) {\n    const isLast = (elements.length - 1) === i;\n    arr.push(typeof(joiner) === 'function' ? joiner(isLast) : joiner);\n    arr.push(elements[i]);\n  }\n\n  return arr;\n}\n\n\nexport function join(elements: (Node | string)[], useLast: boolean, plain: true): string;\nexport function join(elements: (Node | string)[], useLast?: boolean, plain?: false): (string | Node)[];\nexport function join(elements: (Node | string)[], useLast: boolean, plain: boolean): string | (string | Node)[];\nexport function join(elements: (Node | string)[], useLast = true, plain?: boolean): string | (string | Node)[] {\n  const joined = joinElementsWith(elements, (isLast) => {\n    const langPackKey: LangPackKey = isLast && useLast ? 'AutoDownloadSettings.LastDelimeter' : 'AutoDownloadSettings.Delimeter';\n    return plain ? I18n.format(langPackKey, true) : i18n(langPackKey);\n  });\n\n  return plain ? joined.join('') : joined;\n}\n\nMOUNT_CLASS_TO.I18n = I18n;\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport type {MyDialogFilter} from '../storages/filters';\n\n/**\n * Legacy Webogram's format, don't change dcID to camelCase. date is timestamp\n */\nexport type UserAuth = {dcID: number | string, date: number, id: PeerId};\nexport type REAL_FOLDER_ID = 0 | 1;\n\nexport const NULL_PEER_ID: PeerId = 0;\nexport const REPLIES_PEER_ID: PeerId = 1271266957;\nexport const REPLIES_HIDDEN_CHANNEL_ID: ChatId = 777;\nexport const SERVICE_PEER_ID: PeerId = 777000;\nexport const MUTE_UNTIL = 0x7FFFFFFF;\nexport const BOT_START_PARAM = '';\nexport const MAX_FILE_SAVE_SIZE = 20 * 1024 * 1024;\nexport const THUMB_TYPE_FULL = '';\nexport const TOPIC_COLORS = [0x6FB9F0, 0xFFD67E, 0xCB86DB, 0x8EEE98, 0xFF93B2, 0xFB6F5F];\nexport const ATTACH_MENU_BOT_ICON_NAME = 'default_static';\nexport const MESSAGE_ID_OFFSET = 0x100000000;\nexport const GENERAL_TOPIC_ID = MESSAGE_ID_OFFSET + 1;\nexport const T_ME_PREFIXES = new Set(['web', 'k', 'z', 'a']);\nexport const SEND_WHEN_ONLINE_TIMESTAMP = 0x7FFFFFFE;\n\nexport const FOLDER_ID_ALL: REAL_FOLDER_ID = 0;\nexport const FOLDER_ID_ARCHIVE: REAL_FOLDER_ID = 1;\nexport const REAL_FOLDERS: Set<number> = new Set([FOLDER_ID_ALL, FOLDER_ID_ARCHIVE]);\nexport const START_LOCAL_ID = Math.max(...Array.from(REAL_FOLDERS)) + 1 as MyDialogFilter['localId'];\n","import IS_CALL_SUPPORTED from './callSupport';\nimport CAN_USE_TRANSFERABLES from './canUseTransferables';\nimport IS_CANVAS_FILTER_SUPPORTED from './canvasFilterSupport';\nimport IS_EMOJI_SUPPORTED from './emojiSupport';\nimport IS_GEOLOCATION_SUPPORTED from './geolocationSupport';\nimport IS_GROUP_CALL_SUPPORTED from './groupCallSupport';\nimport IMAGE_MIME_TYPES_SUPPORTED from './imageMimeTypesSupport';\nimport MEDIA_MIME_TYPES_SUPPORTED from './mediaMimeTypesSupport';\nimport IS_MOV_SUPPORTED from './movSupport';\nimport IS_PARALLAX_SUPPORTED from './parallaxSupport';\nimport IS_SCREEN_SHARING_SUPPORTED from './screenSharingSupport';\nimport IS_TOUCH_SUPPORTED from './touchSupport';\nimport IS_VIBRATE_SUPPORTED from './vibrateSupport';\nimport VIDEO_MIME_TYPES_SUPPORTED from './videoMimeTypesSupport';\nimport IS_WEBM_SUPPORTED from './webmSupport';\nimport IS_WEBP_SUPPORTED from './webpSupport';\nimport IS_WEBRTC_SUPPORTED from './webrtcSupport';\nimport * as userAgent from './userAgent';\nimport IS_OPUS_SUPPORTED from './opusSupport';\nimport IS_SHARED_WORKER_SUPPORTED from './sharedWorkerSupport';\nimport IS_APPLE_MX from './appleMx';\n\nconst ENVIRONMENT = {\n  CAN_USE_TRANSFERABLES,\n  IS_APPLE_MX,\n  IS_CALL_SUPPORTED,\n  IS_CANVAS_FILTER_SUPPORTED,\n  IS_EMOJI_SUPPORTED,\n  IS_GEOLOCATION_SUPPORTED,\n  IS_GROUP_CALL_SUPPORTED,\n  IS_MOV_SUPPORTED,\n  IS_PARALLAX_SUPPORTED,\n  IS_SCREEN_SHARING_SUPPORTED,\n  IS_TOUCH_SUPPORTED,\n  IS_VIBRATE_SUPPORTED,\n  IS_OPUS_SUPPORTED,\n  IS_SHARED_WORKER_SUPPORTED,\n  IS_WEBM_SUPPORTED,\n  IS_WEBP_SUPPORTED,\n  IS_WEBRTC_SUPPORTED,\n  IMAGE_MIME_TYPES_SUPPORTED,\n  MEDIA_MIME_TYPES_SUPPORTED,\n  VIDEO_MIME_TYPES_SUPPORTED,\n  ...userAgent\n};\n\nexport default ENVIRONMENT;\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport App from '../../../../config/app';\nimport DEBUG from '../../../../config/debug';\nimport {AutoDownloadPeerTypeSettings, State, STATE_INIT, Background, AppTheme} from '../../../../config/state';\nimport compareVersion from '../../../../helpers/compareVersion';\nimport copy from '../../../../helpers/object/copy';\nimport validateInitObject from '../../../../helpers/object/validateInitObject';\nimport {UserAuth} from '../../../mtproto/mtproto_config';\nimport rootScope from '../../../rootScope';\nimport stateStorage from '../../../stateStorage';\nimport sessionStorage from '../../../sessionStorage';\nimport {recordPromiseBound} from '../../../../helpers/recordPromise';\n// import RESET_STORAGES_PROMISE from \"../storages/resetStoragesPromise\";\nimport {StoragesResults} from '../storages/loadStorages';\nimport {logger} from '../../../logger';\nimport {WallPaper} from '../../../../layer';\n\nconst REFRESH_EVERY = 24 * 60 * 60 * 1000; // 1 day\n// const REFRESH_EVERY = 1e3;\n// const REFRESH_EVERY_WEEK = 24 * 60 * 60 * 1000 * 7; // 7 days\n\nconst STATE_VERSION = STATE_INIT.version;\nconst BUILD = STATE_INIT.build;\n\nconst ALL_KEYS = Object.keys(STATE_INIT) as any as Array<keyof State>;\n\nconst REFRESH_KEYS: Array<keyof State> = [\n  'contactsListCachedTime',\n  'stateCreatedTime',\n  'maxSeenMsgId',\n  'filtersArr'\n];\n\n// const REFRESH_KEYS_WEEK = ['dialogs', 'allDialogsLoaded', 'updates', 'pinnedOrders'] as any as Array<keyof State>;\n\nasync function loadStateInner() {\n  const log = logger('STATE-LOADER');\n\n  const totalPerf = performance.now();\n  const recordPromise = recordPromiseBound(log);\n\n  const promises = ALL_KEYS.map((key) => recordPromise(stateStorage.get(key), 'state ' + key))\n  .concat(\n    recordPromise(sessionStorage.get('user_auth'), 'auth'),\n    recordPromise(sessionStorage.get('state_id'), 'auth'),\n    recordPromise(sessionStorage.get('k_build'), 'auth')\n  )\n  .concat(recordPromise(stateStorage.get('user_auth'), 'old auth')); // support old webk format\n\n  const arr = await Promise.all(promises);\n  log.warn('promises', performance.now() - totalPerf);\n  // await new Promise((resolve) => setTimeout(resolve, 3e3));\n  /* const self = this;\n  const skipHandleKeys = new Set(['isProxy', 'filters', 'drafts']);\n  const getHandler = (path?: string) => {\n    return {\n      get(target: any, key: any) {\n        if(key === 'isProxy') {\n          return true;\n        }\n\n        const prop = target[key];\n\n        if(prop !== undefined && !skipHandleKeys.has(key) && !prop.isProxy && typeof(prop) === 'object') {\n          target[key] = new Proxy(prop, getHandler(path || key));\n          return target[key];\n        }\n\n        return prop;\n      },\n      set(target: any, key: any, value: any) {\n        console.log('Setting', target, `.${key} to equal`, value, path);\n\n        target[key] = value;\n\n        // @ts-ignore\n        self.pushToState(path || key, path ? self.state[path] : value, false);\n\n        return true;\n      }\n    };\n  }; */\n\n  // const pushed: {key: keyof State, value: State[keyof State]}[] = [];\n  const pushedKeys: (keyof State)[] = [];\n  const pushToState = <T extends keyof State>(key: T, value: State[T]) => {\n    // appStateManager.pushToState(key, value);\n    state[key] = value;\n    // pushed.push({key, value});\n    pushedKeys.push(key);\n  };\n\n  const replaceState = (_state: State) => {\n    // pushed.length = 0;\n    pushedKeys.length = 0;\n    state = _state;\n    pushedKeys.push(...Object.keys(state) as any as typeof pushedKeys);\n    // state = appStateManager.setState(_state);\n    // appStateManager.storage.set(state);\n  };\n\n  // let state: State = appStateManager.setState({} as any);\n  let state: State = {} as any;\n\n  // ! then can't store false values\n  for(let i = 0, length = ALL_KEYS.length; i < length; ++i) {\n    const key = ALL_KEYS[i];\n    const value = arr[i];\n    if(value !== undefined) {\n      // @ts-ignore\n      state[key] = value;\n    } else {\n      pushToState(key, copy(STATE_INIT[key]));\n    }\n  }\n\n  arr.splice(0, ALL_KEYS.length);\n\n  // * Read auth\n  let auth = arr.shift() as UserAuth | number;\n  const stateId = arr.shift() as number;\n  const sessionBuild = arr.shift() as number;\n  const shiftedWebKAuth = arr.shift() as UserAuth | number;\n  if(!auth && shiftedWebKAuth) { // support old webk auth\n    auth = shiftedWebKAuth;\n    const keys: string[] = ['dc', 'server_time_offset', 'xt_instance'];\n    for(let i = 1; i <= 5; ++i) {\n      keys.push(`dc${i}_server_salt`);\n      keys.push(`dc${i}_auth_key`);\n    }\n\n    const values = await Promise.all(keys.map((key) => stateStorage.get(key as any)));\n    keys.push('user_auth');\n    values.push(typeof(auth) === 'number' || typeof(auth) === 'string' ? {dcID: values[0] || App.baseDcId, date: Date.now() / 1000 | 0, id: auth.toPeerId(false)} as UserAuth : auth);\n\n    const obj: any = {};\n    keys.forEach((key, idx) => {\n      obj[key] = values[idx];\n    });\n\n    await sessionStorage.set(obj);\n  }\n\n  /* if(!auth) { // try to read Webogram's session from localStorage\n    try {\n      const keys = Object.keys(localStorage);\n      for(let i = 0; i < keys.length; ++i) {\n        const key = keys[i];\n        let value: any;\n        try {\n          value = localStorage.getItem(key);\n          value = JSON.parse(value);\n        } catch(err) {\n          //console.error(err);\n        }\n\n        sessionStorage.set({\n          [key as any]: value\n        });\n      }\n\n      auth = sessionStorage.getFromCache('user_auth');\n    } catch(err) {\n      this.log.error('localStorage import error', err);\n    }\n  } */\n\n  if(auth) {\n    // ! Warning ! DON'T delete this\n    state.authState = {_: 'authStateSignedIn'};\n    rootScope.dispatchEvent('user_auth', typeof(auth) === 'number' || typeof(auth) === 'string' ?\n      {dcID: 0, date: Date.now() / 1000 | 0, id: auth.toPeerId(false)} :\n      auth); // * support old version\n  }\n\n  const resetStorages: Set<keyof StoragesResults> = new Set();\n  if(state.stateId !== stateId) {\n    if(stateId !== undefined) {\n      const preserve: Map<keyof State, State[keyof State]> = new Map([\n        ['authState', undefined],\n        ['stateId', undefined]\n      ]);\n\n      preserve.forEach((_, key) => {\n        preserve.set(key, copy(state[key]));\n      });\n\n      state = copy(STATE_INIT);\n\n      preserve.forEach((value, key) => {\n        // @ts-ignore\n        state[key] = value;\n      });\n\n      const r: {[k in keyof StoragesResults]: number} = {\n        chats: 1,\n        dialogs: 1,\n        users: 1\n      };\n      for(const key in r) {\n        resetStorages.add(key as keyof StoragesResults);\n        // this.storagesResults[key as keyof AppStateManager['storagesResults']].length = 0;\n      }\n\n      replaceState(state);\n    }\n\n    await sessionStorage.set({\n      state_id: state.stateId\n    });\n  }\n\n  const time = Date.now();\n  if((state.stateCreatedTime + REFRESH_EVERY) < time) {\n    if(DEBUG) {\n      log('will refresh state', state.stateCreatedTime, time);\n    }\n\n    const r = (keys: typeof REFRESH_KEYS) => {\n      keys.forEach((key) => {\n        pushToState(key, copy(STATE_INIT[key]));\n\n        // const s = appStateManager.storagesResults[key as keyof AppStateManager['storagesResults']];\n        // if(s?.length) {\n        // appStateManager.resetStorages.add(key as keyof AppStateManager['storagesResults']);\n        // s.length = 0;\n        // }\n      });\n    };\n\n    r(REFRESH_KEYS);\n\n    /* if((state.stateCreatedTime + REFRESH_EVERY_WEEK) < time) {\n      if(DEBUG) {\n        this.log('will refresh updates');\n      }\n\n      r(REFRESH_KEYS_WEEK);\n    } */\n  }\n\n  // state = this.state = new Proxy(state, getHandler());\n\n  // * migrate auto download settings\n  const autoDownloadSettings = state.settings.autoDownload;\n  if(autoDownloadSettings?.private !== undefined) {\n    const oldTypes = [\n      'contacts' as const,\n      'private' as const,\n      'groups' as const,\n      'channels' as const\n    ];\n\n    const mediaTypes = [\n      'photo' as const,\n      'video' as const,\n      'file' as const\n    ];\n\n    mediaTypes.forEach((mediaType) => {\n      const peerTypeSettings: AutoDownloadPeerTypeSettings = autoDownloadSettings[mediaType] = {} as any;\n      oldTypes.forEach((peerType) => {\n        peerTypeSettings[peerType] = autoDownloadSettings[peerType];\n      });\n    });\n\n    oldTypes.forEach((peerType) => {\n      delete autoDownloadSettings[peerType];\n    });\n\n    pushToState('settings', state.settings);\n  }\n\n  const SKIP_VALIDATING_PATHS: Set<string> = new Set([\n    'settings.themes'\n  ]);\n  validateInitObject(STATE_INIT, state, (missingKey) => {\n    pushToState(missingKey as keyof State, state[missingKey as keyof State]);\n  }, undefined, SKIP_VALIDATING_PATHS);\n\n  let newVersion: string, oldVersion: string;\n  if(state.version !== STATE_VERSION || state.build !== BUILD/*  || true */) {\n    // reset filters and dialogs if version is older\n    if(state.build < 322) {\n      pushToState('allDialogsLoaded', copy(STATE_INIT.allDialogsLoaded));\n      pushToState('pinnedOrders', copy(STATE_INIT.pinnedOrders));\n      pushToState('filtersArr', copy(STATE_INIT.filtersArr));\n\n      resetStorages.add('dialogs');\n    }\n\n    if(compareVersion(state.version, '1.7.1') === -1) {\n      let migrated = false;\n      // * migrate backgrounds (March 13, 2022; to version 1.3.0)\n      if(compareVersion(state.version, '1.3.0') === -1) {\n        migrated = true;\n        state.settings.theme = copy(STATE_INIT.settings.theme);\n        state.settings.themes = copy(STATE_INIT.settings.themes);\n      } else if(compareVersion(state.version, '1.7.1') === -1) { // * migrate backgrounds (January 25th, 2023; to version 1.7.1)\n        migrated = true;\n        const oldThemes = state.settings.themes as any as Array<{\n          name: AppTheme['name'],\n          background: Background\n        }>;\n\n        state.settings.themes = copy(STATE_INIT.settings.themes);\n\n        try {\n          oldThemes.forEach((oldTheme) => {\n            const oldBackground = oldTheme.background;\n            if(!oldBackground) {\n              return;\n            }\n\n            const newTheme = state.settings.themes.find((t) => t.name === oldTheme.name);\n            newTheme.settings.highlightningColor = oldBackground.highlightningColor;\n\n            const getColorFromHex = (hex: string) => hex && parseInt(hex.slice(1), 16);\n\n            const colors = (oldBackground.color || '').split(',').map(getColorFromHex);\n\n            if(oldBackground.color && !oldBackground.slug) {\n              newTheme.settings.wallpaper = {\n                _: 'wallPaperNoFile',\n                id: 0,\n                pFlags: {},\n                settings: {\n                  _: 'wallPaperSettings',\n                  pFlags: {}\n                }\n              };\n            } else {\n              const wallPaper: WallPaper.wallPaper = {\n                _: 'wallPaper',\n                id: 0,\n                access_hash: 0,\n                slug: oldBackground.slug,\n                document: {} as any,\n                pFlags: {},\n                settings: {\n                  _: 'wallPaperSettings',\n                  pFlags: {}\n                }\n              };\n\n              const wallPaperSettings = wallPaper.settings;\n              newTheme.settings.wallpaper = wallPaper;\n              if(oldBackground.slug && !oldBackground.color) {\n                wallPaperSettings.pFlags.blur = oldBackground.blur || undefined;\n              } else if(oldBackground.intensity) {\n                wallPaperSettings.intensity = oldBackground.intensity;\n                wallPaper.pFlags.pattern = true;\n                wallPaper.pFlags.dark = oldBackground.intensity < 0 || undefined;\n              }\n            }\n\n            if(colors.length) {\n              const wallPaperSettings = newTheme.settings.wallpaper.settings;\n              wallPaperSettings.background_color = colors[0];\n              wallPaperSettings.second_background_color = colors[1];\n              wallPaperSettings.third_background_color = colors[2];\n              wallPaperSettings.fourth_background_color = colors[3];\n            }\n          });\n        } catch(err) {\n          console.error('migrating themes error', err);\n        }\n      }\n\n      if(migrated) {\n        pushToState('settings', state.settings);\n      }\n    }\n\n    if(state.build < 309) {\n      state.settings.liteMode.animations = !state.settings.animationsEnabled;\n      state.settings.liteMode.video = !state.settings.autoPlay.videos;\n      state.settings.liteMode.gif = !state.settings.autoPlay.gifs;\n    }\n\n    if(state.build < 312 && typeof(state.settings.stickers.suggest) === 'boolean') {\n      state.settings.stickers.suggest = state.settings.stickers.suggest ? 'all' : 'none';\n    }\n\n    if(compareVersion(state.version, STATE_VERSION) !== 0) {\n      newVersion = STATE_VERSION;\n      oldVersion = state.version;\n    }\n\n    pushToState('version', STATE_VERSION);\n    pushToState('build', BUILD);\n  }\n\n  if(sessionBuild !== BUILD && (!sessionBuild || sessionBuild < BUILD)) {\n    sessionStorage.set({k_build: BUILD});\n  }\n\n  // ! probably there is better place for it\n  rootScope.settings = state.settings;\n\n  if(DEBUG) {\n    log('state res', state, copy(state));\n  }\n\n  // return resolve();\n\n  log.warn('total', performance.now() - totalPerf);\n\n  // RESET_STORAGES_PROMISE.resolve(appStateManager.resetStorages);\n\n  return {state, resetStorages, newVersion, oldVersion, pushedKeys};\n}\n\nlet promise: ReturnType<typeof loadStateInner>;\nexport default function loadState() {\n  return promise ??= loadStateInner();\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport type {Awaited} from '../../types';\nimport type {CacheStorageDbName} from '../files/cacheStorage';\nimport type {State} from '../../config/state';\nimport type {Message, MessagePeerReaction, PeerNotifySettings} from '../../layer';\nimport {CryptoMethods} from '../crypto/crypto_methods';\nimport rootScope from '../rootScope';\nimport webpWorkerController from '../webp/webpWorkerController';\nimport {MOUNT_CLASS_TO} from '../../config/debug';\nimport sessionStorage from '../sessionStorage';\nimport webPushApiManager from './webPushApiManager';\nimport appRuntimeManager from '../appManagers/appRuntimeManager';\nimport telegramMeWebManager from './telegramMeWebManager';\nimport pause from '../../helpers/schedulers/pause';\nimport ENVIRONMENT from '../../environment';\nimport loadState from '../appManagers/utils/state/loadState';\nimport opusDecodeController from '../opusDecodeController';\nimport MTProtoMessagePort from './mtprotoMessagePort';\nimport cryptoMessagePort from '../crypto/cryptoMessagePort';\nimport SuperMessagePort from './superMessagePort';\nimport IS_SHARED_WORKER_SUPPORTED from '../../environment/sharedWorkerSupport';\nimport toggleStorages from '../../helpers/toggleStorages';\nimport idleController from '../../helpers/idleController';\nimport ServiceMessagePort from '../serviceWorker/serviceMessagePort';\nimport App from '../../config/app';\nimport deferredPromise, {CancellablePromise} from '../../helpers/cancellablePromise';\n\nexport type Mirrors = {\n  state: State\n};\n\nexport type MirrorTaskPayload<T extends keyof Mirrors = keyof Mirrors, K extends keyof Mirrors[T] = keyof Mirrors[T], J extends Mirrors[T][K] = Mirrors[T][K]> = {\n  name: T,\n  key?: K,\n  value: any\n};\n\nexport type NotificationBuildTaskPayload = {\n  message: Message.message | Message.messageService,\n  fwdCount?: number,\n  peerReaction?: MessagePeerReaction,\n  peerTypeNotifySettings?: PeerNotifySettings\n};\n\nexport type TabState = {\n  chatPeerIds: PeerId[],\n  idleStartTime: number,\n};\n\nclass ApiManagerProxy extends MTProtoMessagePort {\n  // private worker: /* Window */Worker;\n  // private sockets: Map<number, Socket> = new Map();\n  private mirrors: Mirrors;\n\n  public newVersion: string;\n  public oldVersion: string;\n\n  private tabState: TabState;\n\n  public share: ShareData;\n\n  public serviceMessagePort: ServiceMessagePort<true>;\n  private lastServiceWorker: ServiceWorker;\n\n  private pingServiceWorkerPromise: CancellablePromise<void>;\n\n  constructor() {\n    super();\n\n    this.mirrors = {} as any;\n    this.tabState = {\n      chatPeerIds: [],\n      idleStartTime: 0\n    };\n\n    this.log('constructor');\n\n                      \n    this.registerWorker();\n             \n\n    this.registerServiceWorker();\n    this.registerCryptoWorker();\n\n    // const perf = performance.now();\n    this.addMultipleEventsListeners({\n      convertWebp: ({fileName, bytes}) => {\n        return webpWorkerController.convert(fileName, bytes);\n      },\n\n      convertOpus: ({fileName, bytes}) => {\n        return opusDecodeController.pushDecodeTask(bytes, false).then((result) => result.bytes);\n      },\n\n      event: ({name, args}) => {\n        // @ts-ignore\n        rootScope.dispatchEventSingle(name, ...args);\n      },\n\n      localStorageProxy: (payload) => {\n        const storageTask = payload;\n        return (sessionStorage[storageTask.type] as any)(...storageTask.args);\n      },\n\n      mirror: this.onMirrorTask\n\n      // hello: () => {\n      //   this.log.error('time hello', performance.now() - perf);\n      // }\n    });\n\n    // this.addTaskListener('socketProxy', (task) => {\n    //   const socketTask = task.payload;\n    //   const id = socketTask.id;\n    //   //console.log('socketProxy', socketTask, id);\n\n    //   if(socketTask.type === 'send') {\n    //     const socket = this.sockets.get(id);\n    //     socket.send(socketTask.payload);\n    //   } else if(socketTask.type === 'close') { // will remove from map in onClose\n    //     const socket = this.sockets.get(id);\n    //     socket.close();\n    //   } else if(socketTask.type === 'setup') {\n    //     const socket = new Socket(socketTask.payload.dcId, socketTask.payload.url, socketTask.payload.logSuffix);\n\n    //     const onOpen = () => {\n    //       //console.log('socketProxy onOpen');\n    //       this.postMessage({\n    //         type: 'socketProxy',\n    //         payload: {\n    //           type: 'open',\n    //           id\n    //         }\n    //       });\n    //     };\n    //     const onClose = () => {\n    //       this.postMessage({\n    //         type: 'socketProxy',\n    //         payload: {\n    //           type: 'close',\n    //           id\n    //         }\n    //       });\n\n    //       socket.removeEventListener('open', onOpen);\n    //       socket.removeEventListener('close', onClose);\n    //       socket.removeEventListener('message', onMessage);\n    //       this.sockets.delete(id);\n    //     };\n    //     const onMessage = (buffer: ArrayBuffer) => {\n    //       this.postMessage({\n    //         type: 'socketProxy',\n    //         payload: {\n    //           type: 'message',\n    //           id,\n    //           payload: buffer\n    //         }\n    //       });\n    //     };\n\n    //     socket.addEventListener('open', onOpen);\n    //     socket.addEventListener('close', onClose);\n    //     socket.addEventListener('message', onMessage);\n    //     this.sockets.set(id, socket);\n    //   }\n    // });\n\n    rootScope.addEventListener('language_change', (language) => {\n      rootScope.managers.networkerFactory.setLanguage(language);\n    });\n\n    window.addEventListener('online', () => {\n      rootScope.managers.networkerFactory.forceReconnectTimeout();\n    });\n\n    rootScope.addEventListener('logging_out', () => {\n      const toClear: CacheStorageDbName[] = ['cachedFiles', 'cachedStreamChunks'];\n      Promise.all([\n        toggleStorages(false, true),\n        sessionStorage.clear(),\n        Promise.race([\n          telegramMeWebManager.setAuthorized(false),\n          pause(3000)\n        ]),\n        webPushApiManager.forceUnsubscribe(),\n        Promise.all(toClear.map((cacheName) => caches.delete(cacheName)))\n      ]).finally(() => {\n        appRuntimeManager.reload();\n      });\n    });\n\n    idleController.addEventListener('change', (idle) => {\n      this.updateTabStateIdle(idle);\n    });\n    this.updateTabStateIdle(idleController.isIdle);\n\n    this.log('Passing environment:', ENVIRONMENT);\n    this.invoke('environment', ENVIRONMENT);\n    // this.sendState();\n  }\n\n  public pingServiceWorkerWithIframe() {\n    if(this.pingServiceWorkerPromise) {\n      return this.pingServiceWorkerPromise;\n    }\n\n    const promise = this.pingServiceWorkerPromise = deferredPromise<void>();\n    const iframe = document.createElement('iframe');\n    iframe.hidden = true;\n    const onLoad = () => {\n      setTimeout(() => { // ping once in 10 seconds\n        this.pingServiceWorkerPromise = undefined;\n      }, 10e3);\n\n      clearTimeout(timeout);\n      iframe.remove();\n      iframe.removeEventListener('load', onLoad);\n      iframe.removeEventListener('error', onLoad);\n      promise.resolve();\n    };\n    iframe.addEventListener('load', onLoad);\n    iframe.addEventListener('error', onLoad);\n    iframe.src = 'ping/' + (Math.random() * 0xFFFFFFFF | 0);\n    document.body.append(iframe);\n\n    const timeout = window.setTimeout(onLoad, 1e3);\n    return promise;\n  }\n\n  private attachServiceWorker(serviceWorker: ServiceWorker) {\n    this.lastServiceWorker && this.serviceMessagePort.detachPort(this.lastServiceWorker);\n    this.serviceMessagePort.attachSendPort(this.lastServiceWorker = serviceWorker);\n    this.serviceMessagePort.invokeVoid('hello', undefined);\n  }\n\n  private _registerServiceWorker() {\n    navigator.serviceWorker.register(\n      /* webpackChunkName: \"sw\" */\n      new URL('../serviceWorker/index.service', import.meta.url),\n      {scope: './'}\n    ).then((registration) => {\n      this.log('SW registered', registration);\n\n      // ! doubtful fix for hard refresh\n      if(registration.active && !navigator.serviceWorker.controller) {\n        return registration.unregister().then(() => {\n          window.location.reload();\n        });\n      }\n\n      const sw = registration.installing || registration.waiting || registration.active;\n      sw.addEventListener('statechange', (e) => {\n        this.log('SW statechange', e);\n      });\n\n      const controller = navigator.serviceWorker.controller || registration.installing || registration.waiting || registration.active;\n      this.attachServiceWorker(controller);\n\n                       \n                                            \n               \n    }, (err) => {\n      this.log.error('SW registration failed!', err);\n\n      this.invokeVoid('serviceWorkerOnline', false);\n    });\n  }\n\n  private registerServiceWorker() {\n    if(!('serviceWorker' in navigator)) return;\n\n    this.serviceMessagePort = new ServiceMessagePort<true>();\n\n    // this.addMultipleEventsListeners({\n    //   hello: () => {\n    //     // this.serviceMessagePort.invokeVoid('port', undefined);\n    //   }\n    // });\n\n    // ! I hate webpack - it won't load it by using worker.register, only navigator.serviceWorker will do it.\n    const worker = navigator.serviceWorker;\n    this._registerServiceWorker();\n\n    // worker.startMessages();\n\n    worker.addEventListener('controllerchange', () => {\n      this.log.warn('controllerchange');\n\n      const controller = worker.controller;\n      this.attachServiceWorker(controller);\n\n      controller.addEventListener('error', (e) => {\n        this.log.error('controller error:', e);\n      });\n    });\n\n                     \n                                  \n            \n    this.serviceMessagePort.attachListenPort(worker);\n    this.serviceMessagePort.addMultipleEventsListeners({\n      port: (payload, source, event) => {\n        this.invokeVoid('serviceWorkerPort', undefined, undefined, [event.ports[0]]);\n      },\n\n      hello: (payload, source) => {\n        this.serviceMessagePort.resendLockTask(source);\n      },\n\n      share: (payload) => {\n        this.log('will try to share something');\n        this.share = payload;\n      }\n    });\n             \n\n    worker.addEventListener('messageerror', (e) => {\n      this.log.error('SW messageerror:', e);\n    });\n  }\n\n  private async registerCryptoWorker() {\n    const get = (url: string) => {\n      return fetch(url).then((response) => response.text()).then((text) => {\n        const pathnameSplitted = location.pathname.split('/');\n        pathnameSplitted[pathnameSplitted.length - 1] = '';\n        const pre = location.origin + pathnameSplitted.join('/');\n        text = `\n        var originalImportScripts = importScripts; \n        importScripts = (url) => {\n          console.log('importScripts', url);\n          var newUrl = '${pre}' + url.split('/').pop();\n          return originalImportScripts(newUrl);\n        };\n        ${text}`;\n        const blob = new Blob([text], {type: 'application/javascript'});\n        return blob;\n      });\n    };\n\n    const workerHandler = {\n      construct(target: any, args: any): any {\n        const url = args[0] + location.search;\n        return {url};\n      }\n    };\n\n    const originals = [\n      Worker,\n      typeof(SharedWorker) !== 'undefined' && SharedWorker\n    ].filter(Boolean);\n    originals.forEach((w) => window[w.name as any] = new Proxy(w, workerHandler));\n\n    const worker: SharedWorker | Worker = new Worker(\n      /* webpackChunkName: \"crypto.worker\" */\n      new URL('../crypto/crypto.worker.ts', import.meta.url),\n      {type: 'module'}\n    );\n\n    originals.forEach((w) => window[w.name as any] = w as any);\n\n    const originalUrl = (worker as any).url;\n\n    const createWorker = (url: string) => new constructor(url, {type: 'module'});\n    const attachWorkerToPort = (worker: SharedWorker | Worker) => this.attachWorkerToPort(worker, cryptoMessagePort, 'crypto');\n    const constructor = IS_SHARED_WORKER_SUPPORTED ? SharedWorker : Worker;\n\n    // let cryptoWorkers = workers.length;\n    cryptoMessagePort.addEventListener('port', (payload, source, event) => {\n      this.invokeVoid('cryptoPort', undefined, undefined, [event.ports[0]]);\n      // .then((attached) => {\n      //   if(!attached && cryptoWorkers-- > 1) {\n      //     this.log.error('terminating unneeded crypto worker');\n\n      //     cryptoMessagePort.invokeVoid('terminate', undefined, source);\n      //     const worker = workers.find((worker) => (worker as SharedWorker).port === source || (worker as any) === source);\n      //     if((worker as SharedWorker).port) (worker as SharedWorker).port.close();\n      //     else (worker as Worker).terminate();\n      //     cryptoMessagePort.detachPort(source);\n      //   }\n      // });\n    });\n\n    const firstWorker = createWorker(originalUrl);\n    attachWorkerToPort(firstWorker);\n\n    const blob = await get(originalUrl);\n    const urlsPromise = await this.invoke('createProxyWorkerURLs', {originalUrl, blob});\n    const workers = urlsPromise.slice(1).map(createWorker);\n    workers.forEach(attachWorkerToPort);\n  }\n\n                    \n  private registerWorker() {\n    // return;\n\n    let worker: SharedWorker | Worker;\n    if(IS_SHARED_WORKER_SUPPORTED) {\n      worker = new SharedWorker(\n        /* webpackChunkName: \"mtproto.worker\" */\n        new URL('./mtproto.worker.ts', import.meta.url),\n        {type: 'module'}\n      );\n    } else {\n      worker = new Worker(\n        /* webpackChunkName: \"mtproto.worker\" */\n        new URL('./mtproto.worker.ts', import.meta.url),\n        {type: 'module'}\n      );\n    }\n\n    this.onWorkerFirstMessage(worker);\n  }\n           \n\n  private attachWorkerToPort(worker: SharedWorker | Worker, messagePort: SuperMessagePort<any, any, any>, type: string) {\n    const port: MessagePort = (worker as SharedWorker).port || worker as any;\n    messagePort.attachPort(port);\n\n    worker.addEventListener('error', (err) => {\n      this.log.error(type, 'worker error', err);\n    });\n  }\n\n  private onWorkerFirstMessage(worker: any) {\n    this.log('set webWorker');\n\n    // this.worker = worker;\n                     \n                                \n            \n    this.attachWorkerToPort(worker, this, 'mtproto');\n             \n  }\n\n  private loadState() {\n    return Promise.all([\n      loadState().then((stateResult) => {\n        this.newVersion = stateResult.newVersion;\n        this.oldVersion = stateResult.oldVersion;\n        this.mirrors['state'] = stateResult.state;\n        return stateResult;\n      })\n      // loadStorages(createStorages()),\n    ]);\n  }\n\n  public sendState() {\n    return this.loadState().then((result) => {\n      const [stateResult] = result;\n      this.invoke('state', {...stateResult, userId: rootScope.myId.toUserId()});\n      return result;\n    });\n  }\n\n                       \n  public invokeCrypto<Method extends keyof CryptoMethods>(method: Method, ...args: Parameters<CryptoMethods[typeof method]>): Promise<Awaited<ReturnType<CryptoMethods[typeof method]>>> {\n    return cryptoMessagePort.invokeCrypto(method, ...args);\n  }\n           \n\n  public async toggleStorages(enabled: boolean, clearWrite: boolean) {\n    await toggleStorages(enabled, clearWrite);\n    this.invoke('toggleStorages', {enabled, clearWrite});\n    this.serviceMessagePort.invokeVoid('toggleStorages', {enabled, clearWrite});\n  }\n\n  public async getMirror<T extends keyof Mirrors>(name: T) {\n    const mirror = this.mirrors[name];\n    return mirror;\n  }\n\n  public getState() {\n    return this.getMirror('state');\n  }\n\n  public updateTabState<T extends keyof TabState>(key: T, value: TabState[T]) {\n    this.tabState[key] = value;\n    this.invokeVoid('tabState', this.tabState);\n  }\n\n  public updateTabStateIdle(idle: boolean) {\n    this.updateTabState('idleStartTime', idle ? Date.now() : 0);\n  }\n\n  private onMirrorTask = (payload: MirrorTaskPayload) => {\n    const {name, key, value} = payload;\n    if(!payload.hasOwnProperty('key')) {\n      this.mirrors[name] = value;\n      return;\n    }\n\n    const mirror = this.mirrors[name] ??= {} as any;\n    if(value === undefined) {\n      delete mirror[key];\n    } else {\n      mirror[key] = value;\n    }\n  };\n}\n\ninterface ApiManagerProxy extends MTProtoMessagePort<true> {}\n\nconst apiManagerProxy = new ApiManagerProxy();\nMOUNT_CLASS_TO.apiManagerProxy = apiManagerProxy;\nexport default apiManagerProxy;\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n *\n * Originally from:\n * https://github.com/zhukov/webogram\n * Copyright (C) 2014 Igor Zhukov <igor.beatle@gmail.com>\n * https://github.com/zhukov/webogram/blob/master/LICENSE\n */\n\nimport App from '../../config/app';\nimport {MOUNT_CLASS_TO} from '../../config/debug';\nimport tabId from '../../config/tabId';\nimport IS_SHARED_WORKER_SUPPORTED from '../../environment/sharedWorkerSupport';\nimport EventListenerBase from '../../helpers/eventListenerBase';\nimport idleController from '../../helpers/idleController';\nimport {logger} from '../logger';\nimport rootScope from '../rootScope';\nimport sessionStorage from '../sessionStorage';\nimport apiManagerProxy from './mtprotoworker';\n\nexport type AppInstance = {\n  id: number,\n  idle: boolean,\n  time: number\n};\n\nexport type InstanceDeactivateReason = 'version' | 'tabs';\n\nconst CHECK_INSTANCE_INTERVAL = 5000;\nconst DEACTIVATE_TIMEOUT = 30000;\nconst MULTIPLE_TABS_THRESHOLD = 20000;\nconst IS_MULTIPLE_TABS_SUPPORTED = IS_SHARED_WORKER_SUPPORTED;\n\nexport class SingleInstance extends EventListenerBase<{\n  activated: () =>  void,\n  deactivated: (reason: InstanceDeactivateReason) => void\n}> {\n  private instanceId: number;\n  private started: boolean;\n  private masterInstance: boolean;\n  private deactivateTimeout: number;\n  private deactivated: InstanceDeactivateReason;\n  private log = logger('INSTANCE');\n\n  constructor() {\n    super(false);\n\n    this.log = logger('INSTANCE');\n    this.instanceId = tabId;\n  }\n\n  public get deactivatedReason() {\n    return this.deactivated;\n  }\n\n  public start() {\n    this.reset();\n\n    if(!this.started/*  && !Config.Navigator.mobile && !Config.Modes.packed */) {\n      this.started = true;\n\n      idleController.addEventListener('change', this.checkInstance);\n      setInterval(this.checkInstance, CHECK_INSTANCE_INTERVAL);\n      this.checkInstance();\n\n      try {\n        document.documentElement.addEventListener('beforeunload', this.clearInstance);\n      } catch(e) {}\n    }\n  }\n\n  private reset() {\n    this.masterInstance = false;\n    this.clearDeactivateTimeout();\n    this.deactivated = undefined;\n  }\n\n  private clearInstance = () => {\n    if(this.masterInstance && !this.deactivated) {\n      this.log.warn('clear master instance');\n      sessionStorage.delete('xt_instance');\n    }\n  };\n\n  public activateInstance() {\n    if(this.deactivated) {\n      this.reset();\n      this.checkInstance(false);\n      this.dispatchEvent('activated');\n    }\n  }\n\n  private deactivateInstance(reason: InstanceDeactivateReason) {\n    if(this.masterInstance || this.deactivated) {\n      return;\n    }\n\n    this.log.warn('deactivate', reason);\n    this.clearDeactivateTimeout();\n    this.deactivated = reason;\n\n    this.dispatchEvent('deactivated', reason);\n  }\n\n  private clearDeactivateTimeout() {\n    if(this.deactivateTimeout) {\n      clearTimeout(this.deactivateTimeout);\n      this.deactivateTimeout = 0;\n    }\n  }\n\n  private checkInstance = async(idle = idleController.isIdle) => {\n    if(this.deactivated) {\n      return;\n    }\n\n    const time = Date.now();\n    const newInstance: AppInstance = {\n      id: this.instanceId,\n      idle,\n      time\n    };\n\n    const [curInstance, build = App.build] = await Promise.all([\n      sessionStorage.get('xt_instance', false),\n      sessionStorage.get('k_build', false)\n    ]);\n\n    if(build > App.build) {\n      this.masterInstance = false;\n      rootScope.managers.networkerFactory.stopAll();\n      this.deactivateInstance('version');\n      apiManagerProxy.toggleStorages(false, false);\n      return;\n    } else if(IS_MULTIPLE_TABS_SUPPORTED) {\n      sessionStorage.set({xt_instance: newInstance});\n      return;\n    }\n\n    // this.log('check instance', newInstance, curInstance)\n    if(!idle ||\n        !curInstance ||\n        curInstance.id === this.instanceId ||\n        curInstance.time < (time - MULTIPLE_TABS_THRESHOLD)) {\n      sessionStorage.set({xt_instance: newInstance});\n\n      if(!this.masterInstance) {\n        this.masterInstance = true;\n        rootScope.managers.networkerFactory.startAll();\n        this.log.warn('now master instance', newInstance);\n      }\n\n      this.clearDeactivateTimeout();\n    } else if(this.masterInstance) {\n      this.masterInstance = false;\n      rootScope.managers.networkerFactory.stopAll();\n      this.log.warn('now idle instance', newInstance);\n      this.deactivateTimeout ||= window.setTimeout(() => this.deactivateInstance('tabs'), DEACTIVATE_TIMEOUT);\n    }\n  };\n}\n\nconst singleInstance = new SingleInstance();\nMOUNT_CLASS_TO && (MOUNT_CLASS_TO.singleInstance = singleInstance);\nexport default singleInstance;\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n *\n * Originally from:\n * https://github.com/zhukov/webogram\n * Copyright (C) 2014 Igor Zhukov <igor.beatle@gmail.com>\n * https://github.com/zhukov/webogram/blob/master/LICENSE\n */\n\nimport App from '../../config/app';\nimport {MOUNT_CLASS_TO} from '../../config/debug';\nimport Modes from '../../config/modes';\nimport loadScript from '../../helpers/dom/loadScript';\nimport tsNow from '../../helpers/tsNow';\nimport sessionStorage from '../sessionStorage';\n\nexport class TelegramMeWebManager {\n  private disabled = /* false &&  */(Modes.test || !App.domains.includes(location.hostname));\n\n  public setAuthorized(canRedirect: boolean) {\n    if(this.disabled) {\n      return;\n    }\n\n    return sessionStorage.get('tgme_sync').then((curValue) => {\n      const ts = tsNow(true);\n      if(\n        canRedirect &&\n        curValue?.canRedirect === canRedirect &&\n        (curValue.ts + 86400) > ts\n      ) {\n        return;\n      }\n\n      sessionStorage.set({\n        tgme_sync: {\n          canRedirect,\n          ts\n        }\n      });\n\n      const path = `_websync_?authed=${canRedirect ? '1' : '0'}&version=${encodeURIComponent(App.version + ' ' + App.suffix)}`;\n      const urls = [\n        '//telegram.me/' + path,\n        '//t.me/' + path\n      ];\n\n      const promises = urls.map((url) => {\n        return loadScript(url).then((script) => {\n          script.remove();\n        });\n      });\n\n      return Promise.all(promises);\n    });\n  }\n}\n\nconst telegramMeWebManager = new TelegramMeWebManager();\nMOUNT_CLASS_TO && (MOUNT_CLASS_TO.telegramMeWebManager = telegramMeWebManager);\nexport default telegramMeWebManager;\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nexport default function loadScript(url: string) {\n  const script = document.createElement('script');\n  const promise = new Promise<HTMLScriptElement>((resolve) => {\n    script.onload = script.onerror = () => {\n      resolve(script);\n    };\n  });\n  script.src = url;\n  document.body.appendChild(script);\n  return promise;\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n *\n * Originally from:\n * https://github.com/zhukov/webogram\n * Copyright (C) 2014 Igor Zhukov <igor.beatle@gmail.com>\n * https://github.com/zhukov/webogram/blob/master/LICENSE\n */\n\nimport type {PushNotificationObject} from '../serviceWorker/push';\nimport type {ServicePushPingTaskPayload} from '../serviceWorker/serviceMessagePort';\nimport type {NotificationSettings} from '../appManagers/uiNotificationsManager';\nimport {MOUNT_CLASS_TO} from '../../config/debug';\nimport {logger} from '../logger';\nimport apiManagerProxy from './mtprotoworker';\nimport I18n, {LangPackKey} from '../langPack';\nimport {IS_MOBILE} from '../../environment/userAgent';\nimport appRuntimeManager from '../appManagers/appRuntimeManager';\nimport copy from '../../helpers/object/copy';\nimport singleInstance from './singleInstance';\nimport EventListenerBase from '../../helpers/eventListenerBase';\nimport getServerMessageId from '../appManagers/utils/messageId/getServerMessageId';\n\nexport type PushSubscriptionNotifyType = 'init' | 'subscribe' | 'unsubscribe';\nexport type PushSubscriptionNotifyEvent = `push_${PushSubscriptionNotifyType}`;\n\nexport type PushSubscriptionNotify = {\n  tokenType: number,\n  tokenValue: string\n};\n\nconst PING_PUSH_INTERVAL = 10000;\n\nexport class WebPushApiManager extends EventListenerBase<{\n  push_notification_click: (n: PushNotificationObject) => void,\n  push_init: (n: PushSubscriptionNotify) => void,\n  push_subscribe: (n: PushSubscriptionNotify) => void,\n  push_unsubscribe: (n: PushSubscriptionNotify) => void\n}> {\n  public isAvailable = true;\n  private isPushEnabled = false;\n  private localNotificationsAvailable = true;\n  private started = false;\n  private settings: NotificationSettings & {baseUrl?: string} = {} as any;\n  private isAliveTO: any;\n  private isFirefox = navigator.userAgent.toLowerCase().indexOf('firefox') > -1;\n  private userVisibleOnly = this.isFirefox ? false : true;\n  private log = logger('PUSH-API');\n\n  constructor() {\n    super(false);\n\n    if(!('PushManager' in window) ||\n      !('Notification' in window) ||\n      !('serviceWorker' in navigator)) {\n      this.log.warn('Push messaging is not supported.');\n      this.isAvailable = false;\n      this.localNotificationsAvailable = false;\n    }\n\n    if(this.isAvailable && Notification.permission === 'denied') {\n      this.log.warn('The user has blocked notifications.');\n    }\n  }\n\n  public start() {\n    if(!this.started) {\n      this.started = true;\n      this.getSubscription();\n      this.setUpServiceWorkerChannel();\n    }\n  }\n\n  public setLocalNotificationsDisabled() {\n    this.localNotificationsAvailable = false;\n  }\n\n  public getSubscription() {\n    if(!this.isAvailable) {\n      return;\n    }\n\n    navigator.serviceWorker.ready.then((reg) => {\n      reg.pushManager.getSubscription().then((subscription) => {\n        this.isPushEnabled = !!subscription;\n        this.pushSubscriptionNotify('init', subscription);\n      }).catch((err) => {\n        this.log.error('Error during getSubscription()', err);\n      });\n    });\n  }\n\n  public subscribe = () => {\n    if(!this.isAvailable) {\n      return;\n    }\n\n    navigator.serviceWorker.ready.then((reg) => {\n      reg.pushManager.subscribe({userVisibleOnly: this.userVisibleOnly}).then((subscription) => {\n        // The subscription was successful\n        this.isPushEnabled = true;\n        this.pushSubscriptionNotify('subscribe', subscription);\n      }).catch((e) => {\n        if(Notification.permission === 'denied') {\n          this.log('Permission for Notifications was denied');\n        } else {\n          this.log('Unable to subscribe to push.', e);\n          if(!this.userVisibleOnly) {\n            this.userVisibleOnly = true;\n            setTimeout(this.subscribe, 0);\n          }\n        }\n      });\n    });\n  }\n\n  public unsubscribe() {\n    if(!this.isAvailable) {\n      return;\n    }\n\n    navigator.serviceWorker.ready.then((reg) => {\n      reg.pushManager.getSubscription().then((subscription) => {\n        this.isPushEnabled = false;\n\n        if(subscription) {\n          this.pushSubscriptionNotify('unsubscribe', subscription);\n\n          setTimeout(() => {\n            subscription.unsubscribe().then((successful) => {\n              this.isPushEnabled = false;\n            }).catch((e) => {\n              this.log.error('Unsubscription error: ', e);\n            });\n          }, 3000);\n        }\n      }).catch((e) => {\n        this.log.error('Error thrown while unsubscribing from ' +\n          'push messaging.', e);\n      });\n    });\n  }\n\n  public forceUnsubscribe() {\n    if(!this.isAvailable) {\n      return;\n    }\n\n    navigator.serviceWorker.ready.then((reg) => {\n      reg.pushManager.getSubscription().then((subscription) => {\n        this.log.warn('force unsubscribe', subscription);\n        if(subscription) {\n          subscription.unsubscribe().then((successful) => {\n            this.log.warn('force unsubscribe successful', successful);\n            this.isPushEnabled = false;\n          }).catch((e) => {\n            this.log.error('Unsubscription error: ', e);\n          });\n        }\n      }).catch((e) => {\n        this.log.error('Error thrown while unsubscribing from ' +\n          'push messaging.', e);\n      });\n    });\n  }\n\n  public isAliveNotify = () => {\n    if(!this.isAvailable || singleInstance.deactivatedReason) {\n      return;\n    }\n\n    this.settings.baseUrl = (location.href || '').replace(/#.*$/, '');\n\n    const lang: ServicePushPingTaskPayload['lang'] = {} as any;\n    const ACTIONS_LANG_MAP: Record<keyof ServicePushPingTaskPayload['lang'], LangPackKey> = {\n      push_action_mute1d: IS_MOBILE ? 'PushNotification.Action.Mute1d.Mobile' : 'PushNotification.Action.Mute1d',\n      push_action_settings: IS_MOBILE ? 'PushNotification.Action.Settings.Mobile' : 'PushNotification.Action.Settings',\n      push_message_nopreview: 'PushNotification.Message.NoPreview'\n    };\n\n    for(const action in ACTIONS_LANG_MAP) {\n      lang[action as keyof typeof ACTIONS_LANG_MAP] = I18n.format(ACTIONS_LANG_MAP[action as keyof typeof ACTIONS_LANG_MAP], true);\n    }\n\n    apiManagerProxy.serviceMessagePort.invokeVoid('pushPing', {\n      localNotifications: this.localNotificationsAvailable,\n      lang: lang,\n      settings: this.settings\n    });\n\n    this.isAliveTO = setTimeout(this.isAliveNotify, PING_PUSH_INTERVAL);\n  }\n\n  public setSettings(newSettings: WebPushApiManager['settings']) {\n    this.settings = copy(newSettings);\n    clearTimeout(this.isAliveTO);\n    this.isAliveNotify();\n  }\n\n  public hidePushNotifications() {\n    if(!this.isAvailable) {\n      return;\n    }\n\n    apiManagerProxy.serviceMessagePort.invokeVoid('notificationsClear', undefined);\n  }\n\n  public setUpServiceWorkerChannel() {\n    if(!this.isAvailable) {\n      return;\n    }\n\n    apiManagerProxy.serviceMessagePort.addEventListener('pushClick', (payload) => {\n      if(singleInstance.deactivatedReason) {\n        appRuntimeManager.reload();\n        return;\n      }\n\n      this.dispatchEvent('push_notification_click', payload);\n    });\n\n    navigator.serviceWorker.ready.then(this.isAliveNotify);\n  }\n\n  public pushSubscriptionNotify(event: PushSubscriptionNotifyType, subscription?: PushSubscription) {\n    if(subscription) {\n      const subscriptionObj: PushSubscriptionJSON = subscription.toJSON();\n      if(!subscriptionObj ||\n        !subscriptionObj.endpoint ||\n        !subscriptionObj.keys ||\n        !subscriptionObj.keys.p256dh ||\n        !subscriptionObj.keys.auth) {\n        this.log.warn('Invalid push subscription', subscriptionObj);\n        this.unsubscribe();\n        this.isAvailable = false;\n        this.pushSubscriptionNotify(event);\n        return;\n      }\n\n      this.log.warn('Push', event, subscriptionObj);\n      this.dispatchEvent(('push_' + event) as PushSubscriptionNotifyEvent, {\n        tokenType: 10,\n        tokenValue: JSON.stringify(subscriptionObj)\n      });\n    } else {\n      this.log.warn('Push', event, false);\n      this.dispatchEvent(('push_' + event) as PushSubscriptionNotifyEvent, false as any);\n    }\n  }\n\n  public ignorePushByMid(peerId: PeerId, mid: number) {\n    if(!this.isAvailable) {\n      return;\n    }\n\n    apiManagerProxy.serviceMessagePort.invokeVoid('shownNotification', peerId + '_' + getServerMessageId(mid));\n  }\n}\n\nconst webPushApiManager = new WebPushApiManager();\nMOUNT_CLASS_TO && (MOUNT_CLASS_TO.webPushApiManager = webPushApiManager);\nexport default webPushApiManager;\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport {MOUNT_CLASS_TO} from '../config/debug';\nimport IS_OPUS_SUPPORTED from '../environment/opusSupport';\nimport {IS_SAFARI} from '../environment/userAgent';\nimport {Modify} from '../types';\nimport {logger, LogTypes} from './logger';\nimport apiManagerProxy from './mtproto/mtprotoworker';\nimport type {ConvertWebPTask} from './webp/webpWorkerController';\n\ntype Result = {\n  bytes: Uint8Array,\n  waveform?: Uint8Array\n};\n\ntype Task = {\n  pages: Uint8Array,\n  withWaveform: boolean,\n  waveform?: Uint8Array,\n  callback: {resolve: (result: Result) => void, reject: (err: any) => void},\n  timeout: number\n};\n\nexport interface ConvertOpusTask extends Modify<ConvertWebPTask, {type: 'convertOpus'}> {\n  type: 'convertOpus'\n}\n\nexport class OpusDecodeController {\n  private worker: Worker;\n  private wavWorker: Worker;\n  private sampleRate = 48000;\n  private tasks: Array<Task> = [];\n  private keepAlive = false;\n  private log = logger('OPUS', LogTypes.Error);\n\n  public isPlaySupported() {\n    return IS_OPUS_SUPPORTED;\n  }\n\n  public loadWavWorker() {\n    if(this.wavWorker) return;\n\n    this.wavWorker = new Worker('waveWorker.min.js');\n    this.wavWorker.addEventListener('message', (e) => {\n      const data = e.data;\n\n      this.log('[WAV] got message:', data);\n      if(data && data.page) {\n        const bytes = data.page;\n        this.onTaskEnd(this.tasks.shift(), bytes);\n      }\n    });\n  }\n\n  public loadWorker() {\n    if(this.worker) return;\n\n    this.worker = new Worker('decoderWorker.min.js');\n    this.worker.addEventListener('message', (e) => {\n      const data = e.data;\n\n      this.log('[DECODER] got message', data);\n      if(data.type === 'done') {\n        // this.log('[DECODER] send done to wav');\n        this.wavWorker.postMessage({command: 'done'});\n\n        if(data.waveform) {\n          this.tasks[0].waveform = data.waveform;\n        }\n      } else { // e.data contains decoded buffers as float32 values\n        // this.log('[DECODER] send encode to wav');\n        this.wavWorker.postMessage({\n          command: 'encode',\n          buffers: e.data\n        }, IS_SAFARI ? undefined : data.map((typedArray: Uint8Array) => typedArray.buffer));\n      }\n    });\n  }\n\n  public setKeepAlive(keepAlive: boolean) {\n    this.keepAlive = keepAlive;\n    if(this.keepAlive) {\n      this.loadWorker();\n      this.loadWavWorker();\n    } else if(!this.tasks.length) {\n      this.terminateWorkers();\n    }\n  }\n\n  public onTaskEnd(task: Task, result?: Uint8Array) {\n    if(!result) {\n      task.callback.reject('timeout');\n    } else {\n      clearTimeout(task.timeout);\n      task.callback.resolve({bytes: result, waveform: task.waveform});\n    }\n\n    if(this.tasks.length) {\n      this.executeNewTask(this.tasks[0]);\n    }\n\n    this.terminateWorkers();\n  }\n\n  public terminateWorkers(kill = false) {\n    if((this.keepAlive || this.tasks.length) && !kill) return;\n\n    if(this.worker) {\n      this.worker.terminate();\n      this.worker = null;\n    }\n\n    if(this.wavWorker) {\n      this.wavWorker.terminate();\n      this.wavWorker = null;\n    }\n  }\n\n  public executeNewTask(task: Task) {\n    this.worker.postMessage({\n      command: 'init',\n      decoderSampleRate: this.sampleRate,\n      outputBufferSampleRate: this.sampleRate\n    });\n\n    this.wavWorker.postMessage({\n      command: 'init',\n      wavBitDepth: 16,\n      wavSampleRate: this.sampleRate\n    });\n\n    // console.log('sending command to worker:', task);\n    // setTimeout(() => {\n    this.log('[DECODER] send decode');\n    this.worker.postMessage({\n      command: 'decode',\n      pages: task.pages,\n      waveform: task.withWaveform\n    }, IS_SAFARI ? undefined : [task.pages.buffer]);\n    // }, 1e3);\n\n    task.timeout = window.setTimeout(() => {\n      this.log.error('decode timeout'/* , task */);\n\n      this.terminateWorkers(true);\n      if(this.tasks.length) {\n        this.loadWorker();\n        this.loadWavWorker();\n      }\n\n      this.onTaskEnd(this.tasks.shift());\n    }, 10e3);\n  }\n\n  public pushDecodeTask(pages: Uint8Array, withWaveform: boolean) {\n    return new Promise<Result>((resolve, reject) => {\n      const task = {\n        pages,\n        withWaveform,\n        callback: {resolve, reject},\n        timeout: 0\n      };\n\n      this.loadWorker();\n      this.loadWavWorker();\n\n      if(this.tasks.push(task) === 1) {\n        this.executeNewTask(task);\n      }\n    });\n  }\n\n  public async decode(typedArray: Uint8Array, withWaveform = false) {\n    return this.pushDecodeTask(typedArray, withWaveform).then(async(result) => {\n      const dataBlob = new Blob([result.bytes], {type: 'audio/wav'});\n      return {url: await apiManagerProxy.invoke('createObjectURL', dataBlob), waveform: result.waveform};\n    });\n  }\n}\n\nconst opusDecodeController = new OpusDecodeController();\nMOUNT_CLASS_TO.opusDecodeController = opusDecodeController;\nexport default opusDecodeController;\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n *\n * Originally from:\n * https://github.com/zhukov/webogram\n * Copyright (C) 2014 Igor Zhukov <igor.beatle@gmail.com>\n * https://github.com/zhukov/webogram/blob/master/LICENSE\n */\n\nimport emojiRegExp from '../../vendor/emoji/regex';\nimport {MessageEntity} from '../../layer';\n\nconst EmojiHelper = {\n  emojiMap: (code: string) => { return code; },\n  shortcuts: [] as any,\n  emojis: [] as any\n};\n\nexport const ALPHA_CHARS_REG_EXP = 'a-z' +\n  '\\\\u00c0-\\\\u00d6\\\\u00d8-\\\\u00f6\\\\u00f8-\\\\u00ff' + // Latin-1\n  '\\\\u0100-\\\\u024f' + // Latin Extended A and B\n  '\\\\u0253\\\\u0254\\\\u0256\\\\u0257\\\\u0259\\\\u025b\\\\u0263\\\\u0268\\\\u026f\\\\u0272\\\\u0289\\\\u028b' + // IPA Extensions\n  '\\\\u02bb' + // Hawaiian\n  '\\\\u0300-\\\\u036f' + // Combining diacritics\n  '\\\\u1e00-\\\\u1eff' + // Latin Extended Additional (mostly for Vietnamese)\n  '\\\\u0400-\\\\u04ff\\\\u0500-\\\\u0527' + // Cyrillic\n  '\\\\u2de0-\\\\u2dff\\\\ua640-\\\\ua69f' + // Cyrillic Extended A/B\n  '\\\\u0591-\\\\u05bf\\\\u05c1-\\\\u05c2\\\\u05c4-\\\\u05c5\\\\u05c7' +\n  '\\\\u05d0-\\\\u05ea\\\\u05f0-\\\\u05f4' + // Hebrew\n  '\\\\ufb1d-\\\\ufb28\\\\ufb2a-\\\\ufb36\\\\ufb38-\\\\ufb3c\\\\ufb3e\\\\ufb40-\\\\ufb41' +\n  '\\\\ufb43-\\\\ufb44\\\\ufb46-\\\\ufb4f' + // Hebrew Pres. Forms\n  '\\\\u0610-\\\\u061a\\\\u0620-\\\\u065f\\\\u066e-\\\\u06d3\\\\u06d5-\\\\u06dc' +\n  '\\\\u06de-\\\\u06e8\\\\u06ea-\\\\u06ef\\\\u06fa-\\\\u06fc\\\\u06ff' + // Arabic\n  '\\\\u0750-\\\\u077f\\\\u08a0\\\\u08a2-\\\\u08ac\\\\u08e4-\\\\u08fe' + // Arabic Supplement and Extended A\n  '\\\\ufb50-\\\\ufbb1\\\\ufbd3-\\\\ufd3d\\\\ufd50-\\\\ufd8f\\\\ufd92-\\\\ufdc7\\\\ufdf0-\\\\ufdfb' + // Pres. Forms A\n  '\\\\ufe70-\\\\ufe74\\\\ufe76-\\\\ufefc' + // Pres. Forms B\n  '\\\\u200c' + // Zero-Width Non-Joiner\n  '\\\\u0e01-\\\\u0e3a\\\\u0e40-\\\\u0e4e' + // Thai\n  '\\\\u1100-\\\\u11ff\\\\u3130-\\\\u3185\\\\uA960-\\\\uA97F\\\\uAC00-\\\\uD7AF\\\\uD7B0-\\\\uD7FF' + // Hangul (Korean)\n  '\\\\u3003\\\\u3005\\\\u303b' + // Kanji/Han iteration marks\n  '\\\\uff21-\\\\uff3a\\\\uff41-\\\\uff5a' + // full width Alphabet\n  '\\\\uff66-\\\\uff9f' + // half width Katakana\n  '\\\\uffa1-\\\\uffdc'; // half width Hangul (Korean)\nexport const ALPHA_NUMERIC_REG_EXP = '0-9\\_' + ALPHA_CHARS_REG_EXP;\nexport const DOMAIN_ADD_CHARS = '\\u00b7';\n// Based on Regular Expression for URL validation by Diego Perini\nexport const URL_ALPHANUMERIC_REG_EXP_PART = '[' + ALPHA_CHARS_REG_EXP + '0-9]';\nexport const URL_PROTOCOL_REG_EXP_PART = '((?:https?|ftp)://|mailto:)?';\nexport const URL_REG_EXP = URL_PROTOCOL_REG_EXP_PART +\n  // user:pass authentication\n  '(?:' + URL_ALPHANUMERIC_REG_EXP_PART + '{1,64}(?::' + URL_ALPHANUMERIC_REG_EXP_PART + '{0,64})?@)?' +\n  '(?:' +\n  // sindresorhus/ip-regexp\n  '(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])(?:\\\\.(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])){3}' +\n  '|' +\n  // host name\n  URL_ALPHANUMERIC_REG_EXP_PART + '[' + ALPHA_CHARS_REG_EXP + DOMAIN_ADD_CHARS + '0-9\\-]{0,64}' +\n  // domain name\n  '(?:\\\\.' + URL_ALPHANUMERIC_REG_EXP_PART + '[' + ALPHA_CHARS_REG_EXP + DOMAIN_ADD_CHARS + '0-9\\-]{0,64}){0,10}' +\n  // TLD identifier\n  '(?:\\\\.(xn--[0-9a-z]{2,16}|[' + ALPHA_CHARS_REG_EXP + ']{2,24}))' +\n  ')' +\n  // port number\n  '(?::\\\\d{2,5})?' +\n  // resource path\n  '(?:/(?:\\\\S{0,255}[^\\\\s.;,(\\\\[\\\\]{}<>\"\\'])?)?';\nexport const URL_PROTOCOL_REG_EXP = new RegExp('^' + URL_PROTOCOL_REG_EXP_PART.slice(0, -1), 'i');\nexport const URL_ANY_PROTOCOL_REG_EXP = /^((?:[^\\/]+?):\\/\\/|mailto:)/;\nexport const USERNAME_REG_EXP = '[a-zA-Z\\\\d_]{5,32}';\nexport const TIMESTAMP_REG_EXP = '(?:\\\\s|^)((?:\\\\d{1,2}:)?(?:[0-5]?[0-9]):(?:[0-5][0-9]))(?:\\\\s|$)';\nexport const BOT_COMMAND_REG_EXP = '\\\\/([a-zA-Z\\\\d_]{1,32})(?:@(' + USERNAME_REG_EXP + '))?(\\\\b|$)';\nexport const FULL_REG_EXP = new RegExp('(^| )(@)(' + USERNAME_REG_EXP + ')|(' + URL_REG_EXP + ')|(\\\\n)|(' + emojiRegExp + ')|(^|[\\\\s\\\\(\\\\]])(#[' + ALPHA_NUMERIC_REG_EXP + ']{2,64})|(^|\\\\s)' + BOT_COMMAND_REG_EXP + '|' + TIMESTAMP_REG_EXP + '', 'i');\nexport const EMAIL_REG_EXP = /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n// const markdownTestRegExp = /[`_*@~]/;\nexport const MARKDOWN_REG_EXP = /(^|\\s|\\n)(````?)([\\s\\S]+?)(````?)([\\s\\n\\.,:?!;]|$)|(^|\\s|\\x01)(`|~~|\\*\\*|__|_-_|\\|\\|)([^\\n]+?)\\7([\\x01\\s\\.,:?!;]|$)|@(\\d+)\\s*\\((.+?)\\)|(\\[(.+?)\\]\\((.+?)\\))/m;\nexport const SITE_HASHTAGS: {[siteName: string]: string} = {\n  'Telegram': 'tg://search_hashtag?hashtag={1}',\n  'Twitter': 'https://twitter.com/hashtag/{1}',\n  'Instagram': 'https://instagram.com/explore/tags/{1}/',\n  'Google Plus': 'https://plus.google.com/explore/{1}'\n};\n\n// export const SITE_MENTIONS: {[siteName in 'Telegram' | 'Twitter' | 'Instagram' | 'GitHub']: string} = {\n//   Telegram: '#{1}',\n//   Twitter: 'https://twitter.com/{1}',\n//   Instagram: 'https://instagram.com/{1}/',\n//   GitHub: 'https://github.com/{1}'\n// };\n\nexport const MARKDOWN_ENTITIES: {[markdown: string]: MessageEntity['_']} = {\n  '`': 'messageEntityCode',\n  '``': 'messageEntityPre',\n  '**': 'messageEntityBold',\n  '__': 'messageEntityItalic',\n  '~~': 'messageEntityStrike',\n  '_-_': 'messageEntityUnderline',\n  '||': 'messageEntitySpoiler'\n};\n\nexport const MARKDOWN_ENTITIES_TYPES = new Set(Object.values(MARKDOWN_ENTITIES));\n\nexport const PASS_CONFLICTING_ENTITIES: Set<MessageEntity['_']> = new Set([\n  'messageEntityEmoji',\n  'messageEntityLinebreak',\n  'messageEntityCaret'\n]);\nexport const PASS_SINGLE_CONFLICTING_ENTITIES = new Set(PASS_CONFLICTING_ENTITIES);\nfor(const i in MARKDOWN_ENTITIES) {\n  PASS_CONFLICTING_ENTITIES.add(MARKDOWN_ENTITIES[i]);\n}\n\nexport const PHONE_NUMBER_REG_EXP = /^\\+\\d+$/;\n\n/* export function parseEmojis(text: string) {\n  return text.replace(/:([a-z0-9\\-\\+\\*_]+?):/gi, function (all, shortcut) {\n    var emojiCode = EmojiHelper.shortcuts[shortcut]\n    if (emojiCode !== undefined) {\n      return EmojiHelper.emojis[emojiCode][0]\n    }\n    return all\n  })\n} */\n\n\n/* export function replaceUrlEncodings(urlWithEncoded: string) {\n  return urlWithEncoded.replace(/(%[A-Z\\d]{2})+/g, (str) => {\n    try {\n      return decodeURIComponent(str);\n    } catch (e) {\n      return str;\n    }\n  });\n} */\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport type addAnchorListener from '../../helpers/addAnchorListener';\nimport {PHONE_NUMBER_REG_EXP} from '.';\nimport {MOUNT_CLASS_TO} from '../../config/debug';\nimport matchUrlProtocol from './matchUrlProtocol';\nimport {T_ME_PREFIXES} from '../mtproto/mtproto_config';\n\nexport default function wrapUrl(url: string, unsafe?: number | boolean) {\n  if(!matchUrlProtocol(url)) {\n    url = 'https://' + url;\n  }\n\n  const out: {url: string, onclick?: Parameters<typeof addAnchorListener>[0]['name']} = {url};\n  let tgMeMatch, telescoPeMatch, tgMatch;\n  let onclick: typeof out['onclick'];\n  /* if(unsafe === 2) {\n    url = 'tg://unsafe_url?url=' + encodeURIComponent(url);\n  } else  */if((tgMeMatch = url.match(/^(?:https?:\\/\\/)?(?:(.+?)\\.)?(?:(?:web|k|z|a)\\.)?t(?:elegram)?\\.me(?:\\/(.+))?/))) {\n    const u = new URL(url);\n    let prefix = tgMeMatch[1];\n    if(prefix && T_ME_PREFIXES.has(tgMeMatch[1])) {\n      prefix = undefined;\n    }\n\n    if(prefix) {\n      u.pathname = prefix + (u.pathname === '/' ? '' : u.pathname);\n    }\n\n    const fullPath = u.pathname.slice(1);\n    const path = fullPath.split('/');\n\n    if(path[0] && path[0][0] === '$' && path[0].length > 1) {\n      onclick = 'invoice';\n    } else if(/^\\+/.test(fullPath) && !PHONE_NUMBER_REG_EXP.test(fullPath)) { // second regexp is for phone numbers (t.me/+38050...)\n      onclick = 'joinchat';\n    } else if(path[0]) switch(path[0]) {\n      case 'addlist':\n      case 'joinchat':\n      case 'addstickers':\n      case 'addemoji':\n      case 'voicechat':\n      case 'invoice':\n        if(path.length !== 1 && !prefix) {\n          onclick = path[0];\n          break;\n        }\n\n      default:\n        if(path.length <= 2 || path[1]?.match(/^\\d+(?:\\?(?:comment|thread)=\\d+)?$/)) {\n          onclick = 'im';\n          break;\n        }\n\n        break;\n    }\n  } else if((telescoPeMatch = url.match(/^(?:https?:\\/\\/)?telesco\\.pe\\/([^/?]+)\\/(\\d+)/))) {\n    onclick = 'im';\n  } else if((tgMatch = url.match(/tg:(?:\\/\\/)?(.+?)(?:\\?|$)/))) {\n    onclick = 'tg_' + tgMatch[1] as any;\n  }/*  else if(unsafe) {\n    url = 'tg://unsafe_url?url=' + encodeURIComponent(url);\n  } */\n\n  if(!(window as any)[onclick]) {\n    onclick = undefined;\n  }\n\n  out.onclick = onclick;\n  return out;\n}\n\nMOUNT_CLASS_TO && (MOUNT_CLASS_TO.wrapUrl = wrapUrl);\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport type {Message, StickerSet, Update, NotifyPeer, PeerNotifySettings, PollResults, Poll, WebPage, GroupCall, GroupCallParticipant, ReactionCount, MessagePeerReaction, PhoneCall, Config, Reaction, AttachMenuBot} from '../layer';\nimport type {Dialog, ForumTopic, MessagesStorageKey, MyMessage} from './appManagers/appMessagesManager';\nimport type {MyDialogFilter} from './storages/filters';\nimport type {Folder} from './storages/dialogs';\nimport type {UserTyping} from './appManagers/appProfileManager';\nimport type {MyDraftMessage} from './appManagers/appDraftsManager';\nimport type {ConnectionStatusChange} from './mtproto/connectionStatus';\nimport type {GroupCallId} from './appManagers/appGroupCallsManager';\nimport type {AppManagers} from './appManagers/managers';\nimport type {State} from '../config/state';\nimport type {Progress} from './appManagers/appDownloadManager';\nimport type {CallId} from './appManagers/appCallsManager';\nimport type {MyDocument} from './appManagers/appDocsManager';\nimport type {MTAppConfig} from './mtproto/appConfig';\nimport {NULL_PEER_ID, UserAuth} from './mtproto/mtproto_config';\nimport EventListenerBase from '../helpers/eventListenerBase';\nimport {MOUNT_CLASS_TO} from '../config/debug';\nimport MTProtoMessagePort from './mtproto/mtprotoMessagePort';\nimport {IS_WORKER} from '../helpers/context';\n\nexport type BroadcastEvents = {\n  'chat_full_update': ChatId,\n  'chat_update': ChatId,\n  'chat_toggle_forum': {chatId: ChatId, enabled: boolean},\n  'chat_participant': Update.updateChannelParticipant,\n\n  'channel_update': ChatId,\n\n  'user_update': UserId,\n  'user_auth': UserAuth,\n  'user_full_update': UserId,\n\n  'attach_menu_bot': AttachMenuBot,\n\n  'peer_pinned_messages': {peerId: PeerId, mids?: number[], pinned?: boolean, unpinAll?: true},\n  'peer_pinned_hidden': {peerId: PeerId, maxId: number},\n  'peer_typings': {peerId: PeerId, threadId?: number, typings: UserTyping[]},\n  'peer_block': {peerId: PeerId, blocked: boolean},\n  'peer_title_edit': {peerId: PeerId, threadId?: number},\n  'peer_bio_edit': PeerId,\n  'peer_deleted': PeerId, // left chat, deleted user dialog, left channel\n  'peer_full_update': PeerId,\n\n  'filter_delete': MyDialogFilter,\n  'filter_update': MyDialogFilter,\n  'filter_new': MyDialogFilter,\n  'filter_order': number[],\n  'filter_joined': MyDialogFilter,\n\n  'folder_unread': Omit<Folder, 'dialogs' | 'dispatchUnreadTimeout'>,\n\n  'dialog_draft': {peerId: PeerId, dialog: Dialog | ForumTopic, drop: boolean, draft: MyDraftMessage | undefined},\n  'dialog_unread': {peerId: PeerId, dialog: Dialog | ForumTopic},\n  'dialog_flush': {peerId: PeerId, dialog: Dialog},\n  'dialog_drop': Dialog | ForumTopic,\n  'dialog_migrate': {migrateFrom: PeerId, migrateTo: PeerId},\n  // 'dialog_top': Dialog,\n  'dialog_notify_settings': Dialog | ForumTopic,\n  // 'dialog_order': {dialog: Dialog, pos: number},\n  'dialogs_multiupdate': Map<PeerId, {dialog?: Dialog, topics?: Map<number, ForumTopic>}>,\n\n  'history_append': {storageKey: MessagesStorageKey, message: Message.message},\n  'history_update': {storageKey: MessagesStorageKey, message: MyMessage, sequential?: boolean},\n  'history_reply_markup': {peerId: PeerId},\n  'history_multiappend': MyMessage,\n  'history_delete': {peerId: PeerId, msgs: Set<number>},\n  'history_forbidden': PeerId,\n  'history_reload': PeerId,\n  // 'history_request': void,\n\n  'message_edit': {storageKey: MessagesStorageKey, peerId: PeerId, mid: number, message: MyMessage},\n  'message_sent': {storageKey: MessagesStorageKey, tempId: number, tempMessage: any, mid: number, message: MyMessage},\n  'message_error': {storageKey: MessagesStorageKey, tempId: number, error: ApiError},\n  'message_transcribed': {peerId: PeerId, mid: number, text: string, pending?: boolean},\n  'messages_views': {peerId: PeerId, mid: number, views: number}[],\n  'messages_reactions': {message: Message.message, changedResults: ReactionCount[]}[],\n  'messages_pending': void,\n  'messages_read': void,\n  'messages_downloaded': {peerId: PeerId, mids: number[]},\n  'messages_media_read': {peerId: PeerId, mids: number[]},\n\n  'replies_updated': Message.message,\n\n  'scheduled_new': Message.message,\n  'scheduled_delete': {peerId: PeerId, mids: number[]},\n\n  'album_edit': {peerId: PeerId, groupId: string, deletedMids: number[], messages: Message.message[]},\n\n  'stickers_installed': StickerSet.stickerSet,\n  'stickers_deleted': StickerSet.stickerSet,\n  'stickers_updated': {type: 'recent' | 'faved', stickers: MyDocument[]},\n  'stickers_top': Long,\n  'stickers_order': {type: 'masks' | 'emojis' | 'stickers', order: Long[]},\n  'sticker_updated': {type: 'recent' | 'faved', document: MyDocument, faved: boolean},\n\n  'state_cleared': void,\n  'state_synchronized': ChatId | void,\n  'state_synchronizing': ChatId | void,\n\n  'contacts_update': UserId,\n  'avatar_update': {peerId: PeerId, threadId?: number},\n  'poll_update': {poll: Poll, results: PollResults},\n  'invalidate_participants': ChatId,\n  // 'channel_settings': {channelId: number},\n  'webpage_updated': {id: WebPage.webPage['id'], msgs: {peerId: PeerId, mid: number, isScheduled: boolean}[]},\n\n  'connection_status_change': ConnectionStatusChange,\n  'settings_updated': {key: string, value: any, settings: State['settings']},\n  'draft_updated': {peerId: PeerId, threadId: number, draft: MyDraftMessage | undefined, force?: boolean},\n\n  'background_change': void,\n\n  'privacy_update': Update.updatePrivacy,\n\n  'notify_settings': Update.updateNotifySettings,\n  'notify_peer_type_settings': {key: Exclude<NotifyPeer['_'], 'notifyPeer'>, settings: PeerNotifySettings},\n\n  'notification_reset': string,\n  'notification_cancel': string,\n\n  'language_change': string,\n\n  'theme_change': void,\n  'theme_changed': void,\n\n  'media_play': void,\n\n  'emoji_recent': AppEmoji,\n\n  'download_progress': Progress,\n  'document_downloading': DocId,\n  'document_downloaded': DocId,\n\n  'choosing_sticker': boolean\n\n  'group_call_update': GroupCall,\n  'group_call_participant': {groupCallId: GroupCallId, participant: GroupCallParticipant},\n  // 'group_call_video_track_added': {instance: GroupCallInstance}\n\n  'call_update': PhoneCall,\n  'call_signaling': {callId: CallId, data: Uint8Array},\n\n  'quick_reaction': Reaction,\n\n  'service_notification': Update.updateServiceNotification,\n\n  'logging_out': void,\n\n  'payment_sent': {peerId: PeerId, mid: number, receiptMessage: Message.messageService},\n\n  'web_view_result_sent': Long,\n\n  'premium_toggle': boolean,\n  'premium_toggle_private': {isNew: boolean, isPremium: boolean},\n\n  'config': Config,\n  'app_config': MTAppConfig\n};\n\nexport type BroadcastEventsListeners = {\n  [name in keyof BroadcastEvents]: (e: BroadcastEvents[name]) => void\n};\n\nexport class RootScope extends EventListenerBase<BroadcastEventsListeners> {\n  public myId: PeerId;\n  private connectionStatus: {[name: string]: ConnectionStatusChange};\n  public settings: State['settings'];\n  public managers: AppManagers;\n  public premium: boolean;\n\n  constructor() {\n    super();\n\n    this.myId = NULL_PEER_ID;\n    this.connectionStatus = {};\n    this.premium = false;\n\n    this.addEventListener('user_auth', ({id}) => {\n      this.myId = id.toPeerId();\n    });\n\n    this.addEventListener('premium_toggle_private', ({isNew, isPremium}) => {\n      this.premium = isPremium;\n      this.dispatchEventSingle('premium_toggle', isPremium);\n    });\n\n    this.addEventListener('connection_status_change', (status) => {\n      this.connectionStatus[status.name] = status;\n    });\n\n    this.dispatchEvent = (e, ...args) => {\n      super.dispatchEvent(e, ...args);\n      MTProtoMessagePort.getInstance().invokeVoid('event', {name: e as string, args});\n    };\n\n    if(!IS_WORKER) {\n      this.addEventListener('settings_updated', ({settings}) => {\n        this.settings = settings;\n      });\n    }\n  }\n\n  public getConnectionStatus() {\n    return this.connectionStatus;\n  }\n\n  public getPremium() {\n    return this.premium;\n  }\n\n  public dispatchEventSingle(...args: any[]) {\n    // @ts-ignore\n    super.dispatchEvent(...args);\n  }\n}\n\nconst rootScope = new RootScope();\nMOUNT_CLASS_TO.rootScope = rootScope;\nexport default rootScope;\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport {MOUNT_CLASS_TO} from '../../config/debug';\nimport deferredPromise, {CancellablePromise} from '../../helpers/cancellablePromise';\nimport {WorkerTaskVoidTemplate} from '../../types';\n\nexport interface ConvertWebPTask extends WorkerTaskVoidTemplate {\n  type: 'convertWebp',\n  payload: {\n    fileName: string,\n    bytes: Uint8Array\n  }\n};\n\nexport class WebpWorkerController {\n  private worker: Worker;\n  private convertPromises: {[fileName: string]: CancellablePromise<Uint8Array>} = {};\n\n  private init() {\n    this.worker = new Worker(new URL('./webp.worker.ts', import.meta.url));\n    this.worker.addEventListener('message', (e) => {\n      const task = e.data as ConvertWebPTask;\n      const payload = task.payload;\n\n      const promise = this.convertPromises[payload.fileName];\n      if(promise) {\n        payload.bytes ? promise.resolve(payload.bytes) : promise.reject();\n        delete this.convertPromises[payload.fileName];\n      }\n    });\n  }\n\n  private postMessage(data: ConvertWebPTask) {\n    if(this.init) {\n      this.init();\n      this.init = null;\n    }\n\n    this.worker.postMessage(data);\n  }\n\n  public convert(fileName: string, bytes: Uint8Array) {\n    if(this.convertPromises.hasOwnProperty(fileName)) {\n      return this.convertPromises[fileName];\n    }\n\n    const convertPromise = deferredPromise<Uint8Array>();\n\n    this.postMessage({type: 'convertWebp', payload: {fileName, bytes}});\n\n    return this.convertPromises[fileName] = convertPromise;\n  }\n}\n\nconst webpWorkerController = new WebpWorkerController();\nMOUNT_CLASS_TO.webpWorkerController = webpWorkerController;\nexport default webpWorkerController;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + ({\"589\":\"crypto.worker\",\"630\":\"npm.qr-code-styling\",\"670\":\"sw\",\"678\":\"mtproto.worker\"}[chunkId] || chunkId) + \".\" + {\"8\":\"93d2f33af815eb0455aa\",\"41\":\"83c36e3548aa9e7591e3\",\"53\":\"3252106677a230e8006a\",\"61\":\"8072b41326aa0c2659df\",\"63\":\"a85cfb00bd147822d3d2\",\"77\":\"b8cf11d2b5dca36479ca\",\"104\":\"45250b69db45c6c9da15\",\"231\":\"0052a8f91f5253c73e7d\",\"301\":\"95838a8203f23dd1ce8f\",\"339\":\"12bdbede82465e666965\",\"392\":\"6ce981ebdcbba9b6fd04\",\"436\":\"9e54c5e9f3feccf9d736\",\"437\":\"37bcbe9db9cbb8d8a753\",\"442\":\"54c010363ba1cdea7bce\",\"480\":\"20510b170b62be34dddd\",\"508\":\"63b01198d31ba56526c4\",\"589\":\"03737fac862d52a1eef9\",\"630\":\"f8f57a1c721e03c3f699\",\"641\":\"c9c38a8719275da5f0e3\",\"642\":\"be93122d1116ecdc9322\",\"670\":\"bf13ad5d50e44edd307e\",\"678\":\"0e8c484cbc8ee3f1b454\",\"709\":\"dc21d102a9c5e8b25a71\",\"776\":\"9dbf85d657a8087e3928\",\"781\":\"c527d73f348ae695f21a\",\"783\":\"949e247466ad3ebe82d6\",\"810\":\"3fc399369c174f452112\",\"813\":\"315ffd640c7d6013a536\"}[chunkId] + \".chunk.js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","(() => {\n  if (typeof __webpack_require__ !== 'undefined') {\n    var oldGetScript = __webpack_require__.u;\n    var oldLoadScript = __webpack_require__.e;\n    var queryMap = {};\n    var countMap = {};\n    var getRetryDelay = function () {\n      return 3000;\n    };\n    __webpack_require__.u = function (chunkId) {\n      var result = oldGetScript(chunkId);\n      return (\n        result +\n        (queryMap.hasOwnProperty(chunkId) ? '?' + queryMap[chunkId] : '')\n      );\n    };\n    __webpack_require__.e = function (chunkId) {\n      var result = oldLoadScript(chunkId);\n      return result.catch(function (error) {\n        var retries = countMap.hasOwnProperty(chunkId)\n          ? countMap[chunkId]\n          : 999999;\n        if (retries < 1) {\n          var realSrc = oldGetScript(chunkId);\n          error.message =\n            'Loading chunk ' +\n            chunkId +\n            ' failed after 999999 retries.\\n(' +\n            realSrc +\n            ')';\n          error.request = realSrc;\n          throw error;\n        }\n        return new Promise(function (resolve) {\n          var retryAttempt = 999999 - retries + 1;\n          setTimeout(function () {\n            var retryAttemptString = '&retry-attempt=' + retryAttempt;\n            var cacheBust = (function () {\n              return Date.now();\n            })();\n            +retryAttemptString;\n            queryMap[chunkId] = cacheBust;\n            countMap[chunkId] = retries - 1;\n            resolve(__webpack_require__.e(chunkId));\n          }, getRetryDelay(retryAttempt));\n        });\n      });\n    };\n  }\n})();\n","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t179: 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t} else installedChunks[chunkId] = 0;\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = this[\"webpackChunktweb\"] = this[\"webpackChunktweb\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [85,116], () => (__webpack_require__(2938)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["deferred","leafPrototypes","getProto","inProgress","dataWebpackPrefix","MAIN_DOMAINS","DEFAULT_BACKGROUND_SLUG","threads","Math","min","navigator","hardwareConcurrency","App","id","hash","version","versionFull","build","langPackVersion","langPack","langPackCode","domains","baseDcId","isMainDomain","includes","location","hostname","suffix","cryptoWorkers","IS_BETA","DEBUG","MOUNT_CLASS_TO","window","self","STATE_VERSION","BUILD","DEFAULT_THEME","_","access_hash","settings","pFlags","base_theme","accent_color","message_colors","wallpaper","default","pattern","document","undefined","slug","intensity","background_color","second_background_color","third_background_color","fourth_background_color","dark","title","emoticon","makeDefaultAppTheme","name","baseTheme","highlightningColor","find","s","STATE_INIT","allDialogsLoaded","pinnedOrders","contactsListCachedTime","updates","filtersArr","maxSeenMsgId","stateCreatedTime","Date","now","recentEmoji","recentCustomEmoji","topPeersCache","recentSearch","authState","IS_MOBILE","hiddenPinnedMessages","messagesTextSize","distanceUnit","sendShortcut","autoDownload","photo","contacts","private","groups","channels","video","file","autoDownloadNew","file_size_max","video_preload_large","audio_preload_next","photo_size_max","video_size_max","video_upload_maxbitrate","stickers","suggest","dynamicPackOrder","loop","emoji","big","themes","theme","notifications","sound","timeFormat","toLocaleString","match","liteMode","all","animations","chat","chat_background","chat_spoilers","effects","effects_premiumstickers","effects_reactions","effects_emoji","emoji_messages","emoji_panel","gif","stickers_chat","stickers_panel","playbackParams","volume","muted","playbackRate","playbackRates","voice","audio","round","keepSigned","chatContextMenuHintWasShown","stateId","notifySettings","confirmedWebViews","IS_APPLE_MX","ctx","createElement","getContext","extension","getExtension","renderer","getParameter","UNMASKED_RENDERER_WEBGL","getSupportedExtensions","indexOf","err","CAN_USE_TRANSFERABLES","IS_SAFARI","userAgent","search","geolocation","getCurrentPosition","IMAGE_MIME_TYPES_SUPPORTED","Set","add","arr","concat","canPlayType","IS_APPLE_MOBILE","replace","IS_FIREFOX","mediaDevices","DocumentTouch","USER_AGENT","IS_APPLE","IS_ANDROID","toLowerCase","IS_CHROMIUM","test","vendor","platform","maxTouchPoints","IS_MOBILE_SAFARI","vibrate","VIDEO_MIME_TYPES_SUPPORTED","toDataURL","startsWith","calcImageInBox","imageW","imageH","boxW","boxH","noZoom","boxedImageW","boxedImageH","rgbToHsv","r","g","b","v","max","c","h","hsvToRgb","f","n","k","rgbaToHsla","a","l","d","hslaToRgba","hue2rgb","p","q","t","map","hexaToRgba","hexa","offset","length","slice","i","push","parseInt","hexToRgb","hex","hexaToHsla","rgba","rgbaToHexa","toString","join","hslaStringToHex","hsla","splitted","split","alpha","pop","val","endsWith","hslaStringToRgba","hslaStringToHexa","mixColors","color1","color2","weight","out","Array","v1","v2","floor","computePerceivedBrightness","color","getAverageColor","getAccentColor","baseHsv","baseColor","elementColor","hsvTemp3","hsvTemp4","dist","changeColorAccent","accentHsv","isDarkTheme","colorHsv","abs","newColor","origBrightness","newBrightness","amountOfNew","amount","changeBrightness","getHexColorFromTelegramColor","repeat","getRgbColorFromTelegramColor","getColorsFromWallPaper","wallPaper","filter","Boolean","compareVersion","s1","s2","months","monthsLocalized","daysLocalized","ONE_DAY","fillLocalizedDates","splice","dateTimeFormat","month","date","UTC","format","setMonth","getMonth","getMonths","weekday","setDate","getDate","getWeekDays","getWeekNumber","getFullYear","dayNum","getUTCDay","setUTCDate","getUTCDate","yearStart","getUTCFullYear","ceil","getTime","formatDateAccordingToTodayNew","time","today","timestamp","options","hour","minute","year","day","element","formatFullSentTimeRaw","timeEl","formatTime","dateEl","capitalize","style","textTransform","formatFullSentTime","fragment","createDocumentFragment","append","getFullDate","joiner","monthAsNumber","getHours","getMinutes","noSeconds","getSeconds","leadingZero","noTime","minYear","yearPattern","RegExp","anyLetterRegExp","monthPattern","monthYearOrDayPattern","yearOrDayAndMonthPattern","shortDate","longDate","numberOfDaysEachMonth","fillTipDates","query","dates","trim","some","haystack","setFullYear","setHours","minDate","maxDate","dayOfWeek","formatWeekLong","getDay","getDayOfWeek","distance","setTime","matches","exec","g1","g2","createForDayMonth","createForMonthYear","selectedYear","currentYear","g3","validDateForMonth","formatterYearMax","k1","formatterMonthYear","formatterDayMonth","blurActiveElement","activeElement","blur","cancelEvent","event","originalEvent","stopPropagation","preventDefault","returnValue","cancelBubble","customProperties","constructor","resetCache","this","computedStyle","cache","getProperty","value","getComputedStyle","documentElement","getPropertyValue","setPropertyCache","getPropertyAsSize","size","findUpClassName","el","className","closest","fixSafariStickyInput","input","transform","focus","then","IS_STICKY_INPUT_BUGGED","key","startY","o","capture","passive","onTouchMove","e","touch","touches","scrollable","target","y","scrolled","scrollTop","scrollHeight","clientHeight","nextScrollTop","lastFocusOutTimeStamp","addEventListener","classList","contains","timeStamp","touchStart","removeEventListener","fixSafariStickyInputFocusing","callback","cacheInstallPrompt","deferredPrompt","prompt","outcome","userChoice","getInstallPrompt","texts","fonts","text","icons","monospace","loadFonts","types","Promise","resolve","promises","type","_texts","font","weights","_promises","load","race","catch","setInnerHTML","elem","html","setDirection","replaceChildren","textContent","setAttribute","FOCUS_EVENT_NAME","IdleController","super","_isIdle","focusPromise","focusResolve","isIdle","once","idle","getFocusPromise","dispatchEvent","MediaSize","width","height","aspect","boxSize","fitted","aspectFitted","aspectCovered","makeMediaSize","ScreenSize","CUSTOM_EMOJI_SIZE","ESG_CUSTOM_EMOJI_SIZE","EMOJI_STATUS_SIZE","MediaSizes","screenSizes","mobile","medium","large","sizes","handhelds","regular","webpage","album","esgSticker","animatedSticker","staticSticker","emojiSticker","poll","documentName","invoice","extendedInvoice","customEmoji","esgCustomEmoji","emojiStatus","popupSticker","desktop","isMobile","handleResize","innerWidth","activeScreen","wasScreen","active","rAF","cancelAnimationFrame","requestAnimationFrame","mediaSizes","clamp","OverlayCounter","overlaysActive","isOverlayActive","fastRafCallbacks","fastRaf","currentCallbacks","forEach","cb","fastRafConventionalCallbacks","rafPromise","processing","fastRafConventional","fastRafPromise","doubleRaf","parseUriParams","uri","parseUriParamsLine","line","params","item","decodeURIComponent","appColorMap","rgb","light","lightFilled","darkRgb","darkFilled","colorMap","night","themeController","setTheme","themeColorElem","_themeColorElem","head","querySelector","setThemeColor","themeColor","isNight","setThemeListener","darkModeMediaQuery","matchMedia","checkDarkMode","systemTheme","addListener","applyHighlightningColor","getTheme","setProperty","removeProperty","colorScheme","toggle","applyTheme","styleElement","cssText","switchTheme","bindColorApplier","appliedColors","applyAppColor","_options","finalize","has","lightenAlpha","darkenAlpha","mixColor","appColor","lightenedRgb","darkenedHsla","properties","isDocumentElement","applyNewTheme","isNightTheme","currentTheme","themeSettings","newAppTheme","AppBackgroundTab","setBackgroundDocument","isArray","baseColors","hsvTemp1","hsvTemp2","newAccentRgb","newAccentHex","messageLightenAlpha","baseMessageColor","baseMessageOutBackgroundColor","myMessagesAccent","nextColor","accentColor2","outbox_accent_color","newMessageOutBackgroundColor","getThemeParamsForWebView","themePropertiesMap","bg_color","button_color","button_text_color","hint_color","link_color","secondary_bg_color","text_color","themeParams","workerHandler","construct","args","url","Worker","SharedWorker","w","Proxy","setWorkerProxy","Element","prototype","toggleAttribute","force","hasAttribute","removeAttribute","Node","nodes","rootScope","getProxiedManagers","getElementById","href","singleInstance","visualViewport","lastVH","setViewportVH","setVH","vh","overlayCounter","innerHeight","toggleResizeMode","tabId","onImTabChange","wasTabId","tagName","appMediaViewer","onInResize","hasFocus","onOutResize","console","log","perf","performance","langPromise","stateResult","fadeInWhenFontsReady","promise","opacity","state","isPremium","appVersion","lang_code","dir","tgWebAuthToken","data","token","dcId","tgWebAuthDcId","userId","tgWebAuthUserId","toUserId","isTest","tgWebAuthTest","tgAddr","tgaddr","urlSearchParams","URLSearchParams","set","delete","pagePromise","placeholder","prepend","cloneNode","meModule","pushModule","setAuthorized","forceUnsubscribe","mount","sentCode","authCode","pause","ready","reload","close","DEBUG_MANAGER_REQUESTS","createProxyProxy","proxied","ack","get","receiver","method","warn","createProxy","acknowledged","getServerMessageId","messageId","IDB","db","storageIsAvailable","openDatabase","INSTANCES","isAvailable","createNew","openDbPromise","createIndexes","os","store","indexNames","from","indexName","deleteIndex","indexes","index","createIndex","keyPath","objectParameters","request","indexedDB","open","reject","error","message","finished","setTimeout","onerror","onsuccess","result","calledNew","onclose","onabort","transaction","onversionchange","onupgradeneeded","oldVersion","newVersion","stores","objectStoreNames","objectStore","createObjectStore","static","instance","preserve","storage","IDBStorage","storeName","idb","create","entryName","getObjectStore","clear","save","idx","put","mode","onError","clearTimeout","timeout","onComplete","results","requests","waitForTransactionComplete","oncomplete","callbackResult","left","onRequestFinished","getAll","UNSUPPORTED_LANG_PACK_KEY","I18n","pluralRules","cacheLangPackPromise","setLangCode","langCode","lastRequestedLangCode","lastRequestedNormalizedLangCode","updateAmPm","getDateTimeFormat","hour12","amText","amPmCache","am","pmText","pm","loadLocalLangPack","defaultCode","lang","langSign","countries","strings","formatLocalStrings","saveLangPack","from_version","local","loadLangPack","web","requestedServerLanguage","managers","apiManager","invokeApiCacheable","lang_pack","polyfillPromise","pushTo","applyLangPack","currentLangCode","Intl","PluralRules","string","countriesList","country","langPackKey","default_name","lastAppliedLangCode","cachedDateTimeFormats","querySelectorAll","weakMap","update","superFormatter","indexHolder","lastIndex","p1","p2","p3","p4","lastIndexOf","wrappedUrl","onclick","DocumentFragment","firstChild","formatted","arg","pushNextArgument","plain","str","select","Map","isRTL","setRTL","rtl","getCacheLangPack","finally","setTimeFormat","haveToUpdate","IntlDateElement","getStrings","keys","getLangPack","langPack1","langPack2","localLangPack1","localLangPack2","_Intl","Object","assign","WeakMap","IntlElementBase","property","IntlElement","dataset","compareAndUpdate","json","JSON","stringify","DateTimeFormat","hours","i18n","i18n_","_i18n","joinElementsWith","elements","isLast","useLast","joined","NULL_PEER_ID","REPLIES_PEER_ID","REPLIES_HIDDEN_CHANNEL_ID","SERVICE_PEER_ID","MUTE_UNTIL","BOT_START_PARAM","MAX_FILE_SAVE_SIZE","THUMB_TYPE_FULL","TOPIC_COLORS","ATTACH_MENU_BOT_ICON_NAME","MESSAGE_ID_OFFSET","GENERAL_TOPIC_ID","T_ME_PREFIXES","SEND_WHEN_ONLINE_TIMESTAMP","FOLDER_ID_ALL","FOLDER_ID_ARCHIVE","REAL_FOLDERS","IS_CALL_SUPPORTED","IS_CANVAS_FILTER_SUPPORTED","IS_EMOJI_SUPPORTED","IS_GEOLOCATION_SUPPORTED","IS_GROUP_CALL_SUPPORTED","IS_MOV_SUPPORTED","IS_PARALLAX_SUPPORTED","IS_SCREEN_SHARING_SUPPORTED","IS_TOUCH_SUPPORTED","IS_VIBRATE_SUPPORTED","IS_OPUS_SUPPORTED","IS_SHARED_WORKER_SUPPORTED","IS_WEBM_SUPPORTED","IS_WEBP_SUPPORTED","IS_WEBRTC_SUPPORTED","MEDIA_MIME_TYPES_SUPPORTED","ALL_KEYS","REFRESH_KEYS","loadStateInner","logger","totalPerf","recordPromise","stateStorage","sessionStorage","pushedKeys","pushToState","copy","auth","shift","sessionBuild","shiftedWebKAuth","values","dcID","toPeerId","obj","resetStorages","chats","dialogs","users","_state","state_id","autoDownloadSettings","oldTypes","mediaType","peerTypeSettings","peerType","SKIP_VALIDATING_PATHS","validateInitObject","missingKey","migrated","oldThemes","oldTheme","oldBackground","background","newTheme","colors","wallPaperSettings","animationsEnabled","autoPlay","videos","gifs","k_build","ApiManagerProxy","onMirrorTask","payload","hasOwnProperty","mirrors","mirror","tabState","chatPeerIds","idleStartTime","registerWorker","registerServiceWorker","registerCryptoWorker","addMultipleEventsListeners","convertWebp","fileName","bytes","webpWorkerController","convertOpus","opusDecodeController","localStorageProxy","storageTask","language","toggleStorages","telegramMeWebManager","webPushApiManager","cacheName","caches","appRuntimeManager","idleController","updateTabStateIdle","invoke","pingServiceWorkerWithIframe","pingServiceWorkerPromise","iframe","hidden","onLoad","remove","src","random","body","attachServiceWorker","serviceWorker","lastServiceWorker","serviceMessagePort","detachPort","attachSendPort","invokeVoid","_registerServiceWorker","register","URL","scope","registration","controller","unregister","installing","waiting","worker","attachListenPort","port","source","ports","hello","resendLockTask","share","originals","originalUrl","createWorker","attachWorkerToPort","cryptoMessagePort","blob","fetch","response","pathnameSplitted","pathname","origin","Blob","onWorkerFirstMessage","messagePort","attachPort","loadState","sendState","invokeCrypto","enabled","clearWrite","getMirror","getState","updateTabState","apiManagerProxy","IS_MULTIPLE_TABS_SUPPORTED","SingleInstance","clearInstance","masterInstance","deactivated","checkInstance","newInstance","instanceId","curInstance","deactivateInstance","xt_instance","clearDeactivateTimeout","deactivateTimeout","deactivatedReason","start","reset","started","setInterval","activateInstance","reason","TelegramMeWebManager","disabled","canRedirect","curValue","ts","tsNow","tgme_sync","path","encodeURIComponent","script","onload","appendChild","loadScript","WebPushApiManager","isPushEnabled","localNotificationsAvailable","isFirefox","userVisibleOnly","subscribe","reg","pushManager","subscription","pushSubscriptionNotify","Notification","permission","isAliveNotify","baseUrl","ACTIONS_LANG_MAP","push_action_mute1d","push_action_settings","push_message_nopreview","action","localNotifications","isAliveTO","getSubscription","setUpServiceWorkerChannel","setLocalNotificationsDisabled","unsubscribe","successful","setSettings","newSettings","hidePushNotifications","subscriptionObj","toJSON","endpoint","p256dh","tokenType","tokenValue","ignorePushByMid","peerId","mid","sampleRate","tasks","keepAlive","isPlaySupported","loadWavWorker","wavWorker","page","onTaskEnd","loadWorker","postMessage","command","waveform","buffers","typedArray","buffer","setKeepAlive","terminateWorkers","task","executeNewTask","kill","terminate","decoderSampleRate","outputBufferSampleRate","wavBitDepth","wavSampleRate","pages","withWaveform","pushDecodeTask","decode","dataBlob","ALPHA_CHARS_REG_EXP","ALPHA_NUMERIC_REG_EXP","URL_ALPHANUMERIC_REG_EXP_PART","URL_PROTOCOL_REG_EXP_PART","URL_REG_EXP","URL_ANY_PROTOCOL_REG_EXP","USERNAME_REG_EXP","BOT_COMMAND_REG_EXP","FULL_REG_EXP","EMAIL_REG_EXP","MARKDOWN_REG_EXP","SITE_HASHTAGS","MARKDOWN_ENTITIES","PASS_CONFLICTING_ENTITIES","PASS_SINGLE_CONFLICTING_ENTITIES","PHONE_NUMBER_REG_EXP","wrapUrl","unsafe","tgMeMatch","telescoPeMatch","tgMatch","u","prefix","fullPath","RootScope","myId","connectionStatus","premium","isNew","dispatchEventSingle","status","getConnectionStatus","getPremium","convertPromises","init","convert","convertPromise","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","call","m","O","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","every","getter","__esModule","getPrototypeOf","ns","def","current","getOwnPropertyNames","definition","defineProperty","enumerable","chunkId","reduce","miniCssF","globalThis","Function","prop","done","needAttach","scripts","getElementsByTagName","getAttribute","charset","nc","onScriptComplete","prev","doneFns","parentNode","removeChild","bind","Symbol","toStringTag","scriptUrl","importScripts","currentScript","Error","oldGetScript","oldLoadScript","queryMap","countMap","retries","realSrc","cacheBust","baseURI","installedChunks","installedChunkData","errorType","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","__webpack_exports__"],"sourceRoot":""}