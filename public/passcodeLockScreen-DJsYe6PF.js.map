{"version":3,"file":"passcodeLockScreen-DJsYe6PF.js","sources":["../src/components/passcodeLock/passwordMonkeyTsx.tsx","../src/components/passcodeLock/simplePopup.tsx","../src/components/passcodeLock/background.tsx","../src/components/passcodeLock/passcodeLockScreen.tsx"],"sourcesContent":["import {Component, createRenderEffect, createSignal, mergeProps, onCleanup, Ref, Show} from 'solid-js';\n\nimport {useLockScreenHotReloadGuard} from '../../lib/solidjs/hotReloadGuard';\n\nimport type PasswordInputField from '../passwordInputField';\nimport type PasswordMonkey from '../monkeys/password';\n\nimport styles from './passwordMonkeyTsx.module.scss';\n\n\nconst PasswordMonkeyTsx: Component<{\n  ref?: Ref<HTMLDivElement>;\n  passwordInputField: PasswordInputField;\n  hidden?: boolean;\n  size?: number;\n}> = (inProps) => {\n  const props = mergeProps({size: 100}, inProps);\n\n  const {PasswordMonkey} = useLockScreenHotReloadGuard();\n\n  const [monkey, setMonkey] = createSignal<PasswordMonkey>();\n  const [monkeyLoaded, setMonkeyLoaded] = createSignal(false);\n\n  createRenderEffect(() => {\n    const monkey = new PasswordMonkey(props.passwordInputField, props.size);\n    monkey.load().then(() => setMonkeyLoaded(true));\n    setMonkey(monkey);\n\n    onCleanup(() => {\n      monkey.remove();\n    });\n  });\n\n  return (\n    <div\n      ref={props.ref}\n      class={styles.PasswordMonkey}\n      classList={{\n        [styles.hidden]: props.hidden\n      }}\n      style={{'--size': props.size + 'px'}}\n    >\n      {monkey().container}\n\n      {/* Prevent the monkey blinking when reloading the page */}\n      <Show when={!monkeyLoaded()}>\n        <img class={styles.MonkeyImage} src=\"assets/img/password-monkey-closed.png\" />\n      </Show>\n    </div>\n  );\n};\n\nexport default PasswordMonkeyTsx;\n","import {Component, JSX, onCleanup, onMount} from 'solid-js';\nimport {Transition} from 'solid-transition-group';\nimport {Portal} from 'solid-js/web';\n\nimport pause from '../../helpers/schedulers/pause';\nimport {i18n} from '../../lib/langPack';\n\nimport ripple from '../ripple'; ripple; // keep\n\nimport styles from './simplePopup.module.scss';\n\nconst SimplePopup: Component<{\n  visible?: boolean;\n\n  title: JSX.Element;\n  description: JSX.Element;\n  confirmButtonContent: JSX.Element;\n\n  onClose?: () => void;\n  onConfirm: () => void;\n}> = (props) => {\n  onMount(() => {\n    const listener = (e: KeyboardEvent) => {\n      if(e.key === 'Escape') props.onClose?.();\n    }\n    document.addEventListener('keydown', listener);\n\n    onCleanup(() => {\n      document.removeEventListener('keydown', listener);\n    });\n  });\n\n  return (\n    <Portal>\n      <Transition\n        onEnter={async(el, done) => {\n          await pause(0);\n          el.classList.add('active');\n          await pause(0);\n          done();\n        }}\n        onExit={async(el, done) => {\n          el.classList.remove('active');\n          await pause(200);\n          done();\n        }}\n      >\n        {props.visible && <div\n          class={'popup popup-peer popup-confirmation ' + styles.Popup}\n          onClick={(e) => {\n            if(e.target === e.currentTarget) {\n              props.onClose?.();\n            }\n          }}\n        >\n          <div class='popup-container'>\n            <div class='popup-header'>\n              <div class='popup-title'>\n                {props.title}\n              </div>\n            </div>\n\n            <div class='popup-description'>\n              {props.description}\n            </div>\n\n            <div class='popup-buttons'>\n              <button class='popup-button btn danger' use:ripple onClick={props.onConfirm}>\n                {props.confirmButtonContent}\n              </button>\n              <button class='popup-button btn primary' use:ripple onClick={props.onClose} autofocus>\n                {i18n('Cancel')}\n              </button>\n            </div>\n          </div>\n        </div>}\n      </Transition>\n    </Portal>\n  );\n};\n\nexport default SimplePopup;\n","import {Component, Show} from 'solid-js';\n\nimport {useLockScreenHotReloadGuard} from '../../lib/solidjs/hotReloadGuard';\nimport {ScreenSize} from '../../helpers/mediaSizes';\n\nimport ChatBackgroundGradientRenderer from '../chat/gradientRenderer';\n\nimport useScreenSize from '../../hooks/useScreenSize';\nimport {ChatBackground} from '../chat/bubbles/chatBackground';\n\n\nconst Background: Component<{\n  gradientRendererRef: (value: ChatBackgroundGradientRenderer | undefined) => void\n}> = (props) => {\n  const {themeController, rootScope} = useLockScreenHotReloadGuard();\n\n  const screenSize = useScreenSize();\n\n  return (\n    <Show when={screenSize() !== ScreenSize.mobile}>\n      <ChatBackground\n        themeController={themeController}\n        managers={rootScope.managers}\n        gradientRendererRef={props.gradientRendererRef}\n      />\n    </Show>\n  );\n};\n\nexport default Background;\n","import {Component, createEffect, createResource, on, onCleanup, onMount, Show} from 'solid-js';\nimport {createMutable} from 'solid-js/store';\n\nimport {useLockScreenHotReloadGuard} from '../../lib/solidjs/hotReloadGuard';\nimport AccountController from '../../lib/accounts/accountController';\nimport {MAX_PASSCODE_LENGTH} from '../../lib/passcode/constants';\nimport {usePasscodeActions} from '../../lib/passcode/actions';\nimport commonStateStorage from '../../lib/commonStateStorage';\nimport throttle from '../../helpers/schedulers/throttle';\nimport focusInput from '../../helpers/dom/focusInput';\nimport pause from '../../helpers/schedulers/pause';\nimport {i18n} from '../../lib/langPack';\n\nimport ChatBackgroundGradientRenderer from '../chat/gradientRenderer';\nimport type PasswordInputField from '../passwordInputField';\nimport {animateValue} from '../mediaEditor/utils';\nimport ripple from '../ripple'; ripple; // keep\nimport Space from '../space';\n\nimport PasswordMonkeyTsx from './passwordMonkeyTsx';\nimport SimplePopup from './simplePopup';\nimport Background from './background';\n\nimport styles from './passcodeLockScreen.module.scss';\nimport {ChatBackground} from '../chat/bubbles/chatBackground';\n\n\ntype StateStore = {\n  isMonkeyHidden: boolean;\n  isError: boolean;\n  tooManyAttempts: boolean;\n  passcode: string;\n  isLogoutPopupOpen: boolean;\n  gradientRenderer?: ChatBackgroundGradientRenderer;\n};\n\n\nconst MAX_ATTEMPTS = 5;\nconst MAX_ATTEMPTS_TIMEOUT_SEC = 60;\n\n\nconst PasscodeLockScreen: Component<{\n  onUnlock: () => void;\n  fromLockIcon?: HTMLElement;\n  onAnimationEnd?: () => void;\n}> = (props) => {\n  let container: HTMLDivElement;\n  let passwordInputField: PasswordInputField;\n  let passwordMonkeyContainer: HTMLDivElement;\n\n  let attempts = 0;\n\n  const {isMyPasscode, unlockWithPasscode} = usePasscodeActions();\n  const {InputFieldTsx, PasswordInputField, apiManagerProxy} = useLockScreenHotReloadGuard();\n\n  const store = createMutable<StateStore>({\n    isMonkeyHidden: !!props.fromLockIcon,\n    isError: false,\n    tooManyAttempts: false,\n    passcode: '',\n    isLogoutPopupOpen: false\n  });\n\n  const [totalAccounts] = createResource(() => AccountController.getUnencryptedTotalAccounts());\n\n  onMount(() => {\n    attempts = 0;\n\n    const lockIcon = props.fromLockIcon;\n    if(lockIcon) (async() => {\n      const lockIconRect = lockIcon.getBoundingClientRect();\n      const rect = passwordMonkeyContainer.getBoundingClientRect();\n\n      lockIcon.style.setProperty('--x', (rect.left + (rect.width / 2)) + 'px');\n      lockIcon.style.setProperty('--y', (rect.top + (rect.height / 2)) + 'px');\n      lockIcon.style.setProperty('--scale', (rect.width / lockIconRect.width) + '');\n      lockIcon.classList.add('passcode-lock-screen__animated-lock-icon--shift-body')\n\n      await pause(500);\n\n      lockIcon.classList.add('passcode-lock-screen__animated-lock-icon--disappear')\n      store.isMonkeyHidden = false;\n\n      await pause(400);\n      lockIcon.remove();\n      props.onAnimationEnd?.();\n    })();\n\n    const listener = (e: KeyboardEvent) => {\n      if(document.activeElement && document.activeElement.tagName === 'INPUT') return;\n      focusInput(passwordInputField.input, e);\n    };\n    document.addEventListener('keydown', listener);\n    onCleanup(() => {\n      document.removeEventListener('keydown', listener);\n    });\n  });\n\n  let cancelAnimation: () => void;\n\n  function rotateBackgroundGradient() {\n    cancelAnimation?.();\n\n    if(store.gradientRenderer) {\n      let progress = 0;\n      cancelAnimation = animateValue(0, 1, 200, (p) => progress = p);\n      store.gradientRenderer.toNextPosition(() => progress);\n    }\n  }\n\n  const rotateBackgroundGradientThrottled = throttle(rotateBackgroundGradient, 100, true);\n\n  createEffect(on(() => store.passcode, () => {\n    rotateBackgroundGradientThrottled();\n\n    store.isError = false;\n    store.tooManyAttempts = false;\n  }));\n\n  onCleanup(() => {\n    store.passcode = '';\n    (passwordInputField.input as HTMLInputElement).value = '';\n  });\n\n  const canSubmit = () => !!store.passcode && store.passcode.length <= MAX_PASSCODE_LENGTH;\n\n  const canAttempt = async() => {\n    const settings = structuredClone(await commonStateStorage.get('settings', false));\n    const canAttemptAgainOn = settings?.passcode?.canAttemptAgainOn;\n    if(!canAttemptAgainOn) return true;\n\n    if(canAttemptAgainOn > Date.now()) return false;\n\n    store.tooManyAttempts = false;\n    attempts = 0;\n    settings.passcode.canAttemptAgainOn = null;\n    commonStateStorage.set({settings});\n    return true;\n  };\n\n  let isSubmiting = false;\n  const onSubmit = async(e?: Event) => {\n    e?.preventDefault();\n    if(isSubmiting) return;\n\n    isSubmiting = true;\n\n    try {\n      if(!(await canAttempt())) {\n        store.tooManyAttempts = true;\n      } else if(canSubmit() && await isMyPasscode(store.passcode)) {\n        await unlockWithPasscode(store.passcode);\n        props.onUnlock();\n      } else {\n        attempts ++;\n        store.isError = true;\n        if(attempts > MAX_ATTEMPTS) {\n          store.tooManyAttempts = true;\n          const settings = structuredClone(await commonStateStorage.get('settings', false));\n          settings.passcode.canAttemptAgainOn = Date.now() + MAX_ATTEMPTS_TIMEOUT_SEC * 1000;\n          await commonStateStorage.set({settings});\n        }\n      }\n    } catch{\n      store.isError = true;\n    } finally {\n      isSubmiting = false;\n    }\n  };\n\n  const input = (\n    <InputFieldTsx\n      InputFieldClass={PasswordInputField}\n      instanceRef={(value) => void (passwordInputField = value)}\n      class={styles.Input}\n      value={store.passcode}\n      onRawInput={(value) => void (store.passcode = value)}\n      label=\"PasscodeLock.EnterYourPasscode\"\n      errorLabel={\n        store.tooManyAttempts ?\n          'PasscodeLock.TooManyAttempts' :\n          store.isError ?\n            'PasscodeLock.WrongPasscode' :\n            undefined\n      }\n      maxLength={MAX_PASSCODE_LENGTH}\n    />\n  );\n\n\n  return (\n    <div ref={container} class={styles.Container}>\n      <Background gradientRendererRef={(value) => void(store.gradientRenderer = value)} />\n      <div class={styles.Card}>\n        <PasswordMonkeyTsx\n          hidden={store.isMonkeyHidden}\n          ref={passwordMonkeyContainer}\n          passwordInputField={passwordInputField}\n        />\n        <Space amount=\"1.125rem\" />\n        <form action=\"\" onSubmit={onSubmit}>\n          {input}\n          <Space amount=\"1rem\" />\n          <button\n            type='button'\n            onMouseDown={() => {\n              onSubmit();\n            }}\n            class={`btn-primary btn-color-primary btn-large ${styles.SubmitButton}`}\n            disabled={!store.passcode}\n          >\n            {i18n('PasscodeLock.Proceed')}\n          </button>\n          <button hidden style={{visibility: 'hidden', height: '0', width: '0'}} type='submit' />\n        </form>\n        <Space amount=\"1.625rem\" />\n        <div class={styles.Description}>\n          {\n            i18n(\n              totalAccounts() > 1 ? // Gonna be `false` when undefined\n                'PasscodeLock.ForgotPasscode.MultipleAccounts' :\n                'PasscodeLock.ForgotPasscode.OneAccount',\n              [\n                <button\n                  class={styles.LogoutButton}\n                  onClick={() => {\n                    store.isLogoutPopupOpen = true;\n                  }}\n                /> as HTMLButtonElement\n              ]\n            )\n          }\n        </div>\n      </div>\n\n      <SimplePopup\n        visible={store.isLogoutPopupOpen}\n        title={i18n('LogOut')}\n        description={i18n('PasscodeLock.LogoutPopup.Description')}\n        confirmButtonContent={i18n('LogOut')}\n        onConfirm={() => {\n          apiManagerProxy.invokeVoid('forceLogout', undefined);\n          // store.isLogoutPopupOpen = false\n        }}\n        onClose={() => void(store.isLogoutPopupOpen = false)}\n      />\n    </div>\n  );\n};\n\nexport default PasscodeLockScreen;\n"],"names":["PasswordMonkeyTsx","inProps","props","mergeProps","size","PasswordMonkey","useLockScreenHotReloadGuard","monkey","setMonkey","createSignal","monkeyLoaded","setMonkeyLoaded","createRenderEffect","passwordInputField","load","then","onCleanup","remove","_el$","_tmpl$2","_ref$","ref","_$use","_$insert","container","_$createComponent","Show","when","children","_el$2","_tmpl$","_$effect","_$className","styles","MonkeyImage","_p$","_v$","_v$2","hidden","_v$3","e","t","_$classList","a","style","setProperty","removeProperty","undefined","SimplePopup","onMount","listener","key","onClose","document","addEventListener","removeEventListener","Portal","Transition","onEnter","el","done","pause","classList","add","onExit","_$memo","visible","firstChild","_el$3","_el$4","_el$5","nextSibling","_el$6","_el$7","_el$8","$$click","target","currentTarget","title","description","_$addEventListener","onConfirm","ripple","confirmButtonContent","i18n","Popup","_$delegateEvents","Background","themeController","rootScope","screenSize","useScreenSize","ScreenSize","mobile","ChatBackground","managers","gradientRendererRef","MAX_ATTEMPTS","MAX_ATTEMPTS_TIMEOUT_SEC","PasscodeLockScreen","passwordMonkeyContainer","attempts","isMyPasscode","unlockWithPasscode","usePasscodeActions","InputFieldTsx","PasswordInputField","apiManagerProxy","store","createMutable","isMonkeyHidden","fromLockIcon","isError","tooManyAttempts","passcode","isLogoutPopupOpen","totalAccounts","createResource","AccountController","getUnencryptedTotalAccounts","lockIcon","lockIconRect","getBoundingClientRect","rect","left","width","top","height","onAnimationEnd","activeElement","tagName","focusInput","input","cancelAnimation","rotateBackgroundGradient","gradientRenderer","progress","animateValue","p","toNextPosition","rotateBackgroundGradientThrottled","throttle","createEffect","on","value","canSubmit","length","MAX_PASSCODE_LENGTH","canAttempt","settings","structuredClone","commonStateStorage","get","canAttemptAgainOn","Date","now","set","isSubmiting","onSubmit","preventDefault","onUnlock","InputFieldClass","instanceRef","Input","onRawInput","label","errorLabel","maxLength","r$","_ref$2","Space","amount","$$mousedown","LogoutButton","invokeVoid","Container","Card","SubmitButton","_v$4","_v$5","Description","o","disabled","i"],"mappings":"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"}