{"version":3,"file":"enterPasswordTab-CgbKNu7-.js","sources":["../src/components/sidebarLeft/tabs/passcodeLock/enterPasswordTab.tsx"],"sourcesContent":["import {createEffect, createSignal, onCleanup} from 'solid-js';\nimport {keepMe} from '@helpers/keepMe';\nimport {i18n} from '@lib/langPack';\nimport {usePasscodeActions} from '@lib/passcode/actions';\nimport {MAX_PASSCODE_LENGTH} from '@lib/passcode/constants';\nimport SettingsTabLottieAnimation from '@components/settingsTabLottieAnimation';\nimport {InputFieldTsx} from '@components/inputFieldTsx';\nimport PasswordInputField from '@components/passwordInputField';\nimport ripple from '@components/ripple';\nimport Section from '@components/section';\nimport type {AppPasscodeEnterPasswordTab} from '@components/solidJsTabs';\nimport {useSuperTab} from '@components/solidJsTabs/superTabProvider';\nimport Space from '@components/space';\nimport commonStyles from '@components/sidebarLeft/tabs/passcodeLock/common.module.scss';\n\nkeepMe(ripple);\n\n\ntype AppPasscodeEnterPasswordTabClass = typeof AppPasscodeEnterPasswordTab;\n\nconst EnterPasswordTab = () => {\n  const [tab] = useSuperTab<AppPasscodeEnterPasswordTabClass>();\n  const actions = usePasscodeActions();\n\n  let inputField: PasswordInputField;\n\n  const [value, setValue] = createSignal('');\n  const [isError, setIsError] = createSignal(false);\n\n  createEffect(() => {\n    value();\n    setIsError(false);\n  });\n\n  setTimeout(() => {\n    inputField.input.focus();\n  }, 400); // Smaller timeout will make the tab animation jerky\n\n  onCleanup(() => {\n    // Just in case\n    setValue('');\n    (inputField.input as HTMLInputElement).value = '';\n  });\n\n  const canSubmit = () => value() && value().length <= MAX_PASSCODE_LENGTH;\n\n  let isSubmitting = false;\n  async function onSubmit(e: Event) {\n    e.preventDefault();\n\n    if(!canSubmit() || isSubmitting) return;\n    isSubmitting = true;\n\n    try {\n      await tab.payload.onSubmit(value(), tab, actions);\n    } catch{\n      setIsError(true);\n    } finally {\n      isSubmitting = false;\n    }\n  }\n\n  return (\n    <Section caption=\"PasscodeLock.Notice\">\n      <SettingsTabLottieAnimation name=\"UtyanPasscode\" />\n\n      <Space amount=\"1.125rem\" />\n\n      <form\n        action=\"\"\n        autocomplete=\"off\"\n        onSubmit={onSubmit}\n      >\n        <div class={commonStyles.AdditionalPadding}>\n          <InputFieldTsx\n            InputFieldClass={PasswordInputField}\n            instanceRef={(ref) => void (inputField = ref)}\n            maxLength={MAX_PASSCODE_LENGTH}\n            autocomplete=\"off\"\n            value={value()}\n            errorLabel={isError() ? 'PasscodeLock.PasscodesDontMatch' : undefined}\n            label={tab.payload.inputLabel}\n            onRawInput={setValue}\n          />\n        </div>\n\n        <Space amount=\"1rem\" />\n\n        <div class={commonStyles.AdditionalPadding}>\n          <button\n            use:ripple\n            type=\"submit\"\n            class=\"btn-primary btn-color-primary btn-large\"\n            disabled={!canSubmit()}\n          >\n            {i18n(tab.payload.buttonText)}\n          </button>\n        </div>\n      </form>\n\n      <Space amount=\"1rem\" />\n    </Section>\n  );\n};\n\nexport default EnterPasswordTab;\n"],"names":["EnterPasswordTab","tab","useSuperTab","actions","usePasscodeActions","inputField","value","setValue","createSignal","isError","setIsError","createEffect","setTimeout","input","focus","onCleanup","canSubmit","length","MAX_PASSCODE_LENGTH","isSubmitting","onSubmit","e","preventDefault","payload","_$createComponent","Section","caption","children","SettingsTabLottieAnimation","name","Space","amount","_el$","_tmpl$","_el$2","firstChild","_el$3","nextSibling","_el$4","addEventListener","_$insert","InputFieldTsx","InputFieldClass","PasswordInputField","instanceRef","ref","maxLength","autocomplete","errorLabel","undefined","label","inputLabel","onRawInput","_$use","ripple","i18n","buttonText","_$effect","_p$","_v$","commonStyles","AdditionalPadding","_v$2","_v$3","_$className","disabled"],"mappings":"shCAoBMA,GAAmBA,IAAM,CAC7B,KAAM,CAACC,CAAG,EAAIC,IACRC,EAAUC,IAEhB,IAAIC,EAEJ,KAAM,CAACC,EAAOC,CAAQ,EAAIC,EAAa,EAAE,EACnC,CAACC,EAASC,CAAU,EAAIF,EAAa,EAAK,EAEhDG,EAAa,IAAM,CACjBL,IACAI,EAAW,EAAK,CAClB,CAAC,EAEDE,WAAW,IAAM,CACfP,EAAWQ,MAAMC,OAClB,EAAE,GAAG,EAENC,EAAU,IAAM,CAEdR,EAAS,EAAE,EACVF,EAAWQ,MAA2BP,MAAQ,EACjD,CAAC,EAED,MAAMU,EAAYA,IAAMV,EAAK,GAAMA,EAAO,EAACW,QAAUC,EAErD,IAAIC,EAAe,GACnB,eAAeC,EAASC,EAAU,CAGhC,GAFAA,EAAEC,eAAc,EAEb,GAACN,KAAeG,GACnBA,CAAAA,EAAe,GAEf,GAAI,CACF,MAAMlB,EAAIsB,QAAQH,SAASd,EAAK,EAAIL,EAAKE,CAAO,CAClD,MAAO,CACLO,EAAW,EAAI,CACjB,QAAU,CACRS,EAAe,EACjB,EACF,CAEA,OAAAK,EACGC,EAAO,CAACC,QAAO,sBAAA,IAAAC,UAAA,CAAA,MAAAH,CAAAA,EACbI,EAA0B,CAACC,KAAI,gBAAAL,EAAAA,EAE/BM,EAAK,CAACC,OAAM,UAAA,CAAA,GAAA,IAAA,CAAA,MAAAC,EAAAC,EAAA,EAAAC,EAAAF,EAAAG,WAAAC,EAAAF,EAAAG,YAAAC,EAAAF,EAAAD,WAAAH,OAAAA,EAAAO,iBAAA,SAKDnB,CAAQ,EAAAoB,EAAAN,EAAAV,EAGfiB,EAAa,CACZC,gBAAiBC,EACjBC,YAAcC,GAAQ,KAAMxC,EAAawC,GACzCC,UAAW5B,EACX6B,aAAY,MAAA,IACZzC,OAAK,CAAA,OAAEA,EAAK,CAAE,EAAA,IACd0C,YAAU,CAAA,OAAEvC,EAAO,EAAK,kCAAoCwC,MAAS,EAAA,IACrEC,OAAK,CAAA,OAAEjD,EAAIsB,QAAQ4B,UAAU,EAC7BC,WAAY7C,CAAQ,CAAA,CAAA,EAAAiC,EAAAR,EAAAR,EAIvBM,EAAK,CAACC,OAAM,MAAA,CAAA,EAAAK,CAAA,EAAAiB,EAILC,EAAMhB,EAAA,IAAA,EAAA,EAAAE,EAAAF,EAAA,IAKTiB,EAAKtD,EAAIsB,QAAQiC,UAAU,CAAC,EAAAC,EAAAC,GAAA,CAAA,MAAAC,EAtBrBC,EAAaC,kBAAiBC,EAe9BF,EAAaC,kBAAiBE,EAK5B,CAAC/C,IAAW2C,OAAAA,IAAAD,EAAAC,KAAAK,EAAA9B,EAAAwB,EAAAC,IAAAA,CAAA,EAAAG,IAAAJ,EAAAI,MAAAE,EAAA5B,EAAAsB,EAAAI,KAAAA,CAAA,EAAAC,IAAAL,EAAAK,OAAAzB,EAAA2B,SAAAP,EAAAK,KAAAA,GAAAL,CAAA,EAAA,CAAAC,IAAAV,OAAAa,KAAAb,OAAAc,KAAAd,MAAA,CAAA,EAAAjB,IAAAR,EAAAA,EAO3BM,EAAK,CAACC,OAAM,MAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAGnB"}