{"version":3,"sources":["webpack:///./src/pages/pageIm.ts"],"names":["page","pushToState","_","then","m","default","dispatchEvent","requestedServerLanguage","getCacheLangPack","langPack","local","getLangPack","lang_code","Promise","resolve","window","requestAnimationFrame","finally"],"mappings":"wFAAA,iD,sSAyFA,MAAMA,EAAO,IAAI,IAAK,cAAc,EA7EjB,KAEjB,UAAgBC,YAAY,YAAa,CAACC,EAAG,sBAI7C,wCAA2BC,KAAKC,IAC9BA,EAAEC,QAAQC,cAAc,cAGtB,UAAKC,yBACP,UAAKC,mBAAmBL,KAAKM,IACxBA,EAASC,OACV,UAAKC,YAAYF,EAASG,aAKhC,cACO,cAAYT,KAAK,IACf,IAAIU,QAAeC,IACxBC,OAAOC,sBAAsB,KAET,mEACRC,QAAQ,IAAW,OAAD,6BAExBH,eAoDG","file":"28.a362089452745dd019a7.chunk.js","sourcesContent":["/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport blurActiveElement from \"../helpers/dom/blurActiveElement\";\r\nimport loadFonts from \"../helpers/dom/loadFonts\";\r\nimport appStateManager from \"../lib/appManagers/appStateManager\";\r\nimport I18n from \"../lib/langPack\";\r\nimport Page from \"./page\";\r\n\r\nlet onFirstMount = () => {\r\n  //return;\r\n  appStateManager.pushToState('authState', {_: 'authStateSignedIn'});\r\n  // ! TOO SLOW\r\n  /* appStateManager.saveState(); */\r\n\r\n  import('../lib/rootScope').then(m => {\r\n    m.default.dispatchEvent('im_mount');\r\n  });\r\n\r\n  if(!I18n.requestedServerLanguage) {\r\n    I18n.getCacheLangPack().then(langPack => {\r\n      if(langPack.local) {\r\n        I18n.getLangPack(langPack.lang_code);\r\n      }\r\n    });\r\n  }\r\n\r\n  blurActiveElement();\r\n  return loadFonts().then(() => {\r\n    return new Promise<void>((resolve) => {\r\n      window.requestAnimationFrame(() => {\r\n        // setTimeout(() => {\r\n          const promise = import('../lib/appManagers/appDialogsManager');\r\n          promise.finally(async() => {\r\n            //alert('pageIm!');\r\n            resolve();\r\n        \r\n            //AudioContext && global.navigator && global.navigator.mediaDevices && global.navigator.mediaDevices.getUserMedia && global.WebAssembly;\r\n        \r\n            /* // @ts-ignore\r\n            var AudioContext = globalThis.AudioContext || globalThis.webkitAudioContext;\r\n            alert('AudioContext:' + typeof(AudioContext));\r\n            // @ts-ignore\r\n            alert('global.navigator:' + typeof(navigator));\r\n            alert('navigator.mediaDevices:' + typeof(navigator.mediaDevices));\r\n            alert('navigator.mediaDevices.getUserMedia:' + typeof(navigator.mediaDevices?.getUserMedia));\r\n            alert('global.WebAssembly:' + typeof(WebAssembly)); */\r\n        \r\n            //(Array.from(document.getElementsByClassName('rp')) as HTMLElement[]).forEach(el => ripple(el));\r\n          });\r\n        // }, 5e3);\r\n      });\r\n    })\r\n  });\r\n\r\n  //let promise = /* Promise.resolve() */.then(() => {//import('../lib/services').then(services => {\r\n    /* fetch('assets/img/camomile.jpg')\r\n    .then(res => res.blob())\r\n    .then(blob => {\r\n      let img = new Image();\r\n      let url = URL.createObjectURL(blob);\r\n      img.src = url;\r\n      img.onload = () => {\r\n        let id = 'chat-background-canvas';\r\n        var canvas  = document.getElementById(id) as HTMLCanvasElement;\r\n        //URL.revokeObjectURL(url);\r\n  \r\n        let elements = ['.chat-container'].map(selector => {\r\n          return document.querySelector(selector) as HTMLDivElement;\r\n        });\r\n  \r\n        stackBlurImage(img, id, 15, 0);\r\n  \r\n        canvas.toBlob(blob => {\r\n          //let dataUrl = canvas.toDataURL('image/jpeg', 1);\r\n          let dataUrl = URL.createObjectURL(blob);\r\n  \r\n          elements.forEach(el => {\r\n            el.style.backgroundImage = 'url(' + dataUrl + ')';\r\n          });\r\n        }, 'image/jpeg', 1);\r\n      };\r\n    }); */\r\n  //});\r\n};\r\n\r\nconst page = new Page('page-chats', false, onFirstMount);\r\nexport default page;\r\n"],"sourceRoot":""}