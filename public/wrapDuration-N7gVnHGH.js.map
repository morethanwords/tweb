{"version":3,"file":"wrapDuration-N7gVnHGH.js","sources":["../src/helpers/dom/anchorCallback.ts","../src/helpers/formatDuration.ts","../src/helpers/string/toHHMMSS.ts","../src/components/wrappers/wrapDuration.ts"],"sourcesContent":["import cancelEvent from '@helpers/dom/cancelEvent';\n\nexport default function anchorCallback(callback: (e: MouseEvent) => any, _cancelEvent = true) {\n  const a = document.createElement('a');\n  a.href = '#';\n  a.onclick = (e) => {\n    _cancelEvent && cancelEvent(e);\n    callback(e);\n  };\n  return a;\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nexport enum DurationType {\n  Seconds,\n  Minutes,\n  Hours,\n  Days,\n  Weeks,\n  Months,\n  Years\n}\n\nexport default function formatDuration(duration: number, showLast = 2) {\n  if(!duration) {\n    duration = 1;\n  }\n\n  const d: {duration: number, type: DurationType}[] = [];\n  const p = [\n    {m: 1, t: DurationType.Seconds},\n    {m: 60, t: DurationType.Minutes},\n    {m: 60, t: DurationType.Hours},\n    {m: 24, t: DurationType.Days},\n    {m: 7, t: DurationType.Weeks}\n  ] as Array<{m?: number, t: DurationType}>\n  const s = 1;\n  let t = s;\n  p.forEach((o, idx) => {\n    t = Math.round(t * o.m);\n\n    if(duration < t) {\n      return;\n    }\n\n    let dd = duration / t;\n    if(idx !== (p.length - 1)) {\n      const modulus = p[idx === (p.length - 1) ? idx : idx + 1].m;\n      dd %= modulus;\n    }\n\n    d.push({\n      duration: dd | 0,\n      type: o.t\n    });\n  });\n\n  const out = d.slice(-showLast).reverse();\n  for(let i = out.length - 1; i >= 0; --i) {\n    if(out[i].duration === 0) {\n      out.splice(i, 1);\n    }\n  }\n\n  return out;\n}\n","export default function toHHMMSS(str: string | number, leadZero = false) {\n  const sec_num = parseInt(str + '', 10);\n  let hours: any = Math.floor(sec_num / 3600);\n  let minutes: any = Math.floor((sec_num - (hours * 3600)) / 60);\n  let seconds: any = sec_num - (hours * 3600) - (minutes * 60);\n\n  if(hours && hours < 10 && leadZero) hours = '0' + hours;\n  if(minutes < 10 && (hours || leadZero)) minutes ='0' + minutes;\n  if(seconds < 10) seconds = '0' + seconds;\n  return (hours ? hours + ':' : '') + minutes + ':' + seconds;\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport I18n, {LangPackKey, i18n, join} from '@lib/langPack';\nimport formatDuration, {DurationType} from '@helpers/formatDuration';\nimport toHHMMSS from '@helpers/string/toHHMMSS';\n\nexport const DURATION_LANG_KEYS: {[type in DurationType]: LangPackKey} = {\n  [DurationType.Seconds]: 'Seconds',\n  [DurationType.Minutes]: 'Minutes',\n  [DurationType.Hours]: 'Hours',\n  [DurationType.Days]: 'Days',\n  [DurationType.Weeks]: 'Weeks',\n  [DurationType.Months]: 'Months',\n  [DurationType.Years]: 'Years'\n};\n\nexport function wrapFormattedDuration(formatted: ReturnType<typeof formatDuration>, plain: true): string;\nexport function wrapFormattedDuration(formatted: ReturnType<typeof formatDuration>, plain?: false): HTMLSpanElement;\nexport function wrapFormattedDuration(formatted: ReturnType<typeof formatDuration>, plain?: boolean): string | HTMLSpanElement;\n\nexport function wrapFormattedDuration(formatted: ReturnType<typeof formatDuration>, plain?: boolean): string | HTMLSpanElement {\n  if(plain) {\n    const strings = formatted.map((d) => I18n.format(DURATION_LANG_KEYS[d.type], true, [d.duration]));\n    return join(strings, false, plain);\n  }\n\n  const elements = formatted.map((d) => i18n(DURATION_LANG_KEYS[d.type], [d.duration]));\n\n  const fragment = document.createElement('span');\n  fragment.append(...join(elements, false));\n\n  return fragment;\n}\n\nexport function wrapCallDuration(duration: number, plain?: boolean) {\n  return wrapFormattedDuration(formatDuration(duration, 2), plain);\n}\n\nexport function wrapLeftDuration(timeLeft: number) {\n  const formatted = formatDuration(timeLeft, 3);\n  if(formatted[0].type <= DurationType.Hours) {\n    return toHHMMSS(timeLeft, true);\n  } else {\n    formatted.splice(1, Infinity);\n    return wrapFormattedDuration(formatted);\n  }\n}\n\nexport function wrapSlowModeLeftDuration(timeLeft: number) {\n  const formatted = formatDuration(timeLeft, 3);\n  if(formatted[0].type === DurationType.Seconds) {\n    return wrapFormattedDuration(formatted);\n  } else {\n    return toHHMMSS(timeLeft, true);\n  }\n}\n"],"names":["anchorCallback","callback","_cancelEvent","a","e","cancelEvent","DurationType","DurationType2","formatDuration","duration","showLast","d","p","t","o","idx","dd","modulus","out","i","toHHMMSS","str","leadZero","sec_num","hours","minutes","seconds","DURATION_LANG_KEYS","wrapFormattedDuration","formatted","plain","strings","I18n","join","elements","i18n","fragment","wrapCallDuration","wrapLeftDuration","timeLeft","wrapSlowModeLeftDuration"],"mappings":"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"}