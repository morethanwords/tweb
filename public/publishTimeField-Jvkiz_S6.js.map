{"version":3,"file":"publishTimeField-Jvkiz_S6.js","sources":["../src/components/chat/suggestPostPopup/popupSchedulePost.ts","../src/components/chat/suggestPostPopup/publishTimeField.tsx"],"sourcesContent":["import {formatTime} from '@helpers/date';\nimport {i18n} from '@lib/langPack';\nimport PopupSchedule from '@components/popups/schedule';\nimport styles from '@components/chat/suggestPostPopup/styles.module.scss';\n\n\nconst MILLIS_IN_MINUTE = 60 * 1000;\n\ntype Args = {\n  minTimeDate: Date;\n} & ConstructorParameters<typeof PopupSchedule>[0];\n\nexport default class PopupSchedulePost extends PopupSchedule {\n  protected caption: HTMLElement;\n  protected minTimeDate: Date;\n\n  constructor(args: Args) {\n    const {minTimeDate, ...rest} = args;\n\n    super(rest);\n\n    this.minTimeDate = minTimeDate;\n\n    this.caption = document.createElement('div');\n    this.caption.classList.add(styles.Caption, styles.center);\n    this.caption.append(i18n('SuggestedPosts.PublishingTime.MinSendTime', [formatTime(minTimeDate)]));\n\n    this.timeDiv.after(this.caption);\n  }\n\n  public setTimeTitle() {\n    super.setTimeTitle();\n\n    if(!this.caption || !this.minTimeDate) return;\n\n    const sendDate = new Date(this.selectedDate.getTime());\n    sendDate.setHours(+this.hoursInputField.value, +this.minutesInputField.value);\n\n    const disabled = sendDate < new Date() || (sendDate.valueOf() / MILLIS_IN_MINUTE | 0) < (this.minTimeDate.valueOf() / MILLIS_IN_MINUTE | 0);\n\n    this.btnConfirm.toggleAttribute('disabled', disabled);\n\n    const isCaptionVisible = sendDate.getDate() === this.minTimeDate.getDate();\n    this.caption.classList.toggle('hide', !isCaptionVisible);\n  }\n}\n","import {formatFullSentTime} from '@helpers/date';\nimport {I18nTsx} from '@helpers/solid/i18n';\nimport {LangPackKey} from '@lib/langPack';\nimport {ButtonIconTsx} from '@components/buttonIconTsx';\nimport {IconTsx} from '@components/iconTsx';\nimport SimpleFormField from '@components/simpleFormField';\nimport styles from '@components/chat/suggestPostPopup/commonStyles.module.scss';\nimport PopupSchedulePost from '@components/chat/suggestPostPopup/popupSchedulePost';\n\n\ntype Props = {\n  value: number;\n  onChange: (value: number | undefined) => void;\n  noTimeLangKey: LangPackKey;\n};\n\nconst PUBLISH_MIN_DELAY_MINUTES = 10;\n\nconst PublishTimeField = (props: Props) => {\n  const onContainerClick = () => {\n    const minTimeDate = new Date();\n    minTimeDate.setMinutes(minTimeDate.getMinutes() + PUBLISH_MIN_DELAY_MINUTES);\n\n    const minDate = new Date(minTimeDate);\n    minDate.setHours(0, 0, 0, 0);\n\n    new PopupSchedulePost({\n      initDate: new Date(minTimeDate),\n      minDate,\n      minTimeDate,\n      onPick: (timestamp) => {\n        console.log(timestamp);\n        props.onChange(timestamp);\n      }\n    }).show();\n  };\n\n  const onCrossClick = (event: MouseEvent) => {\n    event.stopPropagation();\n    props.onChange(undefined);\n  };\n\n  return (\n    <SimpleFormField\n      clickable\n      withEndButtonIcon={!!props.value}\n      onClick={onContainerClick}\n    >\n      <SimpleFormField.InputStub>\n        {props.value ?\n          <span>{formatFullSentTime(props.value)}</span> :\n          <I18nTsx key={props.noTimeLangKey} />\n        }\n      </SimpleFormField.InputStub>\n      <SimpleFormField.Label active>\n        <I18nTsx key='SuggestedPosts.PublishingTime.Label' />\n      </SimpleFormField.Label>\n      <SimpleFormField.SideContent last>\n        {props.value ?\n          <ButtonIconTsx icon='cross' tabIndex={-1} onClick={onCrossClick} /> :\n          <IconTsx class={styles.Icon} icon='down' />\n        }\n      </SimpleFormField.SideContent>\n    </SimpleFormField>\n  )\n};\n\nexport default PublishTimeField;\n"],"names":["MILLIS_IN_MINUTE","PopupSchedulePost","PopupSchedule","args","minTimeDate","rest","styles","i18n","formatTime","sendDate","disabled","isCaptionVisible","PUBLISH_MIN_DELAY_MINUTES","PublishTimeField","props","onContainerClick","Date","setMinutes","getMinutes","minDate","setHours","initDate","onPick","timestamp","console","log","onChange","show","onCrossClick","event","stopPropagation","undefined","_$createComponent","SimpleFormField","clickable","withEndButtonIcon","value","onClick","children","InputStub","_$memo","_el$","_tmpl$","_$insert","formatFullSentTime","I18nTsx","key","noTimeLangKey","Label","active","SideContent","last","ButtonIconTsx","icon","tabIndex","IconTsx","Icon"],"mappings":"uZAMMA,EAAmB,GAAK,IAM9B,MAAqBC,UAA0BC,CAAc,CAI3D,YAAYC,EAAY,CACtB,KAAM,CAAC,YAAAC,EAAa,GAAGC,CAAA,EAAQF,EAE/B,MAAME,CAAI,EAEV,KAAK,YAAcD,EAEd,KAAA,QAAU,SAAS,cAAc,KAAK,EAC3C,KAAK,QAAQ,UAAU,IAAIE,EAAO,QAASA,EAAO,MAAM,EACnD,KAAA,QAAQ,OAAOC,EAAK,4CAA6C,CAACC,EAAWJ,CAAW,CAAC,CAAC,CAAC,EAE3F,KAAA,QAAQ,MAAM,KAAK,OAAO,CACjC,CAEO,cAAe,CAGpB,GAFA,MAAM,aAAa,EAEhB,CAAC,KAAK,SAAW,CAAC,KAAK,YAAa,OAEvC,MAAMK,EAAW,IAAI,KAAK,KAAK,aAAa,SAAS,EAC5CA,EAAA,SAAS,CAAC,KAAK,gBAAgB,MAAO,CAAC,KAAK,kBAAkB,KAAK,EAE5E,MAAMC,EAAWD,EAAe,IAAA,OAAWA,EAAS,QAAY,EAAAT,EAAmB,IAAM,KAAK,YAAY,QAAA,EAAYA,EAAmB,GAEpI,KAAA,WAAW,gBAAgB,WAAYU,CAAQ,EAEpD,MAAMC,EAAmBF,EAAS,QAAA,IAAc,KAAK,YAAY,UACjE,KAAK,QAAQ,UAAU,OAAO,OAAQ,CAACE,CAAgB,CACzD,CACF,qBC7BMC,EAA4B,GAE5BC,EAAoBC,GAAiB,CACzC,MAAMC,EAAmBA,IAAM,CAC7B,MAAMX,EAAc,IAAIY,KACxBZ,EAAYa,WAAWb,EAAYc,WAAY,EAAGN,CAAyB,EAE3E,MAAMO,EAAU,IAAIH,KAAKZ,CAAW,EACpCe,EAAQC,SAAS,EAAG,EAAG,EAAG,CAAC,EAE3B,IAAInB,EAAkB,CACpBoB,SAAU,IAAIL,KAAKZ,CAAW,EAC9Be,QAAAA,EACAf,YAAAA,EACAkB,OAASC,GAAc,CACrBC,QAAQC,IAAIF,CAAS,EACrBT,EAAMY,SAASH,CAAS,CAC1B,CACF,CAAC,EAAEI,KAAI,GAGHC,EAAgBC,GAAsB,CAC1CA,EAAMC,gBAAe,EACrBhB,EAAMY,SAASK,MAAS,GAG1B,OAAAC,EACGC,EAAe,CACdC,UAAS,GAAA,IACTC,mBAAiB,CAAA,MAAE,CAAC,CAACrB,EAAMsB,KAAK,EAChCC,QAAStB,EAAgB,IAAAuB,UAAA,CAAA,MAAA,CAAAN,EAExBC,EAAgBM,UAAS,CAAA,IAAAD,UAAA,CAAA,OACvBE,EAAA,IAAA,CAAA,CAAA1B,EAAMsB,KAAK,EAAA,GAAA,IAAA,CAAA,MAAAK,EAAAC,IAAAC,OAAAA,EAAAF,EACHG,IAAAA,EAAmB9B,EAAMsB,KAAK,CAAC,EAAAK,IAAAT,EAAAA,EACrCa,EAAO,CAAA,IAACC,KAAG,CAAA,OAAEhC,EAAMiC,aAAa,EAAI,CAAA,CAAA,CAAA,EAAAf,EAGxCC,EAAgBe,MAAK,CAACC,OAAM,GAAA,IAAAX,UAAA,CAAA,OAAAN,EAC1Ba,EAAO,CAACC,IAAG,qCAAA,CAAA,CAAA,CAAA,CAAA,EAAAd,EAEbC,EAAgBiB,YAAW,CAACC,KAAI,GAAA,IAAAb,UAAA,CAAA,OAC9BE,QAAA1B,EAAMsB,KAAK,EAAAJ,EAAAA,EACToB,EAAa,CAACC,KAAI,QAASC,SAAU,GAAIjB,QAAST,EAAYI,EAAAA,EAC9DuB,EAAO,CAAA,IAAA,OAAA,CAAA,OAAQjD,EAAOkD,IAAI,EAAEH,KAAI,OAAU,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAKrD"}