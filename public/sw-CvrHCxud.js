const nt={test:location.search.indexOf("test=1")>0,debug:location.search.indexOf("debug=1")>0,http:!1,ssl:!0,asServiceWorker:!1,transport:"websocket",noSharedWorker:location.search.indexOf("noSharedWorker=1")>0,multipleTransports:!0};(nt.http=location.search.indexOf("http=1")>0)&&(nt.multipleTransports=!1);nt.multipleTransports&&(nt.http=!0);nt.http&&(nt.transport="https");const we=nt.debug,As=typeof window<"u"?window:self,At=As,lt=typeof window<"u"?window:self,Jt=navigator?navigator.userAgent:null;navigator.userAgent.search(/OS X|iPhone|iPad|iOS/i);navigator.userAgent.toLowerCase().indexOf("android");(()=>{try{return+navigator.userAgent.match(/Chrom(?:e|ium)\/(.+?)(?:\s|\.)/)[1]}catch{}})();const ct="safari"in lt||!!(Jt&&(/\b(iPad|iPhone|iPod)\b/.test(Jt)||Jt.match("Safari")&&!Jt.match("Chrome"))),Ye=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;(navigator.maxTouchPoints===void 0||navigator.maxTouchPoints>0)&&navigator.userAgent.search(/iOS|iPhone OS|Android|BlackBerry|BB10|Series ?[64]0|J2ME|MIDP|opera mini|opera mobi|mobi.+Gecko|Windows Phone/i)!=-1;const Lt=typeof ServiceWorkerGlobalScope<"u"&&self instanceof ServiceWorkerGlobalScope,Xt=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&!Lt,Ke=Xt||Lt,ve=()=>self.clients.matchAll({includeUncontrolled:!1,type:"window"}),Ge=(e,...t)=>{try{e.postMessage(...t)}catch(s){console.error("[worker] postMessage error:",s,t)}},Ze=(e,...t)=>{ve().then(s=>{s.length&&s.slice(e?0:-1).forEach(i=>{Ge(i,...t)})})},Xe=(...e)=>{Ge(self,...e)},Qe=()=>{};Lt&&Ze.bind(null,!1);Lt&&Ze.bind(null,!0);const Cs=Date.now();function De(){return"["+((Date.now()-Cs)/1e3).toFixed(3)+"]"}var vt=(e=>(e[e.None=0]="None",e[e.Error=1]="Error",e[e.Warn=2]="Warn",e[e.Log=4]="Log",e[e.Debug=8]="Debug",e))(vt||{});const Bs=[0,1,2,4,8],Ds=ct||Ye,Oe=!Ds,ne={reset:"\x1B[0m",bright:"\x1B[1m",dim:"\x1B[2m",underscore:"\x1B[4m",blink:"\x1B[5m",reverse:"\x1B[7m",hidden:"\x1B[8m",fg:{black:"\x1B[30m",red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",blue:"\x1B[34m",magenta:"\x1B[35m",cyan:"\x1B[36m",white:"\x1B[37m"},bg:{black:"\x1B[40m",red:"\x1B[41m",green:"\x1B[42m",yellow:"\x1B[43m",blue:"\x1B[44m",magenta:"\x1B[45m",cyan:"\x1B[46m",white:"\x1B[47m"}},Os=[["debug",8],["info",4],["warn",2],["error",1],["assert",1],["trace",4],["group",4],["groupCollapsed",4],["groupEnd",4]];function Q(e,t=7,s=!1,i=""){let r;!we&&!s&&(t=1),Oe?i||(Lt?i=ne.fg.yellow:Xt&&(i=ne.fg.cyan)):i="";const o=i;i?i=`%s ${i}%s`:i="%s";const l=function(...g){return t&4&&console.log(i,De(),e,...g)};Os.forEach(([g,f])=>{l[g]=function(...c){return t&f&&console[g](i,De(),e,...c)}}),l.setPrefix=function(g){r=g,e="["+g+"]"},l.setPrefix(e),l.setLevel=function(g){t=Bs.slice(0,g+1).reduce((f,c)=>f|c,0)};const _={};return l.bindPrefix=function(g,f=t){return _[g]??(_[g]=Q(`${r}] ${Oe&&o?ne.reset:""}[${g}`,f,s,o))},l}function Ct(e){return new Promise(t=>{setTimeout(t,e)})}const Rs=self,ts="cachedAssets";function oe(e){return e.ok&&e.status===200}function Re(e){return Promise.race([e,Ct(1e4).then(()=>Promise.reject())])}async function Ns(e){try{const t=await Re(Rs.caches.open(ts)),s=await Re(t.match(e.request,{ignoreVary:!0}));if(s&&oe(s))return s;const i={Vary:"*"};let r=await fetch(e.request,{headers:i});if(oe(r))t.put(e.request,r.clone());else if(r.status===304){const o=e.request.url.replace(/\?.+$/,"")+"?"+(Math.random()*1e5|0);r=await fetch(o,{headers:i}),oe(r)&&t.put(e.request,r.clone())}return r}catch{return fetch(e.request)}}function Ls(e,t){return new Promise(s=>{const i=new FileReader;i.addEventListener("loadend",r=>{s(r.target.result)}),i[t](e)})}function qs(e){return Ls(e,"readAsArrayBuffer")}function Kt(e){return qs(e).then(t=>new Uint8Array(t))}function es(...e){const t=e.reduce((r,o)=>r+(o.byteLength||o.length),0),s=new Uint8Array(t);let i=0;return e.forEach(r=>{s.set(r instanceof ArrayBuffer?new Uint8Array(r):r,i),i+=r.byteLength||r.length}),s}function ss(){}const zs={isFulfilled:!1,isRejected:!1,notify:()=>{},notifyAll:function(...e){this.lastNotify=e,this.listeners?.forEach(t=>t(...e))},addNotifyListener:function(e){this.lastNotify&&e(...this.lastNotify),(this.listeners??(this.listeners=[])).push(e)},resolve:function(e){this.isFulfilled||this.isRejected||(this.isFulfilled=!0,this._resolve(e),this.onFinish())},reject:function(...e){this.isRejected||this.isFulfilled||(this.isRejected=!0,this._reject(...e),this.onFinish())},onFinish:function(){this.notify=this.notifyAll=this.lastNotify=null,this.listeners&&(this.listeners.length=0),this.cancel&&(this.cancel=ss)}};function H(){let e,t;const s=new Promise((i,r)=>{e=i,t=r});return Object.assign(s,zs),s._resolve=e,s._reject=t,s}self.deferredPromise=H;function Ws(e){const t=e.length,s=new Uint8Array(Math.ceil(t/2));let i=0;t%2&&(s[i++]=parseInt(e.charAt(0),16));for(let r=i;r<t;r+=2)s[i++]=parseInt(e.substr(r,2),16);return s}function js(e,t){const s=e.length;if(s!==t.length)return!1;for(let i=0;i<s;++i)if(e[i]!==t[i])return!1;return!0}function Gt(e,t){let s=0,i=0;for(let r=0;r<4;r++){const o=e[t+r];if(s=(s<<7)+(o&127),i++,!(o&128))break}return[i,s]}function Js(e){if(e[0]!==5)throw new Error("Invalid DecoderSpecificInfo tag");const[t,s]=Gt(e,1),i=1+t;return e.subarray(i,i+s)}function $s(e){if(e[0]!==4)throw new Error("Invalid DecoderConfigDescriptor tag");const[t,s]=Gt(e,1);let i=1+t;return i+=13,Js(e.subarray(i))}function Hs(e){if(e[0]!==3)throw new Error("Invalid ES_Descriptor tag");const t=new DataView(e.buffer,e.byteOffset,e.byteLength),[s,i]=Gt(e,1);let r=1+s;r+=2;const o=t.getUint8(r);r+=1;const l=o&128,_=o&64;if(l&&(r+=2),_){const f=Gt(e,r);r+=1+f[0]+f[1]}return{decoderConfigDescriptor:$s(e.subarray(r))}}const Vs=[19,136],ae=Ws("0327000100041940150000000001f4000000bb750507138856e5a5"),Ys=new TextEncoder().encode("esds"),Ks=new TextEncoder().encode("mp4a");function Ne(e,t,s=e.length){for(let i=s-t.length;i>=0;i--){let r=!0;for(let o=0;o<t.length;o++)if(e[i+o]!==t[o]){r=!1;break}if(r)return i}return-1}function Gs(e){const t=new DataView(e.buffer,e.byteOffset,e.byteLength);let s=e.length,i=null;for(;;){const l=Ne(e,Ys,s);if(l===-1)break;s=l;const _=t.getUint32(l-4);if(_<0||l+_>e.length)continue;const g=Ne(e,Ks,l);g===-1||l-g>100||(i={offset:l+8,size:_-12})}if(!i)throw new Error("No ESDS found");const r=e.subarray(i.offset,i.offset+i.size),o=Hs(r);if(!o)throw new Error("Invalid ESDS");if(!js(o.decoderConfigDescriptor,Vs))throw new Error("Not a broken DSCI");if(i.size<ae.length)throw new Error(`ESDS Size not enough (expected at least ${ae.length}, got ${i.size})`);e.set(ae,i.offset)}function Zs(e){try{return Gs(e),!0}catch{return!1}}function Xs(e,t,s=!0,i=!0){let r,o,l,_,g=!1;const f=u=>{const d=l,S=_;try{const U=e.apply(null,u);d(U)}catch(U){console.error("debounce error",U),S(U)}},c=(...u)=>{o||(o=new Promise((S,U)=>(l=S,_=U))),r?(clearTimeout(r),g=!0,_(),o=new Promise((S,U)=>(l=S,_=U))):s&&(f(u),g=!1);const d=lt.setTimeout(()=>{i&&(!s||g)&&f(u),r===d&&(r=o=l=_=void 0,g=!1)},t);return r=d,o.catch(ss),o};return c.clearTimeout=()=>{r&&(lt.clearTimeout(r),_(),r=o=l=_=void 0,g=!1)},c.isDebounced=()=>!!r,c}function Qs(e){return e=parseInt((e||"1")+""),e<=4&&e>=1?e:1}const ti="account";function qt(e){const t=new URL(e).searchParams;return Qs(t.get(ti)||"")}function ei(e){return Array.isArray(e)?e:[e]}function si(e){return["image/jpeg","image/png","image/gif","image/svg+xml","image/webp","image/bmp","image/avif","image/jxl","video/mp4","video/webm","video/quicktime","audio/ogg","audio/mpeg","audio/mp4","audio/wav","application/json","application/pdf"].indexOf(e)===-1?"application/octet-stream":e}function is(e,t=""){e=ei(e);const s=si(t);return new Blob(e,{type:s})}function Bt(e,t){const s=new Error;return{type:e,stack:s.stack}}class rs{constructor(){throw new Error("Cannot instantiate a static utility class")}}const Zt=class Zt extends rs{static async get(){return this.deferred&&await this.deferred,this.key}static async getAsBase64(){const t=await this.get();if(!t)return null;const s=await crypto.subtle.exportKey("raw",t);return btoa(String.fromCharCode(...new Uint8Array(s)))}static save(t){this.key=t,this.deferred?.resolve(),this.deferred=void 0}static resetDeferred(){this.key=null,this.deferred=H()}};Zt.key=null,Zt.deferred=H();let yt=Zt;const ii=Date.now()%Math.random()*1e8|0;function $t(e,t){const s=e.indexOf(t);return(s===-1?void 0:e.splice(s,1))?.[0]}class ri{constructor(t){this._constructor(t)}_constructor(t){this.reuseResults=t,this.listeners={},this.listenerResults={}}addEventListener(t,s,i){var o;const r={callback:s,options:i};if(((o=this.listeners)[t]??(o[t]=new Set)).add(r),this.listenerResults.hasOwnProperty(t)&&(s(...this.listenerResults[t]),i?.once)){this.listeners[t].delete(r);return}}addMultipleEventsListeners(t){for(const s in t)this.addEventListener(s,t[s])}removeEventListener(t,s,i){if(this.listeners[t]){for(const r of this.listeners[t])if(r.callback===s){this.listeners[t].delete(r);break}}}invokeListenerCallback(t,s,...i){let r,o;try{r=s.callback(...i)}catch(l){o=l}if(s.options?.once&&this.removeEventListener(t,s.callback),o)throw o;return r}_dispatchEvent(t,s,...i){this.reuseResults&&(this.listenerResults[t]=i);const r=s&&[],o=this.listeners[t];if(o)for(const l of o){const _=this.invokeListenerCallback(t,l,...i);r&&r.push(_)}return r}dispatchResultableEvent(t,...s){return this._dispatchEvent(t,!0,...s)}dispatchEvent(t,...s){this._dispatchEvent(t,!1,...s)}cleanup(){this.listeners={},this.listenerResults={}}}const ni=!0;class Dt extends ri{constructor(t){super(!1),this.logSuffix=t,this.onMessage=s=>{const i=s.data,r=s.source||s.currentTarget;this.processTaskMap[i.type](i,r,s)},this.processResultTask=s=>{const{taskId:i,result:r,error:o}=s.payload,l=this.awaiting[i];l&&(this.debug&&this.log.debug("done",l.taskType,r,o),"error"in s.payload?l.reject(o):l.resolve(r),delete this.awaiting[i])},this.processAckTask=s=>{const i=s.payload,r=this.awaiting[i.taskId];if(!r)return;const o=r.resolve,l={cached:i.cached,result:i.cached?"result"in i?Promise.resolve(i.result):Promise.reject(i.error):new Promise((_,g)=>{r.resolve=_,r.reject=g})};o(l),i.cached&&delete this.awaiting[i.taskId]},this.processPingTask=(s,i,r)=>{this.pushTask(this.createTask("pong",void 0),r.source)},this.processPongTask=(s,i,r)=>{const o=this.pingResolves.get(i);o&&(this.pingResolves.delete(i),o())},this.processCloseTask=(s,i,r)=>{this.detachPort(i)},this.processBatchTask=(s,i,r)=>{const o={data:r.data,source:r.source,currentTarget:r.currentTarget};s.payload.forEach(l=>{o.data=l,this.onMessage(o)})},this.processLockTask=(s,i,r)=>{const o=s.payload;this.requestedLocks.has(o)||(this.requestedLocks.set(o,i),navigator.locks.request(o,()=>{this.processCloseTask(void 0,i,void 0),this.requestedLocks.delete(o)}))},this.processInvokeTask=async(s,i,r)=>{const o=s.id,l=s.payload;let _,g,f;l.void||(_={taskId:o},g=this.createTask("result",_)),l.withAck&&(f=this.createTask("ack",{taskId:o,cached:!0}));let c;try{const u=this.listeners[l.type];if(!u?.size)throw new Error("no listener");const d=u.values().next().value;let S=this.invokeListenerCallback(l.type,d,l.payload,i,r);if(l.void)return;if(c=S instanceof Promise,f){const U=!c;if(f.payload.cached=U,U&&(f.payload.result=S),this.pushTask(f,i),U)return}c&&(S=await S),S instanceof Dt.TransferableResult&&(g.transfer=S.transferables,S=S.value),_.result=S}catch(u){if(this.log.error("worker task error:",u,s),l.void)return;if(f&&f.payload.cached){f.payload.error=u,this.pushTask(f,i);return}_.error=u}this.pushTask(g,i)},this.listenPorts=[],this.sendPorts=[],this.pingResolves=new Map,this.taskId=Math.random(),this.awaiting={},this.pending=new Map,this.log=Q("MP"+(t?"-"+t:"")),this.debug=we,this.heldLocks=new Map,this.requestedLocks=new Map,this.processTaskMap={result:this.processResultTask,ack:this.processAckTask,invoke:this.processInvokeTask,ping:this.processPingTask,pong:this.processPongTask,close:this.processCloseTask,lock:this.processLockTask,batch:this.processBatchTask}}setOnPortDisconnect(t){this.onPortDisconnect=t}attachPort(t){this.attachListenPort(t),this.attachSendPort(t)}attachListenPort(t){this.listenPorts.push(t),t.addEventListener("message",this.onMessage)}attachSendPort(t){if(this.log.warn("attaching send port"),t.start?.(),this.sendPorts.push(t),typeof window<"u"&&ni)if("locks"in navigator){const s=["lock",ii,this.logSuffix||"",Math.random()*2147483647|0].join("-");this.log.warn("created lock",s);const i=new Promise(r=>this.heldLocks.set(t,{resolve:r,id:s})).then(()=>this.heldLocks.delete(t));navigator.locks.request(s,()=>(this.resendLockTask(t),i))}else window.addEventListener("beforeunload",()=>{const s=this.createTask("close",void 0);this.postMessage(void 0,s)});this.releasePending()}resendLockTask(t){const s=this.heldLocks.get(t);s&&this.pushTask(this.createTask("lock",s.id),t)}detachPort(t){this.log.warn("disconnecting port"),$t(this.listenPorts,t),$t(this.sendPorts,t),t.removeEventListener?.("message",this.onMessage),t.close?.(),this.onPortDisconnect?.(t),this.heldLocks.get(t)?.resolve();const i=Bt("PORT_DISCONNECTED");for(const r in this.awaiting){const o=this.awaiting[r];o.port===t&&(o.reject(i),delete this.awaiting[r])}}postMessage(t,s){(Array.isArray(t)?t:t?[t]:this.sendPorts).forEach(r=>{r.postMessage(s,s.transfer)})}async releasePending(){this.releasingPending||(this.releasingPending=!0,await Promise.resolve(),this.debug&&this.log.debug("releasing tasks, length:",this.pending.size),this.pending.forEach((t,s)=>{let i=t;{let o;i=[],t.forEach(l=>{l.transfer?(o=void 0,i.push(l)):(o||(o=this.createTask("batch",[]),i.push(o)),o.payload.push(l))})}const r=s?[s]:this.sendPorts;r.length&&(i.forEach(o=>{try{this.postMessage(r,o)}catch(l){this.log.error("postMessage error:",l,o,r)}}),this.pending.delete(s))}),this.debug&&this.log.debug("released tasks"),this.releasingPending=!1)}createTask(t,s,i){return{type:t,payload:s,id:this.taskId++,transfer:i}}createInvokeTask(t,s,i,r,o){return this.createTask("invoke",{type:t,payload:s,withAck:i,void:r},o)}pushTask(t,s){let i=this.pending.get(s);i||this.pending.set(s,i=[]),i.push(t),this.releasePending()}invokeVoid(t,s,i,r){const o=this.createInvokeTask(t,s,void 0,!0,r);this.pushTask(o,i)}invoke(t,s,i,r,o){this.debug&&this.log.debug("start",t,s);let l;const _=new Promise((g,f)=>{l=this.createInvokeTask(t,s,i,void 0,o),this.awaiting[l.id]={resolve:g,reject:f,taskType:t,port:r},this.pushTask(l,r)});if(Ke){_.finally(()=>{clearInterval(g)});const g=lt.setInterval(()=>{this.log.error("task still has no result",l,r)},6e4)}return _}invokeExceptSource(t,s,i){const r=this.sendPorts.slice();$t(r,i),r.forEach(o=>{this.invokeVoid(t,s,o)})}async invokeExceptSourceAsync(t,s,i){const r=this.sendPorts.slice();$t(r,i),await Promise.all(r.map(o=>this.invoke(t,s,void 0,o)))}}(e=>{class t{constructor(i,r){this.value=i,this.transferables=r}}e.TransferableResult=t})(Dt||(Dt={}));var ns=Dt;class oi extends ns{constructor(){super("CRYPTO"),this.lastIndex=-1}invokeCryptoNew({method:t,args:s,transfer:i}){const r={method:t,args:s},o=this.listeners.invoke;if(o?.size){let _=o.values().next().value.callback(r);return!Ke&&!(_ instanceof Promise)&&(_=Promise.resolve(_)),_}const l=t==="aes-encrypt"||t==="aes-decrypt"?this.lastIndex=(this.lastIndex+1)%this.sendPorts.length:0;return this.invoke("invoke",r,void 0,this.sendPorts[l],i)}invokeCrypto(t,...s){return this.invokeCryptoNew({method:t,args:s})}sendToOnePort(t){this.invokeVoid("port",void 0,this.sendPorts[0],[t])}}const Ot=new oi;At&&(At.cryptoMessagePort=Ot);const Se=class Se extends rs{static resolveDeferred(t){this.value=t,this.deferred?.resolve(),this.deferred=void 0}static async isUsingPasscode(){if(this.deferred&&await this.deferred,typeof this.value!="boolean")throw new Error("Is using passcode is not boolean WTF?");return this.value}static resetDeferred(){this.value=void 0,this.deferred=H()}};Se.deferred=H();let Ut=Se;class ai{constructor(t,s,i){this.mimeType=t,this.size=s,this.saveFileCallback=i,this.bytes=new Uint8Array(s)}async write(t,s){const i=s+t.byteLength;if(i>this.bytes.byteLength){const r=new Uint8Array(i);r.set(this.bytes,0),this.bytes=r}this.bytes.set(t,s)}truncate(){this.bytes=new Uint8Array}trim(t){this.bytes=this.bytes.slice(0,t)}finalize(t=!0){const s=is(this.bytes,this.mimeType);return t&&this.saveFileCallback&&this.saveFileCallback(s),s}getParts(){return this.bytes}replaceParts(t){this.bytes=t}}const ce={cachedAssets:{encryptable:!1},cachedBackgrounds:{encryptable:!1},cachedFiles:{encryptable:!0},cachedStreamChunks:{encryptable:!0},cachedHlsQualityFiles:{encryptable:!0},cachedHlsStreamChunks:{encryptable:!0}},K=class K{constructor(t){this.dbName=t,this.useStorage=!0,nt.test&&(this.dbName+="_test"),K.STORAGES.length&&(this.useStorage=K.STORAGES[0].useStorage),this.config=Object.entries(ce).find(([s])=>s===t)?.[1],this.openDatabase(),K.STORAGES.push(this)}static async encrypt(t){const s=await yt.get(),i=await Kt(t),r=t.type;console.log("[my-debug] encryption started");const o=await Ot.invokeCryptoNew({method:"aes-local-encrypt",args:[{key:s,data:i}],transfer:[i.buffer]});return console.log("[my-debug] encryption ended"),new Blob([o],{type:r})}static async decrypt(t){const s=await yt.get(),i=await Kt(t),r=t.type;console.log("[my-debug] decryption started");const o=await Ot.invokeCryptoNew({method:"aes-local-decrypt",args:[{key:s,encryptedData:i}],transfer:[i.buffer]});return console.log("[my-debug] decryption ended"),new Blob([o],{type:r})}async waitToEnable(){K.disabledPromise&&await K.disabledPromise}openDatabase(){return this.openDbPromise??(this.openDbPromise=caches.open(this.dbName))}delete(t){return this.timeoutOperation(s=>s.delete("/"+t))}deleteAll(){return caches.delete(this.dbName)}async has(t){return!!await this.timeoutOperation(i=>i.match("/"+t))}async get(t){await this.waitToEnable();const s=await this.timeoutOperation(i=>i.match("/"+t));if(s)return this.config?.encryptable&&await Ut.isUsingPasscode()?new Response(await K.decrypt(await s.blob()),{headers:s.headers,status:s.status,statusText:s.statusText}):s}async save(t,s){await this.waitToEnable();let i=s;return this.config?.encryptable&&await Ut.isUsingPasscode()&&(i=new Response(await K.encrypt(await s.blob()),{headers:s.headers,status:s.status,statusText:s.statusText})),this.timeoutOperation(r=>r.put("/"+t,i))}getFile(t,s="blob"){return this.get(t).then(i=>{if(!i)throw Bt("NO_ENTRY_FOUND");return i[s]()})}saveFile(t,s){s instanceof Blob||(s=is(s));const i=new Response(s,{headers:{"Content-Length":""+s.size}});return this.save(t,i).then(()=>s)}timeoutOperation(t){return this.useStorage?new Promise(async(s,i)=>{let r=!1;const o=setTimeout(()=>{i(),r=!0},15e3);try{const l=await this.openDatabase();if(!l)throw this.useStorage=!1,this.openDbPromise=void 0,"no cache?";const _=await t(l);if(r)return;s(_)}catch(l){i(l)}clearTimeout(o)}):Promise.reject(Bt("STORAGE_OFFLINE"))}prepareWriting(t,s,i){return{deferred:H(),getWriter:()=>new ai(i,s,o=>this.saveFile(t,o).catch(()=>o))}}static toggleStorage(t,s){return this.STORAGES.forEach(i=>{i.useStorage=t}),Promise.resolve()}static async deleteAllStorages(){const t=Object.keys(ce);await Promise.all(t.map(async s=>{await new K(s).deleteAll()}))}static temporarilyToggle(t){t?(this.disabledPromise?.resolve(),this.disabledPromise=void 0):this.disabledPromise=H()}static async clearEncryptableStorages(){const t=Object.entries(ce).filter(([,{encryptable:s}])=>s).map(([s])=>s);await Promise.all(t.map(async s=>{await new K(s).timeoutOperation(async r=>{const o=await r.keys();await Promise.all(o.map(l=>r.delete(l)))})}))}};K.STORAGES=[];let ht=K;function ci(e){return new Promise(t=>{setTimeout(()=>{t(new Response("",{status:408,statusText:"Request timed out."}))},e)})}const os=self,Pt=new Map,he=new ht("cachedStreamChunks"),li=86400,as="Time-Cached",ui=20*1024*1024,hi=()=>he.timeoutOperation(e=>e.keys().then(t=>{const s=new Map,i=Date.now()/1e3|0;for(const o of t){const l=o.url.match(/\/(\d+?)\?/);l&&!s.has(l[1])&&s.set(l[1],o)}const r=[];for(const[o,l]of s){const _=e.match(l).then(g=>{if(+g.headers.get(as)+li<=i)return R("will delete stream chunk:",o),e.delete(l,{ignoreSearch:!0,ignoreVary:!0})});r.push(_)}return Promise.all(r)}));setInterval(hi,18e5);setInterval(()=>{const e=ge();for(const[t,s]of Pt)if(t!==e){for(const i in s)s[i].reject();Pt.delete(t)}},12e4);const Vt=new Map;os.streams=Vt;class mt{constructor(t){this.info=t,this.loadedOffsets=new Set,this.destroy=()=>{this.destroyDebounced.clearTimeout(),Vt.delete(this.id),J.invokeVoid("cancelFilePartRequests",{docId:mt.getDocId(this.info),accountNumber:this.info.accountNumber},ge())},this.toggleInUse=s=>{this.inUse+=s?1:-1,this.inUse||this.destroy()},this.id=mt.getId(t),Vt.set(this.id,this),this.inUse=0,this.limitPart=t.size>75*1024*1024?mi:_i,this.destroyDebounced=Xs(this.destroy,15e4,!1,!0)}async requestFilePartFromWorker(t,s,i=!1){const r={docId:mt.getDocId(this.info),dcId:this.info.dcId,offset:t,limit:s,accountNumber:this.info.accountNumber},o=JSON.stringify(r),l=ge();let _=Pt.get(l);_||Pt.set(l,_={});let g=_[o];if(g)return g.then(c=>c.bytes);this.loadedOffsets.add(t),g=_[o]=H(),J.invoke("requestFilePart",r,void 0,l).then(g.resolve.bind(g),g.reject.bind(g)).finally(()=>{_[o]===g&&(delete _[o],Object.keys(_).length||Pt.delete(l))});const f=g.then(c=>c.bytes);return this.saveChunkToCache(f,t,s),!i&&this.preloadChunks(t,ui),f}requestFilePartFromCache(t,s,i){const r=this.getChunkKey(t,s);return he.getFile(r).then(o=>i?new Uint8Array:Kt(o),o=>{o.type})}requestFilePart(t,s,i){return this.requestFilePartFromCache(t,s,i).then(o=>o||this.requestFilePartFromWorker(t,s,i))}saveChunkToCache(t,s,i){return t.then(r=>{const o=this.getChunkKey(s,i),l=new Response(r,{headers:{"Content-Length":""+r.length,"Content-Type":"application/octet-stream",[as]:""+(Date.now()/1e3|0)}});return he.save(o,l)})}preloadChunk(t){this.loadedOffsets.has(t)||(this.loadedOffsets.add(t),this.requestFilePart(t,this.limitPart,!0))}preloadChunks(t,s){if(s>this.info.size&&(s=this.info.size),!t)this.preloadChunk(Le(t,this.limitPart));else for(;t<s;t+=this.limitPart)this.preloadChunk(t)}requestRange(t){this.destroyDebounced();const s=di(t,this.info.mimeType,this.info.size);if(s)return s;let[i,r]=t;const o=r&&r<this.limitPart?yi(r-i+1):this.limitPart,l=Le(i,o);r||(r=Math.min(i+o,this.info.size-1));let _;return(i!==l||r!==l+o)&&(_=r-l-o+1),Promise.all([this.requestFilePart(l,o),_&&this.requestFilePart(l+o,o)]).then(f=>{let c=es(...f.filter(Boolean));if(i!==l||r!==l+o){const d=i-l,S=r-l+1;c=c.slice(d,S)}(this.shouldPatchMp4===!0||this.shouldPatchMp4===l)&&Zs(c)&&(this.shouldPatchMp4=l);const u={"Accept-Ranges":"bytes","Content-Range":`bytes ${i}-${i+c.byteLength-1}/${this.info.size||"*"}`,"Content-Length":`${c.byteLength}`,"Response-Time":""+Date.now()};return this.info.mimeType&&(u["Content-Type"]=this.info.mimeType),new Response(c,{status:206,statusText:"Partial Content",headers:u})})}getChunkKey(t,s){return this.id+"?offset="+t+"&limit="+s}patchChromiumMp4(){this.shouldPatchMp4=!0}static get(t){return Vt.get(this.getId(t))??new mt(t)}static getId(t){return`${t.accountNumber}-${this.getDocId(t)}`}static getDocId(t){return t.location.id}}function cs(e){return JSON.parse(decodeURIComponent(e))}function fi(e,t,s){async function i(){const r=ls(e.request.headers.get("Range")),o=cs(t),l=await os.clients.get(e.clientId);l?.type==="window"&&(o.accountNumber=qt(l.url));const _=mt.get(o);return s==="_crbug1250841"&&_.patchChromiumMp4(),_.requestRange(r)}e.respondWith(Promise.race([ci(45*1e3),i()]))}function pi({url:e,inUse:t,accountNumber:s}){[e]=e.split("?");const i="stream/",r=e.indexOf(i),o=cs(e.slice(r+i.length));o.accountNumber=s,mt.get(o).toggleInUse(t)}function di(e,t,s){return e[0]===0&&e[1]===1?new Response(new Uint8Array(2).buffer,{status:206,statusText:"Partial Content",headers:{"Accept-Ranges":"bytes","Content-Range":`bytes 0-1/${s||"*"}`,"Content-Length":"2","Content-Type":t||"video/mp4"}}):null}const _i=512*1024,mi=1024*1024,gi=512*4;function ls(e){if(!e)return[0,0];const[,t]=e.split("="),s=t.split(", "),[i,r]=s[0].split("-");return[+i,+r||0]}function Le(e,t=gi){return e-e%t}function yi(e){return 2**Math.ceil(Math.log(e)/Math.log(2))}const us=e=>({name:`tweb-account-${e}`,version:9,stores:[{name:"session",encryptedName:"session__encrypted"},{name:"stickerSets",encryptedName:"stickerSets__encrypted"},{name:"users",encryptedName:"users__encrypted"},{name:"chats",encryptedName:"chats__encrypted"},{name:"dialogs",encryptedName:"dialogs__encrypted"},{name:"messages",encryptedName:"messages__encrypted"},{name:"webapp",encryptedName:"webapp__encrypted"}]});At.getDatabaseState=us;const wi="assets/img/logo_filled_rounded.png",vi="assets/img/logo_plain.svg";function hs(e,t,s){const r=_=>Object.keys(_).filter(g=>_[g]!==void 0),o=typeof e;return e&&t&&o==="object"&&o===typeof t?r(e).length===r(t).length&&r(e).every(_=>hs(e[_],t[_])):e===t}function bi(e,t){if(t)for(const s in t)t[s]!==void 0&&(e[s]=t[s]);return e}const It=class It{constructor(t){bi(this,t),nt.test&&(this.name+="_test"),this.storageIsAvailable=!0,this.log=Q(["IDB",t.name].join("-")),this.log("constructor"),this.openDatabase(!0),It.INSTANCES.push(this)}isAvailable(){return this.storageIsAvailable}openDatabase(t=!1){if(this.openDbPromise&&!t)return this.openDbPromise;const s=(l,_)=>{const g=Array.from(l.indexNames);for(const f of g)l.deleteIndex(f);if(_.indexes?.length)for(const f of _.indexes)l.indexNames.contains(f.indexName)||l.createIndex(f.indexName,f.keyPath,f.objectParameters)},i=(l,_)=>{const g=l.createObjectStore(_.name);s(g,_)};try{var r=indexedDB.open(this.name,this.version);if(!r)return Promise.reject()}catch(l){return this.log.error("error opening db",l.message),this.storageIsAvailable=!1,Promise.reject(l)}let o=!1;return setTimeout(()=>{o||r.onerror(Bt("IDB_CREATE_TIMEOUT"))},3e3),this.openDbPromise=new Promise((l,_)=>{r.onsuccess=g=>{o=!0;const f=r.result;let c=!1;this.log("Opened"),f.onerror=u=>{this.storageIsAvailable=!1,this.log.error("Error creating/accessing IndexedDB database",u),_(u)},f.onclose=u=>{this.log.error("closed:",u),!c&&this.openDatabase()},f.onabort=u=>{this.log.error("abort:",u);const d=u.target;this.openDatabase(c=!0),d.onerror&&d.onerror(u),f.close()},f.onversionchange=u=>{this.log.error("onversionchange, lol?")},l(this.db=f)},r.onerror=g=>{o=!0,this.storageIsAvailable=!1,this.log.error("Error creating/accessing IndexedDB database",g),_(g)},r.onupgradeneeded=g=>{o=!0,this.log.warn("performing idb upgrade from",g.oldVersion,"to",g.newVersion);const f=g.target,c=f.result;this.stores.forEach(u=>{if(!c.objectStoreNames.contains(u.name))i(c,u);else{const S=f.transaction.objectStore(u.name);s(S,u)}u.encryptedName&&!c.objectStoreNames.contains(u.encryptedName)&&c.createObjectStore(u.encryptedName)})}}).then(l=>this.openDbPromise=l)}async closeDatabase(){this.db&&(this.db.onclose=()=>{},this.db.close())}static create(t){return this.INSTANCES.find(s=>s.name===t.name)??new It(t)}static closeDatabases(t){this.INSTANCES.forEach(s=>{t&&t===s||s.closeDatabase()})}static deleteDatabaseByName(t){return new Promise((s,i)=>{this.INSTANCES.forEach(o=>{if(o.name===t)return o.closeDatabase()});const r=indexedDB.deleteDatabase(t);r.onerror=()=>i(),r.onsuccess=()=>s()})}};It.INSTANCES=[];let fe=It;class Fi{constructor(t,s){this.storeName=s,this.log=Q(["IDB",t.name,s].join("-")),this.idb=fe.create(t)}close(){return this.idb.closeDatabase()}delete(t,s){const i=Array.isArray(t);return i||(t=[].concat(t)),this.getObjectStore("readwrite",r=>{const o=t.map(l=>r.delete(l));return i?o:o[0]},"",s)}clear(t){return this.getObjectStore("readwrite",s=>s.clear(),"",t)}save(t,s,i){const r=Array.isArray(t);return r||(t=[].concat(t),s=[].concat(s)),this.getObjectStore("readwrite",o=>{const l=t.map((_,g)=>o.put(s[g],_));return r?l:l[0]},"",i)}get(t,s){const i=Array.isArray(t);if(i){if(!t.length)return Promise.resolve([])}else{if(!t)return;t=[].concat(t)}return this.getObjectStore("readonly",r=>{const o=t.map(l=>r.get(l));return i?o:o[0]},"",s)}async getObjectStore(t,s,i,r=this.storeName){let o;i&&(o=performance.now(),this.log(i+": start"));const l=setTimeout(()=>{this.log.error("transaction not finished",d,i)},1e4),_=this.idb.openDatabase(),g=_ instanceof Promise?await _:_;let f,c;const u=new Promise((B,q)=>[f,c]=[B,q]),d=g.transaction([r],t,{durability:"relaxed"}),S=()=>{clearTimeout(l),c(d.error)},U=()=>{clearTimeout(l),i&&this.log(i+": end",performance.now()-o);const B=C.map(q=>q.result);f(T?B:B[0]),i&&this.log(i+": resolved",T?B:B[0])};d.onerror=S;const x=t==="readwrite";x&&(d.oncomplete=()=>U());const A=s(d.objectStore(r),U,S),T=Array.isArray(A),C=T?A:[].concat(A);if(x)return u;const W=C.length;let j=W;const M=()=>{d.error||--j||U()};for(let B=0;B<W;++B){const q=C[B];q.onerror=S,q.onsuccess=M}return u}getAll(t){return this.getObjectStore("readonly",s=>s.getAll(),"",t)}getAllKeys(t){return this.getObjectStore("readonly",s=>s.getAllKeys(),"",t)}getAllEntries(t){const s=[];return new Promise((i,r)=>{this.getObjectStore("readonly",(o,l,_)=>{const g=o.openCursor();return g.onsuccess=f=>{const c=f.target.result;c?(s.push([c.key,c.value]),c.continue()):(l(),i(s))},g.onerror=_,[]},"",t).catch(r)})}}const st=self,Si=location.protocol+"//"+location.hostname+location.pathname.split("/").slice(0,-1).join("/")+"/",Ui=11500;let fs=0,ps=!0;class Mi{constructor(t,s,i){this.defaults=i,this.cache={},this.storage=new Fi(t,s)}getDefault(t){const s=this.defaults[t];return typeof s=="function"?s():s}get(t){return this.cache.hasOwnProperty(t)?this.cache[t]:this.storage.get(t).then(i=>i,()=>{}).then(i=>this.cache.hasOwnProperty(t)?this.cache[t]:(i??(i=this.getDefault(t)),this.cache[t]=i))}getCached(t){const s=this.get(t);if(s instanceof Promise)throw"no property";return s}async set(t,s){const i=this.cache[t]??this.defaults[t];if(!hs(i,s)){this.cache[t]=s;try{this.storage.save(t,s)}catch{}}}}const ds={push_mute_until:0,push_lang:{push_message_nopreview:"You have a new message",push_action_mute1d:"Mute for 24H",push_action_settings:"Settings"},push_settings:{}},ut=new Mi(us(1),"session",ds);for(const e in ds)ut.get(e);st.addEventListener("push",e=>{const t=e.data.json();R("push",{...t});try{const[s,i,r]=[ut.getCached("push_mute_until"),ut.getCached("push_settings"),ut.getCached("push_lang")],o=Date.now();if(_s()&&s&&o<s)throw`supress notification because mute for ${Math.ceil((s-o)/6e4)} min`;if(Date.now()-fs<=Ui&&ps)throw"supress notification because some instance is alive";const _=Pi(t,i,r);e.waitUntil(_)}catch(s){R(s)}});st.addEventListener("notificationclick",e=>{const t=e.notification;R("on notification click",t),t.close();const s=e.action;if(s==="mute1d"&&_s()){R("[SW] mute for 1d"),ut.set("push_mute_until",Date.now()+864e5);return}const i=t.data;if(!i)return;const r=st.clients.matchAll({type:"window"}).then(o=>{i.action=s,Ft=i;for(let l=0;l<o.length;++l){const _=o[l];if("focus"in _){_.focus(),J.invokeVoid("pushClick",Ft,_),Ft=void 0;return}}if(st.clients.openWindow)return Promise.resolve(ut.get("push_settings")).then(l=>st.clients.openWindow(l.baseUrl||Si))}).catch(o=>{R.error("Clients.matchAll error",o)});e.waitUntil(r)});st.addEventListener("notificationclose",Ti);const pe=new Set;let Ft;function Ti(e){ki(e.notification)}function ki(e){pe.delete(e)}function xi(e){for(const s of pe)try{if(e&&s.tag!==e)continue;s.close(),pe.delete(s)}catch{}let t;return"getNotifications"in st.registration?t=st.registration.getNotifications({tag:e}).then(s=>{for(let i=0,r=s.length;i<r;++i)try{s[i].close()}catch{}}).catch(s=>{R.error("Offline register SW error",s)}):t=Promise.resolve(),t}function _s(){return Ye}function Pi(e,t,s){let i=e.title||"Telegram",r=e.description||"",o;e.custom&&(e.custom.channel_id?o=""+-e.custom.channel_id:e.custom.chat_id?o=""+-e.custom.chat_id:o=e.custom.from_id||""),e.custom.peerId=""+o;let l="peer"+o;const _=o+"_"+e.custom.msg_id;if(Rt.has(_)){const u="ignoring push";throw R.warn(u,e),Rt.delete(_),u}t?.nopreview&&(i="Telegram",r=s.push_message_nopreview,l="unknown_peer");const g=[{action:"mute1d",title:s.push_action_mute1d}],f={body:r,icon:wi,tag:l,data:e,actions:g,badge:vi,silent:e.custom.silent==="1"};return R("show notify",i,r,e,f),st.registration.showNotification(i,f).catch(u=>{R.error("Show notification promise",u)})}function Ei(e,t){fs=Date.now(),ps=e.localNotifications,Ft&&t&&(J.invokeVoid("pushClick",Ft,t),Ft=void 0),e.lang&&ut.set("push_lang",e.lang),e.settings&&ut.set("push_settings",e.settings)}const Rt=new Map;function Ii(e){Rt.set(e,Date.now())}setInterval(()=>{const e=Date.now();Rt.forEach((t,s)=>{e-t>3e4&&Rt.delete(s)})},30*6e4);class Ai extends ns{constructor(){super("SERVICE"),At&&(At.serviceMessagePort=this)}}function Ci(e,t,s){const i=(r,o)=>{e.attachListenPort(r),o&&e.attachSendPort(o)};e.setOnPortDisconnect(s),typeof SharedWorkerGlobalScope<"u"?lt.addEventListener("connect",r=>i(r.source,r.source)):typeof ServiceWorkerGlobalScope<"u"?i(lt,null):i(lt,lt)}const Z=new Map,le=Bt("UNKNOWN"),Bi=!1;self.downloadMap=Z;const Di={download:e=>{const{id:t}=e;if(Z.has(t))return Promise.reject(le);const s=Q("DOWNLOAD-"+t);s("prepare");const i=new CountQueuingStrategy({highWaterMark:1}),r=H();r.then(()=>{setTimeout(()=>{Z.delete(t)},5e3)},()=>{Z.delete(t)});let o;const l=new ReadableStream({start:g=>{o=g},cancel:g=>{s("cancel",t,g),r.reject(le)}},i),_={...e,readableStream:l,promise:r,controller:o,log:s};return Z.set(t,_),r.catch(()=>{throw le})},downloadChunk:({id:e,chunk:t})=>{const s=Z.get(e);return s?s.controller.enqueue(t):Promise.reject()},downloadFinalize:e=>{const t=Z.get(e);return t?(t.log("finalize"),t.promise.resolve(),t.controller.close()):Promise.reject()},downloadCancel:e=>{const t=Z.get(e);if(t)return t.log("cancel"),t.promise.reject(),t.controller.error()}};function Oi(e){return e.addMultipleEventsListeners(Di),{onDownloadFetch:Ri,onClosedWindows:Ni}}function Ri(e,t){ye("downloadRequestReceived",t);const s=Ct(100).then(()=>{const i=Z.get(t);if(!i||i.used&&!Bi){R.warn("no such download",t);return}i.log("fetch"),i.used=!0;const r=i.readableStream;return new Response(r,{headers:i.headers,status:200})});e.respondWith(s)}function Ni(){if(R("cancelling all downloads"),Z.size)for(const[e,t]of Z)t.controller.error()}const Et={};function Li(e){return{files:e.getAll("files"),title:e.get("title"),text:e.get("text"),url:e.get("url")}}async function qi(e,t){try{R("share data",e);const s=Li(e);(Et[t]??(Et[t]=[])).push(s)}catch(s){R.warn("something wrong with the data",s)}}function zi(e){const t=Et[e.id];t&&(delete Et[e.id],R("releasing share events to client:",e.id,"length:",t.length),t.forEach(s=>{J.invokeVoid("share",s,e)}))}function Wi(e,t){const s=e.request.formData().then(i=>(qi(i,e.resultingClientId),Response.redirect("..")));e.respondWith(s)}const qe=1,ji=2;function gt(e,t){if(e.type===t)return e;if(!e.boxes)return null;for(const s of e.boxes){const i=gt(s,t);if(i)return i}return null}function de(e){return new Uint8Array(e._raw.buffer,e._raw.byteOffset,e._raw.byteLength)}function Ji(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ms={exports:{}};(function(e){var t=function(s){var i=1e7,r=7,o=9007199254740992,l=U(o),_="0123456789abcdefghijklmnopqrstuvwxyz",g=typeof BigInt=="function";function f(n,a,h,p){return typeof n>"u"?f[0]:typeof a<"u"?+a==10&&!h?P(n):Ps(n,a,h,p):P(n)}function c(n,a){this.value=n,this.sign=a,this.isSmall=!1}c.prototype=Object.create(f.prototype);function u(n){this.value=n,this.sign=n<0,this.isSmall=!0}u.prototype=Object.create(f.prototype);function d(n){this.value=n}d.prototype=Object.create(f.prototype);function S(n){return-o<n&&n<o}function U(n){return n<1e7?[n]:n<1e14?[n%1e7,Math.floor(n/1e7)]:[n%1e7,Math.floor(n/1e7)%1e7,Math.floor(n/1e14)]}function x(n){A(n);var a=n.length;if(a<4&&pt(n,l)<0)switch(a){case 0:return 0;case 1:return n[0];case 2:return n[0]+n[1]*i;default:return n[0]+(n[1]+n[2]*i)*i}return n}function A(n){for(var a=n.length;n[--a]===0;);n.length=a+1}function T(n){for(var a=new Array(n),h=-1;++h<n;)a[h]=0;return a}function C(n){return n>0?Math.floor(n):Math.ceil(n)}function W(n,a){var h=n.length,p=a.length,y=new Array(h),m=0,w=i,v,F;for(F=0;F<p;F++)v=n[F]+a[F]+m,m=v>=w?1:0,y[F]=v-m*w;for(;F<h;)v=n[F]+m,m=v===w?1:0,y[F++]=v-m*w;return m>0&&y.push(m),y}function j(n,a){return n.length>=a.length?W(n,a):W(a,n)}function M(n,a){var h=n.length,p=new Array(h),y=i,m,w;for(w=0;w<h;w++)m=n[w]-y+a,a=Math.floor(m/y),p[w]=m-a*y,a+=1;for(;a>0;)p[w++]=a%y,a=Math.floor(a/y);return p}c.prototype.add=function(n){var a=P(n);if(this.sign!==a.sign)return this.subtract(a.negate());var h=this.value,p=a.value;return a.isSmall?new c(M(h,Math.abs(p)),this.sign):new c(j(h,p),this.sign)},c.prototype.plus=c.prototype.add,u.prototype.add=function(n){var a=P(n),h=this.value;if(h<0!==a.sign)return this.subtract(a.negate());var p=a.value;if(a.isSmall){if(S(h+p))return new u(h+p);p=U(Math.abs(p))}return new c(M(p,Math.abs(h)),h<0)},u.prototype.plus=u.prototype.add,d.prototype.add=function(n){return new d(this.value+P(n).value)},d.prototype.plus=d.prototype.add;function B(n,a){var h=n.length,p=a.length,y=new Array(h),m=0,w=i,v,F;for(v=0;v<p;v++)F=n[v]-m-a[v],F<0?(F+=w,m=1):m=0,y[v]=F;for(v=p;v<h;v++){if(F=n[v]-m,F<0)F+=w;else{y[v++]=F;break}y[v]=F}for(;v<h;v++)y[v]=n[v];return A(y),y}function q(n,a,h){var p;return pt(n,a)>=0?p=B(n,a):(p=B(a,n),h=!h),p=x(p),typeof p=="number"?(h&&(p=-p),new u(p)):new c(p,h)}function k(n,a,h){var p=n.length,y=new Array(p),m=-a,w=i,v,F;for(v=0;v<p;v++)F=n[v]+m,m=Math.floor(F/w),F%=w,y[v]=F<0?F+w:F;return y=x(y),typeof y=="number"?(h&&(y=-y),new u(y)):new c(y,h)}c.prototype.subtract=function(n){var a=P(n);if(this.sign!==a.sign)return this.add(a.negate());var h=this.value,p=a.value;return a.isSmall?k(h,Math.abs(p),this.sign):q(h,p,this.sign)},c.prototype.minus=c.prototype.subtract,u.prototype.subtract=function(n){var a=P(n),h=this.value;if(h<0!==a.sign)return this.add(a.negate());var p=a.value;return a.isSmall?new u(h-p):k(p,Math.abs(h),h>=0)},u.prototype.minus=u.prototype.subtract,d.prototype.subtract=function(n){return new d(this.value-P(n).value)},d.prototype.minus=d.prototype.subtract,c.prototype.negate=function(){return new c(this.value,!this.sign)},u.prototype.negate=function(){var n=this.sign,a=new u(-this.value);return a.sign=!n,a},d.prototype.negate=function(){return new d(-this.value)},c.prototype.abs=function(){return new c(this.value,!1)},u.prototype.abs=function(){return new u(Math.abs(this.value))},d.prototype.abs=function(){return new d(this.value>=0?this.value:-this.value)};function D(n,a){var h=n.length,p=a.length,y=h+p,m=T(y),w=i,v,F,E,O,I;for(E=0;E<h;++E){O=n[E];for(var L=0;L<p;++L)I=a[L],v=O*I+m[E+L],F=Math.floor(v/w),m[E+L]=v-F*w,m[E+L+1]+=F}return A(m),m}function z(n,a){var h=n.length,p=new Array(h),y=i,m=0,w,v;for(v=0;v<h;v++)w=n[v]*a+m,m=Math.floor(w/y),p[v]=w-m*y;for(;m>0;)p[v++]=m%y,m=Math.floor(m/y);return p}function G(n,a){for(var h=[];a-- >0;)h.push(0);return h.concat(n)}function Wt(n,a){var h=Math.max(n.length,a.length);if(h<=30)return D(n,a);h=Math.ceil(h/2);var p=n.slice(h),y=n.slice(0,h),m=a.slice(h),w=a.slice(0,h),v=Wt(y,w),F=Wt(p,m),E=Wt(j(y,p),j(w,m)),O=j(j(v,G(B(B(E,v),F),h)),G(F,2*h));return A(O),O}function Ss(n,a){return-.012*n-.012*a+15e-6*n*a>0}c.prototype.multiply=function(n){var a=P(n),h=this.value,p=a.value,y=this.sign!==a.sign,m;if(a.isSmall){if(p===0)return f[0];if(p===1)return this;if(p===-1)return this.negate();if(m=Math.abs(p),m<i)return new c(z(h,m),y);p=U(m)}return Ss(h.length,p.length)?new c(Wt(h,p),y):new c(D(h,p),y)},c.prototype.times=c.prototype.multiply;function Ue(n,a,h){return n<i?new c(z(a,n),h):new c(D(a,U(n)),h)}u.prototype._multiplyBySmall=function(n){return S(n.value*this.value)?new u(n.value*this.value):Ue(Math.abs(n.value),U(Math.abs(this.value)),this.sign!==n.sign)},c.prototype._multiplyBySmall=function(n){return n.value===0?f[0]:n.value===1?this:n.value===-1?this.negate():Ue(Math.abs(n.value),this.value,this.sign!==n.sign)},u.prototype.multiply=function(n){return P(n)._multiplyBySmall(this)},u.prototype.times=u.prototype.multiply,d.prototype.multiply=function(n){return new d(this.value*P(n).value)},d.prototype.times=d.prototype.multiply;function Me(n){var a=n.length,h=T(a+a),p=i,y,m,w,v,F;for(w=0;w<a;w++){v=n[w],m=0-v*v;for(var E=w;E<a;E++)F=n[E],y=2*(v*F)+h[w+E]+m,m=Math.floor(y/p),h[w+E]=y-m*p;h[w+a]=m}return A(h),h}c.prototype.square=function(){return new c(Me(this.value),!1)},u.prototype.square=function(){var n=this.value*this.value;return S(n)?new u(n):new c(Me(U(Math.abs(this.value))),!1)},d.prototype.square=function(n){return new d(this.value*this.value)};function Us(n,a){var h=n.length,p=a.length,y=i,m=T(a.length),w=a[p-1],v=Math.ceil(y/(2*w)),F=z(n,v),E=z(a,v),O,I,L,V,$,ie,re;for(F.length<=h&&F.push(0),E.push(0),w=E[p-1],I=h-p;I>=0;I--){for(O=y-1,F[I+p]!==w&&(O=Math.floor((F[I+p]*y+F[I+p-1])/w)),L=0,V=0,ie=E.length,$=0;$<ie;$++)L+=O*E[$],re=Math.floor(L/y),V+=F[I+$]-(L-re*y),L=re,V<0?(F[I+$]=V+y,V=-1):(F[I+$]=V,V=0);for(;V!==0;){for(O-=1,L=0,$=0;$<ie;$++)L+=F[I+$]-y+E[$],L<0?(F[I+$]=L+y,L=0):(F[I+$]=L,L=1);V+=L}m[I]=O}return F=Te(F,v)[0],[x(m),x(F)]}function Ms(n,a){for(var h=n.length,p=a.length,y=[],m=[],w=i,v,F,E,O,I;h;){if(m.unshift(n[--h]),A(m),pt(m,a)<0){y.push(0);continue}F=m.length,E=m[F-1]*w+m[F-2],O=a[p-1]*w+a[p-2],F>p&&(E=(E+1)*w),v=Math.ceil(E/O);do{if(I=z(a,v),pt(I,m)<=0)break;v--}while(v);y.push(v),m=B(m,I)}return y.reverse(),[x(y),x(m)]}function Te(n,a){var h=n.length,p=T(h),y=i,m,w,v,F;for(v=0,m=h-1;m>=0;--m)F=v*y+n[m],w=C(F/a),v=F-w*a,p[m]=w|0;return[p,v|0]}function ft(n,a){var h,p=P(a);if(g)return[new d(n.value/p.value),new d(n.value%p.value)];var y=n.value,m=p.value,w;if(m===0)throw new Error("Cannot divide by zero");if(n.isSmall)return p.isSmall?[new u(C(y/m)),new u(y%m)]:[f[0],n];if(p.isSmall){if(m===1)return[n,f[0]];if(m==-1)return[n.negate(),f[0]];var v=Math.abs(m);if(v<i){h=Te(y,v),w=x(h[0]);var F=h[1];return n.sign&&(F=-F),typeof w=="number"?(n.sign!==p.sign&&(w=-w),[new u(w),new u(F)]):[new c(w,n.sign!==p.sign),new u(F)]}m=U(v)}var E=pt(y,m);if(E===-1)return[f[0],n];if(E===0)return[f[n.sign===p.sign?1:-1],f[0]];y.length+m.length<=200?h=Us(y,m):h=Ms(y,m),w=h[0];var O=n.sign!==p.sign,I=h[1],L=n.sign;return typeof w=="number"?(O&&(w=-w),w=new u(w)):w=new c(w,O),typeof I=="number"?(L&&(I=-I),I=new u(I)):I=new c(I,L),[w,I]}c.prototype.divmod=function(n){var a=ft(this,n);return{quotient:a[0],remainder:a[1]}},d.prototype.divmod=u.prototype.divmod=c.prototype.divmod,c.prototype.divide=function(n){return ft(this,n)[0]},d.prototype.over=d.prototype.divide=function(n){return new d(this.value/P(n).value)},u.prototype.over=u.prototype.divide=c.prototype.over=c.prototype.divide,c.prototype.mod=function(n){return ft(this,n)[1]},d.prototype.mod=d.prototype.remainder=function(n){return new d(this.value%P(n).value)},u.prototype.remainder=u.prototype.mod=c.prototype.remainder=c.prototype.mod,c.prototype.pow=function(n){var a=P(n),h=this.value,p=a.value,y,m,w;if(p===0)return f[1];if(h===0)return f[0];if(h===1)return f[1];if(h===-1)return a.isEven()?f[1]:f[-1];if(a.sign)return f[0];if(!a.isSmall)throw new Error("The exponent "+a.toString()+" is too large.");if(this.isSmall&&S(y=Math.pow(h,p)))return new u(C(y));for(m=this,w=f[1];p&!0&&(w=w.times(m),--p),p!==0;)p/=2,m=m.square();return w},u.prototype.pow=c.prototype.pow,d.prototype.pow=function(n){var a=P(n),h=this.value,p=a.value,y=BigInt(0),m=BigInt(1),w=BigInt(2);if(p===y)return f[1];if(h===y)return f[0];if(h===m)return f[1];if(h===BigInt(-1))return a.isEven()?f[1]:f[-1];if(a.isNegative())return new d(y);for(var v=this,F=f[1];(p&m)===m&&(F=F.times(v),--p),p!==y;)p/=w,v=v.square();return F},c.prototype.modPow=function(n,a){if(n=P(n),a=P(a),a.isZero())throw new Error("Cannot take modPow with modulus 0");var h=f[1],p=this.mod(a);for(n.isNegative()&&(n=n.multiply(f[-1]),p=p.modInv(a));n.isPositive();){if(p.isZero())return f[0];n.isOdd()&&(h=h.multiply(p).mod(a)),n=n.divide(2),p=p.square().mod(a)}return h},d.prototype.modPow=u.prototype.modPow=c.prototype.modPow;function pt(n,a){if(n.length!==a.length)return n.length>a.length?1:-1;for(var h=n.length-1;h>=0;h--)if(n[h]!==a[h])return n[h]>a[h]?1:-1;return 0}c.prototype.compareAbs=function(n){var a=P(n),h=this.value,p=a.value;return a.isSmall?1:pt(h,p)},u.prototype.compareAbs=function(n){var a=P(n),h=Math.abs(this.value),p=a.value;return a.isSmall?(p=Math.abs(p),h===p?0:h>p?1:-1):-1},d.prototype.compareAbs=function(n){var a=this.value,h=P(n).value;return a=a>=0?a:-a,h=h>=0?h:-h,a===h?0:a>h?1:-1},c.prototype.compare=function(n){if(n===1/0)return-1;if(n===-1/0)return 1;var a=P(n),h=this.value,p=a.value;return this.sign!==a.sign?a.sign?1:-1:a.isSmall?this.sign?-1:1:pt(h,p)*(this.sign?-1:1)},c.prototype.compareTo=c.prototype.compare,u.prototype.compare=function(n){if(n===1/0)return-1;if(n===-1/0)return 1;var a=P(n),h=this.value,p=a.value;return a.isSmall?h==p?0:h>p?1:-1:h<0!==a.sign?h<0?-1:1:h<0?1:-1},u.prototype.compareTo=u.prototype.compare,d.prototype.compare=function(n){if(n===1/0)return-1;if(n===-1/0)return 1;var a=this.value,h=P(n).value;return a===h?0:a>h?1:-1},d.prototype.compareTo=d.prototype.compare,c.prototype.equals=function(n){return this.compare(n)===0},d.prototype.eq=d.prototype.equals=u.prototype.eq=u.prototype.equals=c.prototype.eq=c.prototype.equals,c.prototype.notEquals=function(n){return this.compare(n)!==0},d.prototype.neq=d.prototype.notEquals=u.prototype.neq=u.prototype.notEquals=c.prototype.neq=c.prototype.notEquals,c.prototype.greater=function(n){return this.compare(n)>0},d.prototype.gt=d.prototype.greater=u.prototype.gt=u.prototype.greater=c.prototype.gt=c.prototype.greater,c.prototype.lesser=function(n){return this.compare(n)<0},d.prototype.lt=d.prototype.lesser=u.prototype.lt=u.prototype.lesser=c.prototype.lt=c.prototype.lesser,c.prototype.greaterOrEquals=function(n){return this.compare(n)>=0},d.prototype.geq=d.prototype.greaterOrEquals=u.prototype.geq=u.prototype.greaterOrEquals=c.prototype.geq=c.prototype.greaterOrEquals,c.prototype.lesserOrEquals=function(n){return this.compare(n)<=0},d.prototype.leq=d.prototype.lesserOrEquals=u.prototype.leq=u.prototype.lesserOrEquals=c.prototype.leq=c.prototype.lesserOrEquals,c.prototype.isEven=function(){return(this.value[0]&1)===0},u.prototype.isEven=function(){return(this.value&1)===0},d.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},c.prototype.isOdd=function(){return(this.value[0]&1)===1},u.prototype.isOdd=function(){return(this.value&1)===1},d.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},c.prototype.isPositive=function(){return!this.sign},u.prototype.isPositive=function(){return this.value>0},d.prototype.isPositive=u.prototype.isPositive,c.prototype.isNegative=function(){return this.sign},u.prototype.isNegative=function(){return this.value<0},d.prototype.isNegative=u.prototype.isNegative,c.prototype.isUnit=function(){return!1},u.prototype.isUnit=function(){return Math.abs(this.value)===1},d.prototype.isUnit=function(){return this.abs().value===BigInt(1)},c.prototype.isZero=function(){return!1},u.prototype.isZero=function(){return this.value===0},d.prototype.isZero=function(){return this.value===BigInt(0)},c.prototype.isDivisibleBy=function(n){var a=P(n);return a.isZero()?!1:a.isUnit()?!0:a.compareAbs(2)===0?this.isEven():this.mod(a).isZero()},d.prototype.isDivisibleBy=u.prototype.isDivisibleBy=c.prototype.isDivisibleBy;function ke(n){var a=n.abs();if(a.isUnit())return!1;if(a.equals(2)||a.equals(3)||a.equals(5))return!0;if(a.isEven()||a.isDivisibleBy(3)||a.isDivisibleBy(5))return!1;if(a.lesser(49))return!0}function Qt(n,a){for(var h=n.prev(),p=h,y=0,m,w,v;p.isEven();)p=p.divide(2),y++;t:for(w=0;w<a.length;w++)if(!n.lesser(a[w])&&(v=t(a[w]).modPow(p,n),!(v.isUnit()||v.equals(h)))){for(m=y-1;m!=0;m--){if(v=v.square().mod(n),v.isUnit())return!1;if(v.equals(h))continue t}return!1}return!0}c.prototype.isPrime=function(n){var a=ke(this);if(a!==s)return a;var h=this.abs(),p=h.bitLength();if(p<=64)return Qt(h,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var y=Math.log(2)*p.toJSNumber(),m=Math.ceil(n===!0?2*Math.pow(y,2):y),w=[],v=0;v<m;v++)w.push(t(v+2));return Qt(h,w)},d.prototype.isPrime=u.prototype.isPrime=c.prototype.isPrime,c.prototype.isProbablePrime=function(n,a){var h=ke(this);if(h!==s)return h;for(var p=this.abs(),y=n===s?5:n,m=[],w=0;w<y;w++)m.push(t.randBetween(2,p.minus(2),a));return Qt(p,m)},d.prototype.isProbablePrime=u.prototype.isProbablePrime=c.prototype.isProbablePrime,c.prototype.modInv=function(n){for(var a=t.zero,h=t.one,p=P(n),y=this.abs(),m,w,v;!y.isZero();)m=p.divide(y),w=a,v=p,a=h,p=y,h=w.subtract(m.multiply(h)),y=v.subtract(m.multiply(y));if(!p.isUnit())throw new Error(this.toString()+" and "+n.toString()+" are not co-prime");return a.compare(0)===-1&&(a=a.add(n)),this.isNegative()?a.negate():a},d.prototype.modInv=u.prototype.modInv=c.prototype.modInv,c.prototype.next=function(){var n=this.value;return this.sign?k(n,1,this.sign):new c(M(n,1),this.sign)},u.prototype.next=function(){var n=this.value;return n+1<o?new u(n+1):new c(l,!1)},d.prototype.next=function(){return new d(this.value+BigInt(1))},c.prototype.prev=function(){var n=this.value;return this.sign?new c(M(n,1),!0):k(n,1,this.sign)},u.prototype.prev=function(){var n=this.value;return n-1>-o?new u(n-1):new c(l,!0)},d.prototype.prev=function(){return new d(this.value-BigInt(1))};for(var tt=[1];2*tt[tt.length-1]<=i;)tt.push(2*tt[tt.length-1]);var Mt=tt.length,dt=tt[Mt-1];function xe(n){return Math.abs(n)<=i}c.prototype.shiftLeft=function(n){var a=P(n).toJSNumber();if(!xe(a))throw new Error(String(a)+" is too large for shifting.");if(a<0)return this.shiftRight(-a);var h=this;if(h.isZero())return h;for(;a>=Mt;)h=h.multiply(dt),a-=Mt-1;return h.multiply(tt[a])},d.prototype.shiftLeft=u.prototype.shiftLeft=c.prototype.shiftLeft,c.prototype.shiftRight=function(n){var a,h=P(n).toJSNumber();if(!xe(h))throw new Error(String(h)+" is too large for shifting.");if(h<0)return this.shiftLeft(-h);for(var p=this;h>=Mt;){if(p.isZero()||p.isNegative()&&p.isUnit())return p;a=ft(p,dt),p=a[1].isNegative()?a[0].prev():a[0],h-=Mt-1}return a=ft(p,tt[h]),a[1].isNegative()?a[0].prev():a[0]},d.prototype.shiftRight=u.prototype.shiftRight=c.prototype.shiftRight;function te(n,a,h){a=P(a);for(var p=n.isNegative(),y=a.isNegative(),m=p?n.not():n,w=y?a.not():a,v=0,F=0,E=null,O=null,I=[];!m.isZero()||!w.isZero();)E=ft(m,dt),v=E[1].toJSNumber(),p&&(v=dt-1-v),O=ft(w,dt),F=O[1].toJSNumber(),y&&(F=dt-1-F),m=E[0],w=O[0],I.push(h(v,F));for(var L=h(p?1:0,y?1:0)!==0?t(-1):t(0),V=I.length-1;V>=0;V-=1)L=L.multiply(dt).add(t(I[V]));return L}c.prototype.not=function(){return this.negate().prev()},d.prototype.not=u.prototype.not=c.prototype.not,c.prototype.and=function(n){return te(this,n,function(a,h){return a&h})},d.prototype.and=u.prototype.and=c.prototype.and,c.prototype.or=function(n){return te(this,n,function(a,h){return a|h})},d.prototype.or=u.prototype.or=c.prototype.or,c.prototype.xor=function(n){return te(this,n,function(a,h){return a^h})},d.prototype.xor=u.prototype.xor=c.prototype.xor;var ee=1<<30,Ts=(i&-i)*(i&-i)|ee;function jt(n){var a=n.value,h=typeof a=="number"?a|ee:typeof a=="bigint"?a|BigInt(ee):a[0]+a[1]*i|Ts;return h&-h}function Pe(n,a){if(a.compareTo(n)<=0){var h=Pe(n,a.square(a)),p=h.p,y=h.e,m=p.multiply(a);return m.compareTo(n)<=0?{p:m,e:y*2+1}:{p,e:y*2}}return{p:t(1),e:0}}c.prototype.bitLength=function(){var n=this;return n.compareTo(t(0))<0&&(n=n.negate().subtract(t(1))),n.compareTo(t(0))===0?t(0):t(Pe(n,t(2)).e).add(t(1))},d.prototype.bitLength=u.prototype.bitLength=c.prototype.bitLength;function Ee(n,a){return n=P(n),a=P(a),n.greater(a)?n:a}function se(n,a){return n=P(n),a=P(a),n.lesser(a)?n:a}function Ie(n,a){if(n=P(n).abs(),a=P(a).abs(),n.equals(a))return n;if(n.isZero())return a;if(a.isZero())return n;for(var h=f[1],p,y;n.isEven()&&a.isEven();)p=se(jt(n),jt(a)),n=n.divide(p),a=a.divide(p),h=h.multiply(p);for(;n.isEven();)n=n.divide(jt(n));do{for(;a.isEven();)a=a.divide(jt(a));n.greater(a)&&(y=a,a=n,n=y),a=a.subtract(n)}while(!a.isZero());return h.isUnit()?n:n.multiply(h)}function ks(n,a){return n=P(n).abs(),a=P(a).abs(),n.divide(Ie(n,a)).multiply(a)}function xs(n,a,h){n=P(n),a=P(a);var p=h||Math.random,y=se(n,a),m=Ee(n,a),w=m.subtract(y).add(1);if(w.isSmall)return y.add(Math.floor(p()*w));for(var v=Tt(w,i).value,F=[],E=!0,O=0;O<v.length;O++){var I=E?v[O]+(O+1<v.length?v[O+1]/i:0):i,L=C(p()*I);F.push(L),L<v[O]&&(E=!1)}return y.add(f.fromArray(F,i,!1))}var Ps=function(n,a,h,p){h=h||_,n=String(n),p||(n=n.toLowerCase(),h=h.toLowerCase());var y=n.length,m,w=Math.abs(a),v={};for(m=0;m<h.length;m++)v[h[m]]=m;for(m=0;m<y;m++){var F=n[m];if(F!=="-"&&F in v&&v[F]>=w){if(F==="1"&&w===1)continue;throw new Error(F+" is not a valid digit in base "+a+".")}}a=P(a);var E=[],O=n[0]==="-";for(m=O?1:0;m<n.length;m++){var F=n[m];if(F in v)E.push(P(v[F]));else if(F==="<"){var I=m;do m++;while(n[m]!==">"&&m<n.length);E.push(P(n.slice(I+1,m)))}else throw new Error(F+" is not a valid character")}return Ae(E,a,O)};function Ae(n,a,h){var p=f[0],y=f[1],m;for(m=n.length-1;m>=0;m--)p=p.add(n[m].times(y)),y=y.times(a);return h?p.negate():p}function Es(n,a){return a=a||_,n<a.length?a[n]:"<"+n+">"}function Tt(n,a){if(a=t(a),a.isZero()){if(n.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(a.equals(-1)){if(n.isZero())return{value:[0],isNegative:!1};if(n.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-n.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var h=Array.apply(null,Array(n.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return h.unshift([1]),{value:[].concat.apply([],h),isNegative:!1}}var p=!1;if(n.isNegative()&&a.isPositive()&&(p=!0,n=n.abs()),a.isUnit())return n.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(n.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:p};for(var y=[],m=n,w;m.isNegative()||m.compareAbs(a)>=0;){w=m.divmod(a),m=w.quotient;var v=w.remainder;v.isNegative()&&(v=a.minus(v).abs(),m=m.next()),y.push(v.toJSNumber())}return y.push(m.toJSNumber()),{value:y.reverse(),isNegative:p}}function Ce(n,a,h){var p=Tt(n,a);return(p.isNegative?"-":"")+p.value.map(function(y){return Es(y,h)}).join("")}c.prototype.toArray=function(n){return Tt(this,n)},u.prototype.toArray=function(n){return Tt(this,n)},d.prototype.toArray=function(n){return Tt(this,n)},c.prototype.toString=function(n,a){if(n===s&&(n=10),n!==10||a)return Ce(this,n,a);for(var h=this.value,p=h.length,y=String(h[--p]),m="0000000",w;--p>=0;)w=String(h[p]),y+=m.slice(w.length)+w;var v=this.sign?"-":"";return v+y},u.prototype.toString=function(n,a){return n===s&&(n=10),n!=10||a?Ce(this,n,a):String(this.value)},d.prototype.toString=u.prototype.toString,d.prototype.toJSON=c.prototype.toJSON=u.prototype.toJSON=function(){return this.toString()},c.prototype.valueOf=function(){return parseInt(this.toString(),10)},c.prototype.toJSNumber=c.prototype.valueOf,u.prototype.valueOf=function(){return this.value},u.prototype.toJSNumber=u.prototype.valueOf,d.prototype.valueOf=d.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function Be(n){if(S(+n)){var a=+n;if(a===C(a))return g?new d(BigInt(a)):new u(a);throw new Error("Invalid integer: "+n)}var h=n[0]==="-";h&&(n=n.slice(1));var p=n.split(/e/i);if(p.length>2)throw new Error("Invalid integer: "+p.join("e"));if(p.length===2){var y=p[1];if(y[0]==="+"&&(y=y.slice(1)),y=+y,y!==C(y)||!S(y))throw new Error("Invalid integer: "+y+" is not a valid exponent.");var m=p[0],w=m.indexOf(".");if(w>=0&&(y-=m.length-w-1,m=m.slice(0,w)+m.slice(w+1)),y<0)throw new Error("Cannot include negative exponent part for integers");m+=new Array(y+1).join("0"),n=m}var v=/^([0-9][0-9]*)$/.test(n);if(!v)throw new Error("Invalid integer: "+n);if(g)return new d(BigInt(h?"-"+n:n));for(var F=[],E=n.length,O=r,I=E-O;E>0;)F.push(+n.slice(I,E)),I-=O,I<0&&(I=0),E-=O;return A(F),new c(F,h)}function Is(n){if(g)return new d(BigInt(n));if(S(n)){if(n!==C(n))throw new Error(n+" is not an integer.");return new u(n)}return Be(n.toString())}function P(n){return typeof n=="number"?Is(n):typeof n=="string"?Be(n):typeof n=="bigint"?new d(n):n}for(var _t=0;_t<1e3;_t++)f[_t]=P(_t),_t>0&&(f[-_t]=P(-_t));return f.one=f[1],f.zero=f[0],f.minusOne=f[-1],f.max=Ee,f.min=se,f.gcd=Ie,f.lcm=ks,f.isInstance=function(n){return n instanceof c||n instanceof u||n instanceof d},f.randBetween=xs,f.fromArray=function(n,a,h){return Ae(n.map(P),P(a||10),h)},f}();e.hasOwnProperty("exports")&&(e.exports=t)})(ms);var $i=ms.exports,et=Ji($i),N={};N.parseBuffer=function(e){return new X(e).parse()};N.addBoxProcessor=function(e,t){typeof e!="string"||typeof t!="function"||(b.prototype._boxProcessors[e]=t)};N.createFile=function(){return new X};N.createBox=function(e,t,s){var i=b.create(e);return t&&t.append(i,s),i};N.createFullBox=function(e,t,s){var i=N.createBox(e,t,s);return i.version=0,i.flags=0,i};N.Utils={};N.Utils.dataViewToString=function(e,t){var s=t||"utf-8";if(typeof TextDecoder<"u")return new TextDecoder(s).decode(e);var i=[],r=0;if(s==="utf-8")for(;r<e.byteLength;){var o=e.getUint8(r++);o<128||(o<224?(o=(o&31)<<6,o|=e.getUint8(r++)&63):o<240?(o=(o&15)<<12,o|=(e.getUint8(r++)&63)<<6,o|=e.getUint8(r++)&63):(o=(o&7)<<18,o|=(e.getUint8(r++)&63)<<12,o|=(e.getUint8(r++)&63)<<6,o|=e.getUint8(r++)&63)),i.push(String.fromCharCode(o))}else for(;r<e.byteLength;)i.push(String.fromCharCode(e.getUint8(r++)));return i.join("")};N.Utils.utf8ToByteArray=function(e){var t,s;if(typeof TextEncoder<"u")t=new TextEncoder().encode(e);else for(t=[],s=0;s<e.length;++s){var i=e.charCodeAt(s);i<128?t.push(i):i<2048?(t.push(192|i>>6),t.push(128|63&i)):i<65536?(t.push(224|i>>12),t.push(128|63&i>>6),t.push(128|63&i)):(t.push(240|i>>18),t.push(128|63&i>>12),t.push(128|63&i>>6),t.push(128|63&i))}return t};N.Utils.appendBox=function(e,t,s){if(t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,s!==-1){if(s==null){e.boxes.push(t);return}var i=-1,r;if(typeof s=="number")i=s;else{if(typeof s=="string")r=s;else if(typeof s=="object"&&s.type)r=s.type;else{e.boxes.push(t);return}for(var o=0;o<e.boxes.length;o++)if(r===e.boxes[o].type){i=o+1;break}}e.boxes.splice(i,0,t)}};N.Cursor=function(e){this.offset=typeof e>"u"?0:e};var X=function(e){this._cursor=new N.Cursor,this.boxes=[],e&&(this._raw=new DataView(e))};X.prototype.fetch=function(e){var t=this.fetchAll(e,!0);return t.length?t[0]:null};X.prototype.fetchAll=function(e,t){var s=[];return X._sweep.call(this,e,s,t),s};X.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var e=b.parse(this);if(typeof e.type>"u")break;this.boxes.push(e)}return this};X._sweep=function(e,t,s){this.type&&this.type==e&&t.push(this);for(var i in this.boxes){if(t.length&&s)return;X._sweep.call(this.boxes[i],e,t,s)}};X.prototype.write=function(){var e=0,t;for(t=0;t<this.boxes.length;t++)e+=this.boxes[t].getLength(!1);var s=new Uint8Array(e);for(this._rawo=new DataView(s.buffer),this.bytes=s,this._cursor.offset=0,t=0;t<this.boxes.length;t++)this.boxes[t].write();return s.buffer};X.prototype.append=function(e,t){N.Utils.appendBox(this,e,t)};var b=function(){this._cursor=new N.Cursor};b.parse=function(e){var t=new b;return t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,t._parseBox(),e._cursor.offset=t._raw.byteOffset+t._raw.byteLength,t};b.create=function(e){var t=new b;return t.type=e,t.boxes=[],t};b.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca","ilst"];b.prototype._boxProcessors={};b.prototype._procField=function(e,t,s){this._parsing?this[e]=this._readField(t,s):this._writeField(t,s,this[e])};b.prototype._procFieldArray=function(e,t,s,i){var r;if(this._parsing)for(this[e]=[],r=0;r<t;r++)this[e][r]=this._readField(s,i);else for(r=0;r<this[e].length;r++)this._writeField(s,i,this[e][r])};b.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24)};b.prototype._procEntries=function(e,t,s){var i;if(this._parsing)for(this[e]=[],i=0;i<t;i++)this[e].push({}),s.call(this,this[e][i]);else for(i=0;i<t;i++)s.call(this,this[e][i])};b.prototype._procSubEntries=function(e,t,s,i){var r;if(this._parsing)for(e[t]=[],r=0;r<s;r++)e[t].push({}),i.call(this,e[t][r]);else for(r=0;r<s;r++)i.call(this,e[t][r])};b.prototype._procEntryField=function(e,t,s,i){this._parsing?e[t]=this._readField(s,i):this._writeField(s,i,e[t])};b.prototype._procSubBoxes=function(e,t=-1){const s=t===-1;var i;if(this._parsing){s&&(t=1/0);const r=this._offset+this.size;for(this[e]=[],i=0;i<t&&(this[e].push(b.parse(this)),!(s&&this._cursor.offset>=r));i++);}else for(s&&(t=this[e].length),i=0;i<t;i++)this._rawo?this[e][i].write():this.size+=this[e][i].getLength()};b.prototype._readField=function(e,t){switch(e){case"uint":return this._readUint(t);case"int":return this._readInt(t);case"template":return this._readTemplate(t);case"string":return t===-1?this._readTerminatedString():this._readString(t);case"data":return this._readData(t);case"utf8":return this._readUTF8String();default:return-1}};b.prototype._readInt=function(e){var t=null,s=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:t=this._raw.getInt8(s);break;case 16:t=this._raw.getInt16(s);break;case 32:t=this._raw.getInt32(s);break;case 64:{const i=this._raw.getInt32(s),r=this._raw.getInt32(s+4);t=et(i).shiftLeft(32).add(r);break}}return this._cursor.offset+=e>>3,t};b.prototype._readUint=function(e){var t=null,s=this._cursor.offset-this._raw.byteOffset,i,r;switch(e){case 8:t=this._raw.getUint8(s);break;case 16:t=this._raw.getUint16(s);break;case 24:i=this._raw.getUint16(s),r=this._raw.getUint8(s+2),t=(i<<8)+r;break;case 32:t=this._raw.getUint32(s);break;case 64:{const o=this._raw.getUint32(s),l=this._raw.getUint32(s+4);t=et(o).shiftLeft(32).add(l);break}}return this._cursor.offset+=e>>3,t};b.prototype._readString=function(e){for(var t="",s=0;s<e;s++){var i=this._readUint(8);t+=String.fromCharCode(i)}return t};b.prototype._readTemplate=function(e){var t=this._readUint(e/2),s=this._readUint(e/2);return t+s/Math.pow(2,e/2)};b.prototype._readTerminatedString=function(){for(var e="";this._cursor.offset-this._offset<this._raw.byteLength;){var t=this._readUint(8);if(t===0)break;e+=String.fromCharCode(t)}return e};b.prototype._readData=function(e){var t=e>0?e:this._raw.byteLength-(this._cursor.offset-this._offset);if(t>0){var s=new Uint8Array(this._raw.buffer,this._cursor.offset,t);return this._cursor.offset+=t,s}else return null};b.prototype._readUTF8String=function(){var e=this._raw.byteLength-(this._cursor.offset-this._offset),t=null;return e>0&&(t=new DataView(this._raw.buffer,this._cursor.offset,e),this._cursor.offset+=e),t&&N.Utils.dataViewToString(t)};b.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength){this._root._incomplete=!0;return}switch(this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1?this._parseContainerBox():this._data=this._readData())};b.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)};b.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(b.parse(this))};b.prototype.append=function(e,t){N.Utils.appendBox(this,e,t)};b.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1)for(var e=0;e<this.boxes.length;e++)this.size+=this.boxes[e].getLength();return this._data&&this._writeData(this._data),this.size};b.prototype.write=function(){if(this._parsing=!1,!this._parent)throw new Error(`no root at ${this.type}`);switch(this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._parent._rawo||console.log(this.type),this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1)for(var e=0;e<this.boxes.length;e++)this.boxes[e].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size};b.prototype._writeInt=function(e,t){if(this._rawo){var s=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setInt8(s,t);break;case 16:this._rawo.setInt16(s,t);break;case 32:this._rawo.setInt32(s,t);break;case 64:this._rawo.setUint32(s,t.shiftRight(32).and(4294967295).toJSNumber()),this._rawo.setUint32(s+4,t.and(4294967295).toJSNumber());break}this._cursor.offset+=e>>3}else this.size+=e>>3};b.prototype._writeUint=function(e,t){if(this._rawo){var s=this._cursor.offset-this._rawo.byteOffset,i,r;switch(e){case 8:this._rawo.setUint8(s,t);break;case 16:this._rawo.setUint16(s,t);break;case 24:i=(t&16776960)>>8,r=t&255,this._rawo.setUint16(s,i),this._rawo.setUint8(s+2,r);break;case 32:this._rawo.setUint32(s,t);break;case 64:{this._rawo.setUint32(s,t.shiftRight(32).and(4294967295).toJSNumber()),this._rawo.setUint32(s+4,t.and(4294967295).toJSNumber());break}}this._cursor.offset+=e>>3}else this.size+=e>>3};b.prototype._writeString=function(e,t){for(var s=0;s<e;s++)this._writeUint(8,t.charCodeAt(s))};b.prototype._writeTerminatedString=function(e){if(e.length!==0){for(var t=0;t<e.length;t++)this._writeUint(8,e.charCodeAt(t));this._writeUint(8,0)}};b.prototype._writeTemplate=function(e,t){var s=Math.floor(t),i=(t-s)*Math.pow(2,e/2);this._writeUint(e/2,s),this._writeUint(e/2,i)};b.prototype._writeData=function(e){var t;if(e)if(this._rawo){if(e instanceof Array){for(var s=this._cursor.offset-this._rawo.byteOffset,t=0;t<e.length;t++)this._rawo.setInt8(s+t,e[t]);this._cursor.offset+=e.length}e instanceof Uint8Array&&(this._root.bytes.set(e,this._cursor.offset),this._cursor.offset+=e.length)}else this.size+=e.length};b.prototype._writeUTF8String=function(e){var t=N.Utils.utf8ToByteArray(e);if(this._rawo)for(var s=new DataView(this._rawo.buffer,this._cursor.offset,t.length),i=0;i<t.length;i++)s.setUint8(i,t[i]);else this.size+=t.length};b.prototype._writeField=function(e,t,s){switch(e){case"uint":this._writeUint(t,s);break;case"int":this._writeInt(t,s);break;case"template":this._writeTemplate(t,s);break;case"string":t==-1?this._writeTerminatedString(s):this._writeString(t,s);break;case"data":this._writeData(s);break;case"utf8":this._writeUTF8String(s);break}};b.prototype._boxProcessors.avc1=b.prototype._boxProcessors.avc2=b.prototype._boxProcessors.avc3=b.prototype._boxProcessors.avc4=b.prototype._boxProcessors.hvc1=b.prototype._boxProcessors.hev1=b.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1)};b.prototype._boxProcessors.ctts=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"sample_count","uint",32),this._procEntryField(e,"sample_offset",this.version===1?"int":"uint",32)})};b.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)};b.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"segment_duration","uint",this.version===1?64:32),this._procEntryField(e,"media_time","int",this.version===1?64:32),this._procEntryField(e,"media_rate_integer","int",16),this._procEntryField(e,"media_rate_fraction","int",16)})};b.prototype._boxProcessors.emsg=function(){this._procFullBox(),this.version==1?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1)};b.prototype._boxProcessors.free=b.prototype._boxProcessors.skip=function(){this._procField("data","data",-1)};b.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32)};b.prototype._boxProcessors.ftyp=b.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var e=-1;this._parsing&&(e=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",e,"string",4)};b.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)};b.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1)};b.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",this.version==1?64:32),!this._parsing&&typeof this.language=="string"&&(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode((this.language>>10&31)+96,(this.language>>5&31)+96,(this.language&31)+96)),this._procField("pre_defined","uint",16)};b.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",this.version==1?64:32)};b.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32)};b.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32)};b.prototype._boxProcessors.mp4a=b.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procSubBoxes("esds",1)};b.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",this.version==1?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32)};b.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8")};b.prototype._boxProcessors.prft=function(){this._procFullBox(),this._procField("reference_track_ID","uint",32),this._procField("ntp_timestamp_sec","uint",32),this._procField("ntp_timestamp_frac","uint",32),this._procField("media_time","uint",this.version==1?64:32)};b.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8)};b.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),this.flags&1&&this._procField("scheme_uri","string",-1)};b.prototype._boxProcessors.sdtp=function(){this._procFullBox();var e=-1;this._parsing&&(e=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",e,"uint",8)};b.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",this.version==1?64:32),this._procField("first_offset","uint",this.version==1?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,function(e){this._parsing||(e.reference=(e.reference_type&1)<<31,e.reference|=e.referenced_size&2147483647,e.sap=(e.starts_with_SAP&1)<<31,e.sap|=(e.SAP_type&3)<<28,e.sap|=e.SAP_delta_time&268435455),this._procEntryField(e,"reference","uint",32),this._procEntryField(e,"subsegment_duration","uint",32),this._procEntryField(e,"sap","uint",32),this._parsing&&(e.reference_type=e.reference>>31&1,e.referenced_size=e.reference&2147483647,e.starts_with_SAP=e.sap>>31&1,e.SAP_type=e.sap>>28&7,e.SAP_delta_time=e.sap&268435455)})};b.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16)};b.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,function(e){this._procEntryField(e,"ranges_count","uint",32),this._procSubEntries(e,"ranges",e.ranges_count,function(t){this._procEntryField(t,"level","uint",8),this._procEntryField(t,"range_size","uint",24)})})};b.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)};b.prototype._boxProcessors.stts=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"sample_count","uint",32),this._procEntryField(e,"sample_delta","uint",32)})};b.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"sample_delta","uint",32),this._procEntryField(e,"subsample_count","uint",16),this._procSubEntries(e,"subsamples",e.subsample_count,function(t){this._procEntryField(t,"subsample_size","uint",this.version===1?32:16),this._procEntryField(t,"subsample_priority","uint",8),this._procEntryField(t,"discardable","uint",8),this._procEntryField(t,"codec_specific_parameters","uint",32)})})};b.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8)};b.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",this.version==1?64:32)};b.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),this.flags&1&&this._procField("base_data_offset","uint",64),this.flags&2&&this._procField("sample_description_offset","uint",32),this.flags&8&&this._procField("default_sample_duration","uint",32),this.flags&16&&this._procField("default_sample_size","uint",32),this.flags&32&&this._procField("default_sample_flags","uint",32)};b.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(this.length_size_of_traf_num&48)<<4,this.reserved|=(this.length_size_of_trun_num&12)<<2,this.reserved|=this.length_size_of_sample_num&3),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(this.reserved&48)>>4,this.length_size_of_trun_num=(this.reserved&12)>>2,this.length_size_of_sample_num=this.reserved&3),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,function(e){this._procEntryField(e,"time","uint",this.version===1?64:32),this._procEntryField(e,"moof_offset","uint",this.version===1?64:32),this._procEntryField(e,"traf_number","uint",(this.length_size_of_traf_num+1)*8),this._procEntryField(e,"trun_number","uint",(this.length_size_of_trun_num+1)*8),this._procEntryField(e,"sample_number","uint",(this.length_size_of_sample_num+1)*8)})};b.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",this.version==1?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32)};b.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32)};b.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),this.flags&1&&this._procField("data_offset","int",32),this.flags&4&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,function(e){this.flags&256&&this._procEntryField(e,"sample_duration","uint",32),this.flags&512&&this._procEntryField(e,"sample_size","uint",32),this.flags&1024&&this._procEntryField(e,"sample_flags","uint",32),this.flags&2048&&this._procEntryField(e,"sample_composition_time_offset",this.version===1?"int":"uint",32)})};b.prototype._boxProcessors["url "]=b.prototype._boxProcessors["urn "]=function(){this._procFullBox(),this.type==="urn "&&this._procField("name","string",-1),this._procField("location","string",-1)};b.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8")};b.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16)};b.prototype._boxProcessors.vttC=function(){this._procField("config","utf8")};b.prototype._boxProcessors.vtte=function(){};b.prototype._boxProcessors.stco=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procFieldArray("chunk_offsets",this.entry_count,"uint",32)};b.prototype._boxProcessors.stsz=function(){this._procFullBox(),this._procField("sample_size","uint",32),this._procField("sample_count","uint",32),this.sample_size===0&&this._procFieldArray("entry_sizes",this.sample_count,"uint",32)};b.prototype._boxProcessors.stsc=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"first_chunk","uint",32),this._procEntryField(e,"samples_per_chunk","uint",32),this._procEntryField(e,"sample_description_index","uint",32)})};b.prototype._boxProcessors.stss=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procFieldArray("sample_numbers",this.entry_count,"uint",32)};b.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)};b.prototype._boxProcessors.Opus=function(){this._procFieldArray("reserved1",3,"uint",16),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channel_count","uint",16),this._procField("sample_size","uint",16),this._procFieldArray("reserved3",2,"uint",16),this._procField("samplerate","template",32),this._procSubBoxes("entries")};b.prototype._boxProcessors.dOps=function(){this._procField("version","int",8),this._procField("output_channel_count","uint",8),this._procField("pre_skip","uint",16),this._procField("input_sample_rate","uint",32),this._procField("output_gain","uint",16),this._procField("channel_mapping_family","uint",8),this.channel_mapping_family!==0&&(this._procField("stream_count","uint",8),this._procField("coupled_count","uint",8),this._procFieldArray("channel_mapping",this.output_channel_count,"uint",8))};b.prototype._boxProcessors.fLaC=function(){this._procFieldArray("reserved1",3,"uint",16),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channel_count","uint",16),this._procField("sample_size","uint",16),this._procFieldArray("reserved3",2,"uint",16),this._procField("sample_rate","template",32),this._procSubBoxes("entries")};b.prototype._boxProcessors.dfLa=function(){this._procFullBox()};b.prototype._boxProcessors.btrt=function(){this._procField("bufferSizeDB","uint",32),this._procField("maxBitrate","uint",32),this._procField("avgBitrate","uint",32)};const Hi=new Uint8Array([0,7,14,9,28,27,18,21,56,63,54,49,36,35,42,45,112,119,126,121,108,107,98,101,72,79,70,65,84,83,90,93,224,231,238,233,252,251,242,245,216,223,214,209,196,195,202,205,144,151,158,153,140,139,130,133,168,175,166,161,180,179,186,189,199,192,201,206,219,220,213,210,255,248,241,246,227,228,237,234,183,176,185,190,171,172,165,162,143,136,129,134,147,148,157,154,39,32,41,46,59,60,53,50,31,24,17,22,3,4,13,10,87,80,89,94,75,76,69,66,111,104,97,102,115,116,125,122,137,142,135,128,149,146,155,156,177,182,191,184,173,170,163,164,249,254,247,240,229,226,235,236,193,198,207,200,221,218,211,212,105,110,103,96,117,114,123,124,81,86,95,88,77,74,67,68,25,30,23,16,5,2,11,12,33,38,47,40,61,58,51,52,78,73,64,71,82,85,92,91,118,113,120,127,106,109,100,99,62,57,48,55,34,37,44,43,6,1,8,15,26,29,20,19,174,169,160,167,178,181,188,187,150,145,152,159,138,141,132,131,222,217,208,215,194,197,204,203,230,225,232,239,250,253,244,243]),Vi=new Uint16Array([0,32773,32783,10,32795,30,20,32785,32819,54,60,32825,40,32813,32807,34,32867,102,108,32873,120,32893,32887,114,80,32853,32863,90,32843,78,68,32833,32963,198,204,32969,216,32989,32983,210,240,33013,33023,250,33003,238,228,32993,160,32933,32943,170,32955,190,180,32945,32915,150,156,32921,136,32909,32903,130,33155,390,396,33161,408,33181,33175,402,432,33205,33215,442,33195,430,420,33185,480,33253,33263,490,33275,510,500,33265,33235,470,476,33241,456,33229,33223,450,320,33093,33103,330,33115,350,340,33105,33139,374,380,33145,360,33133,33127,354,33059,294,300,33065,312,33085,33079,306,272,33045,33055,282,33035,270,260,33025,33539,774,780,33545,792,33565,33559,786,816,33589,33599,826,33579,814,804,33569,864,33637,33647,874,33659,894,884,33649,33619,854,860,33625,840,33613,33607,834,960,33733,33743,970,33755,990,980,33745,33779,1014,1020,33785,1e3,33773,33767,994,33699,934,940,33705,952,33725,33719,946,912,33685,33695,922,33675,910,900,33665,640,33413,33423,650,33435,670,660,33425,33459,694,700,33465,680,33453,33447,674,33507,742,748,33513,760,33533,33527,754,720,33493,33503,730,33483,718,708,33473,33347,582,588,33353,600,33373,33367,594,624,33397,33407,634,33387,622,612,33377,544,33317,33327,554,33339,574,564,33329,33299,534,540,33305,520,33293,33287,514]);function Yi(e){let t=0;for(let s=0;s<e.length;s++)t=Hi[t^e[s]];return t}function Ki(e){let t=0;for(let s=0;s<e.length;s++)t=(t<<8^Vi[t>>8^e[s]])&65535;return t}function Gi(e,t,s){for(;;){const i=s&127;if(s>>=7,s===0){e.setUint8(t++,i);break}else e.setUint8(t++,i|128)}return t}function Zi(e){const t=new Uint8Array(1e4),s=new DataView(t.buffer,t.byteOffset,t.byteLength);s.setUint16(0,65528),s.setUint8(2,122);const i=e.pcms.length-1;if(i>7)throw new Error("Too many channels");s.setUint8(3,i<<4|8);let o=Gi(s,4,e.index);s.setUint16(o,e.blockSize-1),o+=2;const l=Yi(t.subarray(0,o));s.setUint8(o++,l);for(const g of e.pcms){s.setUint8(o++,2);let f=g[0],c=0,u=0;for(let d=0;d<e.blockSize;d++)u>=f.length&&(f=g[++c],u=0),s.setInt16(o,f[u++]),o+=2;c>0&&g.splice(0,c),u>0&&(g[0]=f.subarray(u))}const _=Ki(t.subarray(0,o));return s.setUint16(o,_),o+=2,{data:t.subarray(0,o),duration:e.blockSize/48e3}}function Xi(e){const t=new Uint8Array(38),s=new DataView(t.buffer);return s.setUint8(0,128),s.setUint8(1,0),s.setUint16(2,34),s.setUint16(4,e.blockSize),s.setUint16(6,e.blockSize),s.setUint16(8,0),s.setUint16(10,0),s.setUint16(12,0),s.setUint8(14,11),s.setUint8(15,184),s.setUint8(16,e.channelCount-1<<1),s.setUint8(17,240),s.setUint32(18,0),s.setUint32(22,0),s.setUint32(26,0),s.setUint32(30,0),s.setUint32(34,0),t}function Qi(e){const t=gt(e,"stbl"),s=gt(e,"mdhd");let i,r,o,l,_,g,f;for(const k of t.boxes)k.type==="stts"&&(i=k),k.type==="stsc"&&(r=k),k.type==="stco"&&(o=k),k.type==="ctts"&&(l=k),k.type==="stsz"&&(_=k),k.type==="stsd"&&(g=k),k.type==="stss"&&(f=k);if(!i||!r||!o||!_||!g)throw new Error("Missing required box");const c=[];let u=!1,d=0,S=0,U,x,A,T,C,W=-1,j=-1,M=-1,B=-1,q=0;for(let k=0;k<_.sample_count;k++){const D={idx:k,size:_.sample_size||_.entry_sizes[k]};if(S+=D.size,c.push(D),k===0?(U=1,x=0,A=r.entries[x].samples_per_chunk,T=0,D.chunkIdx=U,D.chunkRunIdx=x,x+1<r.entry_count?C=r.entries[x+1].first_chunk-1:C=1/0):k<A?(D.chunkIdx=U,D.chunkRunIdx=x):(U++,D.chunkIdx=U,T=0,U<=C||(x++,x+1<r.entry_count?C=r.entries[x+1].first_chunk-1:C=1/0),D.chunkRunIdx=x,A+=r.entries[x].samples_per_chunk),D.descriptionIndex=r.entries[x].sample_description_index-1,D.offset=o.chunk_offsets[D.chunkIdx-1]+T,T+=D.size,k>W&&(j+=1,W<0&&(W=0),W+=i.entries[j].sample_count),k>0){const z=c[k-1];z.duration=i.entries[j].sample_delta,d+=z.duration,D.dts=z.dts+z.duration}else D.dts=0;l?(k>=M&&(B+=1,M<0&&(M=0),M+=l.entries[B].sample_count),D.cts=D.dts+l.entries[B].sample_offset):D.cts=D.dts,f?k===f.sample_numbers[q]-1?(D.isSync=!0,u=!0,q++):D.isSync=!1:(D.isSync=!0,u=!0)}if(c.length){const k=c[c.length-1];k.duration=Math.max(0,s.duration-k.dts),d+=k.duration}return{mdhd:s,totalSize:S,samples:c,hasSyncSamples:u}}async function tr(e){const{decodeOpus:t,chunk:s,samples:i}=e,r=2048;let o=null,l=0;const _=[];function g(f=!1){if(!f&&l<r)return;const c=f?l:r,u=Zi({index:_.length,blockSize:c,pcms:o});l-=c,_.push(u)}for(const f of i){const{channelData:c,samplesDecoded:u}=await t(s.subarray(f.offset,f.offset+f.size));l+=u,o===null&&(o=Array.from({length:c.length},()=>[]));for(let d=0;d<c.length;d++)o[d].push(er(c[d]));g()}return g(!0),_}function er(e){const t=new Int16Array(e.length);for(let s=0;s<e.length;s++){const i=Math.max(-1,Math.min(1,e[s]));t[s]=i*32767.5-.5}return t}function sr(e,t){const{opusToFlac:s=!1}=t;let i,r;const o=es(de(e.fetch("ftyp")),de(e.fetch("moov"))),l=N.parseBuffer(o.buffer),_=l.fetch("ftyp");_.compatible_brands.includes("iso6")||_.compatible_brands.push("iso6");const g=l.fetch("moov");let f=-1;const c=[];for(let d=0;d<g.boxes.length;d++){const S=g.boxes[d];if(S.type==="mvhd"&&(S.duration=0,S.next_track_ID=2),S.type!=="trak")continue;const U=S;f=d,c.push(U);const x=[];let A=null;for(const T of U.boxes){if(T.type==="tkhd"){T.duration=0,A=T.track_ID,x.push(T);continue}if(T.type==="mdia"){const C=gt(T,"mdhd");C.duration=0;const W=gt(T,"stbl"),j=[];for(const M of W.boxes){if(M.type==="stts"){M.entry_count=0,M.entries=[],j.push(M);continue}if(M.type==="stsc"){M.entry_count=0,M.entries=[],j.push(M);continue}if(M.type==="stsz"){M.sample_size=0,M.sample_count=0,M.entry_sizes=[],j.push(M);continue}if(M.type==="stco"){M.entry_count=0,M.chunk_offsets=[],j.push(M);continue}if(M.type==="stsd"){if(s&&M.entries[0].type==="Opus"){const B=M.entries[0],q=B.entries[0];if(q.type!=="dOps")throw new Error("Invalid Opus box");const k=N.createFullBox("fLaC",M,-1);k.reserved1=[0,0,0],k.reserved2=[0,0],k.reserved3=[0,0],k.data_reference_index=B.data_reference_index,k.channel_count=q.output_channel_count,k.sample_size=16,k.sample_rate=48e3;const D=N.createFullBox("dfLa",k,-1);D._data=Xi({blockSize:4096/q.output_channel_count,channelCount:q.output_channel_count});const z=N.createFullBox("btrt",k,-1);z.bufferSizeDB=0,z.maxBitrate=48e3*16*q.output_channel_count,z.avgBitrate=z.maxBitrate/2,k.entries=[D,z],M.entries=[k],i=A,r={preSkip:q.pre_skip,channels:q.output_channel_count,streamCount:q.stream_count,coupledStreamCount:q.coupled_count,channelMappingTable:q.channel_mapping}}j.push(M);continue}}W.boxes=j,x.push(T)}}U.boxes=x}if(f===-1)throw new Error("No trak box found");const u=N.createFullBox("mvex",g,f+1);for(const d of c){const S=N.createFullBox("trex",u);S.track_ID=gt(d,"tkhd").track_ID,S.default_sample_description_index=1,S.default_sample_duration=0,S.default_sample_size=0,S.default_sample_flags=0}return{opusTrackId:i,opusInitOptions:r,data:new Uint8Array(l.write())}}async function ir(e){const{chunk:t,seq:s=0,timestamp:i=et.zero,decodeOpus:r,opusTrackId:o}=e,l=de(t),_=t.fetch("moov"),g=N.createFile(),f=N.createFullBox("moof"),c=N.createFullBox("mfhd",f);c.sequence_number=s;const u=[];let d=0;for(const A of _.boxes){if(A.type!=="trak")continue;const T=A,{mdhd:C,samples:W,totalSize:j,hasSyncSamples:M}=Qi(T),B=N.createFullBox("traf",f),q=N.createFullBox("tfhd",B);q.flags=131072,q.track_ID=gt(T,"tkhd").track_ID;const k=N.createFullBox("tfdt",B);k.version=1,k.baseMediaDecodeTime=i.multiply(C.timescale).divide(1e3);const D=N.createFullBox("trun",B);if(D.flags=3841,D.data_offset=0,o===q.track_ID){const z=await tr({decodeOpus:r,samples:W,chunk:l});D.sample_count=z.length,D.samples=z.map(G=>(d+=G.data.byteLength,{__data:G.data,sample_duration:Math.round(G.duration*C.timescale),sample_size:G.data.byteLength,sample_flags:2<<24,sample_composition_time_offset:0}))}else d+=j,D.sample_count=W.length,D.samples=W.map(z=>{let G=0;return M&&(z.isSync?G|=2<<24:G|=65536|1<<24),{__data:l.subarray(z.offset,z.offset+z.size),sample_duration:z.duration,sample_size:z.size,sample_flags:G,sample_composition_time_offset:z.cts-z.dts}});u.push(D)}const S=N.createFullBox("mdat");S.data=new Uint8Array(d);let U=0;const x=f.getLength();for(const A of u){A.data_offset=x+U+8;for(const T of A.samples)S.data.set(T.__data,U),U+=T.sample_size}return g.append(f),g.append(S),new Uint8Array(g.write())}const rr=(e,t=4294967295,s=79764919)=>{const i=new Int32Array(256);let r,o,l,_=t;for(r=0;r<256;r++){for(l=r<<24,o=8;o>0;--o)l=l&2147483648?l<<1^s:l<<1;i[r]=l}for(r=0;r<e.length;r++)_=_<<8^i[(_>>24^e[r])&255];return _},ze=(e,t=rr)=>{const s=T=>new Uint8Array(T.length/2).map((C,W)=>parseInt(T.substring(W*2,(W+1)*2),16)),i=T=>s(T)[0],r=T=>new DataView(s(T).buffer).getInt32(0,!0),o=new Map;[,8364,,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,,381,,,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,,382,376].forEach((T,C)=>o.set(T,C));const l=new Uint8Array(e.length);let _=!1,g=0,f,c=42,u=e.length>13&&e.substring(0,9)==="dynEncode",d,S=0,U;u&&(S=11,d=i(e.substring(9,S)),d<=1&&(S+=2,c=i(e.substring(11,S))),d===1&&(S+=8,U=r(e.substring(13,S))));const x=256-c;for(let T=S;T<e.length;T++){if(f=e.charCodeAt(T),f===61&&!_){_=!0;continue}if(f===92&&T<e.length-5&&u){const C=e.charCodeAt(T+1);(C===117||C===85)&&(f=parseInt(e.substring(T+2,T+6),16),T+=5)}if(f>255){const C=o.get(f);C&&(f=C+127)}_&&(_=!1,f-=64),l[g++]=f<c&&f>0?f+x:f-c}const A=l.subarray(0,g);if(u&&d===1){const T=t(A);if(T!==U){const C="Decode failed crc32 validation";throw console.error("`simple-yenc`\n",C+`
`,"Expected: "+U+"; Got: "+T+`
`,"Visit https://github.com/eshaz/simple-yenc for more information"),new Error(C)}}return A};function Y(){const e=Uint8Array,t=Float32Array;Y.modules||Object.defineProperties(Y,{modules:{value:new WeakMap},setModule:{value(s,i){Y.modules.set(s,Promise.resolve(i))}},getModule:{value(s,i){let r=Y.modules.get(s);return r||(i?r=WebAssembly.compile(ze(i)):(i=s.wasm,r=Y.inflateDynEncodeString(i).then(o=>WebAssembly.compile(o))),Y.modules.set(s,r)),r}},concatFloat32:{value(s,i){let r=new t(i),o=0,l=0;for(;o<s.length;)r.set(s[o],l),l+=s[o++].length;return r}},getDecodedAudio:{value:(s,i,r,o,l)=>({errors:s,channelData:i,samplesDecoded:r,sampleRate:o,bitDepth:l})},getDecodedAudioMultiChannel:{value(s,i,r,o,l,_){let g=[],f,c;for(f=0;f<r;f++){const u=[];for(c=0;c<i.length;)u.push(i[c++][f]||[]);g.push(Y.concatFloat32(u,o))}return Y.getDecodedAudio(s,g,o,l,_)}},inflateDynEncodeString:{value(s){return s=ze(s),new Promise(i=>{const r=String.raw`dynEncode0114db91da9bu*ttt$#UU3yzzss|yusvuy&4<054<,5T44^T44<(6U~J(44< ~A544U~6J0444545 444J0444J,4U4U7U454U4Z4U4U^/6545T4T44BU~64CU~O4U54U~5 U5T4B4Z!4U~5U5U5T4U~6U4ZTU5U5T44~4O4U2ZTU5T44Z!4B6T44U~64B6U~O44U~4O4U~54U~5 44~C4~54U~5 44~5454U4B6Ub!444~UO4U~5 U54U4ZTU#44U$464<4~B6^4<444~U~B4U~54U544~544~U5 U#UJU#5TT4U0ZTTUX5U5T4T4U#~4OU4U$~C4~54U~5 T44$6U\!TTT4UaT4<6T4<64<Z!44~4N4<U~5 4UZ!4U_TU#44UU6U~B$544$6U\!4U6U#~B44U#~B$~64<6_TU#444U~B~6~54<Y!44<_!T4Y!4<64~444~AN44<U~6J4U5 44J4U[!U#44UO4U~54U~5 U54 7U6844J44J 4UJ4UJ04VK(44<J44<J$4U~54U~5 4U~5!TTT4U$5"U5TTTTTTT4U$"4VK,U54<(6U~64<$6_!4< 64~6A54A544U~6#J(U54A4U[!44J(44#~A4U6UUU[!4464~64_!4<64~54<6T4<4]TU5 T4Y!44~44~AN4U~54U~54U5 44J(44J UA!U5U#UJU"UJU#U"JU#U"JT4UZTU5T4UZTU5T4UDZTU5T4U$[T44~UO4U~5 UU4U~U$.U5T4UP[T4U~4~UO4U~5 U#<U#<4U~U2$.UUN 44 ~UO4U~5 44!~UO4U~5 4U~4~UO4U~5 44J44J(U5 44U~J@44U~J<44UD~J844U~J44U$54U$5U54U$54U1^4U1^!4U~54U~5U54U~6U4U^/65T4T4U$54U~4BU~4O4U54U~5 UU'464U'_/54UU~5T4T4U~4BU~UO4U54U~5 U54U~4U~4U~U'$!44~5U5T44\T44U<~$6U\!4U#aT4U~4U~4O4U~5 U5U5U5TTT4U$"4YTU5 4U4~C5U5 U5U5444$4~64~\TU5 4U~4U~5T4Y!44O4U~54U~54U5 4CYTU5 4U~4U~4U~4$6TU54U\!44B4B~[!4U~4UD~4U~4U~4$6TU54U\!44B4B~[!44U<~4U4~$5 4U"U#$544"Y!454U^!44<J44<(J454U~84UN!#%'+/37?GOWgwU;U9$%& !"#`;Y.getModule(Y,r).then(o=>WebAssembly.instantiate(o,{})).then(({exports:o})=>{const l=new Map(Object.entries(o)),_=l.get("puff"),g=l.get("memory").buffer,f=new e(g),c=new DataView(g);let u=l.get("__heap_base");const d=s.length,S=u;u+=4,c.setInt32(S,d,!0);const U=u;u+=d,f.set(s,U);const x=u;u+=4,c.setInt32(x,f.byteLength-u,!0),_(u,x,U,S),i(f.slice(u,u+c.getInt32(x,!0)))})})}}}),Object.defineProperty(this,"wasm",{enumerable:!0,get:()=>this._wasm}),this.getOutputChannels=(s,i,r)=>{let o=[],l=0;for(;l<i;)o.push(s.slice(l*r,l++*r+r));return o},this.allocateTypedArray=(s,i,r=!0)=>{const o=this._wasm.malloc(i.BYTES_PER_ELEMENT*s);return r&&this._pointers.add(o),{ptr:o,len:s,buf:new i(this._wasm.HEAP,o,s)}},this.free=()=>{this._pointers.forEach(s=>{this._wasm.free(s)}),this._pointers.clear()},this.codeToString=s=>{const i=[],r=new Uint8Array(this._wasm.HEAP);for(let o=r[s];o!==0;o=r[++s])i.push(o);return String.fromCharCode.apply(null,i)},this.addError=(s,i,r,o,l,_)=>{s.push({message:i,frameLength:r,frameNumber:o,inputBytes:l,outputSamples:_})},this.instantiate=(s,i)=>(i&&Y.setModule(s,i),this._wasm=new s(Y).instantiate(),this._pointers=new Set,this._wasm.ready.then(()=>this))}function kt(e){function t(){}function s(M){throw M}for(var i=new Uint8Array(123),r=25;r>=0;--r)i[48+r]=52+r,i[65+r]=r,i[97+r]=26+r;i[43]=62,i[47]=63,kt.wasm||Object.defineProperty(kt,"wasm",{get:()=>String.raw`dynEncode01a36c6f98c83%y#6Ih-^*:8J#(3s/.*[v\z(oBMvm1I(&b?0=MPxA%T=} c0PN:QM_qA1k@6uk9F(Ac  )T=M]+aBc{!_#'.(hB\0E?s*i9)~Q6+=MlU<igW,$(mzq6"o1GwY$)(!j I,X_=M6JX>$F	M/=}WsF$9PsH03PWqC~}:ta/sdv[<x[0bRjzhqJ"'*034rv[B/9!rn5MEk5?7k,*drk4Vjooooal^=}MQ]Ql[g=M9	~3 9gGze	ulf	|Sot=z<h]9:#D3Le	[)hf?p9
Vn $%1rn:f+|;o:*W(J+vOb7<	[)oU89~3VN&vlGk&M6 6!^ vBL,Y+jLRekX\yF=1X1hQ^d@!G
 )+wyIOi;gR#'%fP S[Ec&0v\G-pSX-UQ<J#i"<o;6i|#mY	=$}
q_.}XixKQQK=MK8RM[@4(=M2 
'e3<&lw"j5i,{~OcWJXnrg/	lzdI~ j=Mv0A~DUn+mFiFU''^%np d)"~VYg}Q7"]eFZ0 v dc^i\	qd-|7{~UrV/wYF',nVcyi7e$ ~)&$d1G5S=M@=^=}QU:74t3?vs
A4e\WX2l<U{>f#pH5_r,=}7==T	qMa)_;T$k"b"l}"D:o5{6Nn?=M)~9* @kc$ne&^3/V"13H}oT{Z=j6_DKMw.tRcI!fuWwYYT I D=M5h=MtYn~e
ef1u)tpK*;;{Ot;pSo9<{	SS!<qVl>,(sU5-^SC%(%^}3I4}|
^h*{rzcTd<xOZ5?Lsk|L; -)rSXYWf{JA.pD LIoHI{/='+y3Mj:mP@,0	:>!\0%wAGi/XkK:PH_rrO8u=}8QR5y)P/!5Z#l;40R{W!U1{gTu&iF7zHTsCuPY$?*=Mq?N\d+iyzp(LvP~n:=kO~?Uh,a[SP,uNI<}:3; =@kj;@#G:W![>YyXvF?d!_o3)f(L~OM{^=Mu]6c$T@{I=M{d	=}8>LlUm(kx;Z+@XF@	h<FB+Q BG=hcWI
21R]r}^o'<<qNun%vu0lS% *5HV9O tn#heMKg=ML&67w+qEW+/M=}]z?H+'S [9j6%n38-1t)	,WGQ^P54wxv70FI,47-+Xdo6H=M.pU$7B)(=MO/k4,NHEzq,j[Ii[luBCsX{w+\;K@
M(Llvi?QP>fv;RMj\z-K{|xJt<a/}F|h_ Q%<g2(e3/m6Y/=s72r7 xIuhzY_1nf>Uc|zg}OU!%@mv9+Qc?'4c%%A'.Q0dSC%$p:(hLd<#h1X3.KqeH7u=q/<\iL$wGzEHY7RNBA8&.i? vch=DWmcl<|p7<#lsV3*5H]5Gqw,uhuJvJ?HL*,wB56T=}BWyM
[m)iM
e(78m}=w^kF#].'6"7*	U71\gkunH[[13.'5uCLBgaV3_vOqaUZ<-KsZ~\!^2^?*\RG+l)Df|]\x$4w9G AvpZX@@p	4z&j3=M=vgURWd/x+,ae*1vl
^m"@s# ;r[B- [a|>]6JHX@:{=}q!K "A=M=z*1z^5b*mZU ){
8ApG FE19bnX&>~1$5@a,'<i?2U;pw u f@2>y2LV^sY8,FQ<uDR.O lh%icU4Js|"VhejSqc5T^'l S#";R"sYY k 5wBYz
V9-[,\l
yh8@i1&q-b:|3d"YI_;UpCs]@D T\,"jif	hg> )[9),3=k@H79ywWB)*/#:%Ku3f@Z(M=M/}PCOCE?G(Mcp0YE$$IHXrpk%>n @-\?L}]Nqli3v3?r+4 )H}Q*8x(=M=}wf4FR!"\VT)jm8McFrH8[c@Jv
Tb!r~{%u3pC0wnP/{s5!f^"Qk5-Dh6 VGH#hdi\-3TE.[fLJ,KBF.Z*EV^
f#uY)PfZ	I2Ux4"BUR:eAAlD,[O0b){un\a?laP+ ?yw.3;+@>=}1vQ%n<_F!Z}"S');?LIH0#B#J=}"\?rp2q(=MYh x4_2gXP/_F|f*2 qcS
rQb.68W
gz**YbY,Z$ohdr #0^k\ umnxA5kmW,iL4aavw=M309WTn:-*bi%b	na
wz ~	/<4fP{}I1b=gM$7G=}sdP2UBeM&%T
5igee'"Ie$WK*E=M T	 oC7f*LBGWsnvw]0LQiK/	4tbU,2tppkJD7D8MLb?;$1\iJfAMCu)Ux}j4x%^q&]9F3+c60\7=My-)FF2g=}2H?.=MORl;U/ws:7p:ZL*wE#vShdJNqBJVAve7,@0PRC5a\}xr6poG_7dqwJ3|FKc+/N4J Vn=A,*=}o@b=MAf_JtSLI>Ix'=MCV^>V9-|CCt[
Fg7Wls,d%zjGI&)AeQ.:V$Po{]v,NXP8_#12u",4b"&Gz\g6&{cif5[=}#\e}~i~aN@v4Ll=}YEQ8_d*8Ma=M5nm'q\/+!4g,TN P0}[zZr)E;N$=ad;X\tI}TgrGu<rB}PB=}i5)Y.qSNaT,Bd'~h%tz{DW =M .ve6eRfhzLLRY"&z{4L.H41~dP lr*piz.a^/u?aelzZ>\=Hs1/=FeB{fU8gr4	 +@Y+1'{	1~F{M\5hL+;f4Rs++p\(KR{0;&e9l-Ez{D@Ct Hv#=1H/10X!L&[(h|g4Y~#'JdF4TbMSOr0pG]LUH<O"N+/#/]0DIH=Mk+v|.UK
F1c+$P7J>CKXN8G2g>}r.&Wq
6%!MU=}"Zj=}Y<upp6qf;	))%			^e	I!=MYNR@/mO(uWu!Vg5h8,Ar4Afge"Zz
i,kS%>6u
{rJ0qvHS8hmh<j
\r'mgB;9i{Rx+Tz
v[JZm[4}qR4f~ |195lK/=M0JNuMY4 #x|=>Z:nR{$* 2>%m QdP-
oJcNK)63W+nAWqs#F
6]c&:=}|<fe^	4#s^MY=M:uygmqErHY>?AXjb& 6yxH'+5pP*Gz7A)-	0BDmH +0GuRMGm/Y<go4H=}6-	s9u+,.0k5.&pz|Zdh<=!gaIC;|o~){P<F{De9?hB-
1WDPzjZ
aDM}O702?A,dOYTKm:hdUo}mwM!UxCGHFGfnk:e)ToHpcI#|&4qYwAE0x''=}D6j^p~Paw
N7~j:G H smm7-=}mi'p*K2V^%gg~l
o)k*cJ_ =MIj,KC}}Ps._ZN#G?UJejz(}g<68eK>$3s+]#[:J6@!U i{==}iU,m0cS$VN^7#v#I/Gu;0xNqJd-c;n	"QRsB|I }'C@/w+aAI2+1TOOz VTIn=}ga;v8\GTwaxh{dq_jJdGjyS{#*ST4~nvZmo	t]PJDwSTj%99{56#ySDvaw1j[28x8 EKv|Uhe(UYDSL_(4Ot=}w|8Hsfmc[DotPW]=}sKLV6kfx(&Azq1Q+j'A\BZd ;W*[$|ue&G{oaF=}C"|pzJ8D,eO2f:8O5\TFsP+#5[k0E{!W=M=Mx+G,?	htgw%uun/%=}PJKqCG=}S 7{8<<k e&f0&=}NhaT%5ldU|p &4^v2{h 7+xHdj@mh,f9P^"ewkWxW6?iCTN&pH5=M:dR,N:z4BZ@ 2it/FXOs0(R:zuw?d8\Q/9/p_2WGy3f8IV9I.\G =M9U+}J~@oq_>d1I=}=}I^p+k#ct(C=u+D=txtt>n*TPJz+9"2?]&KiNr/SLj{{OTd#{	c%ck{]j%61*fazd)O2%Px%ySc]uDG:$3&m=}J***1My61o*x~dScZj.=MeML\c>@f7~{
YQd0u&qaWg
1.{]1nne;DYRYjv-aR\=MVMANdYam+gHhI.@bLb%PPolIs,w/*%~@n4nN"-35<itQmJq'-:]R2yOIGY|1~n9\dQ~5fK\baozfnaZB:vn"glor1M%m_KJAkb)3L=q d]:}x--(=*fQ ]sFdmZ,^dH!7d=}6E
-/o=-P=MQDY\=}.s[rGJDob!S_pG	HT3ddvK[YMrcuOwPYM_n,%r\,rz%m:haMUNy=}vSbaPSNciFn;?]	si=}KS=}ahG|,f"'dN
3"A}U/.mIb5
mO [wm 3IL#W)_k4EKd%#4w: :;7wY|q7-
\o+V~QwD}KhD)djc0,};)jw3x|=I$xiKSL<m<o7q]o2
h=I)Mv*;v/oKE
FVV=}%ErYSHyG9*y9)!,5d/fV>6t
FtC5=xK	p=M(+~=M\:(5XV=MuS%$ik<d-o55o!Lt	+4LJfI:=}h\$8%?}^(;LG;1j#y:pQRE1WMG9uwG"}NfI%uzzoj)9C>ojy-Mw8,1B&!'!}u17HMm+	]oQp/<bC2|~dr<.:a4TCEmi3T7p#1_\mguiz$|LPzu][d=}+AqSc'u	81=}Y,2k#C.ea7G7D3l@xnN)]D!UgsMp9'B\#5Lkjy4[/R#In^PZm70]D\YRBA1F6."ff7J7!P=\Qzw%uUtI>_k!ORiX]GF	hbo	"_	'9M,Z*IOI&+1av]8u91Fc=M\#PCj&Y7TE:v&5I})S/ctvy.iu8I	>4vy%KiV@1 X3w,E
~FjWCGPcA,"s(\[1I8@nBK	tj5et~;d=M,?JuJ('>i7k:8g4HUHIh)H<OAJJ!}mW=M
zx=M/
N+v-I.'_Hhrr&% "uI%T%O vGmF7%2c=M;x/#g/}TIWtB(# I#Z3l*:P\J2M\jG=/qYT~FqnDRnd n,E?9+g){P :Omc|cSP{vD0aABA=3V,-sB/6W L\IhWB0z*/8Vu[flIG0=MFhmfB5lEPrsA"1n8x3'7-g&5F9	N[&WL{=}n=}fWI$1^1zF%Cd1
(JB~ok+]7<<2;,|Ry=}Cy<SgkAj,R]7YA7h?3(svpZWeWRG*
!N)SMk8AoUD
U^?AfF,N{+ILk=}|~T;V6iu=}UGa=Mh3	~c.}U7Z0@4f/<u/pk;8~0<XUnEgO#lO3:53j.6(To./s@LKt%#o3$'|.	iH/^*\;sySy]l~9wMnW}C,/&wP4nm62	jYhi)ljo/q9("{3-HDjIy2iVUS8O;QOPzYd?{(Z\f0'fm9^!62[UB+EP_v9pdp0],aVVT$#6@La:[T%xqADr#~=,BZ1@w;BH>,\gu+z#W:xHtLwNeG&w0A	Nhg[JK(M/o=}H>{N-pLG~%S|&48~3'tG90xDj0-6'"JbSBn%wf#i&=wC2t'!@m'qa$UjKkD2 Y$nNl bB2:Pbb!4!0Pi[O4*K1)Ek=Mgh,~p_ynTr_	0Zo&a%{g"+ jjvw]rdGqnxp<^L* O1LjK=">g':S>BqAsDs~KZ\I{$S6Ke am+Tfco~n_?zyGYNK]gvHb)'5Idj>W:ie=}kJ=}(+%9g?d(xo7s&Kl"zYkv#mO*sGR@3'M3.BB]=a~SQ9,x!@u50*! y!pVWvL4rIP26j!o-<ou@;|Y1H\t38n~;:qB@uJ>lQ5 
*j$^r\ \\Ml@1k+2(g+Y:X5%ji^u| QbO^[)t+J
%jfM@V2Mx9V8Na)4f#Tps!KPSMWq5#AJ'gdkza)IK6'Mj=M<TnVi=M&6hO]M6o
&C^X,nI]^zdIQHm5b 96i0}A+
Rli3^]R6iv)^\^UlPc"ZnGQm*L\@a	w@@Zr&b}5lr,uTfG?"
>]]|C*h&aX_[jz|#(BN \}Ba&WnG$GEC=}G9$p1A.\j=MV'Ns5Dh{+2-'U,sK-*uY(XXXn yF/EOmE@vqR(QLW;\bnl=M<aMUVU?{2^>Se[cqP*_kaUpv|fN^:7.6x7\<$s=M;t@d<Rz[l%m/HpyS;;g"s;=d 2STicQ.b/3i3o8uCj]$xOh.s~xUw3ZIFBs;!e-dej L"Rejj{ejjWyzbuiW202U6=}Ge3>_MR^ljs-g"lb]D_Ma dZa ?%JSy'tUDdM /W/<UL-t$tM-	"*RX_hJ2R"X LWofE4a	K)@e-n@;r\c$YNxHL)pI"T"H	7Io#'+5|ic@;MV7mxytF[8Y@(KlXSl+7 :=}r=}2/	"ur;r;zj1Boi4x	?P6,>9|,9QHf9UGoA)\|ZWB4i)VUJn{CQp{\3
WJ1"\K"5liI bD\F)_jk)"~p3]5(n5kY%zaTd=]V,XAG?
/$dX-Iq.i9hx;saetlWs+}]g.m-(-dJkI%i-j<3=sKDB*xgI&ATf+k6s^^H!x@mR0Yk4Q96}vO(G~qWrdS1]('+K<;-!5Fo@e+'.d.+lPrn7k*E(f*sIHLy}J4Di.}P{B0]&[6<xxrEa=MbKN|v+<Wugb:as@r< "kDlBX/n<7s-l|'d#[O">~\'K>^	0KDVQJ,Q'^x,YhuU=M"Ri@=Y8uL DEynV	(uMDphKS~Ge4pr#V.bI}C)K6VO*i@d7QHAgL-b4IH@Zo=}yK?GE:uD&&[hw:z|>Gmz ^4]XF	yWL Y 63t@-(\*vIHy%B=}kG=M[N9r.=62- N(Yd?%B=M(#>O]9=}Ji1z6.~C=}3C)!jSnS\ux<=]Qf*x &LJc2YfE7#?:h^..=M\/@ Yb\ua7vfopb_&rzlj$YNaf.p,&1IY=}x{]%zT6C1lPZ[1 +WzzNp!n!bK Y=e+wv\J>0?cc6A_dvrN2k<67z,	YHxDxZW>>(8),/>2:Gj*&"fDT50iV%:s88^V_|P~)Z
hKB9c/Zg&=J"hLeLK0nm~%Y D6[sno|de<a3I=}n0lp	'&qD,@q}bV&53_FzOm>qW%antx+~@'x0^w)WSoiFq<DNO%9Sro!U6^w^=}57=ifd:Awp khf/axr]sFWCc}h~1jly	iO1SZPoV# qo;j3w}4wLjgfO0n-? gi@HP-iU7 K_<UnHL5)[gR.^sI7\}~J1paQ,wJS.t/$bg9*[Aujr$cwoU{-Zn<77nyZr>Mj&aj3h<U"p)%;e;^0!8&Ve'=MS_Zv=2=k)U>'(]u?JMlkh]hmVzg[]U/Py045;:-6ce0CH=MTa*;6;mm7d,Wr!'CfEU6$?y^	+=M<7>9eXe"i|~i
=(zuRh|L
fcar@PNl@0lTV.P;e3OT]w<Q06lN5f|}IlNKLP60g5&tLK9D@VG~%cv
GDKfs /CXI @=0!K<>W-4	G{)L8?BPlrnya8_jGy./A;@F~R\g=V0:hF=M]{3 p<t? J(2X}}qXew}56vvn	v_ntO-t~d(6!Zhr/'u=}mRU+9r NtD\Gb0]utZk?<>L{Rhrdg_'gfUS 1jSJQ$=M_T_D+'J86A~)Bev>0Oj%NVhd4Q+BU"X Ba.'}_A17HDJvwS2%M3qC2	9=}] gs sl{ _K[e$xScBz,C6!r]?;f&	^a?]0B_b1oXh&"GsR
H Q}i7at e o=8	g(N Z\"7lKorvG7a*&<G44kDF.?64/{rzL0sZJN-6-_pr/[F](LJ|5(0k=/h]0h?=M
SHn];9XTpq=}gsK9X+n@5)'q@ /#(aVUo:r<ZrH}:_%&orI^smj7=M^M!d~~&h/ y3#'nEhs
)(q;LbaH	|d8D3MoXaF%E	#^[)O_#c	[Sl,@|r6@V[;r7$S#G S92eD?Mf.Y&S3s>tm+it DO'GJ9lR.33=.:oE>K<?m1q=MUU80Kx XQ3:II38<J%0q9P$_IF?-ud.hv$_GT43]Ttso^svtI\ZIn]x tR)xI(z?*'l5}Uyf%=_dR2^br$0$=:Jc@z>gNV1hQ=Qf4-8X,wm5*T8*$cmChSMrpp] U31l;s),YW~>Ghchk)dQGb%MlKj=}k:#H3\N>= 	U:.c9FS=}r\N1k."TW|;ZV]:0| C;\Y B~ #1bB|jj#_5 nZse$D_xxiST 4AkT=MfRG3\NQFN }?vX>bogV l2N9o/gK~Xh#|~+Ct~Ikbi3gK(5DVtWoX]m|F+.\OswR]6	 3_@bXT;xUq=Mq&O &l(e&J/
=}ZRTOjY4@U{\h'
h!LyOgyM0m|tkL2U~QoyT$]K\i)(Qe8Ov\GK)I-6qE]S5t91^ M@~ds=M_3uun\-=}X:i}}Ct:YU70jl#nO%6Nz1A(ARO ;5	a:N!0x*ljZIj59X)<o			9yW1j+)*p+&98MxDMHB6|T/FR-Hi=}VtIqXawB?loS)K&K.qT=M:4Bp=NstVM"a%*WqhoO3n;fFK-lg&JE+v=Q(6O+XTj8p_C;7/,|p8&QZ*.XY(.7M8|Z}CZvC;TK#Cw/erB4o3^!x?.K@MtF2/T=MY1-aF=_o% A_	uxO48%@z$0k-Hbt)tV2m/x_ ;<Asvkx7N5aFHz6^](l	_M/#y4<BN"Qu)K>Z~|8zLEjmr=Bus~ Fdcz]C)qy[Vox6W-40$Dot;V=$3dC2eiW[)a_w/Z,@_L<,[P-w=M
f'.i3>IT,=M__4#'D T}gF1t5WogD+39c,^Q=M:D
0ZxR1w1..=~5e)RivKBal!%%|~?uDx{N!ihCSxKVvQM"3-Lg#5-b,M{SJIo^z7R	EwHHN44D 4Mqp&j		=^=HON](: &h/7<I-)!P[6~gGhfI Rq-)N&Gx!5NG(W',&U$=}5{w#dJRw=}m}^
=eBtKbzur-"MFm6vt0sMUc4fT*f6MW3Y=M)hIW;gtk i	kkm/#1%dF XtC	|VA4'9%	m&9}UVqli:wS\aYfF\aUU-S'-
Z:rgK2<.}3hC7."v?PU2K,F9\K 	0.DEq-:m74F*^^o#O	3_|!vg'Sh-Py 5YIQxK#P4Kyw s*C@d*#SGK~\HMzL50S-L#UBN3tETpVt!CfFJ!"7$TO~Sw&|=M_	L\&=MD|>wkJ
zJ(ZAFJl-'gljAEN<-tJ=M[3*zn#8	]qP?Cnn=M0us x2avP^c=M|1W9
-?eG-)dnRP{!J[zM8zy(^mbp%7j[~R;&x^^+tk9w?#o"bjs\xf X'~S qiX[PTagSUNKeZXh3wX[*m	!(M+Zled}!"xB9BopJ":dUH*K{HhSAU@7<t/g*ywj
Wb:b[=}w:EhQ9W6zvuX/RDS-r!ZKCb=W!RUsf(V@z<H@('>([Z# )0z|F G{+7e	=}!.kg>X<}Wj%G@G|1Ee,*$x0g,t$4s;GL.@};F*=}o/jl=My[@'n?HQ9O(nk%9OU)k%O,H(D389}rbSOgdU{S<0\oc0dr3WXz=i_9mwvG{(Hn~*4^|*+K+	5
.wh/n';
YncK4u}rt:-/snKEi	405I*?EV*p+pNxH]VnoTM8x<n|llI- { D:]5\I3(0"i4U/ZcE:KXUVEQ4^z&*E|=MA:S(LiKoj%/YFu{2Xl2$R/	PXof?dyS3n8(Q5{
 mW~k'>Cq_H|Pz}ZS9yA?4OIOioB&Wl:x<ayaP3Dr:o&p=c!KQCKe9f	!1;fje<hqNYCp#'c(yCG?l{F8q)&!^QZYPA*f'C~Yv3'twyNxyQ%p\wG]mHQo:9EX|1qM@a4+[7drXuXm0}\5E3_70[cfQ	VJxn!\ulN-JmVg37D#\FxH=MnT~FVL*E-n#tzQl(E2K7&.+%MRyj-:(X#=M@l%j% 3G{9+z,{eZe+$[YT+[1f
2@5gi7;Ki_t8M%ek U08y7NmE7FoFH.Ui3K9VTr!!WIMvHD8](I	_CYG $$
JE~9-#dpR_jE].]bsPbY"y5HmdoKx*1tuS<RTewh|P;3e}6lhh6O=Mj,AWx^yyt5.;MGd8EiYBR$ 4+U~rAo{2TA3g6$1	mBg}<Qc;|"k nMwG\Pm7m12 s#s=}#'SaNh>_rvupC)]'[,	?=b\Ff,y%wS_+1VVx[EA6F5R
{d-R;&2,N32)QT {:~Vjdj1mAs&j=}bi_zL/](Fu(4&| >j*9* &&1mcaFCU"i *?		'+:<k#PZ +5xd/)+?~Lwzc;9Xro3
$Qh
;=}c Oe?kFPotT1LN{[Tc :RmkV /R>h=MNK'54w+w2v({),ETesuf;)=M>[8%HKWU9Rc/EvJYN%{9:~2o6]Dw4IR_.WsBTFn]@Q=BR#L"LT*NiB$,{9?%n)J%:
0,?jVNIMJJx%9Koc	3*4^O."cplh(SZ+ovhdejvy=	}=}<w]bU1Lw-02C@D=}M.qJP!TF*x8|kISBV~^;)83=M-y&a_;;A{D\z0,m4qRVYBFFdbVR*G$=M	qLejbG_>%+@cK%%+bO=}JZqN81|2?AQXl%'E>jc1 \ 9H]7 >>Gf0I873D]mr'[h7dQ.hT5 "	AhN=}2
sh5.hHgNhPs4Kp%'X\XsYAE^G))=}<T+D..jSb,HAJc~t|r#HaVjhHz>?^+*=MFRTT[Ff9Cs~w?AJMTR4
1j<1h&g,RM2Vlz  p(}J>tkJ"~3*"P_#7<4OT2r[UjfC:T14
*DgBMfo|ie;^]	 /\mm^I9l0O[D-N<+}yL*?$=}G"x&pBT?a?,S	^p'y(h\5Q),7N)J%KJ%WiD=>=M
2jr60;ibC&iREuYL_>"8[L#2:+"Ax[vkwN,-% /j<
=}^C|,p[?g=Miz]>YdsB$G-Ti0pIjY9c+2Dw'7Zd?+D\@z]E=ML$!4z=}nJl38i&b \gxxsU^;-m}r09_>N~7)3rc<Qwhb\?Aih#e,9 e(y;bDz*=M)C]&+nO n/Bmd%aK/ wZK8n!%m6'lHM8D3Z~{'Rt=t={tEjpa52<"a?3AuIL5IxIWn=}Z=MtcRt}GKaGH*4b5p22wC5[k02GQXD0:P=M
'9O_n8K[Sg='j282H2\-Q]{)=M tJQy=}Yj\=M 2<v0ha*}[Fr%{ziMs @^|_[yvuo4wocujT{t4wlsOZw)H{k>FoOu&;f) [2J(Zg' 8dFUo(AnR_u3b._rm:kU
UEhrj>3jW?VtGD3_\]bl2
![m<L]!;A{EyY:cwB0E""Zm*;q	krJ!C}he
V^2"s4 ,!/^m '#:GP C~^vz^i7IQ#UKo'8);-JD;CsY %-xo&vYKawd_g{=.nBxyFf-b=Ml-VV(A/\Wt'SM.2ShFkU_?[JIt?W{34A b8)D)<L,o{6cK={mR;
rc>zl93I1	=C=MXJx:i2JIt_k=}Lg/ ZIq9Ktl+B0O=Mb<]=}hG2=}dj9dSi ij/}Xd7] #W=Gfayjn=}:.26)8NEv>E6zG4p$/[|w;=erdQ4CA\=I!$~
48-JOG{}D5{NEJZC=}*SC3qa3/U|K<(4v8ptmf%E-(9o)H-mSNw^QFq 1]wJ<\-Wu6]R-%I3	nw,w!Ma A	t*=Wx-"SXZJUz]s>HNU 1igv[8GCUnL<TI2Fz/Aq_N=M/2@=}AwsGbacp7+RY(5#>;Kn'(YM(PDw15y4,<^YL\_'Tqk!p3)y)1jRinvZ-,zm,kHW 9CD4YL*\vKlHMWxY8PTECr>g-feGS_~zSzS}Y\MO3p3"BG!+o=MPyQ<9=MT) [ lE^dj\.[Ym |zpmJ5M-8-SRl%MEa5\Gws%~Hl&k<n=MLHxF0E~\[tNp'{g-%,#y]6[QRB:@&VOS<S
.W{5%*&P{r+o
{=}%G+0&P{2-{_=}d=}kb&4%DpN {^zqg.F-!$j4-89o<49Ky	GU&-)	=}#Ih#apkcqMW#LxW_>#Jrl#a	Q2;#@N8!@MD/!!Ay"bvP~V,N>"	RY"xpa]|?<dY"{E#YY=}n7m)]
JgZoL)pb	 E=}	7DIb8s3	Y=M9J~P$B="JU[~5.FN\"YM\yFt+
m'b<:h\@X TPq;y
"bR\>.lap6cnrq=}{[Ol!1("l&N{h7faz4-a qcU]g_Q.	]r:zca. '-3/yBw0j'9K|6 v2w4PFayDy;=}>EE Pz#<,@y! ]   2ct qAHM&Pe1!XOu^J82K8Ke]Fw}.Z]?S>ys[>UhnBpR*@h@7c)-I8w|&MM7NF$72&a.1n3B6K=k4ND[Ag^\MD_8MfT>b'[Lu^[3N]v(7UHe3(sQf+sR\RirpuC&ctJ+=}.H)XTGwcMK;F+YHQQRJNX;sqK^ >cy -(Dsbx:($E3Vz0QYwj:^vf9:5\K\[!P~_~wKGs6enn(Q+ {6j1.[mtp@=}'D2LeG_wcwKCThB8#u_UnIjZI3K4t7:<R\Z'FoEqWX:PaGPZ[B3fCd=}8\-IW-aJh	=M[gf1X3D!;-DOx}{7cH;|Lzi 84%,L}.9'=	#d	kDpmU>N	c/7aT>i8sp	k;JAf-o=}K2$ed*>yIeT.E^,~q$Gdb@QI
)"rAZm??(IK^	JK): ,'LHh8RkX?W<NYPX<:=MsQiw(N,>%x|wEa)"Px@Ynz=\LuM"* x) P]&Fu
ykw_%+'O?{*X+@k7l74
)"x}W~~EuVQB*L=}_V/32eg<&i&iivkhFMFW~SRZ$qt>0)k|$Nsc_*f>+5$u+).f+[/uk<A~\gC(/XOk9'wMjcK@7iI;i Z<)aC2]8d8ax.i4;mM_&}hMswI1?eNo*("/fTX?Z&=m1iRz<k*O\1?A{ES{wg\[b=}yb5UpcQJh=^YsZ
(t=:8)6{:PSatt;>8mocA{v)4c^?gC&7=}Rh;YTo^r6=}3Vbs,3J[ht5UX$.?\Sl~WpPd]*O8Sr<)C7BjD^CHJ*?{>E{FWZ?\K+0Hdzr#*YD)eE'uM|~_%;dJw4Z(z,|=M&| Rc hMb.)|.+J|j+oDKF8>pUIWH%wR$H=MYv[f5Rj{Obt 
&%MvMU@m1YA;B2diDD4x:NW.s-OBaKB>\su=}C:'?>zrz%Cs:$m }es&y;fbcf.E.r52}i"3ccm%	#hj::g"9Be[!62nAIO-n#U/Ei!w~Y~Y~YMuz}|fgdBNg%s oMbYt%Ofh	f5Oo(h=M-2w+4e$P@HGf(N3LKCos=M*	xYw?K+])DKgr*]BFI'F%%Zm*Ob&D
*@n+O^s!|>s(=}AQgKar^f)?!u_Ri=iif L!V jvw=Mux<nMM=TY!9098h2t$2:b2jq qoi||OLwU3+]T0	7bn&a=}G	]]Qq@1] <HX ,=[t%po?~qc}Y}98ibp^p p	}{W~xwx7v(s|KVg6
1~TG8+*qY/f~WX7[&T)u~lVJ E#-5;@H'BOr,($KC/ @b?%=}z]ZF0rW7!n&me:GO 3?zhAGQoOjs	L;y~llq{Wwi-erHrR=}.
+[13L8-58zmlP77AC6I+H~"6vm6J$s4guL- gdc=|xT*g6E7p)_rqo"	zX4.$3Whwqb0
*l(r>9Y]}^	zLNrP=9.b|o}r,mQ0
Yt?2 : azp}8?N1T0kaV
Q| >6_9 
{,@_:9K^	,_2}iErC=MT=M+Duy1[hr=})6udq7:pNI_y ZP@\xW|YHN r{paGn}r/]\F4OC{m"i] lT=VT 9'Wb> hF*j-]5$6Q}v?n{B[& *Gs=M* xg}.iA	A0:J5A'stn,5\k6,=M+N'ksmQ-v1.H*:5c(e<mEce{c:JU(+scz-_
*$R+ 3j;Zl5-+oF+mF<gu<%/cJ@g=k?z6KgH-l]+[zcCwAm:9JMAw'o#;C3Sj2w\N<p H'MqY0&xv)],>a$=Mv|z',z"qO?@}}1l	ZY=}-*("6S">|BL6OW=MvU\P%Yq=}?ao=G*%rX*^NbIq@o=}_4	!O"!4'?G]<4}P6,h,\JJ{JEDS	Dg}]DdKXMIK'AZmE-}0udxlk}'U[
ZO?aj|>? %mhG +0w$L	+}h'Y$c'10+qtd}2An^q&V}Q>G1
xIqKsw5s=
lA<NZB Dmq q}P5u7_LH1QV'BaPKo'9n^Ua&i5^r	:J"L:*o T& <2yv=}@	|!=M}{^q]N*yl
&m2$sy| o|uXWIT&r_8dqsddq=}4v-nMQ,0n8>^]TvEn?D(}Y}<}]n)vwmsY3" *IQ(|7A6/<.IZOj>I)qftMp,
!xJIdKQ:e1Qt $
Lb<Wu<nza'edClE!.y2GYf2^4J&58eCR#:hv&l0w 	 <uGb ?)7eRr95pE\w
M*7SLFM6GXr}']W6f#wUCPDR<d<X&,V-kN<1a-*_
M+g=>%yeiaT=;X+21}Gi	],7d;i}%0Z8rF;=aYC(]wF#*#wb8MQu[3l[Ml=M!QVK?fI|sn+53aCECJJl&{PpEgkoiW_i@W#d{KQa!#MAws=MwpF/QduAB	6){ZH4m
o6<<o#_QAi V~T%$sq,t8d/zbS;#s$7m 7o(lWlnA0avip?UXTu|2rn la??Wu|q7]=}AabPZ I93t!~5,:p
)A:QVMHv&
5%iF\
*kDw=G~o!3zrC BX8 &^p=}&"8Z8Q29e=\\o^A*]f%YhQr<
a=}_Kg!xiH(D*Jh,+3+MK+(vmZvD0VMl"]V^^+N]QRzg$bFV)=M=}Z_D$aq2 fVOHT=}NED+{bm64+<Gh%2F'Mc}UhO.OjD15BL2~N~4.4Ii/Kl=}' |9bi^}b;g1F,2<="h
2R.W'#D,J9#<TxKLg=MSnzMdaYZq}WcgT	~MA74:hL~0r}ZI-l.u6ezZc[Zw0AOZt4Tv/Tz=xI.b%{1wtw	{O{{~c7
0P@y**:I1sEk/w+"L,aCae q@C)~BsFaqBoZLDay-?+hC&BTMv+HqIW=^ =MFBXs0CZa=voWq
	gL4|6bP,.GGHsZ8\NEazzs\O_sTY\.y=d/iXCzZy$QFQg:]DaR@{jq'J"sCr4~mGr&U
4{ 6\l&g#wv=60{#|(@F   coKBBNP/QgsD
67OO0L$BtR)XH"zr:y|TX/4C?ORcz:7n)t.$Q)UX| .hX0O
2*EV)B"h]79aLsmQ1<H@*i~fa~p _%).hV|"
gIY !q=}T8=v!NmHL7YWu1qm\/Li<BXi}DNq\PME',b8vSXs(6Lx9Dr)et/hF~jG(\y_?
BWW&qYO~Y=T~Y~Y~Y6]/rLx!]@ dwz=MJiA,	v<lB(	nl=MyTg6LG6\H7XwvPWv=kFOnkimlynkqmlnkdmltn?kl?m?l|?nkhmlxnkpmlnkfmlvn_kn_m_l~_nkjmlznkrm=}<kI@<o	k9U?8O	4,6<6(80v@v&Tulypkqq2Tqrw1aJ?\"_;8p/u	LA	 o7@
m9	p,>|^J(RT~:{LH<@{|8O=M}[uA0$i
_tqMuw5QIXLP\=Mqa'4A-Mj=\xK4@vFXkO7:~!mF	S1O
;p	W,=M	>>9	+@~=}	^Fy^}vA "zrdw*}^1q=
?Ov?)Vrf\=MMIyw8}Rxf\ZLz^B3dfUkN58UIm "\bU$*Y&HZ{AtZ~@]]\qEAr\]h"]!9fB[  b^D&Z&h(dB:tbWSUH'J[=MYLHA]!^o%2DU2;D'e
!SFf3:;&#?f=ofDK#M#O'QR08P	(m9pxXR$\&2z%WZ$I&}$X*T}_'1=}}c xd_x^C}"Q3v0d91/ 8DHoiEsUKO0z,=}c.*)q3P]2c\FTT'#9Z*1x{af=}<A|<aI	9f[W\HX=}^$=tHMkcDC!$s
q I(S^C:y3qs*Kcc~c}e  '}"S&:*$ba7~_kYm53 'fvfwE cQLC $^0%&19;e'"'B2zMA7
d)Nl'=}d;yQ[?mSL+q4-LEX.aM>=}{M+%6AJN'MT7 B75	n[qD\?>Iz
Ej@E v]$^$P8@Nl9=MO z
Xqh)mWH ZH~~i{v6HjkRU)8=1z4w
 BPYrU~\Lmfzs84cR>
$yF#ec;%Ay 4~GgT|t'&rd{S=}E"vU/!pj}2i)4,M5O5Jj~}29:]-^Tak~S'75bzS a"M[Q@MD)LNsJj}|[|Q^
M^;Uq[~NR4b4"6W]4 sS=#S]3L4,;C}['V)l@>t=MvT0]VcE"98/ U<Z"fc]0hccC	x2CN&John5d!Ik	GfYdy^~V7r0=M|7Wr !~Bj!=}'Iw m9]<@]1HU)C]ZHU_5#I3vD,tnKr7-qO055P<nix1x F!B*4px=MuaW (_+/S[a~EI;3/9xg9xN?W8>
o:5zwYx iPM=vk:0(Lgi@GRBH?:VMY O;*N@=#fWjs9hH7YdH=M!~F1E%xGtMIKp=}+Pg#*#y|rCf{T+b,csp|2.aCsVJ. 9_lgG3OC%%_#3%Y'{}HZVkn.YVO?W1[g;SXi=}B<uQ(oJXcGM&]:	=1[pnwI%
ekDRPnG[+U?<N38yKbUwF*xHE1eY0yR *Q7!&\BTnP<_p	_'Pe]_yfZ.z5667[5(%*B6nUHta[boR-|z-7b1iS:"*2;9~AI{RZ^bkZEs|7^,a>@ #
VlY/b~Y~/V0{q)rwH4
s)h>%i=}rG}9ei]Yw.)=M1%rBEk0?UE8Z~S:{BjOR.ik
7FUC5umO}IFj"=;=}id@J%P8jbQ!	"6WW[PgUtT/W)F.W?8eAIG_X5N
L1R]r^7e:J*GOsSbSA	%d dbf."JpJKPB(-Fl=O(Y-b~LK75G?!5:JC5iQdnR)%W |>ktP71=}<?=7UV'(XiF!%0.jx.w'v.kE=+02VIeZ(@wB,C90{OoRoT @j>Sknfg2U\;n6tpcuI@jN|zvi>6tJ4)}y^A("^
]6<
h@dWj=MxvusB)tH!6J8'6:HS6/*99'vM(
:<cr:ygt
V9AhS[R'.7E[2y-OH42V00aHO
f;7dD7'@%%dos7!~+\ Jc}~W
Ng	k f* sfhIai.tXq6
=TPCMsh@V;|qDq\(r?s,>W\k"1O#aLy}V'"~E*jJ|Ey))i#s}p,y-O{ZEx%]jc?o{x=}vf'0=M(uo3"O]{=v;R:<6t,w64@x1vd{\j3) u-TOT
m2f\?N*|t[Fs
3vW<JLV2K4+s"g!jW"uwu*	vopQ=Kt.UA~~&Kp]NNr	@
M1o~$S=}A
}C%C#|Y~~Y~QV~Y~YXA_EJ~t~i#e_z}k{Oja9sPeT'%h\[T#GqH:5>V8c)[H
5k=}ku
jtKf~t6.e+=M6.<#T!K:N._va^bt<m>CJ>fM]UDuYn'(x mbCf>:=MU@w{pzAk_fQ7^"w}W!6|I%_))Ra%(B93u!Ag2hq9h 
Y6S	NW7bTLvp	v8Bmb,u/t01ez?JOa{4hEt@;9QV!USdsV~~Y0~Y~|V~<;E6rhH=MzL~~u#G5(>7,=MD\eQ3ZlUyG=U:6#zVn9/V}=}e$;Tcu7.Q4r=hEX:44LIq{}idI o\wp=MM\&QOZw|X)GkCi}ME[5u0sdL*|=
@yt2N>9BE/P;&~o)ZT4 fF@K^vc(~B? )%_Nb$Qt2!6S2,P@"/'(dA*YK2>M':XA%b8yK
y3B)AZg+Vdq2j@'3|-,aK]&*=M$
9'{HC(@&@TS R@>/3)87,amd-V Vn-/H)pna1=Mgy|QcTqavYY:yXeKA^F	9Ud+]_% F;iY~Y~Y<}Yz}q~YP<GrZUg) 6yil1_4-_AF59B7&><QiVM%%H,1}~G0F]En@Bsg]j	DoiGy72=MiaW>T9WZnfO\YH/|}+u!xG6N-??uN8]YeqDMpJS1uav23rA^0r3$t+ga*s^'fDm@6?k"d!B.?0"-	iT9w-A=.
Chz,<v6H6%o<=85iz<=
%Xk
'@(gVmqUm
)qlfB3rYa/XI=V(Or~?&-4F;np.H7*%8tq0nK $=}[%wMhRLIx*y 8=M\{,AxDUE1T7yy1J$GU!Sn>Mo>l	,	Bue}*Y)vq(7_&	3!X&BG"@XV.THRe z0FsyfJWZ:rafU.
!#w'3#U&ktT Er});vbek;<f@QB%CZ|[j/-L;m.F[-Aa#OcS#N_gO+% Q+6&:,;_XVo28hO	+LN='!7SV%jW%7L'H5E-,*	 &\-.aW74W63|ZfLR{@0{7P6zJ?AfV; qQM
T.8)a	4kURaqL9V'ho)::	_
$\lSC>q32(#o!ki+$O% >C%7[|w@c*{/v;=m*pL53nef1>VdUq'^<:3rJ|7UGer{!LI=MKd08V?d2#W.'i}9+$.m,zV4S\_H)$3^&%j-#f"V60J=}(FS\a%?A~]f<(y{ji$+*[}e>0;Jd(c}!sUQ*h>o/=}$-.]r#b%Se<B;kKRv(/l^z$t'?r#zv$]J.g;>Jx^KXm<Dy-C[CT4&F$~6G~1%j=MRM^!4zbRd-oC{]6r=MA}U\6_5,dL<wX3XXgdl)$jvu!>5@
q4+Q\7N1@^lV+<^,5yW8GQ\E/|GL]/TE_\4g5<4\ky V"6:\>RX4&Ib_>,=uopVolfoY/OX(g7q<qApP 4?77_xr}Rze V\*yy[mC"1>3p7,4 (q	4uC
2i'>:uxyCF^a-QG2Gt\b rueA8wp/XIW	=a*!VE=MZ;	BG
Kq=}RuL <(~OC4=MZK19G|]d0Nu"mxs2as=]c oEN~0U*2d "7j0f,xG%
My2\hiKs	pR<N$=}Q(}}V<1aK.bm({B+;*x8Ta"'87 )5{nOs*9;pyK:Jm{ /P	[,1oYk&_S~@X_.sP4*lD+E%3qW%jjr.gJ4k9L7@&aw\.WjSg4yj/r
 v(x?1p<;<(VS	<&\z\spfn[ 9p=3#6.2x?#}[cMToCT'42/9_;i*gM/h;4 8&ob+hpT[H$h!kf!pn%e	Dc;F[Wi#$H9hjFHpUdwpIlHfDL&5e2{x ,Tf)3fdS=McVk'$(2@Pu'dVh.::9%%?mZe=MbC/r){gz&F	ff[ qp#I~y?=MS=-^CI	9y/?:W^n+h8M'MJ5\55eJlYm9{z6u(K' nAo5X+T&4LtB<^IfS!y&,@(|ImeCLh@HiY28^7\q[<H/=}(
2&AAVUCn?K~PrH^MV-MZxF?-6n
k=M6LdX|IIiWd=}=P86"zswB:dK"*a|el{Jpc7H0Y O{+~xSxwbvx#~=M%sXB,;V{B\3*^8[T<*<BC-&StF'EyW1g~cT*,jS!D|?Vvcr
i	^|[-:QKnjKE-[#-x*T&-3W.su/v-h/'hRB.B_c"he$ w=MV]:'Sps=}Wm=7"fyx,+)8~c%$+^?Dl9pS)bS?-$SO=}3/Jp)'6yu~9SB4w6X,r-)Z37 , vR8sc}1ow._UIZ_eLl=}h=Mt(LM=M] {;Yrut%[E,y JAs-*yK&}v/v<+H(vr@4z&e|<dd(#E[RqodF] qf\4Kg2d^qi[8	xH?qf}{g2/| T.
#@~SY~Y~Y~Y~Y]
AV3O?OBq#c!cdK:"sgB5c'_p:n"rAb,*2rkgoemiq1
B#3K[GW/?%5M]IY1A$4L\HX0@bS[W?E-=}IYaT<H0@FV^Z	R{\)iJ	7yWoQB"bE$P

jbu.GZ0pP ZWIL& jcdbgY =.rL_"bA|#7UYT8f~Z/bBT_y>yt^3_LSX!zdxRv _i8bV |KmmmEE}C"""M9:F<S8MVVVIIc:~\/;Kxyy $zU|mY~yU~~|YR1)Yb[!o|Mc @%V=}AHOnn!C(jdueJ	
LNU11Pf~eo[n, _=M)355aD,*eg*		LU-~-o1H\< _5~i\
#;~}vI$])H=
/Zn49ZjlB<&,_F=}PiGF-@n-jo]~]L =)+Y.9IY*<(T_E5NPg=M!HPJnUywVX{ob5 \J
@%qW+q|nI.V3R#ahm^eOe?FF@r~,5tFZ.:rKT*Yi^gu=}g	Pfi=}mQT0AT
k>:g&|e"U[J&qUV;}Wce9v{&$<p[uO
uy?6F &0
{<UJ.2rLV:1qm[w=}w@f i)QX@AX
l;2{m-\J>'_Js=}/{~YXZpY><~Yaw5(Vl[o$Mn%7:s1s=2 >8pf!pWFxn*	ji)8.v,_LpR4uL*wA	Zf?x{"kB>8%ZE8A}Ya2IwlMkhG=MB--x{ /]=}e~Kj=M1eyGfb(Mb]^=M'O;?<ojluqmh=Mp xN4J^-as)hrh,&9a&=E|u-4qNXzDxYjRwn@Xdpq(b [rjJXVVtPxRWluAte'wV;C#$)$oE9p@nOl}|6=FPt/g5~yl?v I]j@qe;'pNfvS/f
;$'Rxi.5vPI}fW?I0v=}J+(i/DTioh/h>j1vTi oj3,_28H2XhpNrV -&S'#0&=MYf{^A
z|!PjQ|X^
z{@: 
z {: 
z{p. z|p> 
m* TlQ|8^
{x( B{x0 |x8 B|x@ 
:::::: ~ARX)XO{nA


	

VVVVVVVV:$l	U6DnUz ss tt uu vv ww xx yy z
#{'	{+I{/{3|7	)BY)$WI_r?pro:"l!|*'(
)jgh
iJ*4u#q0yURnR\ArU2lAURnVrpAV2g2,hR .*ir0jj u*u:2uJruZvjvzY~2vrv9C%J"W#+*a+2,:a,B-:Ja-ZR.zZa.b/ja/r0za01:a1Z2za2k*bk2!<bo
@r!=}pJPz!>bp=!?q:prtvxz|~^$cY~Y~Y~Y~Y'mP^uMO=mNP\qD-}D/=}C2D.x8 K7=MJ:=MI6!LJ8-O/VrWrl>56@3M	>
U	=}aI>Q6FPomHUmRbRabbgVjUfOVh9fphZNWnPX|PW^SddsdE-Y.I.]-wese0i{0};/m0g1c~Y~YflQE6/rW}l ytj2[":l]Kt$Y>$MlSP
 lT[hJD /<8932=}e7U)_v)stInXIBjHBMJwPD",PmJ1LFzTg(K:BL9UP6m|lm!00O/~{=}j}.wVA6rA0E <E&j
~Y\bV~YK~	~^0MYBT*^\? Z9eSkU<.24<k:k
"z0"as x>n7
mu0q&&W:Y0Y0/)z-hLEEWuJxLr6/.u(E8= 66p"}IPC.]y#U;l2HhlT<yz<rLQKKx@w>JTDqqXf>wZ)j.6;-?LNO=}An ?=}OOO*JqyzHP?<&P=a'k$p! !p!$1OI;@O;g#ETO$@:(>z0RHN=M	

R>Xz t\+| XPQVJ+Y9Z}@=cA'pCA^5)t[zHQ!+pqE'Z2{rnwY\7Ta"yRSIbmiZ=M2]qG}`});var o,l;function _(){var M=l.buffer;o=new Uint8Array(M)}function g(M){return Math.cos(M)}function f(M){return Math.exp(M)}var c=(M,B,q)=>o.copyWithin(M,B,B+q),u=M=>{s("OOM")},d=M=>{o.length,u()},S={b:g,a:f,c,d};function U(M){M.f()}var x={a:S},A,T,C,W,j;this.setModule=M=>{e.setModule(kt,M)},this.getModule=()=>e.getModule(kt),this.instantiate=()=>(this.getModule().then(M=>WebAssembly.instantiate(M,x)).then(M=>{const B=M.exports;A=B.g,T=B.h,C=B.i,W=B.j,j=B.k,l=B.e,_(),U(B),t()}),this.ready=new Promise(M=>{t=M}).then(()=>{this.HEAP=l.buffer,this.malloc=T,this.free=j,this.opus_frame_decoder_create=A,this.opus_frame_decode_float_deinterleaved=C,this.opus_frame_decoder_destroy=W}),this)}function at(e={}){at.errors||Object.defineProperties(at,{errors:{value:new Map([[-1,"OPUS_BAD_ARG: One or more invalid/out of range arguments"],[-2,"OPUS_BUFFER_TOO_SMALL: Not enough bytes allocated in the buffer"],[-3,"OPUS_INTERNAL_ERROR: An internal error was detected"],[-4,"OPUS_INVALID_PACKET: The compressed data passed is corrupted"],[-5,"OPUS_UNIMPLEMENTED: Invalid/unsupported request number"],[-6,"OPUS_INVALID_STATE: An encoder or decoder structure is invalid or already freed"],[-7,"OPUS_ALLOC_FAIL: Memory allocation has failed"]])}}),this._init=()=>new this._WASMAudioDecoderCommon(this).instantiate(this._EmscriptenWASM,this._module).then(c=>{this._common=c,this._inputBytes=0,this._outputSamples=0,this._frameNumber=0,this._input=this._common.allocateTypedArray(this._inputSize,Uint8Array),this._output=this._common.allocateTypedArray(this._outputChannels*this._outputChannelSize,Float32Array);const u=this._common.allocateTypedArray(this._channels,Uint8Array);u.buf.set(this._channelMappingTable),this._decoder=this._common.wasm.opus_frame_decoder_create(this._sampleRate,this._channels,this._streamCount,this._coupledStreamCount,u.ptr,this._preSkip,this._forceStereo)}),Object.defineProperty(this,"ready",{enumerable:!0,get:()=>this._ready}),this.reset=()=>(this.free(),this._init()),this.free=()=>{this._common.free(),this._common.wasm.opus_frame_decoder_destroy(this._decoder),this._common.wasm.free(this._decoder)},this._decode=c=>{if(!(c instanceof Uint8Array))throw Error("Data to decode must be Uint8Array. Instead got "+typeof c);this._input.buf.set(c);let u=this._common.wasm.opus_frame_decode_float_deinterleaved(this._decoder,this._input.ptr,c.length,this._output.ptr),d;return u<0&&(d="libopus "+u+" "+(at.errors.get(u)||"Unknown Error"),console.error(d),u=0),{outputBuffer:this._common.getOutputChannels(this._output.buf,this._outputChannels,u),samplesDecoded:u,error:d}},this.decodeFrame=c=>{let u=[];const d=this._decode(c);return d.error&&this._common.addError(u,d.error,c.length,this._frameNumber,this._inputBytes,this._outputSamples),this._frameNumber++,this._inputBytes+=c.length,this._outputSamples+=d.samplesDecoded,this._WASMAudioDecoderCommon.getDecodedAudioMultiChannel(u,[d.outputBuffer],this._outputChannels,d.samplesDecoded,this._sampleRate)},this.decodeFrames=c=>{let u=[],d=[],S=0,U=0;for(;U<c.length;){const x=c[U++],A=this._decode(x);u.push(A.outputBuffer),S+=A.samplesDecoded,A.error&&this._common.addError(d,A.error,x.length,this._frameNumber,this._inputBytes,this._outputSamples),this._frameNumber++,this._inputBytes+=x.length,this._outputSamples+=A.samplesDecoded}return this._WASMAudioDecoderCommon.getDecodedAudioMultiChannel(d,u,this._outputChannels,S,this._sampleRate)},this._isWebWorker=at.isWebWorker,this._WASMAudioDecoderCommon=at.WASMAudioDecoderCommon||Y,this._EmscriptenWASM=at.EmscriptenWASM||kt,this._module=at.module;const t=8,s=c=>typeof c=="number",i=e.sampleRate,r=e.channels,o=e.streamCount,l=e.coupledStreamCount,_=e.channelMappingTable,g=e.preSkip,f=e.forceStereo?1:0;if(r>2&&(!s(o)||!s(l)||!Array.isArray(_)))throw new Error("Invalid Opus Decoder Options for multichannel decoding.");return this._sampleRate=[8e3,12e3,16e3,24e3,48e3].includes(i)?i:48e3,this._channels=s(r)?r:2,this._streamCount=s(o)?o:1,this._coupledStreamCount=s(l)?l:this._channels-1,this._channelMappingTable=_||(this._channels===2?[0,1]:[0]),this._preSkip=g||0,this._forceStereo=r<=t&&r!=2?f:0,this._inputSize=32e3*.12*this._channels,this._outputChannelSize=120*48,this._outputChannels=this._forceStereo?2:this._channels,this._ready=this._init(),this}function We(e,t,s){return Math.min(s,Math.max(t,e))}const bt=self,Nt=new Map;bt.pendingStreams=Nt;const _e=new Map,Ht=new Map,ue=8e3,nr=1e4,or=5e3,ar=1e3,je=3e4,cr=5e3,Je="video/mp4",lr="application/vnd.apple.mpegurl";function ur(e){return e<0?1e3<<-e:1e3>>e}class hr{constructor(t,s){this.call=t,this.accountNumber=s,this._generation=0,this._retryCount=0,this._destroyed=!1,this._controllers=new Set,this._waitingForBuffer=new Set,this._timeouts=new Set,this._hlsWaitingForBuffer=[],this._hlsWaitingForChunk=new Map,this._pendingRejects=[],this.destroy=(i=new Error("destroyed"))=>{this._log("destroying rtmp stream",i),Nt.delete(this.call.id),this.clearClock(),this.clearDeadTimeout();for(const r of this._timeouts)clearTimeout(r);this._opusDecoder!==void 0&&this._opusDecoder.free();for(const r of this._controllers)r.close();for(const r of this._waitingForBuffer)r.close();for(const r of this._pendingRejects)r(i);this._destroyed=!0,this._generation=0,ye("rtmpStreamDestroyed",this.call.id)},this.onHlsTimeout=()=>{const i=this._log.bindPrefix("onHlsTimeout");if(i("hls playlist refetch timeout"),this._hlsWaitingForBuffer.length||this._hlsWaitingForChunk.size){i("still active (some fetch is pending)"),this.setDeadTimeout(this.onHlsTimeout,je);return}i("destroying due to inactivity"),this.destroy()},this.decodeOpus=this.decodeOpus.bind(this),this._log=Q("RTMP-"+(Date.now()+"").slice(-2)),this._log("constructor",t.id)}updateRtt(t){this._rtts.push(t)>10&&this._rtts.shift()}maybeAdjustBufferSize(){if(this._rtts.length<3)return;const t=this._log.bindPrefix("maybeAdjustBufferSize"),s=this._rtts.reduce((r,o)=>r+o,0)/this._rtts.length,i=Math.ceil(We(s*3,ue,nr)/this._chunkTime);if(t(`avg rtt=${s} target buffer size=${i}`),i!==this._bufferSize){const r=i-this._bufferSize;this._cutoff=this._cutoff.minus(this._chunkTime*r),this._bufferSize=i,t(`adjusted buffer size to ${i}`)}}async processChunk(t,s){return t?ir({chunk:t,seq:s,timestamp:et(s).multiply(this._chunkTime),opusTrackId:this._initChunk.opusTrackId,decodeOpus:ct&&this.decodeOpus}):new Uint8Array(0)}async fetchChunk(t,s){const i=this._log.bindPrefix("fetchChunk-"+t.toString());if(t.isNegative()){i.warn("negative time");return}if(!s&&this._lastRequestedTime!==void 0&&t.lesserOrEquals(this._lastRequestedTime)){i.warn("last requested time is greater or equals",this._lastRequestedTime.toString());return}this._lastRequestedTime=t,i(`starting fetch time=${t}`);const r=Date.now(),o=await J.invoke("requestRtmpPart",{dcId:this._dcId,accountNumber:this.accountNumber,request:{_:"inputGroupCallStream",call:this.call,time_ms:t.toString(),scale:this._scale,video_channel:qe,video_quality:ji}}),l=Date.now()-r;if(this.updateRtt(l),i(`ended fetch time=${t}, rtt=${l}`),!o){i.warn("no bytes");return}if(o.container!=="mp4")throw new Error("Invalid container");return N.parseBuffer(o.bytes.slice(o.contentOffset).buffer)}async generateInitChunk(t){this._initChunk||(this._initChunk=sr(t,{opusToFlac:ct}),this._initChunk.opusInitOptions&&await this.initOpusDecoder(),this._retryCount=0)}async initOpusDecoder(t=!1){if(this._decoderInitPromise){await this._decoderInitPromise;return}this._log("creating opus decoder"),this._opusDecoder!==void 0&&!t&&this._opusDecoder.free();const s=new at(this._initChunk.opusInitOptions);this._decoderInitPromise=s.ready,await this._decoderInitPromise,this._opusDecoder=s,this._log("opus decoder created")}async decodeOpus(t){return this._opusDecoder===void 0&&await this.initOpusDecoder(),this._opusDecoder.decodeFrame(t)}hasEnoughBuffer(){return!!this._initChunk&&this._bufferSize&&this._buffer.some(t=>!!t.segment)}sendBufferToController(t){this._log("sending buffer to controller"),t.enqueue(this._initChunk.data);for(const s of this._buffer){if(!s.segment)break;t.enqueue(s.segment)}}removeStaleChunks(){do{const t=this._buffer[0];if(t&&t.time.lt(this._cutoff))this._buffer.shift(),this._log("removing stale chunk",t.time.toString());else break}while(!0)}async _replenishBuffer(t=1,s=this._lastReplenishingPromise){const i=this._log.bindPrefix("replenishBuffer-"+this._replenishTempId++);this.removeStaleChunks();const r=this._generation,o=We(this._bufferSize-this._buffer.length,0,t);if(!o){i("skipping replenish - buffer full");return}const l=()=>this._destroyed||this._generation!==r,_=this._lastRequestedTime,g=[];i(`replenishing buffer chunksToFetch=${o} lastBufferedChunkTime=${_} bufferLength=${this._buffer.length}`);for(let c=1;c<=o;++c){const u=_.add(this._chunkTime*c),d={time:u};this._buffer.push(d);const S=async U=>{try{d.iso=await this.fetchChunk(u,U)}catch(x){i("error",x.type,u.toString());const A=async T=>{if(await Ct(T),!l())return S(!0)};if(x.type==="TIME_TOO_BIG"){if(U)throw new Error("stream ended");const T=await this.fetchState();if(l())return;const C=this.findChannel(T),W=u.minus(et(C.last_timestamp_ms)).add(this._chunkTime).toJSNumber();if(W<0)throw new Error("stream ended");return A(W)}else throw x}return d};g.push(S())}let f=await Promise.all(g);if(!l()&&(this.maybeAdjustBufferSize(),await s,!l())){if(f=f.filter(c=>c.time.gt(this._lastFlushedTime)),!f.length){i.warn("skipping flush - no new chunks");return}if(this._lastFlushedTime.notEquals(et.zero)&&f[0].time.minus(this._lastFlushedTime).notEquals(this._chunkTime)&&i.error(`chunks are not continuous, lastFlushed=${this._lastFlushedTime.toString()}, newChunks=${f[0].time.toString()}`),this._lastFlushedTime=f[f.length-1].time,f=f.filter(c=>c.iso?!0:(this._log.error("empty chunk?",c),!1)),ct){for(const c of this._hlsWaitingForBuffer)c();this._hlsWaitingForBuffer.length=0;for(const c of f){await this.prepareChunkForFlushing(c);const u=this._hlsWaitingForChunk.get(c.seq)||[];this._hlsWaitingForChunk.delete(c.seq),i(`sending chunk to waiters time=${c.time} seq=${c.seq}`);for(const d of u)d(c.segment)}}else{for(const c of f){await this.prepareChunkForFlushing(c),i(`sending chunk to controller time=${c.time} seq=${c.seq}`);for(const u of this._controllers)u.enqueue(c.segment)}for(const c of this._waitingForBuffer)this.sendBufferToController(c),this._controllers.add(c);this._waitingForBuffer.clear()}i("buffer replenished")}}replenishBuffer(...t){const s=this._lastReplenishingPromise,i=this._lastReplenishingPromise=(async()=>{const r=this._replenishBuffer(...t);try{const o=await r;return await s,o}catch(o){throw o}})();return this._bufferSize-this._buffer.length>0&&this._lastRequestedTime.geq(et.zero)?Promise.all([i,this.replenishBuffer()]).then(()=>{}):i}async prepareChunkForFlushing(t){this._initChunk||(this._log(`will add init chunk to time=${t.time.toString()}`),await this.generateInitChunk(t.iso));const s=this._lastChunkSeq++;t.seq=s,t.segment=await this.processChunk(t.iso,s)}async fetchState(){const t=H();let s=0,i;const r=()=>{if(s>3){t.reject(new Error("Failed to fetch state"));return}i&&(clearTimeout(i),this._timeouts.delete(i)),i=bt.setTimeout(()=>{s++,r()},1e3),this._timeouts.add(i),J.invoke("requestRtmpState",{call:this.call,accountNumber:this.accountNumber}).then(o=>{clearTimeout(i),t.resolve(o)}).catch(o=>{this._log.error("error fetching state",o),s++,r()})};return r(),t}clearClock(){clearInterval(this._clock),this._clock=void 0}setClock(){const t=this._log.bindPrefix("clock"),s=this._clock=bt.setInterval(()=>{this._time=this._time.add(this._chunkTime),this._cutoff=this._cutoff.add(this._chunkTime),this.notifyTime(),t(`tick ts=${this._time.toString()} cutoff=${this._cutoff.toString()}`),this.replenishBuffer().catch(i=>{this._destroyed||this._clock!==s||(t.error("error replenishing buffer",i),this._buffer.some(r=>r.segment)||this.handleError(i))})},this._chunkTime)}findChannel(t){const s=t.channels.find(i=>i.channel===qe);if(!s)throw R.error("no unified channel found",t),new Error("No unified channel found");return s}async _start(){const t=this._log.bindPrefix("start");t(`starting ${this.call.id} generation ${this._generation} -> ${this._generation+1}`,this),this.clearClock(),this._initChunk=void 0,this._lastChunkSeq=0,this._buffer=[],this._lastFlushedTime=et.zero,this._replenishTempId=0,this._lastReplenishingPromise=Promise.resolve(),this._rtts=[];const s=++this._generation,i=()=>this._generation===s&&!this._destroyed,[r]=await Promise.all([this.fetchState(),Ht.get(this.call.id)&&Ct(Math.max(0,Ht.get(this.call.id)-Date.now()))]);if(!i())return;Ht.delete(this.call.id);const o=this.findChannel(r);if(t(`started, last_ts=${o.last_timestamp_ms}, scale=${o.scale}`),this._time=et(o.last_timestamp_ms).minus(ar),this._lastRequestedTime=this._time,ct){const l=_e.get(this.call.id);l&&l.gt(this._time)&&(this._time=l)}this._cutoff=this._time.minus(ue),this._scale=o.scale,this._chunkTime=ur(this._scale),this._bufferSize=Math.ceil(ue/this._chunkTime),this._dcId=r.dcId,this.notifyTime(),this.setClock(),await this.replenishBuffer(Math.ceil(or/this._chunkTime))}start(){this._start().catch(t=>this.handleError(t))}notifyTime(){ct&&_e.set(this.call.id,this._time),ye("rtmpStreamTime",{callId:this.call.id,time:this._time.toString()})}handleError(t){if(this._destroyed)return!1;const s=this._log.bindPrefix("handleError");if(typeof t=="object"&&t&&typeof t.type=="string"){if(t.type.startsWith("FLOOD_WAIT")){const i=+t.type.split("_").pop();return Ht.set(this.call.id,Date.now()+i*1e3),this.start(),!0}if(t.type==="TIME_TOO_SMALL"||t.type==="TIME_INVALID")return s("rtmp stream need resync",t),this.start(),!0;if((t.type==="GROUPCALL_FORBIDDEN"||t.type==="VIDEO_CHANNEL_INVALID")&&this._retryCount<3)return s("retrying rtmp stream",t),this._retryCount+=1,this.start(),!0}s("rtmp stream error",t),this.destroy(t)}createStream(){const t=this._log.bindPrefix("createStream");let s;return new ReadableStream({start:i=>{t(`added rtmp stream controller call=${this.call.id} gen=${this._generation} destroyed=${this._destroyed}`),s=i,this._generation===0&&this.start(),this.clearDeadTimeout(),this.hasEnoughBuffer()?(this.sendBufferToController(i),this._controllers.add(i)):this._waitingForBuffer.add(i)},cancel:()=>{this._destroyed||(t("rtmp stream controller died",this.call.id),this._controllers.delete(s),this._waitingForBuffer.delete(s),this._controllers.size||this.setDeadTimeout(this.destroy,cr))}})}clearDeadTimeout(){this._deadTimeout&&(clearTimeout(this._deadTimeout),this._deadTimeout=void 0)}setDeadTimeout(t,s){this.clearDeadTimeout(),this._deadTimeout=bt.setTimeout(t,s)}generateHlsPlaylist(t,s=!1){const i=this._chunkTime/1e3,r=["#EXTM3U","#EXT-X-VERSION:7",`#EXT-X-TARGETDURATION:${Math.ceil(i)}`,`#EXT-X-MEDIA-SEQUENCE:${this._buffer[0]?.seq??0}`,"#EXT-X-INDEPENDENT-SEGMENTS",`#EXT-X-MAP:URI="${t}?hls=init"`];for(const o of this._buffer){if(!o.segment)break;r.push(`#EXTINF:${i},`,`${t}?hls=${o.seq}`)}return s&&r.push("#EXT-X-ENDLIST"),r.join(`
`)}async getHlsPlaylist(t){const s=this._log.bindPrefix("getHlsPlaylist");return s("getting hls playlist"),this.setDeadTimeout(this.onHlsTimeout,je),this._generation!==0?this.generateHlsPlaylist(t):(this.start(),new Promise(i=>{const r=o=>{s("hls playlist fetch error, returning empty+end",o),i(this.generateHlsPlaylist(t,!0))};this._pendingRejects.push(r),this._hlsWaitingForBuffer.push(()=>{const o=this._pendingRejects.indexOf(r);o!==-1&&this._pendingRejects.splice(o,1),i(this.generateHlsPlaylist(t))})}))}getInitChunk(){return this._initChunk?.data}async getHlsChunk(t){const s=this._log.bindPrefix("getHlsChunk");s("getting hls chunk",t);const i=this._buffer.find(r=>r.seq===t);if(i&&i.segment)return i.segment;if(this._buffer.length&&t<this._buffer[0].seq){s("hls chunk to old",t),s(this._buffer);return}return new Promise((r,o)=>{const l=bt.setInterval(()=>{this._buffer.length&&t<this._buffer[0].seq&&(s("hls chunk fetch timeout",t),r(void 0))},this._chunkTime??500),_=f=>{clearInterval(l),o(f)},g=this._hlsWaitingForChunk.get(t)||[];g.push(f=>{const c=this._pendingRejects.indexOf(_);c!==-1&&this._pendingRejects.splice(c,1),clearInterval(l),r(f)}),this._pendingRejects.push(_),this._hlsWaitingForChunk.set(t,g)})}}async function fr(e,t,s){const i=JSON.parse(decodeURIComponent(t));let r=Nt.get(i.id);const o=s?.startsWith("hls="),l=await bt.clients.get(e.clientId),_=qt(l.url);if(r||(R("creating rtmp stream",i.id),r=new hr(i,_),Nt.set(i.id,r)),o){s=s.split("&t=")[0];const g=e.request.url.split("?")[0],f=s.slice(4);if(f==="playlist")return r.getHlsPlaylist(g).then(u=>new Response(u,{headers:{"Content-Type":lr}}));if(f==="init"){const u=r.getInitChunk();return u?new Response(u,{headers:{"Content-Type":Je}}):new Response("",{status:404})}const c=Number(f);return isNaN(c)?new Response("",{status:404}):r.getHlsChunk(c).then(u=>u?new Response(u,{headers:{"Content-Type":Je}}):new Response("",{status:404}))}return new Response(r.createStream(),{headers:{"Content-Type":"video/mp4"}})}function pr(e,t,s){const i=fr(e,t,s);e.respondWith(i)}function dr([e,t]){const s=Nt.get(e+"");s&&s.destroy(),ct&&t&&_e.delete(e)}const zt=()=>new Response("",{status:500,statusText:"Internal Server Error",headers:{"Cache-Control":"no-cache"}}),_r="application/x-mpegurl",gs=self;Q("HLS");const wt=Q("SW-HLS");function mr(e){return e?.mime_type===_r}class ys{constructor(){this.ongoingRequests=new Map}async performRequest(t,s){let i=this.ongoingRequests.get(t);i||this.ongoingRequests.set(t,i=s());const r=await i;return this.ongoingRequests.delete(t),r}}const $e=new ht("cachedHlsQualityFiles"),gr=new ys;async function yr(e,t,s){const i=H();e.respondWith(i);try{const r=t,o=await gs.clients.get(e.clientId),l=qt(o.url),_=await gr.performRequest(me(r),()=>wr(r,l));i.resolve(new Response(_))}catch(r){i.resolve(zt()),wt.error(r)}}async function wr(e,t){const i=await(await vr(e,t)).text();return await br(i,t)}function me(e){return`hls_quality_${e}`}async function vr(e,t){try{const s=await $e.getFile(me(e));return wt.info("using cached quality file",e),s}catch{wt.info("fetching quality file",e);const s=await J.invoke("downloadDoc",{docId:e,accountNumber:t});return $e.saveFile(me(e),s),s}}async function br(e,t){const s="mtproto:(\\d+)",i=e.match(new RegExp(s));if(!i)throw new Error("Wrong Hls quality file format");const r=i[1];if(wt.info("targetDocId",r),!r)throw new Error("Wrong Hls quality file format");const o=await J.invoke("requestDoc",{docId:r,accountNumber:t}),l={docId:r,dcId:o.dc_id,size:o.size,mimeType:o.mime_type},_=`hls_stream/${encodeURIComponent(JSON.stringify(l))}`,g=new URL(_,location.origin).toString();return e.replace(new RegExp(s,"g"),g)}const ws="Time-Cached",Fr=24*60*60,be=new ht("cachedHlsStreamChunks"),Sr=new ys;async function Ur(e,t){const s=[];let i=0;for(const l of t){const _=await Sr.performRequest(Fe(e,l),()=>Mr(e,l));i+=_.length,s.push(_)}if(s.length===1)return s[0];const r=new Uint8Array(i);let o=0;for(const l of s)r.set(l,o),o+=l.length;return r}async function Mr(e,t){try{const s=Fe(e,t),i=await be.getFile(s,"blob");return await Kt(i)}catch{const{bytes:s}=await J.invoke("requestFilePart",{...e,...t});return Tr(s,e,t),s}}function Fe(e,t){return`${e.accountNumber}-${e.docId}?offset=${t.offset}&limit=${t.limit}`}async function Tr(e,t,s){const i=Fe(t,s),r=new Response(e,{headers:{"Content-Length":""+e.length,"Content-Type":"application/octet-stream",[ws]:""+(Date.now()/1e3|0)}});await be.save(i,r)}async function kr(){await Ct(2e4),He(),setInterval(He,18e5)}function He(){return be.timeoutOperation(async e=>{const t=await e.keys(),s=Date.now()/1e3|0;await Promise.all(t.map(async i=>{const r=await e.match(i);if(!r)return;const o=+r.headers.get(ws);o&&(o+Fr>s||(wt("deleting cached stream chunk",i.url),await e.delete(i)))}))})}const xt=4096,ot=1024*1024;function xr(e,t){const s=Math.floor(e/xt)*xt,i=(Math.floor(t/xt)+1)*xt,r=Math.floor(e/ot)*ot,o=(Math.floor(e/ot)+1)*ot,l=Math.min(o,i),_=l-s,g=Ve(_),f=Math.max(l-g,r),c=[{offset:f,limit:g}];let u=o;for(;u<t&&!((Math.floor(u/ot)+1)*ot>t);)c.push({offset:u,limit:ot}),u+=ot;if(u<=t){const U=t-u+1,x=Ve(U);c.push({offset:u,limit:x})}const d=c[c.length-1],S=d.offset+d.limit-1;return{alignedLowerBound:f,alignedUpperBound:S,ranges:c}}function Ve(e){return Math.max(2**Math.ceil(Math.log2(e)),xt)}const Pr=self;async function Er(e,t,s){const i=H();e.respondWith(i);try{const{docId:r,dcId:o,size:l,mimeType:_}=JSON.parse(decodeURIComponent(t)),g=ls(e.request.headers.get("Range")),f=await Pr.clients.get(e.clientId),c=qt(f.url),[u,d]=g,{ranges:S,alignedLowerBound:U}=xr(u,d),x=await Ur({docId:r,dcId:o,accountNumber:c},S),A={"Accept-Ranges":"bytes","Content-Range":`bytes ${g[0]}-${g[1]}/${l||"*"}`,"Content-Length":`${d-u+1}`};A["Content-Type"]=_;const T=x.slice(u-U,d-U+1);i.resolve(new Response(T,{status:206,statusText:"Partial Content",headers:A}))}catch(r){i.resolve(zt()),wt.error(r)}}let vs;function Ir(){return vs}function Ar(e){return vs=e}const Cr="mtproto:",Br=1e6,Dr=1280,Or=720;function Rr(e){let t=Nr(e);if(Ir().IS_AV1_SUPPORTED||(t=t.filter(i=>i.codec!=="av01")),!t.length)return null;t.sort((i,r)=>i.bandwidth-r.bandwidth);let s=`#EXTM3U
`;for(const i of t){const{w:r,h:o,bandwidth:l,url:_}=i;s+=`#EXT-X-STREAM-INF:BANDWIDTH=${l},RESOLUTION=${r}x${o}
`,s+=_+`
`}return s+=`
#EXT-X-ENDLIST`,s}function Nr(e){if(!e?.length)return[];const t=Lr(e),s=qr(e);return Object.entries(t).map(([i,r])=>{const{w:o=Dr,h:l=Or,duration:_=0,video_codec:g}=r,{size:f}=e.find(u=>u.id.toString()===i),c=(_>0?f/_*8:Br)|0;return{id:i,w:o,h:l,duration:_,bandwidth:c,url:s[i],codec:g}})}function Lr(e){const t={};for(const s of e){const i=s?.attributes?.find(r=>r._==="documentAttributeVideo");i&&(t[s.id]=i)}return t}function qr(e){const t={};for(const s of e)mr(s)&&(t[Wr(s)]=zr(s));return t}function zr(e){return`hls_quality_file/${e.id}`}function Wr(e){const t=e.attributes?.find(i=>i._==="documentAttributeFilename");return(e.file_name||t?.file_name)?.slice(Cr.length)}async function jr(e,t,s){const i=H();e.respondWith(i);try{const r=JSON.parse(decodeURIComponent(t)),o=await gs.clients.get(e.clientId),l=qt(o.url),_=r.location?.id,g=await J.invoke("requestAltDocsByDoc",{docId:_,accountNumber:l});if(!g)throw new Error("No alt docs found for document");const f=Rr(g);if(!f)throw new Error("Failed to create video source for hls streaming");i.resolve(new Response(f))}catch(r){i.resolve(zt()),wt.error(r)}}const Jr=new ht("cachedBackgrounds");function $r(e){const t=e.request.url.match(/backgrounds.*/)[0];if(!t){e.respondWith(zt());return}const s=H();e.respondWith(s),(async()=>{const i=await Jr.getFile(t,"blob");s.resolve(new Response(i,{status:200}))})()}Q("SW-mtproto-bug",vt.Debug);const R=Q("SW",vt.Error|vt.Debug|vt.Log|vt.Warn,!0),it=self;let St;const ge=()=>St;let Yt;const ye=(...e)=>{ve().then(t=>{t.forEach(s=>{J.invokeVoid(...e,s)})})};R("init");const Hr=e=>{const t=new MessageChannel;J.attachPort(St=t.port1),J.invokeVoid("port",void 0,e,[t.port2]);const s=new MessageChannel;Ot.attachPort(Yt=s.port1),J.invokeVoid("serviceCryptoPort",void 0,e,[s.port2])},Vr=e=>{!rt.size&&!St&&(R("sending message port for mtproto"),Hr(e))},bs=e=>{if(R("window connected",e.id,"windows before",rt.size),e.frameType==="none"){R.warn("maybe a bugged Safari starting window",e.id);return}R("windows",Array.from(rt)),J.invokeVoid("hello",void 0,e),Vr(e),rt.set(e.id,e),zi(e)},J=new Ai;J.addMultipleEventsListeners({environment:e=>{Ar(e)},notificationsClear:xi,toggleStorages:({enabled:e,clearWrite:t})=>{ht.toggleStorage(e,t)},pushPing:(e,t)=>{Ei(e,t)},hello:(e,t)=>{bs(t)},shownNotification:Ii,leaveRtmpCall:dr,toggleStreamInUse:pi,toggleCacheStorage:e=>{ht.temporarilyToggle(e)},toggleUsingPasscode:e=>{Ut.resolveDeferred(e.isUsingPasscode),yt.save(e.isUsingPasscode?e.encryptionKey:null)},saveEncryptionKey:e=>{yt.save(e)}});const{onDownloadFetch:Yr,onClosedWindows:Kr}=Oi(J);ve().then(e=>{R(`got ${e.length} windows from the start`),e.forEach(t=>{bs(t)})});const rt=new Map;self.connectedWindows=rt;Ci(J,void 0,e=>{if(R("something has disconnected",e),!(e instanceof WindowClient)||!rt.has(e.id)){R.warn("it is not a window");return}rt.delete(e.id),R("window disconnected, left",rt.size),rt.size||(R.warn("no windows left"),yt.resetDeferred(),Ut.resetDeferred(),St&&(J.detachPort(St),St=void 0),Yt&&(Ot.detachPort(Yt),Yt=void 0),Kr())});kr();const Gr=e=>{if(!ct&&e.request.url.indexOf(location.origin+"/")===0&&e.request.url.match(/\.(js|css|jpe?g|json|wasm|png|mp3|svg|tgs|ico|woff2?|ttf|webmanifest?)(?:\?.*)?$/))return e.respondWith(Ns(e));try{const[t,s]=e.request.url.split("/").slice(-2),[i,r]=s.split("?");switch(t){case"stream":{fi(e,i,r);break}case"d":case"download":{Yr(e,i);break}case"share":{Wi(e,i);break}case"ping":{e.respondWith(new Response("pong"));break}case"rtmp":{pr(e,i,r);break}case"hls":{jr(e,i,r);break}case"hls_quality_file":{yr(e,i,r);break}case"hls_stream":{Er(e,i,r);break}case"backgrounds":{$r(e);break}}}catch(t){R.error("fetch error",t),e.respondWith(zt())}},Fs=()=>{it.onfetch=Gr};it.addEventListener("install",e=>{R("installing"),e.waitUntil(it.skipWaiting().then(()=>R("skipped waiting")))});it.addEventListener("activate",e=>{R("activating",it),e.waitUntil(it.caches.delete(ts).then(()=>R("cleared assets cache"))),e.waitUntil(it.clients.claim().then(()=>R("claimed clients")))});it.onoffline=it.ononline=Fs;Fs();
//# sourceMappingURL=sw-CvrHCxud.js.map
